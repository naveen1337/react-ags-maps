{"version":3,"sources":["webpack:///C:/Users/chubs/development/react-ags-maps/node_modules/@arcgis/core/views/2d/engine/webgl/effects/post-processing/Bloom.js"],"names":["s","r","o","n","a","this","_intensityFBO","_compositeFBO","_mipsFBOs","Array","_nMips","_kernelSizeArray","_size","_programDesc","luminosityHighPass","vsPath","fsPath","attributes","Map","gaussianBlur","composite","blit","key","value","_quad","dispose","_t","horizontal","vertical","t","_a","l","h","width","u","height","p","context","c","painter","materialManager","d","gl","_","g","strength","f","radius","b","threshold","_createOrResizeResources","setStencilTestEnabled","setBlendingEnabled","setBlendFunction","setStencilWriteMask","F","bind","bindFramebuffer","B","getProgram","useProgram","bindTexture","colorTexture","setUniform1i","setUniform3fv","setUniform1f","O","Math","round","setViewport","setClearColor","clear","COLOR_BUFFER_BIT","draw","T","_e","_i","name","setUniform2fv","_o","x","setUniform1fv","w","unbind","e","i","resize","colorTarget","depthStencilTarget","target","pixelFormat","internalFormat","dataType","wrapMode","samplingMode","flipped","_n"],"mappings":"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","file":"154-3f78a1d4b0ea793b2139.js","sourcesContent":["import _classCallCheck from \"C:/Users/chubs/development/react-ags-maps/docz/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:/Users/chubs/development/react-ags-maps/docz/node_modules/@babel/runtime/helpers/esm/createClass\";\n\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport \"../../../../../webgl/BufferObject.js\";\nimport t from \"../../../../../webgl/FramebufferObject.js\";\nimport \"../../../../../../core/has.js\";\nimport \"../../../../../webgl/enums.js\";\nimport \"../../../../../webgl/RenderingContext.js\";\nimport \"../../../../../../chunks/builtins.js\";\nimport \"../../../../../webgl/Texture.js\";\nimport \"../../../../../webgl/VertexArrayObject.js\";\nimport e from \"../../VertexStream.js\";\nvar i = 5,\n    s = [1, 0],\n    r = [0, 1],\n    o = [1, .8, .6, .4, .2],\n    n = [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1];\n\nvar a = /*#__PURE__*/function () {\n  function a() {\n    _classCallCheck(this, a);\n\n    this._intensityFBO = null, this._compositeFBO = null, this._mipsFBOs = new Array(i), this._nMips = i, this._kernelSizeArray = [3, 5, 7, 9, 11], this._size = [0, 0], this._programDesc = {\n      luminosityHighPass: {\n        vsPath: \"post-processing/pp\",\n        fsPath: \"post-processing/bloom/luminosityHighPass\",\n        attributes: new Map([[\"a_position\", 0]])\n      },\n      gaussianBlur: {\n        vsPath: \"post-processing/pp\",\n        fsPath: \"post-processing/bloom/gaussianBlur\",\n        attributes: new Map([[\"a_position\", 0]])\n      },\n      composite: {\n        vsPath: \"post-processing/pp\",\n        fsPath: \"post-processing/bloom/composite\",\n        attributes: new Map([[\"a_position\", 0]])\n      },\n      blit: {\n        vsPath: \"post-processing/pp\",\n        fsPath: \"post-processing/blit\",\n        attributes: new Map([[\"a_position\", 0]])\n      }\n    };\n  }\n\n  _createClass(a, [{\n    key: \"dispose\",\n    value: function dispose() {\n      if (this._quad && (this._quad.dispose(), this._quad = null), this._intensityFBO && (this._intensityFBO.dispose(), this._intensityFBO = null), this._compositeFBO && (this._compositeFBO.dispose(), this._compositeFBO = null), this._mipsFBOs) {\n        for (var _t = 0; _t < this._nMips; _t++) {\n          this._mipsFBOs[_t] && (this._mipsFBOs[_t].horizontal.dispose(), this._mipsFBOs[_t].vertical.dispose());\n        }\n\n        this._mipsFBOs = null;\n      }\n    }\n  }, {\n    key: \"draw\",\n    value: function draw(t, _a, l) {\n      var h = _a.width,\n          u = _a.height,\n          p = t.context,\n          m = t.painter,\n          c = m.materialManager,\n          d = p.gl,\n          _ = this._programDesc,\n          g = l.strength,\n          f = l.radius,\n          b = l.threshold;\n      this._quad || (this._quad = new e(p, [-1, -1, 1, -1, -1, 1, 1, 1])), this._createOrResizeResources(t, h, u), p.setStencilTestEnabled(!1), p.setBlendingEnabled(!0), p.setBlendFunction(1, 771), p.setStencilWriteMask(0);\n      var F = this._quad;\n      F.bind(), p.bindFramebuffer(this._intensityFBO);\n      var B = c.getProgram(t, _.luminosityHighPass);\n      p.useProgram(B), p.bindTexture(_a.colorTexture, 0), B.setUniform1i(\"u_texture\", 0), B.setUniform3fv(\"u_defaultColor\", [0, 0, 0]), B.setUniform1f(\"u_defaultOpacity\", 0), B.setUniform1f(\"u_luminosityThreshold\", b), B.setUniform1f(\"u_smoothWidth\", .01);\n      var O = [Math.round(h / 2), Math.round(u / 2)];\n      p.setViewport(0, 0, O[0], O[1]), p.setClearColor(0, 0, 0, 0), p.clear(d.COLOR_BUFFER_BIT), F.draw(), p.setBlendingEnabled(!1);\n      var T = this._intensityFBO.colorTexture;\n\n      for (var _e = 0; _e < this._nMips; _e++) {\n        var _i = c.getProgram(t, _.gaussianBlur, [{\n          name: \"radius\",\n          value: this._kernelSizeArray[_e]\n        }]);\n\n        p.useProgram(_i), p.bindTexture(T, _e + 1), _i.setUniform1i(\"u_colorTexture\", _e + 1), _i.setUniform2fv(\"u_texSize\", O), _i.setUniform2fv(\"u_direction\", s), p.setViewport(0, 0, O[0], O[1]);\n        var _o = this._mipsFBOs[_e];\n        p.bindFramebuffer(_o.horizontal), F.draw(), T = _o.horizontal.colorTexture, p.bindFramebuffer(_o.vertical), p.bindTexture(T, _e + 1), _i.setUniform2fv(\"u_direction\", r), F.draw(), T = _o.vertical.colorTexture, O[0] = Math.round(O[0] / 2), O[1] = Math.round(O[1] / 2);\n      }\n\n      p.setViewport(0, 0, h, u);\n      var x = c.getProgram(t, _.composite, [{\n        name: \"nummips\",\n        value: i\n      }]);\n      p.bindFramebuffer(this._compositeFBO), p.useProgram(x), x.setUniform1f(\"u_bloomStrength\", g), x.setUniform1f(\"u_bloomRadius\", f), x.setUniform1fv(\"u_bloomFactors\", o), x.setUniform3fv(\"u_bloomTintColors\", n), p.bindTexture(this._mipsFBOs[0].vertical.colorTexture, 1), x.setUniform1i(\"u_blurTexture1\", 1), p.bindTexture(this._mipsFBOs[1].vertical.colorTexture, 2), x.setUniform1i(\"u_blurTexture2\", 2), p.bindTexture(this._mipsFBOs[2].vertical.colorTexture, 3), x.setUniform1i(\"u_blurTexture3\", 3), p.bindTexture(this._mipsFBOs[3].vertical.colorTexture, 4), x.setUniform1i(\"u_blurTexture4\", 4), p.bindTexture(this._mipsFBOs[4].vertical.colorTexture, 5), x.setUniform1i(\"u_blurTexture5\", 5), F.draw(), p.bindFramebuffer(_a), p.setBlendingEnabled(!0);\n      var w = c.getProgram(t, _.blit);\n      p.useProgram(w), p.bindTexture(this._compositeFBO.colorTexture, 6), w.setUniform1i(\"u_texture\", 6), p.setBlendFunction(1, 1), F.draw(), F.unbind(), p.setBlendFunction(1, 771), p.setStencilTestEnabled(!0);\n    }\n  }, {\n    key: \"_createOrResizeResources\",\n    value: function _createOrResizeResources(e, i, s) {\n      var r = e.context;\n      if (this._compositeFBO && this._size[0] === i && this._size[1] === s) return;\n      this._size[0] = i, this._size[1] = s;\n      var o = [Math.round(i / 2), Math.round(s / 2)];\n      this._compositeFBO ? this._compositeFBO.resize(i, s) : this._compositeFBO = new t(r, {\n        colorTarget: 0,\n        depthStencilTarget: 0,\n        width: i,\n        height: s\n      }), this._intensityFBO ? this._intensityFBO.resize(o[0], o[1]) : this._intensityFBO = new t(r, {\n        colorTarget: 0,\n        depthStencilTarget: 0,\n        width: o[0],\n        height: o[1]\n      }, {\n        target: 3553,\n        pixelFormat: 6408,\n        internalFormat: 6408,\n        dataType: 5121,\n        wrapMode: 33071,\n        samplingMode: 9729,\n        flipped: !1,\n        width: o[0],\n        height: o[1]\n      });\n\n      for (var _n = 0; _n < this._nMips; _n++) {\n        this._mipsFBOs[_n] ? (this._mipsFBOs[_n].horizontal.resize(o[0], o[1]), this._mipsFBOs[_n].vertical.resize(o[0], o[1])) : this._mipsFBOs[_n] = {\n          horizontal: new t(r, {\n            colorTarget: 0,\n            depthStencilTarget: 0,\n            width: o[0],\n            height: o[1]\n          }, {\n            target: 3553,\n            pixelFormat: 6408,\n            internalFormat: 6408,\n            dataType: 5121,\n            wrapMode: 33071,\n            samplingMode: 9729,\n            flipped: !1,\n            width: o[0],\n            height: o[1]\n          }),\n          vertical: new t(r, {\n            colorTarget: 0,\n            depthStencilTarget: 0,\n            width: o[0],\n            height: o[1]\n          }, {\n            target: 3553,\n            pixelFormat: 6408,\n            internalFormat: 6408,\n            dataType: 5121,\n            wrapMode: 33071,\n            samplingMode: 9729,\n            flipped: !1,\n            width: o[0],\n            height: o[1]\n          })\n        }, o[0] = Math.round(o[0] / 2), o[1] = Math.round(o[1] / 2);\n      }\n    }\n  }]);\n\n  return a;\n}();\n\nexport { a as Bloom };"],"sourceRoot":""}