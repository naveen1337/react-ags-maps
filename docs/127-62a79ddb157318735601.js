(window.webpackJsonp=window.webpackJsonp||[]).push([[127],{d3un:function(e,t,r){"use strict";r.r(t);var a=r("mK0O"),n=r("eijD"),i=r("0942"),o=r("4Mpa"),l=r("hisu"),c=r("yBJb"),y=r("CHlC"),u=r("kMo5"),s=r("P+uj"),p=r("NthX"),b=r.n(p),f=r("dQW7"),O=(r("ZTBZ"),r("4VMI")),d=(r("fb8N"),r("kDog")),m=r("Mp7X"),j=r("0fJP"),v=r("7im+"),g=r("d4jZ"),h=r("67w/"),S=r("8N15"),w=r("xAIp"),N=(r("wckI"),r("J4Pc"),r("TM+E"),r("mp5+")),k=r("iaHD"),x=r("jr4m"),J=r("B9Yk"),T=r("pkWm"),L=r("12QT"),C=r("EOOn"),I=r("HnKO"),M=r("QZQ7"),P=r("CQtW"),D=r("9P7x"),R=r("oTsO"),E=r("44so"),G=r("wJzb"),_=r("SPOG"),F=r("2d0T"),A=r("DKWO"),B=r("I5De"),W=r("+yVN"),Q=r("YHXj"),z=r("nd5+");function H(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Z(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?H(Object(r),!0).forEach((function(t){Object(a.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):H(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function K(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return X(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return X(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var a=0,n=function(){};return{s:n,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){l=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(l)throw i}}}}function X(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function V(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=Object(s.a)(e);if(t){var n=Object(s.a)(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return Object(u.a)(this,r)}}function Y(e){return e.layers.some((function(e){return null!=e.layerDefinition.visibilityField}))}var U=new _.a({name:"OBJECTID",alias:"OBJECTID",type:"oid",nullable:!1,editable:!1}),$=new _.a({name:"title",alias:"Title",type:"string",nullable:!0,editable:!0}),q=function(e){Object(y.a)(r,e);var t=V(r);function r(){var e;return Object(l.a)(this,r),(e=t.apply(this,arguments)).visibilityMode="inherited",e}return Object(c.a)(r,[{key:"initialize",value:function(){var e,t=this,r=K(this.graphics);try{for(r.s();!(e=r.n()).done;){e.value.sourceLayer=this.layer}}catch(a){r.e(a)}finally{r.f()}this.graphics.on("after-add",(function(e){e.item.sourceLayer=t.layer})),this.graphics.on("after-remove",(function(e){e.item.sourceLayer=null}))}},{key:"sublayers",get:function(){return this.graphics}}]),r}(I.default);Object(f.a)([Object(w.b)({readOnly:!0})],q.prototype,"sublayers",null),Object(f.a)([Object(w.b)()],q.prototype,"layer",void 0),Object(f.a)([Object(w.b)({readOnly:!0})],q.prototype,"visibilityMode",void 0),q=Object(f.a)([Object(k.a)("esri.layers.MapNotesLayer.MapNotesSublayer")],q);var ee=[{geometryType:"polygon",geometryTypeJSON:"esriGeometryPolygon",layerId:"polygonLayer",title:"Polygons",identifyingSymbol:(new F.a).toJSON()},{geometryType:"polyline",geometryTypeJSON:"esriGeometryPolyline",layerId:"polylineLayer",title:"Polylines",identifyingSymbol:(new A.a).toJSON()},{geometryType:"multipoint",geometryTypeJSON:"esriGeometryMultipoint",layerId:"multipointLayer",title:"Multipoints",identifyingSymbol:(new B.a).toJSON()},{geometryType:"point",geometryTypeJSON:"esriGeometryPoint",layerId:"pointLayer",title:"Points",identifyingSymbol:(new B.a).toJSON()},{geometryType:"point",geometryTypeJSON:"esriGeometryPoint",layerId:"textLayer",title:"Text",identifyingSymbol:(new W.a).toJSON()}],te=function(e){Object(y.a)(a,e);var t,r=V(a);function a(e){var t;return Object(l.a)(this,a),(t=r.call(this,e)).capabilities={operations:{supportsMapNotesEditing:!0}},t.featureCollections=null,t.featureCollectionJSON=null,t.featureCollectionType="notes",t.legendEnabled=!1,t.minScale=0,t.maxScale=0,t.spatialReference=Q.a.WGS84,t.sublayers=new d.a(ee.map((function(e){return new q({id:e.layerId,title:e.title,layer:Object(i.a)(t)})}))),t.title="Map Notes",t.type="map-notes",t.visibilityMode="inherited",t}return Object(c.a)(a,[{key:"readCapabilities",value:function(e,t,r){return{operations:{supportsMapNotesEditing:!Y(t)&&"portal-item"!==(null==r?void 0:r.origin)}}}},{key:"readFeatureCollections",value:function(e,t,r){if(!Y(t))return null;var a=t.layers.map((function(e){var t=new C.default;return t.read(e,r),t}));return new d.a({items:a})}},{key:"readLegacyfeatureCollectionJSON",value:function(e,t){return Y(t)?Object(j.a)(t.featureCollection):null}},{key:"readFullExtent",value:function(e,t){if(!t.layers.length)return new z.a({xmin:-180,ymin:-90,xmax:180,ymax:90,spatialReference:Q.a.WGS84});var r=Q.a.fromJSON(t.layers[0].layerDefinition.spatialReference);return t.layers.reduce((function(e,t){var r=t.layerDefinition.extent;return r?z.a.fromJSON(r).union(e):e}),new z.a({spatialReference:r}))}},{key:"readMinScale",value:function(e,t){var r,a=K(t.layers);try{for(a.s();!(r=a.n()).done;){var n=r.value;if(null!=n.layerDefinition.minScale)return n.layerDefinition.minScale}}catch(i){a.e(i)}finally{a.f()}return 0}},{key:"readMaxScale",value:function(e,t){var r,a=K(t.layers);try{for(a.s();!(r=a.n()).done;){var n=r.value;if(null!=n.layerDefinition.maxScale)return n.layerDefinition.maxScale}}catch(i){a.e(i)}finally{a.f()}return 0}},{key:"multipointLayer",get:function(){return this._findSublayer("multipointLayer")}},{key:"pointLayer",get:function(){return this._findSublayer("pointLayer")}},{key:"polygonLayer",get:function(){return this._findSublayer("polygonLayer")}},{key:"polylineLayer",get:function(){return this._findSublayer("polylineLayer")}},{key:"readSpatialReference",value:function(e,t){return t.layers.length?Q.a.fromJSON(t.layers[0].layerDefinition.spatialReference):Q.a.WGS84}},{key:"readSublayers",value:function(e,t,r){var a=this;if(Y(t))return null;for(var n=[],i=function(e){var r=t.layers[e],i=r.layerDefinition,o=r.featureSet,c=null!=(l=i.geometryType)?l:o.geometryType,y=ee.find((function(e){var t,r,a;return c===e.geometryTypeJSON&&(null==(t=i.drawingInfo)||null==(r=t.renderer)||null==(a=r.symbol)?void 0:a.type)===e.identifyingSymbol.type}));if(y){var u=new q({id:y.layerId,title:i.name,layer:a,graphics:o.features.map((function(e){var t=e.geometry,r=e.symbol,a=e.attributes,n=e.popupInfo;return O.a.fromJSON({attributes:a,geometry:t,symbol:r,popupTemplate:n})}))});n.push(u)}},o=0;o<t.layers.length;o++){var l;i(o)}return new d.a(n)}},{key:"writeSublayers",value:function(e,t,r,a){var n=this,i=this.minScale,o=this.maxScale;if(!Object(v.h)(e)){var l=e.some((function(e){return e.graphics.length>0}));if(this.capabilities.operations.supportsMapNotesEditing){var c,y=[],u=this.spatialReference.toJSON(),s=K(e);try{e:for(s.s();!(c=s.n()).done;){var p,b=K(c.value.graphics);try{for(b.s();!(p=b.n()).done;){var f=p.value;if(Object(v.i)(f.geometry)){u=f.geometry.spatialReference.toJSON();break e}}}catch(S){b.e(S)}finally{b.f()}}}catch(S){s.e(S)}finally{s.f()}var O,d=K(ee);try{var j=function(){var t=O.value,r=e.find((function(e){return t.layerId===e.id}));n._writeMapNoteSublayer(y,r,t,i,o,u,a)};for(d.s();!(O=d.n()).done;)j()}catch(S){d.e(S)}finally{d.f()}Object(h.c)("featureCollection.layers",y,t)}else{var g;l&&(null==a||null==(g=a.messages)||g.push(new m.a("map-notes-layer:editing-not-supported","New map notes cannot be added to this layer")))}}}},{key:"textLayer",get:function(){return this._findSublayer("textLayer")}},{key:"load",value:function(e){return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Feature Collection"]},e)),Promise.resolve(this)}},{key:"read",value:function(e,t){"featureCollection"in e&&(e=Object(j.a)(e),Object.assign(e,e.featureCollection)),Object(o.a)(Object(s.a)(a.prototype),"read",this).call(this,e,t)}},{key:"beforeSave",value:(t=Object(n.a)(b.a.mark((function e(){var t,r,a,n,i,o,l,c,y,u;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Object(v.h)(this.sublayers)){e.next=2;break}return e.abrupt("return");case 2:t=null,r=[],a=K(this.sublayers),e.prev=5,a.s();case 7:if((n=a.n()).done){e.next=40;break}i=n.value,o=K(i.graphics),e.prev=10,o.s();case 12:if((l=o.n()).done){e.next=30;break}if(c=l.value,!Object(v.i)(c.geometry)){e.next=28;break}if(y=c.geometry,!t){e.next=26;break}if(e.t0=Object(L.c)(y.spatialReference,t),e.t0){e.next=24;break}if(e.t1=Object(J.b)(y.spatialReference,t)||Object(J.f)(),e.t1){e.next=23;break}return e.next=23,Object(J.h)();case 23:c.geometry=Object(J.i)(y,t);case 24:e.next=27;break;case 26:t=y.spatialReference;case 27:r.push(c);case 28:e.next=12;break;case 30:e.next=35;break;case 32:e.prev=32,e.t2=e.catch(10),o.e(e.t2);case 35:return e.prev=35,o.f(),e.finish(35);case 38:e.next=7;break;case 40:e.next=45;break;case 42:e.prev=42,e.t3=e.catch(5),a.e(e.t3);case 45:return e.prev=45,a.f(),e.finish(45);case 48:return e.next=50,Object(T.a)(r.map((function(e){return e.geometry})));case 50:u=e.sent,r.forEach((function(e,t){return e.geometry=u[t]}));case 52:case"end":return e.stop()}}),e,this,[[5,42,45,48],[10,32,35,38]])}))),function(){return t.apply(this,arguments)})},{key:"_findSublayer",value:function(e){var t,r;return Object(v.h)(this.sublayers)?null:null!=(t=null==(r=this.sublayers)?void 0:r.find((function(t){return t.id===e})))?t:null}},{key:"_writeMapNoteSublayer",value:function(e,t,r,a,n,i,o){var l=[];if(!Object(v.h)(t)){var c,y=K(t.graphics);try{for(y.s();!(c=y.n()).done;){var u=c.value;this._writeMapNote(l,u,r.geometryType,o)}}catch(s){y.e(s)}finally{y.f()}this._normalizeObjectIds(l,U),e.push({layerDefinition:{name:t.title,drawingInfo:{renderer:{type:"simple",symbol:Object(j.a)(r.identifyingSymbol)}},geometryType:r.geometryTypeJSON,minScale:a,maxScale:n,objectIdField:"OBJECTID",fields:[U.toJSON(),$.toJSON()],spatialReference:i},featureSet:{features:l,geometryType:r.geometryTypeJSON}})}}},{key:"_writeMapNote",value:function(e,t,r,a){if(!Object(v.h)(t)){var n,i,o=t.geometry,l=t.symbol,c=t.popupTemplate;if(!Object(v.h)(o))if(o.type===r)if(Object(v.h)(l))null==a||null==(i=a.messages)||i.push(new S.a("map-notes-layer:no-symbol","Skipping map notes with no symbol",{graphic:t}));else{var y={attributes:Z({},t.attributes),geometry:o.toJSON(),symbol:l.toJSON()};Object(v.i)(c)&&(y.popupInfo=c.toJSON()),e.push(y)}else null==a||null==(n=a.messages)||n.push(new S.a("map-notes-layer:invalid-geometry-type",'Geometry "'.concat(o.type,'" cannot be saved in "').concat(r,'" layer'),{graphic:t}))}}},{key:"_normalizeObjectIds",value:function(e,t){var r,a=t.name,n=Object(P.a)(a,e)+1,i=new Set,o=K(e);try{for(o.s();!(r=o.n()).done;){var l=r.value;l.attributes||(l.attributes={});var c=l.attributes;(null==c[a]||i.has(c[a]))&&(c[a]=n++),i.add(c[a])}}catch(y){o.e(y)}finally{o.f()}}}]),a}(Object(D.a)(Object(G.a)(Object(R.a)(Object(E.a)(Object(g.a)(M.a))))));Object(f.a)([Object(w.b)({readOnly:!0})],te.prototype,"capabilities",void 0),Object(f.a)([Object(N.a)(["portal-item","web-map"],"capabilities",["layers"])],te.prototype,"readCapabilities",null),Object(f.a)([Object(w.b)({readOnly:!0})],te.prototype,"featureCollections",void 0),Object(f.a)([Object(N.a)(["web-map","portal-item"],"featureCollections",["layers"])],te.prototype,"readFeatureCollections",null),Object(f.a)([Object(w.b)({readOnly:!0,json:{origins:{"web-map":{write:{enabled:!0,target:"featureCollection"}}}}})],te.prototype,"featureCollectionJSON",void 0),Object(f.a)([Object(N.a)(["web-map","portal-item"],"featureCollectionJSON",["featureCollection"])],te.prototype,"readLegacyfeatureCollectionJSON",null),Object(f.a)([Object(w.b)({readOnly:!0,json:{read:!1,write:{enabled:!0,ignoreOrigin:!0}}})],te.prototype,"featureCollectionType",void 0),Object(f.a)([Object(w.b)({json:{write:!1}})],te.prototype,"fullExtent",void 0),Object(f.a)([Object(N.a)(["web-map","portal-item"],"fullExtent",["layers"])],te.prototype,"readFullExtent",null),Object(f.a)([Object(w.b)({readOnly:!0,json:{origins:{"web-map":{write:{target:"featureCollection.showLegend",overridePolicy:function(){return{enabled:null!=this.featureCollectionJSON}}}}}}})],te.prototype,"legendEnabled",void 0),Object(f.a)([Object(w.b)({type:["show","hide"]})],te.prototype,"listMode",void 0),Object(f.a)([Object(w.b)({type:Number,nonNullable:!0,json:{write:!1}})],te.prototype,"minScale",void 0),Object(f.a)([Object(N.a)(["web-map","portal-item"],"minScale",["layers"])],te.prototype,"readMinScale",null),Object(f.a)([Object(w.b)({type:Number,nonNullable:!0,json:{write:!1}})],te.prototype,"maxScale",void 0),Object(f.a)([Object(N.a)(["web-map","portal-item"],"maxScale",["layers"])],te.prototype,"readMaxScale",null),Object(f.a)([Object(w.b)({readOnly:!0})],te.prototype,"multipointLayer",null),Object(f.a)([Object(w.b)({value:"ArcGISFeatureLayer",type:["ArcGISFeatureLayer"]})],te.prototype,"operationalLayerType",void 0),Object(f.a)([Object(w.b)({readOnly:!0})],te.prototype,"pointLayer",null),Object(f.a)([Object(w.b)({readOnly:!0})],te.prototype,"polygonLayer",null),Object(f.a)([Object(w.b)({readOnly:!0})],te.prototype,"polylineLayer",null),Object(f.a)([Object(w.b)({type:Q.a})],te.prototype,"spatialReference",void 0),Object(f.a)([Object(N.a)(["web-map","portal-item"],"spatialReference",["layers"])],te.prototype,"readSpatialReference",null),Object(f.a)([Object(w.b)({readOnly:!0,json:{origins:{"web-map":{write:{ignoreOrigin:!0}}}}})],te.prototype,"sublayers",void 0),Object(f.a)([Object(N.a)("web-map","sublayers",["layers"])],te.prototype,"readSublayers",null),Object(f.a)([Object(x.a)("web-map","sublayers")],te.prototype,"writeSublayers",null),Object(f.a)([Object(w.b)({readOnly:!0})],te.prototype,"textLayer",null),Object(f.a)([Object(w.b)()],te.prototype,"title",void 0),Object(f.a)([Object(w.b)({readOnly:!0,json:{read:!1}})],te.prototype,"type",void 0);var re=te=Object(f.a)([Object(k.a)("esri.layers.MapNotesLayer")],te);t.default=re}}]);
//# sourceMappingURL=127-62a79ddb157318735601.js.map