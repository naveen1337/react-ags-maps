{"version":3,"sources":["webpack:///C:/Users/chubs/development/react-ags-maps/node_modules/@arcgis/core/views/2d/engine/webgl/effects/post-processing/DropShadow.js"],"names":["s","o","a","this","_horizontalBlurFBO","_verticalBlurFBO","_size","_programDesc","blur","vsPath","fsPath","attributes","Map","composite","blit","key","value","_layerFBOTexture","dispose","t","r","_a","l","context","n","state","u","painter","h","pixelRatio","p","materialManager","d","c","width","m","height","_","Math","round","f","blurRadius","B","offsetX","g","offsetY","b","color","F","_createOrResizeResources","w","x","setStencilWriteMask","setStencilTestEnabled","setDepthWriteEnabled","setDepthTestEnabled","T","copyToTexture","_quad","setViewport","O","bind","setBlendingEnabled","v","getProgram","name","ceil","useProgram","bindFramebuffer","bindTexture","colorTexture","setUniformMatrix3fv","displayMat3","setUniform2fv","setUniform1i","setUniform1f","draw","z","setUniform4fv","setBlendFunction","unbind","e","i","_a2","resize","colorTarget","depthStencilTarget","target","pixelFormat","internalFormat","dataType","wrapMode","samplingMode","flipped"],"mappings":"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","file":"157-c3f1bf1e6a2ee9392044.js","sourcesContent":["import _classCallCheck from \"C:/Users/chubs/development/react-ags-maps/docz/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:/Users/chubs/development/react-ags-maps/docz/node_modules/@babel/runtime/helpers/esm/createClass\";\n\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { pt2px as e } from \"../../../../../../core/screenUtils.js\";\nimport \"../../../../../webgl/BufferObject.js\";\nimport t from \"../../../../../webgl/FramebufferObject.js\";\nimport \"../../../../../../core/has.js\";\nimport \"../../../../../webgl/enums.js\";\nimport \"../../../../../webgl/RenderingContext.js\";\nimport \"../../../../../../chunks/builtins.js\";\nimport r from \"../../../../../webgl/Texture.js\";\nimport \"../../../../../webgl/VertexArrayObject.js\";\nimport i from \"../../VertexStream.js\";\nvar s = [1, 0],\n    o = [0, 1];\n\nvar a = /*#__PURE__*/function () {\n  function a() {\n    _classCallCheck(this, a);\n\n    this._horizontalBlurFBO = null, this._verticalBlurFBO = null, this._size = [0, 0], this._programDesc = {\n      blur: {\n        vsPath: \"post-processing/drop-shadow\",\n        fsPath: \"post-processing/blur/gaussianBlur\",\n        attributes: new Map([[\"a_position\", 0]])\n      },\n      composite: {\n        vsPath: \"post-processing/pp\",\n        fsPath: \"post-processing/drop-shadow/composite\",\n        attributes: new Map([[\"a_position\", 0]])\n      },\n      blit: {\n        vsPath: \"post-processing/pp\",\n        fsPath: \"post-processing/blit\",\n        attributes: new Map([[\"a_position\", 0]])\n      }\n    };\n  }\n\n  _createClass(a, [{\n    key: \"dispose\",\n    value: function dispose() {\n      this._layerFBOTexture && (this._layerFBOTexture.dispose(), this._layerFBOTexture = null), this._horizontalBlurFBO && (this._horizontalBlurFBO.dispose(), this._horizontalBlurFBO = null), this._verticalBlurFBO && (this._verticalBlurFBO.dispose(), this._verticalBlurFBO = null);\n    }\n  }, {\n    key: \"draw\",\n    value: function draw(t, r, _a) {\n      var l = t.context,\n          n = t.state,\n          u = t.painter,\n          h = t.pixelRatio,\n          p = u.materialManager,\n          d = this._programDesc,\n          c = r.width,\n          m = r.height,\n          _ = [Math.round(c / 2), Math.round(m / 2)],\n          f = _a.blurRadius,\n          B = _a.offsetX,\n          g = _a.offsetY,\n          b = _a.color,\n          F = [h * e(B / 2), h * e(g / 2)];\n\n      this._createOrResizeResources(t, c, m, _);\n\n      var w = this._horizontalBlurFBO,\n          x = this._verticalBlurFBO;\n      l.setStencilWriteMask(0), l.setStencilTestEnabled(!1), l.setDepthWriteEnabled(!1), l.setDepthTestEnabled(!1);\n      var T = this._layerFBOTexture;\n      r.copyToTexture(0, 0, c, m, 0, 0, T), this._quad || (this._quad = new i(l, [-1, -1, 1, -1, -1, 1, 1, 1])), l.setViewport(0, 0, _[0], _[1]);\n      var O = this._quad;\n      O.bind(), l.setBlendingEnabled(!1);\n      var v = p.getProgram(t, d.blur, [{\n        name: \"radius\",\n        value: Math.ceil(f)\n      }]);\n      l.useProgram(v), l.bindFramebuffer(w), l.bindTexture(r.colorTexture, 4), v.setUniformMatrix3fv(\"u_displayViewMat3\", n.displayMat3), v.setUniform2fv(\"u_offset\", F), v.setUniform1i(\"u_colorTexture\", 4), v.setUniform2fv(\"u_texSize\", _), v.setUniform2fv(\"u_direction\", s), v.setUniform1f(\"u_sigma\", f), O.draw(), l.bindFramebuffer(x), l.bindTexture(w.colorTexture, 5), v.setUniformMatrix3fv(\"u_displayViewMat3\", n.displayMat3), v.setUniform2fv(\"u_offset\", [0, 0]), v.setUniform1i(\"u_colorTexture\", 5), v.setUniform2fv(\"u_direction\", o), O.draw(), l.bindFramebuffer(r), l.setViewport(0, 0, c, m);\n      var z = p.getProgram(t, d.composite);\n      l.useProgram(z), l.bindTexture(x.colorTexture, 2), z.setUniform1i(\"u_blurTexture\", 2), l.bindTexture(T, 3), z.setUniform1i(\"u_layerFBOTexture\", 3), z.setUniform4fv(\"u_shadowColor\", [b[3] * (b[0] / 255), b[3] * (b[1] / 255), b[3] * (b[2] / 255), b[3]]), O.draw(), l.setBlendingEnabled(!0), l.setStencilTestEnabled(!0), l.setBlendFunction(1, 771), O.unbind();\n    }\n  }, {\n    key: \"_createOrResizeResources\",\n    value: function _createOrResizeResources(e, i, s, o) {\n      var _a2 = e.context;\n      this._horizontalBlurFBO && this._size[0] === i && this._size[1] === s || (this._size[0] = i, this._size[1] = s, this._horizontalBlurFBO ? this._horizontalBlurFBO.resize(o[0], o[1]) : this._horizontalBlurFBO = new t(_a2, {\n        colorTarget: 0,\n        depthStencilTarget: 0,\n        width: o[0],\n        height: o[1]\n      }, {\n        target: 3553,\n        pixelFormat: 6408,\n        internalFormat: 6408,\n        dataType: 5121,\n        wrapMode: 33071,\n        samplingMode: 9729,\n        flipped: !1,\n        width: o[0],\n        height: o[1]\n      }), this._verticalBlurFBO ? this._verticalBlurFBO.resize(o[0], o[1]) : this._verticalBlurFBO = new t(_a2, {\n        colorTarget: 0,\n        depthStencilTarget: 0,\n        width: o[0],\n        height: o[1]\n      }, {\n        target: 3553,\n        pixelFormat: 6408,\n        internalFormat: 6408,\n        dataType: 5121,\n        wrapMode: 33071,\n        samplingMode: 9729,\n        flipped: !1,\n        width: o[0],\n        height: o[1]\n      }), this._layerFBOTexture ? this._layerFBOTexture.resize(i, s) : this._layerFBOTexture = new r(_a2, {\n        target: 3553,\n        pixelFormat: 6408,\n        internalFormat: 6408,\n        dataType: 5121,\n        wrapMode: 33071,\n        samplingMode: 9729,\n        flipped: !1,\n        width: i,\n        height: s\n      }));\n    }\n  }]);\n\n  return a;\n}();\n\nexport { a as DropShadow };"],"sourceRoot":""}