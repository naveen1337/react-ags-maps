(window.webpackJsonp=window.webpackJsonp||[]).push([[70],{tyZc:function(e,t,n){"use strict";n.r(t),n.d(t,"registerFunctions",(function(){return T}));var r=n("VfH5"),a=n("lOyF"),i=n("iSw9"),l=n("b8W3"),c=n("A1aO"),o=n("u6Q5"),s=n("O3Ru"),u=n("6SOj"),f=n("dg0F"),d=n("ZWCB"),y=n("0yMr"),b=n("YNd3"),m=n("Raue"),p=n("omx3"),h=n("x/s0"),v=n("adSR"),O=n("IH5m"),g=n("xnqp"),j=n("EOOn"),F=n("SPOG");function I(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return E(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return E(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){c=!0,i=e},f:function(){try{l||null==n.return||n.return()}finally{if(c)throw i}}}}function E(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function w(e,t,n){var r=e.getVariables();if(r.length>0){for(var a=[],i=0;i<r.length;i++){var l={name:r[i]};a.push(t.evaluateIdentifier(n,l))}return Object(O.b)(a).then((function(t){for(var n={},a=0;a<r.length;a++)n[r[a]]=t[a];return e.parameters=n,e}))}return Object(O.t)(e)}function D(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;for(var r in e)if(r.toLowerCase()===t.toLowerCase())return e[r];return n}function A(e){if(null===e)return null;var t={type:D(e,"type",""),name:D(e,"name","")};if("range"===t.type)t.range=D(e,"range",[]);else{t.codedValues=[];var n,r=I(D(e,"codedValues",[]));try{for(r.s();!(n=r.n()).done;){var a=n.value;t.codedValues.push({name:D(a,"name",""),code:D(a,"code",null)})}}catch(i){r.e(i)}finally{r.f()}}return t}function x(e){if(null===e)return null;var t={},n=D(e,"wkt",null);null!==n&&(t.wkt=n);var r=D(e,"wkid",null);return null!==r&&(t.wkid=r),t}function N(e){if(null===e)return null;var t={hasZ:D(e,"hasz",!1),hasM:D(e,"hasm",!1)},n=D(e,"spatialreference",null);n&&(t.spatialReference=x(n));var r=D(e,"x",null);if(null!==r)return t.x=r,t.y=D(e,"y",null),t;var a=D(e,"rings",null);if(null!==a)return t.rings=a,t;var i=D(e,"paths",null);if(null!==i)return t.paths=i,t;var l=D(e,"points",null);if(null!==l)return t.points=l,t;for(var c=0,o=["xmin","xmax","ymin","ymax","zmin","zmax","mmin","mmax"];c<o.length;c++){var s=o[c],u=D(e,s,null);null!==u&&(t[s]=u)}return t}function S(e){return!!e.layerDefinition&&!!e.featureSet&&!1!==function(e,t){var n,r=I(t);try{for(r.s();!(n=r.n()).done;){if(n.value===e)return!0}}catch(a){r.e(a)}finally{r.f()}return!1}(e.layerDefinition.geometryType,["","esriGeometryPoint","esriGeometryPolyline","esriGeometryPolygon","esriGeometryMultipoint","esriGeometryEnvelope"])&&null!==e.layerDefinition.objectIdField&&""!==e.layerDefinition.objectIdField&&!1!==Object(o.u)(e.layerDefinition.fields)&&!1!==Object(o.u)(e.featureSet.features)}function T(e){"async"===e.mode&&(e.functions.getuser=function(t,n){return e.standardFunctionAsync(t,n,(function(e,n,i){Object(o.J)(i,1,2);var l=Object(o.c)(i[1],""),s=!0===l;if(l=!0===l||!1===l?"":Object(o.x)(l),i[0]instanceof r.a){var u=null;return t.services&&t.services.portal&&(u=t.services.portal),u=Object(c.getPortal)(i[0],u),Object(c.lookupUser)(u,l,s).then((function(e){if(e){for(var t=JSON.parse(JSON.stringify(e)),n=0,r=["lastLogin","created","modified"];n<r.length;n++){var i=r[n];void 0!==t[i]&&null!==t[i]&&(t[i]=new Date(t[i]))}return a.a.convertObjectToArcadeDictionary(t)}return null}))}var f=null;if(Object(o.K)(i[0])&&(f=i[0]),f)return s=!1,l?null:f.load().then((function(){return f.getOwningSystemUrl()})).then((function(e){if(!e)return l?null:f.getIdentityUser().then((function(e){return e?a.a.convertObjectToArcadeDictionary({username:e}):null}));var n=null;return t.services&&t.services.portal&&(n=t.services.portal),n=Object(c.getPortal)(new r.a(e),n),Object(c.lookupUser)(n,l,s).then((function(e){if(e){for(var t=JSON.parse(JSON.stringify(e)),n=0,r=["lastLogin","created","modified"];n<r.length;n++){var i=r[n];void 0!==t[i]&&null!==t[i]&&(t[i]=new Date(t[i]))}return a.a.convertObjectToArcadeDictionary(t)}return null}))}));throw new Error("Invalid Parameter")}))},e.signatures.push({name:"getuser",min:"1",max:"2"}),e.functions.featuresetbyid=function(t,n){return e.standardFunctionAsync(t,n,(function(e,t,n){if(Object(o.J)(n,2,4),n[0]instanceof l.a){var r=Object(o.x)(n[1]),a=Object(o.c)(n[2],null),i=Object(o.O)(Object(o.c)(n[3],!0));if(null===a&&(a=["*"]),!1===Object(o.u)(a))throw new Error("Invalid Parameter");return n[0].featureSetById(r,i,a)}throw new Error("Invalid Parameter")}))},e.signatures.push({name:"featuresetbyid",min:"2",max:"4"}),e.functions.featuresetbyportalitem=function(t,n){return e.standardFunctionAsync(t,n,(function(e,n,a){if(Object(o.J)(a,2,5),null===a[0])throw new Error("Portal is required");if(a[0]instanceof r.a){var i=Object(o.x)(a[1]),l=Object(o.x)(a[2]),s=Object(o.c)(a[3],null),u=Object(o.O)(Object(o.c)(a[4],!0));if(null===s&&(s=["*"]),!1===Object(o.u)(s))throw new Error("Invalid Parameter");var f=null;return t.services&&t.services.portal&&(f=t.services.portal),f=Object(c.getPortal)(a[0],f),Object(c.constructFeatureSetFromPortalItem)(i,l,t.spatialReference,s,u,f,t.lrucache,t.interceptor)}if(!1===Object(o.A)(a[0]))throw new Error("Portal is required");var d=Object(o.x)(a[0]),y=Object(o.x)(a[1]),b=Object(o.c)(a[2],null),m=Object(o.O)(Object(o.c)(a[3],!0));if(null===b&&(b=["*"]),!1===Object(o.u)(b))throw new Error("Invalid Parameter");if(t.services&&t.services.portal)return Object(c.constructFeatureSetFromPortalItem)(d,y,t.spatialReference,b,m,t.services.portal,t.lrucache,t.interceptor);throw new Error("Portal is required")}))},e.signatures.push({name:"featuresetbyportalitem",min:"2",max:"5"}),e.functions.featuresetbyname=function(t,n){return e.standardFunctionAsync(t,n,(function(e,t,n){if(Object(o.J)(n,2,4),n[0]instanceof l.a){var r=Object(o.x)(n[1]),a=Object(o.c)(n[2],null),i=Object(o.O)(Object(o.c)(n[3],!0));if(null===a&&(a=["*"]),!1===Object(o.u)(a))throw new Error("Invalid Parameter");return n[0].featureSetByName(r,i,a)}throw new Error("Invalid Parameter")}))},e.signatures.push({name:"featuresetbyname",min:"2",max:"4"}),e.functions.featureset=function(t,n){return e.standardFunction(t,n,(function(e,n,r){Object(o.J)(r,1,1);var i=r[0],l={layerDefinition:{geometryType:"",objectIdField:"",globalIdField:"",typeIdField:"",fields:[]},featureSet:{geometryType:"",features:[]}};if(Object(o.A)(i))void 0!==(i=JSON.parse(i)).layerDefinition?(l.layerDefinition=i.layerDefinition,l.featureSet=i.featureSet,i.layerDefinition.spatialReference&&(l.layerDefinition.spatialReference=i.layerDefinition.spatialReference)):(l.featureSet.features=i.features,l.featureSet.geometryType=i.geometryType,l.layerDefinition.geometryType=l.featureSet.geometryType,l.layerDefinition.objectIdField=i.objectIdFieldName,l.layerDefinition.typeIdField=i.typeIdFieldName,l.layerDefinition.globalIdField=i.globalIdFieldName,l.layerDefinition.fields=i.fields,i.spatialReference&&(l.layerDefinition.spatialReference=i.spatialReference));else{if(!(r[0]instanceof a.a))throw new Error("Invalid Parameter");var c=D(i=JSON.parse(r[0].castToText()),"layerdefinition");if(null!==c){l.layerDefinition.geometryType=D(c,"geometrytype",""),l.featureSet.geometryType=l.layerDefinition.geometryType,l.layerDefinition.globalIdField=D(c,"globalidfield",""),l.layerDefinition.objectIdField=D(c,"objectidfield",""),l.layerDefinition.typeIdField=D(c,"typeidfield","");var s=D(c,"spatialreference",null);s&&(l.layerDefinition.spatialReference=x(s));var u,f=I(D(c,"fields",[]));try{for(f.s();!(u=f.n()).done;){var d=u.value,y={name:D(d,"name",""),alias:D(d,"alias",""),type:D(d,"type",""),nullable:D(d,"nullable",!0),editable:D(d,"editable",!0),length:D(d,"length",null),domain:A(D(d,"domain"))};l.layerDefinition.fields.push(y)}}catch(_){f.e(_)}finally{f.f()}var m=D(i,"featureset",null);if(m){var p,h={},v=I(l.layerDefinition.fields);try{for(v.s();!(p=v.n()).done;){var O=p.value;h[O.name.toLowerCase()]=O.name}}catch(_){v.e(_)}finally{v.f()}var g,j=I(D(m,"features",[]));try{for(j.s();!(g=j.n()).done;){var F=g.value,E={},w=D(F,"attributes",{});for(var T in w)E[h[T.toLowerCase()]]=w[T];l.featureSet.features.push({attributes:E,geometry:N(D(F,"geometry",null))})}}catch(_){j.e(_)}finally{j.f()}}}else{l.layerDefinition.geometryType=D(i,"geometrytype",""),l.featureSet.geometryType=l.layerDefinition.geometryType,l.layerDefinition.objectIdField=D(i,"objectidfieldname",""),l.layerDefinition.typeIdField=D(i,"typeidfieldname","");var C=D(i,"spatialreference",null);C&&(l.layerDefinition.spatialReference=x(C));var L,R=I(D(i,"fields",[]));try{for(R.s();!(L=R.n()).done;){var W=L.value,P={name:D(W,"name",""),alias:D(W,"alias",""),type:D(W,"type",""),nullable:D(W,"nullable",!0),editable:D(W,"editable",!0),length:D(W,"length",null),domain:A(D(W,"domain"))};l.layerDefinition.fields.push(P)}}catch(_){R.e(_)}finally{R.f()}var k,M={},J=I(l.layerDefinition.fields);try{for(J.s();!(k=J.n()).done;){var G=k.value;M[G.name.toLowerCase()]=G.name}}catch(_){J.e(_)}finally{J.f()}var B,V=I(D(i,"features",[]));try{for(V.s();!(B=V.n()).done;){var H=B.value,z={},K=D(H,"attributes",{});for(var U in K)z[M[U.toLowerCase()]]=K[U];l.featureSet.features.push({attributes:z,geometry:N(D(H,"geometry",null))})}}catch(_){V.e(_)}finally{V.f()}}}if(!1===S(l))throw new Error("Invalid Parameter");return b.a.create(l,t.spatialReference)}))},e.signatures.push({name:"featureset",min:"1",max:"1"}),e.functions.filter=function(t,n){return e.standardFunctionAsync(t,n,(function(n,r,a){return Object(o.J)(a,2,2),Object(o.K)(a[0])?a[0].load().then((function(n){var r=g.WhereClause.create(a[1],n.getFieldsIndex()),i=r.getVariables();if(i.length>0){for(var l=[],c=0;c<i.length;c++){var o={name:i[c]};l.push(e.evaluateIdentifier(t,o))}return Object(O.b)(l).then((function(e){for(var t={},n=0;n<i.length;n++)t[i[n]]=e[n];return r.parameters=t,new u.a({parentfeatureset:a[0],whereclause:r})}))}return Object(O.t)(new u.a({parentfeatureset:a[0],whereclause:r}))})):e.failDefferred("Filter cannot accept this parameter type")}))},e.signatures.push({name:"filter",min:"2",max:"2"}),e.functions.orderby=function(t,n){return e.standardFunctionAsync(t,n,(function(t,n,r){if(Object(o.J)(r,2,2),Object(o.K)(r[0])){var a=new m.a(r[1]);return Object(O.t)(new f.a({parentfeatureset:r[0],orderbyclause:a}))}return e.failDefferred("Order cannot accept this parameter type")}))},e.signatures.push({name:"orderby",min:"2",max:"2"}),e.functions.top=function(t,n){return e.standardFunctionAsync(t,n,(function(t,n,r){return Object(o.J)(r,2,2),Object(o.K)(r[0])?Object(O.t)(new d.a({parentfeatureset:r[0],topnum:r[1]})):Object(o.u)(r[0])?Object(o.N)(r[1])>=r[0].length?r[0].slice(0):r[0].slice(0,Object(o.N)(r[1])):Object(o.v)(r[0])?Object(o.N)(r[1])>=r[0].length()?r[0].slice(0):r[0].slice(0,Object(o.N)(r[1])):e.failDefferred("Top cannot accept this parameter type")}))},e.signatures.push({name:"top",min:"2",max:"2"}),e.functions.first=function(t,n){return e.standardFunctionAsync(t,n,(function(e,t,n){return Object(o.J)(n,1,1),Object(o.K)(n[0])?n[0].first(e.abortSignal).then((function(e){if(null!==e){var t=i.a.createFromGraphicLikeObject(e.geometry,e.attributes,n[0]);t._underlyingGraphic=e,e=t}return e})):Object(o.u)(n[0])?0===n[0].length?Object(O.t)(null):Object(O.t)(n[0][0]):Object(o.v)(n[0])?0===n[0].length()?Object(O.t)(null):Object(O.t)(n[0].get(0)):null}))},e.signatures.push({name:"first",min:"1",max:"1"}),e.functions.attachments=function(t,n){return e.standardFunctionAsync(t,n,(function(e,n,r){Object(o.J)(r,1,2);var l={minsize:-1,maxsize:-1,types:null};if(r.length>1)if(r[1]instanceof a.a){if(r[1].hasField("minsize")&&(l.minsize=Object(o.N)(r[1].field("minsize"))),r[1].hasField("maxsize")&&(l.maxsize=Object(o.N)(r[1].field("maxsize"))),r[1].hasField("types")){var s=Object(o.t)(r[1].field("types"),!1);s.length>0&&(l.types=s)}}else if(null!==r[1])throw new Error("Invalid Parameter");if(r[0]instanceof i.a){var u=r[0]._layer;return u instanceof j.default&&(u=Object(c.constructFeatureSet)(u,t.spatialReference,["*"],!0,t.lrucache,t.interceptor)),null===u||!1===Object(o.K)(u)?[]:u.load().then((function(){return u.queryAttachments(r[0].field(u.objectIdField),l.minsize,l.maxsize,l.types)}))}if(null===r[0])return[];throw new Error("Invalid Parameter")}))},e.signatures.push({name:"attachments",min:"1",max:"2"}),e.functions.featuresetbyrelationshipname=function(t,n){return e.standardFunctionAsync(t,n,(function(e,n,r){Object(o.J)(r,2,4);var a=r[0],l=Object(o.x)(r[1]),s=Object(o.c)(r[2],null),u=Object(o.O)(Object(o.c)(r[3],!0));if(null===s&&(s=["*"]),!1===Object(o.u)(s))throw new Error("Invalid Parameter");if(null===r[0])return null;if(!(r[0]instanceof i.a))throw new Error("Invalid Parameter");var f=a._layer;return f instanceof j.default&&(f=Object(c.constructFeatureSet)(f,t.spatialReference,["*"],!0,t.lrucache,t.interceptor)),null===f||!1===Object(o.K)(f)?null:f.load().then((function(e){var n=e.relationshipMetaData().filter((function(e){return e.name===l}));if(0===n.length)return null;if(void 0!==n[0].relationshipTableId&&null!==n[0].relationshipTableId&&n[0].relationshipTableId>-1)return Object(c.constructFeatureSetFromRelationship)(e,n[0],a.field(e.objectIdField),e.spatialReference,s,u,t.lrucache,t.interceptor);var r=e.serviceUrl();return r?(r="/"===r.charAt(r.length-1)?r+n[0].relatedTableId.toString():r+"/"+n[0].relatedTableId.toString(),Object(c.constructFeatureSetFromUrl)(r,e.spatialReference,s,u,t.lrucache,t.interceptor).then((function(t){return t.load().then((function(){return t.relationshipMetaData()})).then((function(r){if(r=r.filter((function(e){return e.id===n[0].id})),!1===a.hasField(n[0].keyField)||null===a.field(n[0].keyField))return e.getFeatureByObjectId(a.field(e.objectIdField),[n[0].keyField]).then((function(e){if(e){var a=g.WhereClause.create(r[0].keyField+"= @id",t.getFieldsIndex());return a.parameters={id:e.attributes[n[0].keyField]},t.filter(a)}return new y.a({parentfeatureset:t})}));var i=g.WhereClause.create(r[0].keyField+"= @id",t.getFieldsIndex());return i.parameters={id:a.field(n[0].keyField)},t.filter(i)}))}))):null}))}))},e.signatures.push({name:"featuresetbyrelationshipname",min:"2",max:"4"}),e.functions.featuresetbyassociation=function(t,n){return e.standardFunctionAsync(t,n,(function(e,n,r){Object(o.J)(r,2,3);var a=r[0],l=Object(o.x)(Object(o.c)(r[1],"")).toLowerCase(),u=Object(o.A)(r[2])?Object(o.x)(r[2]):null;if(null===r[0])return null;if(!(r[0]instanceof i.a))throw new Error("Invalid Parameter");var f=a._layer;return f instanceof j.default&&(f=Object(c.constructFeatureSet)(f,t.spatialReference,["*"],!0,t.lrucache,t.interceptor)),null===f||!1===Object(o.K)(f)?null:f.load().then((function(){var e=f.serviceUrl();return Object(c.constructAssociationMetaDataFeatureSetFromUrl)(e,t.spatialReference)})).then((function(e){var t=null,n=null,r=!1;if(null!==u&&""!==u&&void 0!==u){var i,c=I(e.terminals);try{for(c.s();!(i=c.n()).done;){var d=i.value;d.terminalName===u&&(n=d.terminalId)}}catch(z){c.e(z)}finally{c.f()}null===n&&(r=!0)}var y,b=e.associations.getFieldsIndex(),m=b.get("TOGLOBALID").name,h=b.get("FROMGLOBALID").name,v=b.get("TOTERMINALID").name,O=b.get("FROMTERMINALID").name,j=b.get("FROMNETWORKSOURCEID").name,E=b.get("TONETWORKSOURCEID").name,w=b.get("ASSOCIATIONTYPE").name,D=b.get("ISCONTENTVISIBLE").name,A=b.get("OBJECTID").name,x=I(f.fields);try{for(x.s();!(y=x.n()).done;){var N=y.value;if("global-id"===N.type){t=a.field(N.name);break}}}catch(z){x.e(z)}finally{x.f()}var S=null,T=new s.d(new F.a({name:"percentalong",alias:"percentalong",type:"double"}),g.WhereClause.create("0",e.associations.getFieldsIndex())),C=new s.d(new F.a({name:"side",alias:"side",type:"string"}),g.WhereClause.create("''",e.associations.getFieldsIndex())),L="globalid",R="globalId",W={};for(var P in e.lkp)W[P]=e.lkp[P].sourceId;var k=new s.e(new F.a({name:"classname",alias:"classname",type:"string"}),null,W),M="";switch(l){case"midspan":M="((".concat(m,"='").concat(t,"') OR ( ").concat(h,"='").concat(t,"')) AND (").concat(w," IN (5))"),k.codefield=g.WhereClause.create("CASE WHEN (".concat(m,"='").concat(t,"') THEN ").concat(j," ELSE ").concat(E," END"),e.associations.getFieldsIndex());var J=Object(p.c)(s.a.findField(e.associations.fields,h));J.name=L,J.alias=L,S=new s.d(J,g.WhereClause.create("CASE WHEN (".concat(h,"='").concat(t,"') THEN ").concat(m," ELSE ").concat(h," END"),e.associations.getFieldsIndex())),T=e.unVersion>=4?new s.c(s.a.findField(e.associations.fields,b.get("PERCENTALONG").name)):new s.d(new F.a({name:"percentalong",alias:"percentalong",type:"double"}),g.WhereClause.create("0",e.associations.getFieldsIndex()));break;case"junctionedge":M="((".concat(m,"='").concat(t,"') OR ( ").concat(h,"='").concat(t,"')) AND (").concat(w," IN (4,6))"),k.codefield=g.WhereClause.create("CASE WHEN (".concat(m,"='").concat(t,"') THEN ").concat(j," ELSE ").concat(E," END"),e.associations.getFieldsIndex());var G=Object(p.c)(s.a.findField(e.associations.fields,h));G.name=L,G.alias=L,S=new s.d(G,g.WhereClause.create("CASE WHEN (".concat(h,"='").concat(t,"') THEN ").concat(m," ELSE ").concat(h," END"),e.associations.getFieldsIndex())),C=new s.d(new F.a({name:"side",alias:"side",type:"string"}),g.WhereClause.create("CASE WHEN (".concat(w,"=4) THEN 'from' ELSE 'to' END"),e.associations.getFieldsIndex()));break;case"connected":var B="".concat(m,"='@T'"),V="".concat(h,"='@T'");null!==n&&(B+=" AND ".concat(v,"=@A"),V+=" AND ".concat(O,"=@A")),M="(("+B+") OR ("+V+"))",M=Object(o.l)(M,"@T",t),B=Object(o.l)(B,"@T",t),null!==n&&(B=Object(o.l)(B,"@A",n.toString()),M=Object(o.l)(M,"@A",n.toString())),k.codefield=g.WhereClause.create("CASE WHEN "+B+" THEN ".concat(j," ELSE ").concat(E," END"),e.associations.getFieldsIndex());var H=Object(p.c)(s.a.findField(e.associations.fields,h));H.name=L,H.alias=L,S=new s.d(H,g.WhereClause.create("CASE WHEN "+B+" THEN ".concat(h," ELSE ").concat(m," END"),e.associations.getFieldsIndex()));break;case"container":M="".concat(m,"='").concat(t,"' AND ").concat(w," = 2"),null!==n&&(M+=" AND ".concat(v," = ")+n.toString()),k.codefield=j,M="( "+M+" )",S=new s.b(s.a.findField(e.associations.fields,h),L,L);case"content":M="(".concat(h,"='").concat(t,"' AND ").concat(w," = 2)"),null!==n&&(M+=" AND ".concat(O," = ")+n.toString()),k.codefield=E,M="( "+M+" )",S=new s.b(s.a.findField(e.associations.fields,m),L,L);break;case"structure":M="(".concat(m,"='").concat(t,"' AND ").concat(w," = 3)"),null!==n&&(M+=" AND ".concat(v," = ")+n.toString()),k.codefield=j,M="( "+M+" )",S=new s.b(s.a.findField(e.associations.fields,h),L,R);break;case"attached":M="(".concat(h,"='").concat(t,"' AND ").concat(w," = 3)"),null!==n&&(M+=" AND ".concat(O," = ")+n.toString()),k.codefield=E,M="( "+M+" )",S=new s.b(s.a.findField(e.associations.fields,m),L,R);break;default:throw new Error("Invalid Parameter")}return r&&(M="1 <> 1"),new s.a({parentfeatureset:e.associations,adaptedFields:[new s.c(s.a.findField(e.associations.fields,A)),new s.c(s.a.findField(e.associations.fields,D)),S,C,k,T],extraFilter:M?g.WhereClause.create(M,e.associations.getFieldsIndex()):null})}))}))},e.signatures.push({name:"featuresetbyassociation",min:"2",max:"6"}),e.functions.groupby=function(t,n){return e.standardFunctionAsync(t,n,(function(n,r,i){return Object(o.J)(i,3,3),Object(o.K)(i[0])?i[0].load().then((function(n){var r=[],l=[],c=!1,s=[];if(Object(o.A)(i[1]))s.push(i[1]);else if(i[1]instanceof a.a)s.push(i[1]);else if(Object(o.u)(i[1]))s=i[1];else{if(!Object(o.v)(i[1]))return e.failDefferred("Illegal Value: GroupBy");s=i[1].toArray()}var u,f=I(s);try{for(f.s();!(u=f.n()).done;){var d=u.value;if(Object(o.A)(d)){var y=g.WhereClause.create(Object(o.x)(d),n.getFieldsIndex()),b=!0===Object(h.c)(y)?Object(o.x)(d):"%%%%FIELDNAME";r.push({name:b,expression:y}),"%%%%FIELDNAME"===b&&(c=!0)}else{if(!(d instanceof a.a))return e.failDefferred("Illegal Value: GroupBy");var m=d.hasField("name")?d.field("name"):"%%%%FIELDNAME",p=d.hasField("expression")?d.field("expression"):"";if("%%%%FIELDNAME"===m&&(c=!0),!m)return e.failDefferred("Illegal Value: GroupBy");r.push({name:m,expression:g.WhereClause.create(p||m,n.getFieldsIndex())})}}}catch(q){f.e(q)}finally{f.f()}if(s=[],Object(o.A)(i[2]))s.push(i[2]);else if(Object(o.u)(i[2]))s=i[2];else if(Object(o.v)(i[2]))s=i[2].toArray();else{if(!(i[2]instanceof a.a))return e.failDefferred("Illegal Value: GroupBy");s.push(i[2])}var v,j=I(s);try{for(j.s();!(v=j.n()).done;){var F=v.value;if(!(F instanceof a.a))return e.failDefferred("Illegal Value: GroupBy");var E=F.hasField("name")?F.field("name"):"",D=F.hasField("statistic")?F.field("statistic"):"",A=F.hasField("expression")?F.field("expression"):"";if(!E||!D||!A)return e.failDefferred("Illegal Value: GroupBy");l.push({name:E,statistic:D.toLowerCase(),expression:g.WhereClause.create(A,n.getFieldsIndex())})}}catch(q){j.e(q)}finally{j.f()}if(c){var x,N={},S=I(n.fields);try{for(S.s();!(x=S.n()).done;){N[x.value.name.toLowerCase()]=1}}catch(q){S.e(q)}finally{S.f()}var T,C=I(r);try{for(C.s();!(T=C.n()).done;){var L=T.value;"%%%%FIELDNAME"!==L.name&&(N[L.name.toLowerCase()]=1)}}catch(q){C.e(q)}finally{C.f()}var R,W=I(l);try{for(W.s();!(R=W.n()).done;){var P=R.value;"%%%%FIELDNAME"!==P.name&&(N[P.name.toLowerCase()]=1)}}catch(q){W.e(q)}finally{W.f()}var k,M=0,J=I(r);try{for(J.s();!(k=J.n()).done;){var G=k.value;if("%%%%FIELDNAME"===G.name){for(;1===N["field_"+M.toString()];)M++;N["field_"+M.toString()]=1,G.name="FIELD_"+M.toString()}}}catch(q){J.e(q)}finally{J.f()}}for(var B=[],V=0,H=r;V<H.length;V++){var z=H[V];B.push(w(z.expression,e,t))}for(var K=0,U=l;K<U.length;K++){var _=U[K];B.push(w(_.expression,e,t))}return B.length>0?Object(O.b)(B).then((function(){return Object(O.t)(i[0].groupby(r,l))})):Object(O.t)(i[0].groupby(r,l))})):e.failDefferred("Illegal Value: GroupBy")}))},e.signatures.push({name:"groupby",min:"3",max:"3"}),e.functions.distinct=function(t,n){return e.standardFunctionAsync(t,n,(function(n,r,i){return Object(o.K)(i[0])?(Object(o.J)(i,2,2),i[0].load().then((function(n){var r=[],l=[];if(Object(o.A)(i[1]))l.push(i[1]);else if(i[1]instanceof a.a)l.push(i[1]);else if(Object(o.u)(i[1]))l=i[1];else{if(!Object(o.v)(i[1]))return e.failDefferred("Illegal Value: GroupBy");l=i[1].toArray()}var c,s=!1,u=I(l);try{for(u.s();!(c=u.n()).done;){var f=c.value;if(Object(o.A)(f)){var d=g.WhereClause.create(Object(o.x)(f),n.getFieldsIndex()),y=!0===Object(h.c)(d)?Object(o.x)(f):"%%%%FIELDNAME";r.push({name:y,expression:d}),"%%%%FIELDNAME"===y&&(s=!0)}else{if(!(f instanceof a.a))return e.failDefferred("Illegal Value: GroupBy");var b=f.hasField("name")?f.field("name"):"%%%%FIELDNAME",m=f.hasField("expression")?f.field("expression"):"";if("%%%%FIELDNAME"===b&&(s=!0),!b)return e.failDefferred("Illegal Value: GroupBy");r.push({name:b,expression:g.WhereClause.create(m||b,n.getFieldsIndex())})}}}catch(W){u.e(W)}finally{u.f()}if(s){var p,v={},j=I(n.fields);try{for(j.s();!(p=j.n()).done;){v[p.value.name.toLowerCase()]=1}}catch(W){j.e(W)}finally{j.f()}var F,E=I(r);try{for(E.s();!(F=E.n()).done;){var D=F.value;"%%%%FIELDNAME"!==D.name&&(v[D.name.toLowerCase()]=1)}}catch(W){E.e(W)}finally{E.f()}var A,x=0,N=I(r);try{for(N.s();!(A=N.n()).done;){var S=A.value;if("%%%%FIELDNAME"===S.name){for(;1===v["field_"+x.toString()];)x++;v["field_"+x.toString()]=1,S.name="FIELD_"+x.toString()}}}catch(W){N.e(W)}finally{N.f()}}for(var T=[],C=0,L=r;C<L.length;C++){var R=L[C];T.push(w(R.expression,e,t))}return T.length>0?Object(O.b)(T).then((function(){return Object(O.t)(i[0].groupby(r,[]))})):Object(O.t)(i[0].groupby(r,[]))}))):function(e,t,n,r){if(1===r.length){if(Object(o.u)(r[0]))return Object(v.a)(e,r[0],-1);if(Object(o.v)(r[0]))return Object(v.a)(e,r[0].toArray(),-1)}return Object(v.a)(e,r,-1)}("distinct",0,0,i)}))})}}}]);
//# sourceMappingURL=70-02947cc2c566757c9e6e.js.map