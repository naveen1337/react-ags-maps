{"version":3,"sources":["webpack://lib/C:/Users/chubs/development/react-ags-maps/node_modules/@arcgis/core/AggregateGraphic.js","webpack://lib/C:/Users/chubs/development/react-ags-maps/node_modules/@arcgis/core/views/2d/engine/webgl/visualVariablesUtils.js","webpack://lib/C:/Users/chubs/development/react-ags-maps/node_modules/@arcgis/core/views/2d/layers/FeatureLayerView2D.js","webpack://lib/C:/Users/chubs/development/react-ags-maps/node_modules/@arcgis/core/views/2d/layers/features/tileRenderers.js","webpack://lib/C:/Users/chubs/development/react-ags-maps/node_modules/@arcgis/core/views/2d/layers/support/FeatureCommandQueue.js","webpack://lib/C:/Users/chubs/development/react-ags-maps/node_modules/@arcgis/core/views/2d/layers/support/FeatureLayerProxy.js","webpack://lib/C:/Users/chubs/development/react-ags-maps/node_modules/@arcgis/core/views/2d/tiling/TileManager.js","webpack://lib/C:/Users/chubs/development/react-ags-maps/node_modules/@arcgis/core/views/layers/FeatureLayerView.js","webpack://lib/C:/Users/chubs/development/react-ags-maps/node_modules/@arcgis/core/views/layers/support/FeatureEffect.js","webpack://lib/C:/Users/chubs/development/react-ags-maps/node_modules/@arcgis/core/views/layers/support/FeatureFilter.js","webpack://lib/C:/Users/chubs/development/react-ags-maps/node_modules/@arcgis/core/views/layers/support/popupUtils.js"],"names":[],"mappings":"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","file":"23.render-page.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"./chunks/tslib.es6.js\";import r from\"./Graphic.js\";import{property as t}from\"./core/accessorSupport/decorators/property.js\";import\"./core/has.js\";import\"./core/accessorSupport/ensureType.js\";import\"./core/Logger.js\";import{subclass as o}from\"./core/accessorSupport/decorators/subclass.js\";var p;let s=p=class extends r{constructor(){super(...arguments),this.isAggregate=!0}getEffectivePopupTemplate(e=!1){if(this.popupTemplate)return this.popupTemplate;const r=this.sourceLayer&&this.sourceLayer.featureReduction;return r&&\"popupTemplate\"in r&&r.popupEnabled?r.popupTemplate:null}getObjectId(){return this.objectId}clone(){return new p({objectId:this.objectId,...this.cloneProperties()})}};e([t({type:Boolean})],s.prototype,\"isAggregate\",void 0),e([t({type:Number,json:{read:!0}})],s.prototype,\"objectId\",void 0),s=p=e([o(\"esri.AggregateGraphic\")],s);var c=s;export default c;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from\"../../../../core/Error.js\";import s from\"../../../../core/Logger.js\";import{WGLVVFlag as i}from\"./enums.js\";import{isNumber as r}from\"./Utils.js\";const l=s.getLogger(\"esri.views.2d.engine.webgl\");function o(s){return r(s.minDataValue)&&r(s.maxDataValue)&&null!=s.minSize&&null!=s.maxSize?i.SIZE_MINMAX_VALUE:(s.expression&&\"view.scale\"===s.expression||s.valueExpression&&\"$view.scale\"===s.valueExpression)&&Array.isArray(s.stops)?i.SIZE_SCALE_STOPS:(null!=s.field||s.expression&&\"view.scale\"!==s.expression||s.valueExpression&&\"$view.scale\"!==s.valueExpression)&&(Array.isArray(s.stops)||\"levels\"in s&&s.levels)?i.SIZE_FIELD_STOPS:(null!=s.field||s.expression&&\"view.scale\"!==s.expression||s.valueExpression&&\"$view.scale\"!==s.valueExpression)&&null!=s.valueUnit?i.SIZE_UNIT_VALUE:(l.error(new e(\"mapview-bad-type\",\"Found invalid size VisualVariable\",s)),i.NONE)}export{o as getTypeOfSizeVisualVariable};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../AggregateGraphic.js\";import\"../../../geometry.js\";import i from\"../../../Graphic.js\";import{flatten as r}from\"../../../core/arrayUtils.js\";import s from\"../../../core/Collection.js\";import a from\"../../../core/Error.js\";import n from\"../../../core/has.js\";import{clone as l}from\"../../../core/lang.js\";import o from\"../../../core/Logger.js\";import{andThen as h,unwrapOr as u,isSome as d,isNone as p}from\"../../../core/maybe.js\";import{debounce as c,eachAlwaysValues as f,isAbortError as y,after as g}from\"../../../core/promiseUtils.js\";import{init as m,whenFalseOnce as _}from\"../../../core/watchUtils.js\";import{property as v}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/accessorSupport/ensureType.js\";import{subclass as b}from\"../../../core/accessorSupport/decorators/subclass.js\";import{isHostedAgolService as R}from\"../../../layers/support/arcgisLayerUrl.js\";import{calculateTolerance as x}from\"../../../renderers/support/clickToleranceUtils.js\";import S from\"../../../rest/support/FeatureSet.js\";import w from\"../../../rest/support/Query.js\";import{MAX_FILTERS as F}from\"../engine/webgl/definitions.js\";import{LayerView2DMixin as U}from\"./LayerView2D.js\";import{createSchema as I}from\"./features/schemaUtils.js\";import{createOrReuseTileRenderer as E}from\"./features/tileRenderers.js\";import{computePxBuffer as C}from\"./features/support/pixelBuffering.js\";import{findSizeVV as T,createClusterCountSizeVariable as O,isClusterCompatibleRenderer as j,createClusterRenderer as q}from\"./support/clusterUtils.js\";import P from\"./support/FeatureCommandQueue.js\";import V from\"./support/FeatureLayerProxy.js\";import{toJSONGeometryType as L}from\"./support/util.js\";import{TileManager as N}from\"../tiling/TileManager.js\";import{FeatureLayerView as H}from\"../../layers/FeatureLayerView.js\";import J from\"../../layers/LayerView.js\";import{RefreshableLayerView as k}from\"../../layers/RefreshableLayerView.js\";import z from\"../../layers/effects/EffectList.js\";import $ from\"../../layers/support/FeatureFilter.js\";import M from\"../../layers/support/FeatureEffect.js\";import{createQueryGeometry as Q}from\"../../support/drapedUtils.js\";import A from\"../../webgl/capabilities.js\";import G from\"../../../geometry/Extent.js\";const D=2147483648,B=1,K=e=>(e&D)>>>31===B;function W(e){return e&&\"openPorts\"in e}const X=o.getLogger(\"esri.views.2d.layers.FeatureLayerView2D\");let Y=class extends(H(k(U(J)))){constructor(){super(...arguments),this._pipelineIsUpdating=!0,this._commandsQueue=new P({process:e=>{switch(e.type){case\"processed-edit\":return this._doEdit(e);case\"refresh\":return this._doRefresh();case\"update\":return this._doUpdate()}}}),this._visibilityOverrides=new Set,this._effect=null,this._highlightIds=new Map,this._lastPixelBuffer=0,this._updateHighlight=c((async()=>this._proxy.setHighlight(Array.from(this._highlightIds.keys())))),this._uploadsLocked=!1,this._needsClusterSizeUpdate=!1,this.filter=null,this.effectLists={included:new z,excluded:new z}}destroy(){var e,t;h(this._updateClusterSizeTask,(e=>e.remove())),null==(e=this._proxy)||e.destroy(),null==(t=this.tileRenderer)||t.destroy(),this._commandsQueue.destroy()}initialize(){this.addResolvingPromise(Promise.all([this._initProxy(),this._initServiceOptions()])),this.handles.add([this.on(\"valueRangesChanged\",(e=>{this._set(\"_aggregateValueRanges\",e.valueRanges)})),m(this,\"effect\",(e=>{this.effectLists.included.effect=null==e?void 0:e.includedEffect})),m(this,\"effect\",(e=>{this.effectLists.excluded.effect=null==e?void 0:e.excludedEffect}))])}async _initProxy(){if(\"isTable\"in this.layer&&this.layer.isTable)throw new a(\"featurelayerview:table-not-supported\",\"table feature layer can't be displayed\",{layer:this.layer});this._proxy&&this._proxy.destroy();const e=this._createClientOptions();return this._set(\"_proxy\",new V({client:e})),this._proxy.when()}async _initServiceOptions(){this._set(\"_serviceOptions\",await this._createServiceOptions())}get labelsVisible(){const e=\"subtype-group\"===this.layer.type?this.layer.sublayers.items:[this.layer];return!this.suspended&&e.some((e=>e.labelingInfo&&e.labelsVisible))}get effect(){return u(this._effect,null)}set effect(e){const t=this._effect;d(t)&&d(t.filter)&&t.filter.enabled&&d(e)&&d(e.filter)&&e.filter.enable(),this._effect=e,this.notifyChange(\"effect\")}get effects(){return this.effect&&[this.effect]||[]}get queryMode(){return this._serviceOptions.type}get renderingConfigHash(){if(!this.layer)return null;const e=this.availableFields,t=this.layer,i=this.view.floors,{definitionExpression:r}=t,s=\"subtype-group\"!==this.layer.type&&this.layer.labelsVisible&&this.layer.labelingInfo,a=\"renderer\"in t&&t.renderer,n=\"feature\"===t.type?t.gdbVersion:void 0,l=\"feature\"===t.type&&t.historicMoment?t.historicMoment.getTime():void 0,{timeExtent:o}=this,h=\"stream\"===t.type?`${JSON.stringify(t.geometryDefinition)}${t.definitionExpression}`:null,u=JSON.stringify(this.clips),p=t.featureReduction&&t.featureReduction.toJSON(),c=\"sublayers\"in this.layer&&this.layer.sublayers.items.reduce(((e,t)=>e+`${t.visible?1:0}.${JSON.stringify(t.renderer)}.${t.labelsVisible}\\n.${JSON.stringify(t.labelingInfo)}`),\"\");return JSON.stringify({sublayerHash:c,filterHash:d(this.filter)&&this.filter.toJSON(),effectHash:d(this.effect)&&this.effect.toJSON(),streamFilter:h,gdbVersion:n,definitionExpression:r,historicMoment:l,availableFields:e,renderer:a,labelingInfo:s,timeExtent:o,floors:i,clipsHash:u,featureReduction:p})}get hasEffects(){return this.effectLists.included.hasEffects||this.effectLists.excluded.hasEffects}highlight(e){let t;return e instanceof i?t=[e.getObjectId()]:\"number\"==typeof e||\"string\"==typeof e?t=[e]:s.isCollection(e)?t=e.map((e=>e&&e.getAttribute(this.layer.objectIdField))).toArray():Array.isArray(e)&&e.length>0&&(t=\"number\"==typeof e[0]||\"string\"==typeof e[0]?e:e.map((e=>e&&e.getAttribute(this.layer.objectIdField)))),t&&t.length?(t=t.filter((e=>null!=e)),this._addHighlight(t),{remove:()=>this._removeHighlight(t)}):{remove:()=>{}}}hasHighlight(){return!!this._highlightIds.size}hitTest(e,t){return this._hitTest(e,t)}queryStatistics(){return this._proxy.queryStatistics()}async querySummaryStatistics(e,t,i){const r={...t};var s;t.valueExpression&&(r.viewInfoParams={viewingMode:\"map\",scale:this.view.scale,spatialReference:null==(s=this.view.spatialReference)?void 0:s.toJSON()});return this._proxy.querySummaryStatistics(this._cleanUpQuery(e),r,i)}queryFeatures(e,t){return this.queryFeaturesJSON(e,t).then((e=>{const t=S.fromJSON(e);return t.features.forEach((e=>this._setLayersForFeature(e))),t}))}queryFeaturesJSON(e,t){return this._proxy.queryFeatures(this._cleanUpQuery(e),t)}queryObjectIds(e,t){return this._proxy.queryObjectIds(this._cleanUpQuery(e),t)}queryFeatureCount(e,t){return this._proxy.queryFeatureCount(this._cleanUpQuery(e),t)}queryExtent(e,t){return this._proxy.queryExtent(this._cleanUpQuery(e),t).then((e=>({count:e.count,extent:G.fromJSON(e.extent)})))}setVisibility(e,t){t?this._visibilityOverrides.delete(e):this._visibilityOverrides.add(e),this._update()}update(e){if(!this._tileStrategy||!this.tileRenderer)return;const{hasMissingTiles:t,added:i,removed:r}=this._tileStrategy.update(e);(i.length||r.length)&&this._proxy.updateTiles({added:i,removed:r}),t&&this.requestUpdate(),this.notifyChange(\"updating\")}attach(){this.view.timeline.record(`${this.layer.title} (FeatureLayer) Attach`),this._tileStrategy=new N({acquireTile:e=>this._acquireTile(e),releaseTile:e=>this._releaseTile(e),tileInfoView:this.view.featuresTilingScheme,buffer:0}),this.handles.add(m(this,\"renderingConfigHash\",(()=>this._update())),\"attach\"),\"stream\"!==this.layer.type&&this.handles.add(this.layer.on(\"edits\",(e=>this._edit(e))),\"attach\")}detach(){this.container.removeAllChildren(),this.handles.remove(\"attach\"),this.tileRenderer&&(this.tileRenderer.uninstall(this.container),this.tileRenderer=null),this._tileStrategy&&(this._tileStrategy.destroy(),this._tileStrategy=null),this._tileRendererHash=null}moveStart(){this.requestUpdate()}viewChange(){this.requestUpdate()}moveEnd(){this.requestUpdate()}async fetchPopupFeatures(e,i){if(d(i)&&i.clientGraphics.length){const e=i.clientGraphics[0];if(e instanceof t)return[e];i.clientGraphics=i.clientGraphics.filter((e=>{const{layer:t}=e,i=\"popupEnabled\"in t&&t.popupEnabled,r=\"popupTemplate\"in t&&t.popupTemplate,s=this.view.popup.defaultPopupTemplateEnabled;return i&&(r||s)}))}const s=this.validateFetchPopupFeatures(i);if(s)throw s;if(d(i)&&0===i.clientGraphics.length)return[];const a=this.fetchClientPopupFeatures(i);if(!e)return a;const n=this._fetchServicePopupFeatures(e,i);return f([a,n]).then(r)}async _fetchServicePopupFeatures(e,t){if(\"stream\"===this.layer.type||\"ogc-feature\"===this.layer.type)return[];const i=await this.createPopupQuery(t),{layer:r}=this,s=\"renderer\"in r&&r.renderer,a=d(t)?t.event:null,n=x({renderer:s,event:a});i.geometry=this.createFetchPopupFeaturesQueryGeometry(e,n);const l=new Set,{objectIdField:o}=r,h=d(t)?t.clientGraphics:null;if(h)for(const u of h)l.add(u.attributes[o]);return r.queryFeatures(i).then((e=>e.features.filter((e=>!l.has(e.attributes[o])))))}createFetchPopupFeaturesQueryGeometry(e,t){return Q(e,t,this.view)}isUpdating(){var e;const t=\"renderer\"in this.layer&&null!=this.layer.renderer,i=this._commandsQueue.updating,r=null!=this._updatingRequiredFieldsPromise,s=!this._proxy||!this._proxy.isReady,a=this._pipelineIsUpdating,l=null===this.tileRenderer||(null==(e=this.tileRenderer)?void 0:e.updating),o=t&&(i||r||s||a||l);return n(\"esri-2d-log-updating\")&&console.log(`Updating FLV2D: ${o}\\n  -> hasRenderer ${t}\\n  -> hasPendingCommand ${i}\\n  -> updatingRequiredFields ${r}\\n  -> updatingProxy ${s}\\n  -> updatingPipeline ${a}\\n  -> updatingTileRenderer ${l}\\n`),o}_createClientOptions(){return{setUpdating:e=>{this._set(\"_pipelineIsUpdating\",e)},emitEvent:e=>{this.emit(e.name,e.event)}}}async _detectQueryMode(e){if(\"path\"in e&&R(e.path)&&(\"feature\"===this.layer.type||\"subtype-group\"===this.layer.type)&&\"point\"===this.layer.geometryType&&!this.layer.capabilities.operations.supportsEditing&&n(\"featurelayer-snapshot-enabled\"))try{const e=await this.layer.queryFeatureCount();if(e<=n(\"featurelayer-snapshot-point-min-threshold\"))return{mode:\"snapshot\",featureCount:e};const t=n(\"featurelayer-snapshot-point-max-threshold\"),i=n(\"featurelayer-snapshot-point-coverage\"),r=this.view.extent,s=this.layer.fullExtent,a=null==s?void 0:s.clone().intersection(r),l=(null==a?void 0:a.width)*(null==a?void 0:a.height),o=(null==s?void 0:s.width)*(null==s?void 0:s.height),h=0===o?0:l/o;if(e<=t&&h>=i)return{mode:\"snapshot\",featureCount:e}}catch(t){X.warn(\"mapview-feature-layer\",\"Encountered an error when querying for featureCount\",{error:t})}return{mode:\"on-demand\"}}async _createServiceOptions(){var e;const t=this.layer;if(\"stream\"===t.type)return null;const{capabilities:i,objectIdField:r}=t,s=t.fields.map((e=>e.toJSON())),a=t.fullExtent&&t.fullExtent.toJSON(),n=L(t.geometryType),o=t.timeInfo&&t.timeInfo.toJSON()||null,h=t.spatialReference?t.spatialReference.toJSON():null,u={...\"customParameters\"in t?t.customParameters:void 0,token:\"apiKey\"in t?t.apiKey:void 0},d=\"feature\"===t.type?t.globalIdField:null;let p;\"ogc-feature\"===t.type?p=t.source.getFeatureDefinition():W(t.source)?p=await t.source.openPorts():t.parsedUrl&&(p=l(t.parsedUrl),\"dynamicDataSource\"in t&&t.dynamicDataSource&&(p.query={layer:JSON.stringify({source:t.dynamicDataSource})}));const c=null!=(e=\"subtypeField\"in this.layer&&this.layer.subtypeField)?e:null,{mode:f,featureCount:y}=await this._detectQueryMode(p);return{type:f,subtypeField:c,featureCount:y,globalIdField:d,maxRecordCount:i.query.maxRecordCount,tileMaxRecordCount:i.query.tileMaxRecordCount,capabilities:i,fields:s,fullExtent:a,geometryType:n,objectIdField:r,source:p,timeInfo:o,spatialReference:h,customParameters:u}}async _createMemoryServiceOptions(e){const t=await e.openPorts();return{...this._createServiceOptions(),type:\"memory\",source:t}}_cleanUpQuery(e){const t=w.from(e)||this.createQuery();return t.outSpatialReference||(t.outSpatialReference=this.view.spatialReference),t}async _update(){return this._commandsQueue.push({type:\"update\"})}async _edit(e){if(this._validateEdit(e))return this._commandsQueue.push({type:\"edit\",edits:e})}async doRefresh(){return this._commandsQueue.push({type:\"refresh\"})}_validateEdit(e){const t=\"globalIdField\"in this.layer&&this.layer.globalIdField,i=e.deletedFeatures.some((e=>-1===e.objectId||!e.objectId)),r=t&&this.availableFields.includes(t);return i&&!r?(X.error(new a(\"mapview-apply-edits\",`Editing the specified service requires the layer's globalIdField, ${t} to be included the layer's outFields for updates to be reflected on the map`)),null):e}async _doUpdate(){try{if(this.destroyed||!this._hasRequiredSupport(this.layer)||!this._tileStrategy)return;const{effect:t,filter:i}=this;await this._updateRequiredFields();const{renderer:r}=this._getEffectiveRenderer();this._set(\"_effectiveRenderer\",r);const s=this._createSchemaConfig(),a=L(this.layer.geometryType),n=await C(r,a,this.layer.featureReduction),l=this._createConfiguration(s,i,t);this._lastPixelBuffer=0===n?0:Math.max(n,this._lastPixelBuffer),l.schema.source.pixelBuffer=this._lastPixelBuffer;const o=this._createTileRendererHash(r);if(o!==this._tileRendererHash){await this._initTileRenderer(r);const e=this._serviceOptions;this.effects.forEach((e=>d(e)&&d(e.filter)&&e.filter.enable())),this.tileRenderer.onConfigUpdate(r);const t={added:this._tileStrategy.tileKeys(),removed:[]},i=this.layer;\"stream\"!==i.type&&W(i.source)&&(e.source=await i.source.openPorts()),await this._proxy.startup(this.view.featuresTilingScheme,l,e,t),this.hasHighlight()&&await this._proxy.setHighlight(Array.from(this._highlightIds.keys())),await this._onceTilesUpdated(),this.tileRenderer.onConfigUpdate(r)}else{const t=await this._proxy.update(l);(t.mesh||t.targets.aggregate)&&this._lockGPUUploads();try{await this._proxy.applyUpdate(t)}catch(e){y(e)||X.error(e)}(t.mesh||t.targets.aggregate)&&this._unlockGPUUploads(),this.effects.forEach((e=>d(e)&&d(e.filter)&&e.filter.enable())),this.tileRenderer.onConfigUpdate(r),this._updateClusterSizeVariable(),this._forceAttributeTextureUpload()}this._tileRendererHash=o,this.tileRenderer.invalidateLabels(),this.requestUpdate()}catch(e){}}async _doEdit(e){try{await this._proxy.onEdits(e)}catch(t){y(t),0}}async _doRefresh(){this._lockGPUUploads();try{await this._proxy.refresh()}catch(e){y(e),0}this._unlockGPUUploads()}_updateClusterSizeVariable(){this._needsClusterSizeUpdate&&(this.tileRenderer.onConfigUpdate(this._effectiveRenderer),this._needsClusterSizeUpdate=!1)}_createUpdateClusterSizeTask(e,t){return this.watch(\"_aggregateValueRanges\",(async i=>{this._updateClusterEffectiveRendererSizeVariable(e,t,i),this._needsClusterSizeUpdate=!0,this._uploadsLocked||this._updateClusterSizeVariable()}))}async _updateClusterEffectiveRendererSizeVariable(e,t,i){if(e.dynamicClusterSize&&\"visualVariables\"in e&&e.visualVariables){const r=T(e.visualVariables);if(d(r)&&\"cluster_count\"===r.field){const s=e.visualVariables.indexOf(r);e.visualVariables[s]=O(t,i);const a=e.clone();a.dynamicClusterSize=!0,this._set(\"_effectiveRenderer\",a)}}}_getEffectiveRenderer(){const e=\"renderer\"in this.layer&&this.layer.renderer,t=this.layer.featureReduction;if(d(this._updateClusterSizeTask)&&(this._updateClusterSizeTask.remove(),this._updateClusterSizeTask=null),t&&\"cluster\"===t.type&&j(e)){const i=t,r=[],s=q(r,e,i,this._aggregateValueRanges);return h(this._updateClusterSizeTask,(e=>e.remove())),this._updateClusterSizeTask=this._createUpdateClusterSizeTask(s,i),{renderer:s,aggregateFields:r,featureReduction:t}}return{renderer:e,aggregateFields:[],featureReduction:null}}_acquireTile(e){const t=this.tileRenderer.acquireTile(e);return t.once(\"attach\",(()=>{this.requestUpdate()})),t}_releaseTile(e){this.tileRenderer.releaseTile(e)}async _initTileRenderer(e){const t=await E(e,{layerView:this,tileInfoView:this.view.featuresTilingScheme,layer:this.layer});return this.tileRenderer&&(this._tileStrategy.clear(),this.tileRenderer.uninstall(this.container),this.tileRenderer.destroy(),this.tileRenderer=null),this.destroyed?null:(this._proxy.tileRenderer=t,this._set(\"tileRenderer\",t),this.tileRenderer.install(this.container),this.tileRenderer.onConfigUpdate(e),this.requestUpdate(),this.tileRenderer)}_createTileRendererHash(e){return`${\"heatmap\"===e.type?\"heatmap\":\"symbol\"}.${\"dot-density\"===e.type}`}_createFeatureDataHash(e,t,i){const r=e.getAttributeHash(),s=JSON.stringify(t),a=d(i)&&JSON.stringify(i.filter),n=JSON.stringify(this.timeExtent);let l=\"\";return this._visibilityOverrides.forEach((e=>l+=e)),`${r}.${s}.${a}.${n}.${l}`}get hasFilter(){const e=!!(\"floorInfo\"in this.layer&&this.layer.floorInfo&&this.view.floors&&this.view.floors.length);return!!this.filter||e||!!this._visibilityOverrides.size||!!this.timeExtent}_injectOverrides(e){const t=d(e)?e.timeExtent:null,i=d(this.timeExtent)&&d(t)?this.timeExtent.intersection(t):this.timeExtent||t;let r=null;const s=\"floorInfo\"in this.layer&&this.layer.floorInfo;if(s){const t=d(e)&&e.where;r=this._addFloorFilterClause(t)}if(!this._visibilityOverrides.size&&!i&&!s)return e;const a=d(e)&&e.clone()||new $;return a.hiddenIds=this._visibilityOverrides,a.timeExtent=i,r&&(a.where=r),a}_addFloorFilterClause(e){const t=this.layer;let i=e||\"\";if(\"floorInfo\"in t&&t.floorInfo){var r;let e=this.view.floors;if(!e||!e.length)return i;null!=(r=t.floorInfo.viewAllLevelIds)&&r.length&&(e=t.floorInfo.viewAllLevelIds);const s=e.filter((e=>\"\"!==e)).map((e=>\"'\"+e+\"'\"));s.push(\"''\");const a=t.floorInfo.floorField;let n=\"(\"+a+\" IN ({ids}) OR \"+a+\" IS NULL)\";if(n=n.replace(\"{ids}\",s.join(\", \")),d(i)&&i.includes(a)){let e=new RegExp(\"AND \\\\(\"+a+\".*NULL\\\\)\",\"g\");i=i.replace(e,\"\"),e=new RegExp(\"\\\\(\"+a+\".*NULL\\\\)\",\"g\"),i=i.replace(e,\"\"),i=i.replace(/\\s+/g,\" \").trim()}i=\"\"!==i?\"(\"+i+\") AND \"+n:n}return\"\"!==i?i:null}_createConfiguration(e,t,i){const r=\"feature\"===this.layer.type&&this.layer.historicMoment?this.layer.historicMoment.getTime():void 0,s=\"feature\"===this.layer.type?this.layer.gdbVersion:void 0,a=new Array(F),n=this._injectOverrides(t);a[0]=d(n)?n.toJSON():null,a[1]=d(i)&&i.filter?i.filter.toJSON():null;const l=I(e);if(p(l))return null;const o=A();return{definitionExpression:this.layer.definitionExpression,availableFields:this.availableFields,gdbVersion:s,historicMoment:r,devicePixelRatio:window.devicePixelRatio||1,filters:a,schema:l,supportsTextureFloat:o.supportsTextureFloat,maxTextureSize:o.maxTextureSize}}_hasRequiredSupport(e){var t;return!(\"renderer\"in e&&\"dot-density\"===(null==(t=e.renderer)?void 0:t.type)&&!A().supportsTextureFloat)||(X.error(new a(\"webgl-missing-extension\",\"Missing WebGL extension OES_Texture_Float which is required for DotDensity\")),!1)}_onceTilesUpdated(){return this.requestUpdate(),_(this,\"_pipelineIsUpdating\",!1)}_lockGPUUploads(){this.tileRenderer&&(this._uploadsLocked=!0,this.tileRenderer.lockGPUUploads())}_unlockGPUUploads(){this.tileRenderer&&(this._uploadsLocked=!1,this.tileRenderer.unlockGPUUploads())}_forceAttributeTextureUpload(){this.tileRenderer&&this.tileRenderer.forceAttributeTextureUpload()}_createSchemaConfig(){const e=\"feature\"===this.layer.type?this.layer.historicMoment:null,t=\"feature\"===this.layer.type?this.layer.gdbVersion:null;return{renderer:\"renderer\"in this.layer&&this.layer.renderer,spatialReference:this.layer.spatialReference,timeExtent:this.layer.timeExtent,definitionExpression:this.layer.definitionExpression,featureReduction:this.layer.featureReduction,fields:this.layer.fields,geometryType:this.layer.geometryType,historicMoment:e,labelsVisible:\"labelsVisible\"in this.layer&&this.layer.labelsVisible,labelingInfo:\"labelingInfo\"in this.layer&&this.layer.labelingInfo,availableFields:this.availableFields,effect:this.effect,filter:this.filter,gdbVersion:t,pixelBuffer:0}}_addHighlight(e){for(const t of e)if(this._highlightIds.has(t)){const e=this._highlightIds.get(t);this._highlightIds.set(t,e+1)}else this._highlightIds.set(t,1);this._updateHighlight().catch((e=>{y(e)||X.error(e)}))}_removeHighlight(e){for(const t of e)if(this._highlightIds.has(t)){const e=this._highlightIds.get(t)-1;0===e?this._highlightIds.delete(t):this._highlightIds.set(t,e)}this._updateHighlight().catch((e=>{y(e)||X.error(e)}))}_setLayersForFeature(e){const t=this.layer;e.layer=t,e.sourceLayer=t}_createHittestResult(e){return this._setLayersForFeature(e),d(e.geometry)&&(e.geometry.spatialReference=this.view.spatialReference),e}async _hitTest(e,r){if(this.suspended||!this.tileRenderer)return null;const s=await this.tileRenderer.hitTest(e,r);if(0===s.length)return await g(1),null;const a=s[0];if(!K(a)){const e=await this._proxy.getFeature(a);return h(e,(e=>this._createHittestResult(i.fromJSON(e))))}const n=await this._proxy.getAggregate(a);if(p(n))return null;if(d(n.referenceId)){const e=await this._proxy.getFeature(n.referenceId);return h(e,(e=>this._createHittestResult(i.fromJSON(e))))}return this._createHittestResult(t.fromJSON(n))}};e([v()],Y.prototype,\"_serviceOptions\",void 0),e([v()],Y.prototype,\"_proxy\",void 0),e([v()],Y.prototype,\"_pipelineIsUpdating\",void 0),e([v()],Y.prototype,\"_effectiveRenderer\",void 0),e([v()],Y.prototype,\"_aggregateValueRanges\",void 0),e([v()],Y.prototype,\"_commandsQueue\",void 0),e([v()],Y.prototype,\"labelsVisible\",null),e([v({type:$})],Y.prototype,\"filter\",void 0),e([v({type:M})],Y.prototype,\"effect\",null),e([v({readOnly:!0})],Y.prototype,\"effects\",null),e([v({readOnly:!0})],Y.prototype,\"queryMode\",null),e([v()],Y.prototype,\"renderingConfigHash\",null),e([v()],Y.prototype,\"tileRenderer\",void 0),e([v()],Y.prototype,\"updating\",void 0),Y=e([b(\"esri.views.2d.layers.FeatureLayerView2D\")],Y);var Z=Y;export default Z;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nasync function e(e,a){if(!e)return null;switch(e.type){case\"class-breaks\":case\"simple\":case\"unique-value\":case\"dot-density\":case\"dictionary\":return new((await import(\"./tileRenderers/SymbolTileRenderer.js\")).default)(a);case\"heatmap\":return new((await import(\"./tileRenderers/HeatmapTileRenderer.js\")).default)(a)}}export{e as createOrReuseTileRenderer};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import r from\"../../../../core/Accessor.js\";import{property as s}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/has.js\";import\"../../../../core/accessorSupport/ensureType.js\";import\"../../../../core/Logger.js\";import{subclass as t}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{QueueProcessor as o}from\"../../../support/QueueProcessor.js\";function d(e){return e.some((e=>e.globalId))}function n(e){return e.filter((e=>!e.error)).map((e=>{var r;return null!=(r=e.objectId)?r:e.globalId}))}function a(e,r){const s=new Set(e);for(const t of r.values())s.add(t);return s}function i(e,r){const s=new Set(e);for(const t of r.values())s.delete(t);return s}let u=class extends r{constructor(e){super(),this._hasGlobalIds=!1,this._queueProcessor=new o({concurrency:1,process:e.process})}destroy(){this._queueProcessor.clear()}get updating(){return this._queueProcessor.length>0}push(e){const r=this._queueProcessor,s=r.last();switch(e.type){case\"update\":case\"refresh\":if((null==s?void 0:s.type)===e.type)return;r.push(e).finally((()=>this.notifyChange(\"updating\")));break;case\"edit\":{const t=\"processed-edit\"===(null==s?void 0:s.type)?s:null;t&&r.popLast();const o=this._mergeEdits(t,e);for(const e of o)r.push(e).finally((()=>this.notifyChange(\"updating\")));break}}this.notifyChange(\"updating\")}_mergeEdits(e,r){var s,t;const{addedFeatures:o,deletedFeatures:u,updatedFeatures:c}=r.edits;if(this._hasGlobalIds=this._hasGlobalIds||d(o)||d(c)||d(u),this._hasGlobalIds){return[e,{type:\"processed-edit\",edits:{addOrModified:[...o,...c],removed:u}}]}const p=new Set(n(null!=(s=null==e?void 0:e.edits.addOrModified)?s:[])),l=new Set(n(null!=(t=null==e?void 0:e.edits.removed)?t:[])),f=new Set([...n(o),...n(c)]),h=new Set(n(u));return[{type:\"processed-edit\",edits:{addOrModified:Array.from(a(i(p,h),f)).map((e=>({objectId:e}))),removed:Array.from(a(i(l,f),h)).map((e=>({objectId:e})))}}]}};e([s({readOnly:!0})],u.prototype,\"updating\",null),u=e([t(\"esri.views.2d.layers.support.FeatureCommandQueue\")],u);var c=u;export default c;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../../../chunks/tslib.es6.js\";import{EsriPromise as e}from\"../../../../core/Promise.js\";import{createResolver as r,createAbortController as s,ignoreAbortErrors as o,throwIfNotAbortError as i}from\"../../../../core/promiseUtils.js\";import{open as n}from\"../../../../core/workers/workers.js\";import{property as a}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/has.js\";import\"../../../../core/accessorSupport/ensureType.js\";import\"../../../../core/Logger.js\";import{subclass as c}from\"../../../../core/accessorSupport/decorators/subclass.js\";function l(t){return Array.isArray(t)}let u=class extends e{constructor(t){super(t),this._startupResolver=r(),this.isReady=!1}initialize(){this._controller=s(),this.addResolvingPromise(this._startWorker(this._controller.signal))}destroy(){this._controller.abort(),this._connection&&this._connection.close()}set tileRenderer(t){this.client.tileRenderer=t}get closed(){return this._connection.closed}async startup(t,e,r,s){await this.when();const o=this._controller.signal,i=l(r.source)?{transferList:r.source,signal:o}:void 0,n={service:r,config:e,tileInfo:t.tileInfo.toJSON(),tiles:s};await this._connection.invoke(\"startup\",n,i),this._startupResolver.resolve(),this._set(\"isReady\",!0)}async updateTiles(t){return await this._startupResolver.promise,o(this._connection.invoke(\"updateTiles\",t))}async update(t){const e={config:t};return await this._startupResolver.promise,this._connection.invoke(\"update\",e)}async applyUpdate(t){return await this._startupResolver.promise,this._connection.invoke(\"applyUpdate\",t)}async setHighlight(t){return await this._startupResolver.promise,o(this._connection.invoke(\"controller.setHighlight\",t))}async refresh(){return await this._startupResolver.promise,o(this._connection.invoke(\"controller.refresh\"))}async querySummaryStatistics(t,e,r){return await this._startupResolver.promise,this._connection.invoke(\"controller.querySummaryStatistics\",{query:t.toJSON(),params:e},r)}async queryFeatures(t,e){return await this._startupResolver.promise,this._connection.invoke(\"controller.queryFeatures\",t.toJSON(),e)}async queryObjectIds(t,e){return await this._startupResolver.promise,this._connection.invoke(\"controller.queryObjectIds\",t.toJSON(),e)}async queryFeatureCount(t,e){return await this._startupResolver.promise,this._connection.invoke(\"controller.queryFeatureCount\",t.toJSON(),e)}async queryExtent(t,e){return this._connection.invoke(\"controller.queryExtent\",t.toJSON(),e)}async queryLatestObservations(t,e){return await this._startupResolver.promise,this._connection.invoke(\"controller.queryLatestObservations\",t.toJSON(),e)}async queryStatistics(t){return await this._startupResolver.promise,this._connection.invoke(\"controller.queryStatistics\",t)}async getObjectId(t){return await this._startupResolver.promise,this._connection.invoke(\"controller.getObjectId\",t)}async getDisplayId(t){return await this._startupResolver.promise,this._connection.invoke(\"controller.getDisplayId\",t)}async getFeature(t){return await this._startupResolver.promise,this._connection.invoke(\"controller.getFeature\",t)}async getAggregate(t){return await this._startupResolver.promise,this._connection.invoke(\"controller.getAggregate\",t)}async getAggregateValueRanges(){return await this._startupResolver.promise,this._connection.invoke(\"controller.getAggregateValueRanges\")}async mapValidDisplayIds(t){return await this._startupResolver.promise,this._connection.invoke(\"controller.mapValidDisplayIds\",t)}async onEdits(t){return await this._startupResolver.promise,o(this._connection.invoke(\"controller.onEdits\",t))}async enableEvent(t,e){return await this._startupResolver.promise,o(this._connection.invoke(\"controller.enableEvent\",{name:t,value:e}))}async _startWorker(t){try{this._connection=await n(\"Pipeline\",{client:this.client,strategy:\"dedicated\",signal:t})}catch(e){i(e)}}};t([a()],u.prototype,\"isReady\",void 0),t([a()],u.prototype,\"client\",void 0),t([a()],u.prototype,\"tileRenderer\",null),u=t([c(\"esri.views.2d.layers.support.FeatureLayerProxy\")],u);var p=u;export default p;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{isSome as e}from\"../../../core/maybe.js\";import i from\"./TileCoverage.js\";import t from\"./TileKey.js\";const l=1e-6;class s{constructor(e){this._tiles=new Map,this.buffer=0,this.acquireTile=e.acquireTile,this.releaseTile=e.releaseTile,this.tileInfoView=e.tileInfoView,this.buffer=e.buffer}destroy(){}clear(){this._tiles.forEach((e=>this._releaseTile(e)))}tileKeys(){const e=[];return this._tiles.forEach(((i,t)=>e.push(t))),e}update(e){const l=this.tileInfoView.getTileCoverage(e.state,this.buffer,\"closest\"),{spans:s,lodInfo:r}=l,{level:a}=r,o=[],d=[],h=new Set,n=new Set;for(const{row:i,colFrom:c,colTo:f}of s)for(let e=c;e<=f;e++){const l=t.getId(a,i,r.normalizeCol(e),r.getWorldForColumn(e)),s=this._getOrAcquireTile(o,l);h.add(l),s.isReady?s.visible=!0:n.add(s.key)}n.forEach((e=>this._addPlaceholders(h,e))),this._tiles.forEach((e=>{h.has(e.key.id)||(d.push(e.key.id),this._releaseTile(e))})),i.pool.release(l);return{hasMissingTiles:n.size>0,added:o,removed:d}}_getOrAcquireTile(e,i){if(!this._tiles.has(i)){const l=this.acquireTile(new t(i));e.push(i),this._tiles.set(i,l),l.visible=!1}return this._tiles.get(i)}_getTile(e){return this._tiles.get(e)}_releaseTile(e){this._tiles.delete(e.key.id),this.releaseTile(e)}_addPlaceholders(e,i){const t=this._addPlaceholderChildren(e,i);if(!(Math.abs(1-t)<l)){if(!this._addPlaceholderParent(e,i)){this._getTile(i.id).visible=!0}}}_addPlaceholderChildren(e,i){let t=0;return this._tiles.forEach((l=>{t+=this._addPlaceholderChild(e,l,i)})),t}_addPlaceholderChild(e,i,t){if(i.key.level<=t.level||!i.hasData||!t.contains(i.key))return 0;i.visible=!0,e.add(i.key.id);return 1/(1<<2*(i.key.level-t.level))}_addPlaceholderParent(i,t){let l=t.getParentKey(),s=0,r=null;for(;e(l);){if(i.has(l.id))return!0;const e=this._getTile(l.id);if(null!=e&&e.isReady)return e.visible=!0,i.add(e.key.id),!0;null!=e&&e.hasData&&e.patchCount>s&&(s=e.patchCount,r=e),l=l.getParentKey()}return!!r&&(r.visible=!0,i.add(r.key.id),!0)}}export{s as TileManager};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import t from\"../../core/Error.js\";import r from\"../../core/Logger.js\";import{isSome as i,isNone as s}from\"../../core/maybe.js\";import{eachAlways as o}from\"../../core/promiseUtils.js\";import{init as n,on as l}from\"../../core/watchUtils.js\";import{property as a}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import{subclass as u}from\"../../core/accessorSupport/decorators/subclass.js\";import{combinedViewLayerTimeExtentProperty as p}from\"../../layers/support/commonProperties.js\";import{fixFields as d,unpackFieldNames as m,collectLabelingFields as c,collectElevationFields as f,collectFilterFields as y,collectFeatureReductionFields as h,collectFields as F,collectField as w,featureHasFields as g}from\"../../layers/support/fieldUtils.js\";import x from\"../../rest/support/Query.js\";import{loadArcade as b}from\"../../support/arcadeOnDemand.js\";import E from\"./support/FeatureEffect.js\";import v from\"./support/FeatureFilter.js\";import{getFetchPopupTemplate as q,getRequiredFields as j}from\"./support/popupUtils.js\";const I=r.getLogger(\"esri.views.layers.FeatureLayerView\"),R=r=>{let R=class extends r{constructor(...e){super(...e),this._updatingRequiredFieldsPromise=null,this.effect=null,this.filter=null,this.timeExtent=null,this.layer=null,this.requiredFields=[],this.view=null}initialize(){n(this,[\"layer.renderer\",\"layer.labelingInfo\",\"layer.elevationInfo.featureExpressionInfo\",\"layer.displayField\",\"filter\",\"effect\",\"layer.timeInfo\",\"layer.floorInfo\",\"timeExtent\"],(()=>this._handleRequiredFieldsChange()),!0),l(this,\"view.floors\",\"change\",(()=>this._handleRequiredFieldsChange())),l(this,\"layer.sublayer\",\"change\",(()=>this._handleRequiredFieldsChange()))}get availableFields(){const{layer:e,layer:{fieldsIndex:t},requiredFields:r}=this;return\"outFields\"in e&&e.outFields?d(t,[...m(t,e.outFields),...r]):d(t,r)}get maximumNumberOfFeatures(){return 0}set maximumNumberOfFeatures(e){I.error(\"#maximumNumberOfFeatures=\",\"Setting maximum number of features is not supported\")}get maximumNumberOfFeaturesExceeded(){return!1}highlight(e){throw new Error(\"missing implementation\")}createQuery(){const e={outFields:[\"*\"],returnGeometry:!0,outSpatialReference:this.view.spatialReference},t=i(this.filter)?this.filter.createQuery(e):new x(e);return i(this.timeExtent)&&(t.timeExtent=i(t.timeExtent)?t.timeExtent.intersection(this.timeExtent):this.timeExtent.clone()),t}queryFeatures(e,t){throw new Error(\"missing implementation\")}queryObjectIds(e,t){throw new Error(\"missing implementation\")}queryFeatureCount(e,t){throw new Error(\"missing implementation\")}queryExtent(e,t){throw new Error(\"missing implementation\")}_loadArcadeModules(e){if(e.get(\"expressionInfos.length\"))return b()}_handleRequiredFieldsChange(){const e=this._updateRequiredFields();this._set(\"_updatingRequiredFieldsPromise\",e),e.then((()=>{this._updatingRequiredFieldsPromise===e&&this._set(\"_updatingRequiredFieldsPromise\",null)}))}async _updateRequiredFields(){if(!this.layer||!this.view)return;const e=\"3d\"===this.view.type,{layer:t,layer:{fieldsIndex:r,objectIdField:s}}=this,n=\"renderer\"in t&&t.renderer,l=t.featureReduction,a=new Set,u=await o([n?n.collectRequiredFields(a,r):null,c(a,t),e?f(a,t):null,i(this.filter)?y(a,t,this.filter):null,this.effect?y(a,t,this.effect.filter):null,l?h(a,t,l):null]);if(t.timeInfo&&this.timeExtent&&F(a,t.fieldsIndex,[t.timeInfo.startField,t.timeInfo.endField]),\"feature\"===t.type&&t.floorInfo&&F(a,t.fieldsIndex,[t.floorInfo.floorField]),\"subtype-group\"===t.type){w(a,r,t.subtypeField);const e=t.sublayers.map((e=>{var t;return Promise.all([null==(t=e.renderer)?void 0:t.collectRequiredFields(a,r),c(a,e)])}));await o(e)}for(const i of u)i.error&&I.error(i.error);w(a,r,s),e&&\"displayField\"in t&&t.displayField&&w(a,r,t.displayField);const p=Array.from(a).sort();this._set(\"requiredFields\",p)}validateFetchPopupFeatures(e){if(s(e))return null;for(const r of e.clientGraphics){const i=r.layer;if(\"popupEnabled\"in i&&!i.popupEnabled)return new t(\"featurelayerview:fetchPopupFeatures\",\"Popups are disabled\",{layer:i});if(\"popupTemplate\"in i){if(!q(i,e))return new t(\"featurelayerview:fetchPopupFeatures\",\"Layer does not define a popup template\",{layer:i})}}}async fetchClientPopupFeatures(e){const t=i(e)?e.clientGraphics:null;if(!t||0===t.length)return Promise.resolve([]);const r=[],s=[],o=await this.createPopupQuery(e);for(const n of t){const{layer:t}=n;if(!(\"popupEnabled\"in t))continue;const l=m(this.layer.fieldsIndex,o.outFields),a=q(t,e);if(!i(a))continue;const u=await this._loadArcadeModules(a);u&&u.arcadeUtils.hasGeometryOperations(a)||!g(l,n)?s.push(n):r.push(n)}return\"stream\"===this.layer.type||0===s.length?Promise.resolve(r):(o.objectIds=s.map((e=>e.attributes[this.layer.objectIdField])),this.layer.queryFeatures(o).then((e=>r.concat(e.features))).catch((()=>s)))}async createPopupQuery(e){const t=this.layer.createQuery(),r=new Set;let s=!1;const o=i(e)&&e.clientGraphics?e.clientGraphics.map((e=>e.layer)):[this.layer];for(const n of o){if(!(\"popupEnabled\"in n))continue;const t=q(n,e);if(!i(t))continue;const o=await this._loadArcadeModules(t),l=o&&o.arcadeUtils.hasGeometryOperations(t);s=!(\"point\"!==this.layer.geometryType&&!l);const a=await j(this.layer,t);for(const e of a)r.add(e)}return t.returnGeometry=s,t.returnZ=s,t.returnM=s,t.outFields=Array.from(r),t.outSpatialReference=this.view.spatialReference,t}canResume(){return!!super.canResume()&&(!i(this.timeExtent)||!this.timeExtent.isEmpty)}};return e([a()],R.prototype,\"_updatingRequiredFieldsPromise\",void 0),e([a({readOnly:!0})],R.prototype,\"availableFields\",null),e([a({type:E})],R.prototype,\"effect\",void 0),e([a({type:v})],R.prototype,\"filter\",void 0),e([a(p)],R.prototype,\"timeExtent\",void 0),e([a()],R.prototype,\"layer\",void 0),e([a({type:Number})],R.prototype,\"maximumNumberOfFeatures\",null),e([a({readOnly:!0,type:Boolean})],R.prototype,\"maximumNumberOfFeaturesExceeded\",null),e([a({readOnly:!0})],R.prototype,\"requiredFields\",void 0),e([a()],R.prototype,\"suspended\",void 0),e([a()],R.prototype,\"view\",void 0),R=e([u(\"esri.views.layers.FeatureLayerView\")],R),R};export default R;export{R as FeatureLayerView};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import{JSONSupport as t}from\"../../../core/JSONSupport.js\";import{property as r}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/Logger.js\";import{subclass as o}from\"../../../core/accessorSupport/decorators/subclass.js\";import s from\"./FeatureFilter.js\";var i;let c=i=class extends t{constructor(){super(...arguments),this.filter=null,this.includedEffect=null,this.excludedEffect=null,this.excludedLabelsVisible=!1}clone(){return new i({filter:this.filter&&this.filter.clone(),includedEffect:this.includedEffect,excludedEffect:this.excludedEffect,excludedLabelsVisible:this.excludedLabelsVisible})}};e([r({type:s,json:{write:!0}})],c.prototype,\"filter\",void 0),e([r({json:{write:!0}})],c.prototype,\"includedEffect\",void 0),e([r({json:{write:!0}})],c.prototype,\"excludedEffect\",void 0),e([r({type:Boolean,json:{write:!0}})],c.prototype,\"excludedLabelsVisible\",void 0),c=i=e([o(\"esri.views.layers.support.FeatureEffect\")],c);var l=c;export default l;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import{geometryTypes as t}from\"../../../geometry.js\";import r from\"../../../TimeExtent.js\";import{JSONMap as i}from\"../../../core/jsonMap.js\";import{JSONSupport as s}from\"../../../core/JSONSupport.js\";import{clone as o}from\"../../../core/lang.js\";import{property as n}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/has.js\";import\"../../../core/Logger.js\";import{subclass as a}from\"../../../core/accessorSupport/decorators/subclass.js\";import{writer as p}from\"../../../core/accessorSupport/decorators/writer.js\";import{fromJSON as l}from\"../../../geometry/support/jsonUtils.js\";import c from\"../../../rest/support/Query.js\";var d;const m=new i({esriSpatialRelIntersects:\"intersects\",esriSpatialRelContains:\"contains\",esriSpatialRelCrosses:\"crosses\",esriSpatialRelDisjoint:\"disjoint\",esriSpatialRelEnvelopeIntersects:\"envelope-intersects\",esriSpatialRelIndexIntersects:\"index-intersects\",esriSpatialRelOverlaps:\"overlaps\",esriSpatialRelTouches:\"touches\",esriSpatialRelWithin:\"within\",esriSpatialRelRelation:\"relation\"}),u=new i({esriSRUnit_Meter:\"meters\",esriSRUnit_Kilometer:\"kilometers\",esriSRUnit_Foot:\"feet\",esriSRUnit_StatuteMile:\"miles\",esriSRUnit_NauticalMile:\"nautical-miles\",esriSRUnit_USNauticalMile:\"us-nautical-miles\"});let h=d=class extends s{constructor(e){super(e),this.where=null,this.geometry=null,this.spatialRelationship=\"intersects\",this.hiddenIds=new Set,this.distance=void 0,this.objectIds=null,this.units=null,this.timeExtent=null,this.enabled=!1}writeWhere(e,t){t.where=e||\"1=1\"}enable(){this._set(\"enabled\",!0)}createQuery(e={}){const{where:t,geometry:r,spatialRelationship:i,timeExtent:s,objectIds:n,units:a,distance:p}=this;return new c({geometry:o(r),objectIds:o(n),spatialRelationship:i,timeExtent:o(s),where:t,units:a,distance:p,...e})}clone(){const{where:e,geometry:t,spatialRelationship:r,hiddenIds:i,timeExtent:s,objectIds:n,units:a,distance:p}=this,l=new Set;return i.forEach((e=>l.add(e))),new d({geometry:o(t),hiddenIds:l,objectIds:o(n),spatialRelationship:r,timeExtent:o(s),where:e,units:a,distance:p})}};e([n({type:String})],h.prototype,\"where\",void 0),e([p(\"where\")],h.prototype,\"writeWhere\",null),e([n({types:t,json:{read:l,write:!0}})],h.prototype,\"geometry\",void 0),e([n({type:String,json:{read:{source:\"spatialRel\",reader:m.read},write:{target:\"spatialRel\",writer:m.write}}})],h.prototype,\"spatialRelationship\",void 0),e([n({json:{write:(e,t,r)=>t[r]=Array.from(e),read:e=>new Set(e)}})],h.prototype,\"hiddenIds\",void 0),e([n({type:Number,json:{write:{overridePolicy:e=>({enabled:e>0})}}})],h.prototype,\"distance\",void 0),e([n({type:[Number],json:{write:!0}})],h.prototype,\"objectIds\",void 0),e([n({type:String,json:{read:u.read,write:{writer:u.write,overridePolicy(e){return{enabled:e&&this.distance>0}}}}})],h.prototype,\"units\",void 0),e([n({type:r,json:{write:!0}})],h.prototype,\"timeExtent\",void 0),e([n({readOnly:!0})],h.prototype,\"enabled\",void 0),h=d=e([a(\"esri.views.layers.support.FeatureFilter\")],h);var y=h;export default y;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{isSome as e}from\"../../../core/maybe.js\";import{getFeatureEditFields as p,fixFields as l}from\"../../../layers/support/fieldUtils.js\";async function t(t,d=t.popupTemplate){if(!e(d))return[];const i=await d.getRequiredFields(t.fieldsIndex),{lastEditInfoEnabled:n}=d,{objectIdField:s,typeIdField:a,globalIdField:o,relationships:u}=t;if(i.includes(\"*\"))return[\"*\"];const f=n?await p(t):[],r=l(t.fieldsIndex,[...i,...f]);return a&&r.push(a),r&&s&&t.fieldsIndex.has(s)&&-1===r.indexOf(s)&&r.push(s),r&&o&&t.fieldsIndex.has(o)&&-1===r.indexOf(o)&&r.push(o),u&&u.forEach((e=>{const{keyField:p}=e;r&&p&&t.fieldsIndex.has(p)&&-1===r.indexOf(p)&&r.push(p)})),r}function d(p,l){return p.popupTemplate?p.popupTemplate:e(l)&&l.defaultPopupTemplateEnabled&&e(p.defaultPopupTemplate)?p.defaultPopupTemplate:null}export{d as getFetchPopupTemplate,t as getRequiredFields};\n"],"sourceRoot":""}