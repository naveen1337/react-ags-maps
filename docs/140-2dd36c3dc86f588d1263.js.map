{"version":3,"sources":["webpack:///C:/Users/chubs/development/react-ags-maps/node_modules/@arcgis/core/views/2d/layers/features/support/whereUtils.js","webpack:///C:/Users/chubs/development/react-ags-maps/node_modules/@arcgis/core/layers/graphics/data/FeatureFilter.js"],"names":["getLogger","a","getAttribute","e","r","field","_x","_x2","_s","apply","this","arguments","mark","_callee","s","n","o","_r","wrap","_context","prev","next","sent","WhereClause","create","isStandardized","error","abrupt","readArcadeFeature","testFeature","t0","warn","stop","_createForOfIteratorHelper","allowArrayLike","it","Symbol","iterator","Array","isArray","minLen","_arrayLikeToArray","Object","prototype","toString","call","slice","constructor","name","from","test","_unsupportedIterableToArray","length","i","F","done","value","_e2","f","TypeError","err","normalCompletion","didErr","step","_e3","return","arr","len","arr2","m","p","t","_geometryBounds","_idToVisibility","Map","_serviceInfo","_setGeometryFilter2","_setAttributeFilter2","_update","key","get","_hash","_applyFilter","_resetAllHiddenIds","update","show","hide","_this","forEach","set","_step","_iterator","_e","_this2","Set","h","has","push","_","geometry","spatialRel","where","timeExtent","objectIds","fromJSON","JSON","stringify","Promise","all","_setGeometryFilter","_setIdFilter","_setAttributeFilter","_setTimeFilter","_callee2","_context2","_clause","fieldsIndex","_x3","_idsToShow","_idsToHide","hiddenIds","_callee3","_context3","_spatialQueryOperator","geometryType","hasZ","hasM","_x4","_timeOperator","timeInfo","_i","_filterByGeometry","_filterById","_filterByTime","_filterByExpression","size","getObjectId","readHydratedGeometry","_this3"],"mappings":"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","file":"140-2dd36c3dc86f588d1263.js","sourcesContent":["import _asyncToGenerator from \"C:/Users/chubs/development/react-ags-maps/docz/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _regeneratorRuntime from \"C:/Users/chubs/development/react-ags-maps/docz/node_modules/@babel/runtime/regenerator\";\n\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from \"../../../../../core/Error.js\";\nimport r from \"../../../../../core/Logger.js\";\nvar t = r.getLogger(\"esri.views.2d.layers.features.support.whereUtils\"),\n    a = {\n  getAttribute: function getAttribute(e, r) {\n    return e.field(r);\n  }\n};\n\nfunction s(_x, _x2) {\n  return _s.apply(this, arguments);\n}\n\nfunction _s() {\n  _s = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(r, s) {\n    var n, o, _r;\n\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return import(\"../../../../../core/sql/WhereClause.js\");\n\n          case 2:\n            n = _context.sent;\n            _context.prev = 3;\n            o = n.WhereClause.create(r, s);\n\n            if (!o.isStandardized) {\n              _r = new e(\"mapview - bad input\", \"Unable to apply filter's definition expression, as expression is not standardized.\", o);\n              t.error(_r);\n            }\n\n            return _context.abrupt(\"return\", function (e) {\n              var r = e.readArcadeFeature();\n              return o.testFeature(r, a);\n            });\n\n          case 9:\n            _context.prev = 9;\n            _context.t0 = _context[\"catch\"](3);\n            return _context.abrupt(\"return\", (t.warn(\"mapview-bad-where-clause\", \"Encountered an error when evaluating where clause\", r), function (e) {\n              return !0;\n            }));\n\n          case 12:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[3, 9]]);\n  }));\n  return _s.apply(this, arguments);\n}\n\nexport { s as createWhereClause };","import _asyncToGenerator from \"C:/Users/chubs/development/react-ags-maps/docz/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"C:/Users/chubs/development/react-ags-maps/docz/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:/Users/chubs/development/react-ags-maps/docz/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _regeneratorRuntime from \"C:/Users/chubs/development/react-ags-maps/docz/node_modules/@babel/runtime/regenerator\";\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e2) { throw _e2; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e3) { didErr = true; err = _e3; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport t from \"../../../core/Error.js\";\nimport e from \"../../../core/Logger.js\";\nimport { isSome as i } from \"../../../core/maybe.js\";\nimport { create as s } from \"../../../geometry/support/aaBoundingRect.js\";\nimport { getBoundsXY as r } from \"../../../geometry/support/boundsUtils.js\";\nimport { getSpatialQueryOperator as o } from \"./spatialQuerySupport.js\";\nimport { getTimeOperator as h } from \"./timeSupport.js\";\nimport { normalizeQueryLike as l } from \"./utils.js\";\nimport a from \"../../../rest/support/Query.js\";\nimport { featureAdapter as n } from \"../../../views/2d/layers/features/FeatureStore2D.js\";\nimport { createWhereClause as d } from \"../../../views/2d/layers/features/support/whereUtils.js\";\nvar m = e.getLogger(\"esri.views.2d.layers.features.controllers.FeatureFilter\"),\n    _ = 1,\n    u = 2;\n\nvar p = /*#__PURE__*/function () {\n  function p(t) {\n    _classCallCheck(this, p);\n\n    this._geometryBounds = s(), this._idToVisibility = new Map(), this._serviceInfo = t;\n  }\n\n  _createClass(p, [{\n    key: \"hash\",\n    get: function get() {\n      return this._hash;\n    }\n  }, {\n    key: \"check\",\n    value: function check(t) {\n      return this._applyFilter(t);\n    }\n  }, {\n    key: \"clear\",\n    value: function clear() {\n      var t = this._resetAllHiddenIds();\n\n      return this.update(), {\n        show: t,\n        hide: []\n      };\n    }\n  }, {\n    key: \"invalidate\",\n    value: function invalidate() {\n      var _this = this;\n\n      this._idToVisibility.forEach(function (t, e) {\n        _this._idToVisibility.set(e, 0);\n      });\n    }\n  }, {\n    key: \"setKnownIds\",\n    value: function setKnownIds(t) {\n      var _iterator = _createForOfIteratorHelper(t),\n          _step;\n\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var _e = _step.value;\n\n          this._idToVisibility.set(_e, _);\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n    }\n  }, {\n    key: \"setTrue\",\n    value: function setTrue(t) {\n      var _this2 = this;\n\n      var e = [],\n          i = [],\n          s = new Set(t);\n      return this._idToVisibility.forEach(function (t, r) {\n        var o = !!(_this2._idToVisibility.get(r) & _),\n            h = s.has(r);\n        !o && h ? e.push(r) : o && !h && i.push(r), _this2._idToVisibility.set(r, h ? _ | u : 0);\n      }), {\n        show: e,\n        hide: i\n      };\n    }\n  }, {\n    key: \"createQuery\",\n    value: function createQuery() {\n      var t = this.geometry,\n          e = this.spatialRel,\n          i = this.where,\n          s = this.timeExtent,\n          r = this.objectIds;\n      return a.fromJSON({\n        geometry: t,\n        spatialRel: e,\n        where: i,\n        timeExtent: s,\n        objectIds: r\n      });\n    }\n  }, {\n    key: \"update\",\n    value: function () {\n      var _update = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(t, e) {\n        var i;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                this._hash = JSON.stringify(t);\n                _context.next = 3;\n                return l(t, null, e);\n\n              case 3:\n                i = _context.sent;\n                _context.next = 6;\n                return Promise.all([this._setGeometryFilter(i), this._setIdFilter(i), this._setAttributeFilter(i), this._setTimeFilter(i)]);\n\n              case 6:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function update(_x, _x2) {\n        return _update.apply(this, arguments);\n      }\n\n      return update;\n    }()\n  }, {\n    key: \"_setAttributeFilter\",\n    value: function () {\n      var _setAttributeFilter2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(t) {\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                if (!(!t || !t.where)) {\n                  _context2.next = 2;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\", (this._clause = null, void (this.where = null)));\n\n              case 2:\n                _context2.next = 4;\n                return d(t.where, this._serviceInfo.fieldsIndex);\n\n              case 4:\n                this._clause = _context2.sent;\n                this.where = t.where;\n\n              case 6:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function _setAttributeFilter(_x3) {\n        return _setAttributeFilter2.apply(this, arguments);\n      }\n\n      return _setAttributeFilter;\n    }()\n  }, {\n    key: \"_setIdFilter\",\n    value: function _setIdFilter(t) {\n      this._idsToShow = t && t.objectIds && new Set(t.objectIds), this._idsToHide = t && t.hiddenIds && new Set(t.hiddenIds), this.objectIds = t && t.objectIds;\n    }\n  }, {\n    key: \"_setGeometryFilter\",\n    value: function () {\n      var _setGeometryFilter2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(t) {\n        var e, i, s;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                if (!(!t || !t.geometry)) {\n                  _context3.next = 2;\n                  break;\n                }\n\n                return _context3.abrupt(\"return\", (this._spatialQueryOperator = null, this.geometry = null, void (this.spatialRel = null)));\n\n              case 2:\n                e = t.geometry;\n                i = t.spatialRel || \"esriSpatialRelIntersects\";\n                _context3.next = 6;\n                return o(i, e, this._serviceInfo.geometryType, this._serviceInfo.hasZ, this._serviceInfo.hasM);\n\n              case 6:\n                s = _context3.sent;\n                r(this._geometryBounds, e), this._spatialQueryOperator = s, this.geometry = e, this.spatialRel = i;\n\n              case 8:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function _setGeometryFilter(_x4) {\n        return _setGeometryFilter2.apply(this, arguments);\n      }\n\n      return _setGeometryFilter;\n    }()\n  }, {\n    key: \"_setTimeFilter\",\n    value: function _setTimeFilter(e) {\n      if (this.timeExtent = this._timeOperator = null, e && e.timeExtent) if (this._serviceInfo.timeInfo) this.timeExtent = e.timeExtent, this._timeOperator = h(this._serviceInfo.timeInfo, e.timeExtent, n);else {\n        var _i = new t(\"feature-layer-view:time-filter-not-available\", \"Unable to apply time filter, as layer doesn't have time metadata.\", e.timeExtent);\n\n        m.error(_i);\n      }\n    }\n  }, {\n    key: \"_applyFilter\",\n    value: function _applyFilter(t) {\n      return this._filterByGeometry(t) && this._filterById(t) && this._filterByTime(t) && this._filterByExpression(t);\n    }\n  }, {\n    key: \"_filterByExpression\",\n    value: function _filterByExpression(t) {\n      return !this.where || this._clause(t);\n    }\n  }, {\n    key: \"_filterById\",\n    value: function _filterById(t) {\n      return (!this._idsToHide || !this._idsToHide.size || !this._idsToHide.has(t.getObjectId())) && (!this._idsToShow || !this._idsToShow.size || this._idsToShow.has(t.getObjectId()));\n    }\n  }, {\n    key: \"_filterByGeometry\",\n    value: function _filterByGeometry(t) {\n      if (!this.geometry) return !0;\n      var e = t.readHydratedGeometry();\n      return !!e && this._spatialQueryOperator(e);\n    }\n  }, {\n    key: \"_filterByTime\",\n    value: function _filterByTime(t) {\n      return !i(this._timeOperator) || this._timeOperator(t);\n    }\n  }, {\n    key: \"_resetAllHiddenIds\",\n    value: function _resetAllHiddenIds() {\n      var _this3 = this;\n\n      var t = [];\n      return this._idToVisibility.forEach(function (e, i) {\n        e & _ || (_this3._idToVisibility.set(i, _), t.push(i));\n      }), t;\n    }\n  }]);\n\n  return p;\n}();\n\nexport default p;"],"sourceRoot":""}