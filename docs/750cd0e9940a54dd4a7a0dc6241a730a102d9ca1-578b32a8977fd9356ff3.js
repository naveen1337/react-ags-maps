(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{"/L0V":function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return u}));var n=r("mK0O"),i=r("eDEE");function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){Object(n.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var u={type:i.a,json:{origins:{service:{read:{source:["tileInfo","minScale","maxScale","minLOD","maxLOD"],reader:o}}}}};function o(e,t,r,n){if(!e)return null;var a=t.minScale,u=t.maxScale,o=t.minLOD,c=t.maxLOD;if(null!=o&&null!=c)return n&&n.ignoreMinMaxLOD?i.a.fromJSON(e):i.a.fromJSON(s(s({},e),{},{lods:e.lods.filter((function(e){var t=e.level;return null!=t&&t>=o&&t<=c}))}));if(0!==a&&0!==u){var l=function(e){return Math.round(1e4*e)/1e4},f=a?l(a):1/0,h=u?l(u):-1/0;return i.a.fromJSON(s(s({},e),{},{lods:e.lods.filter((function(e){var t=l(e.scale);return t<=f&&t>=h}))}))}return i.a.fromJSON(e)}},"3bUX":function(e,t,r){"use strict";r.r(t);var n=r("mK0O"),i=r("hisu"),a=r("yBJb"),s=r("CHlC"),u=r("kMo5"),o=r("P+uj"),c=r("dQW7"),l=(r("ZTBZ"),r("DGz/")),f=r("Mp7X"),h=r("d4jZ"),d=r("lZmO"),p=r("z9dv"),y=r("xAIp"),m=(r("J4Pc"),r("wckI"),r("TM+E"),r("mp5+")),b=r("iaHD"),v=r("jr4m"),g=r("QZQ7"),x=r("9P7x"),O=r("oTsO"),j=r("44so"),_=r("2eXi"),w=r("wJzb"),I=r("Viq4"),S=r("eDEE"),k=r("EYBZ"),A=r("nd5+"),F=r("YHXj"),T=r("OTJA");function M(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return R(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return R(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(u)throw a}}}}function R(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function B(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Object(o.a)(e);if(t){var i=Object(o.a)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Object(u.a)(this,r)}}var E=function(e){Object(s.a)(r,e);var t=P(r);function r(){var e;Object(i.a)(this,r);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).copyright="",e.fullExtent=new A.a(-20037508.342787,-20037508.34278,20037508.34278,20037508.342787,F.a.WebMercator),e.legendEnabled=!1,e.isReference=null,e.popupEnabled=!1,e.spatialReference=F.a.WebMercator,e.subDomains=null,e.tileInfo=new S.a({size:[256,256],dpi:96,format:"png8",compressionQuality:0,origin:new T.a({x:-20037508.342787,y:20037508.342787,spatialReference:F.a.WebMercator}),spatialReference:F.a.WebMercator,lods:[new I.a({level:0,scale:591657527.591555,resolution:156543.033928}),new I.a({level:1,scale:295828763.795777,resolution:78271.5169639999}),new I.a({level:2,scale:147914381.897889,resolution:39135.7584820001}),new I.a({level:3,scale:73957190.948944,resolution:19567.8792409999}),new I.a({level:4,scale:36978595.474472,resolution:9783.93962049996}),new I.a({level:5,scale:18489297.737236,resolution:4891.96981024998}),new I.a({level:6,scale:9244648.868618,resolution:2445.98490512499}),new I.a({level:7,scale:4622324.434309,resolution:1222.99245256249}),new I.a({level:8,scale:2311162.217155,resolution:611.49622628138}),new I.a({level:9,scale:1155581.108577,resolution:305.748113140558}),new I.a({level:10,scale:577790.554289,resolution:152.874056570411}),new I.a({level:11,scale:288895.277144,resolution:76.4370282850732}),new I.a({level:12,scale:144447.638572,resolution:38.2185141425366}),new I.a({level:13,scale:72223.819286,resolution:19.1092570712683}),new I.a({level:14,scale:36111.909643,resolution:9.55462853563415}),new I.a({level:15,scale:18055.954822,resolution:4.77731426794937}),new I.a({level:16,scale:9027.977411,resolution:2.38865713397468}),new I.a({level:17,scale:4513.988705,resolution:1.19432856685505}),new I.a({level:18,scale:2256.994353,resolution:.597164283559817}),new I.a({level:19,scale:1128.497176,resolution:.298582141647617})]}),e.type="web-tile",e.urlTemplate=null,e.wmtsInfo=null,e}return Object(a.a)(r,[{key:"normalizeCtorArgs",value:function(e,t){return"string"==typeof e?function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?B(Object(r),!0).forEach((function(t){Object(n.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):B(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({urlTemplate:e},t):e}},{key:"load",value:function(e){var t=this,r=this.loadFromPortal({supportedTypes:["WMTS"]},e).then((function(){var e="";if(t.urlTemplate)if(t.spatialReference.equals(t.tileInfo.spatialReference)){var r=new p.a(t.urlTemplate);t.subDomains&&t.subDomains.length>0||-1===r.authority.indexOf("{subDomain}")||(e="is missing 'subDomains' property")}else e="spatialReference must match tileInfo.spatialReference";else e="is missing the required 'urlTemplate' property value";if(e)throw new f.a("web-tile-layer:load","WebTileLayer (title: '".concat(t.title,"', id: '").concat(t.id,"') ").concat(e))}));return this.addResolvingPromise(r),Promise.resolve(this)}},{key:"levelValues",get:function(){var e=[];if(!this.tileInfo)return null;var t,r=M(this.tileInfo.lods);try{for(r.s();!(t=r.n()).done;){var n=t.value;e[n.level]=n.levelValue||n.level}}catch(i){r.e(i)}finally{r.f()}return e}},{key:"readSpatialReference",value:function(e,t){return e||t.fullExtent&&t.fullExtent.spatialReference&&F.a.fromJSON(t.fullExtent.spatialReference)}},{key:"tileServers",get:function(){if(!this.urlTemplate)return null;var e=[],t=this.urlTemplate,r=this.subDomains,n=new p.a(t),i=n.scheme?n.scheme+"://":"//",a=i+n.authority+"/";if(-1===n.authority.indexOf("{subDomain}"))e.push(a);else if(r&&r.length>0&&n.authority.split(".").length>1){var s,u=M(r);try{for(u.s();!(s=u.n()).done;){var o=s.value;e.push(i+n.authority.replace(/\{subDomain\}/gi,o)+"/")}}catch(c){u.e(c)}finally{u.f()}}return e.map((function(e){return"/"!==e.charAt(e.length-1)&&(e+="/"),e}))}},{key:"urlPath",get:function(){if(!this.urlTemplate)return null;var e=this.urlTemplate,t=new p.a(e),r=(t.scheme?t.scheme+"://":"//")+t.authority+"/";return e.substring(r.length)}},{key:"readUrlTemplate",value:function(e,t){return e||t.templateUrl}},{key:"writeUrlTemplate",value:function(e,t){e&&Object(p.w)(e)&&(e="https:"+e),e&&(e=e.replace(/\{z\}/gi,"{level}").replace(/\{x\}/gi,"{col}").replace(/\{y\}/gi,"{row}"),e=Object(p.D)(e)),t.templateUrl=e}},{key:"fetchTile",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=n.signal,a=n.timestamp,s=this.getTileUrl(e,t,r),u={responseType:"image",signal:i};return null!=a&&(u.query={_ts:n.timestamp}),Object(l.default)(s,u).then((function(e){return e.data}))}},{key:"getTileUrl",value:function(e,t,r){var n=this.levelValues[e];return this.tileServers[t%this.tileServers.length]+Object(d.c)(this.urlPath,{level:n,z:n,col:r,x:r,row:t,y:t})}}]),r}(Object(x.a)(Object(_.a)(Object(w.a)(Object(O.a)(Object(j.a)(Object(h.a)(g.a)))))));Object(c.a)([Object(y.b)({type:String,value:"",json:{write:!0}})],E.prototype,"copyright",void 0),Object(c.a)([Object(y.b)({type:A.a,json:{write:!0}})],E.prototype,"fullExtent",void 0),Object(c.a)([Object(y.b)({readOnly:!0,json:{read:!1,write:!1}})],E.prototype,"legendEnabled",void 0),Object(c.a)([Object(y.b)({type:["show","hide"]})],E.prototype,"listMode",void 0),Object(c.a)([Object(y.b)()],E.prototype,"levelValues",null),Object(c.a)([Object(y.b)({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:function(){return{enabled:!1}}}}})],E.prototype,"isReference",void 0),Object(c.a)([Object(y.b)({type:["WebTiledLayer"],value:"WebTiledLayer"})],E.prototype,"operationalLayerType",void 0),Object(c.a)([Object(y.b)({readOnly:!0,json:{read:!1,write:!1}})],E.prototype,"popupEnabled",void 0),Object(c.a)([Object(y.b)({type:F.a})],E.prototype,"spatialReference",void 0),Object(c.a)([Object(m.a)("spatialReference",["spatialReference","fullExtent.spatialReference"])],E.prototype,"readSpatialReference",null),Object(c.a)([Object(y.b)({type:[String],json:{write:!0}})],E.prototype,"subDomains",void 0),Object(c.a)([Object(y.b)({type:S.a,json:{write:!0}})],E.prototype,"tileInfo",void 0),Object(c.a)([Object(y.b)({readOnly:!0})],E.prototype,"tileServers",null),Object(c.a)([Object(y.b)({json:{read:!1}})],E.prototype,"type",void 0),Object(c.a)([Object(y.b)()],E.prototype,"urlPath",null),Object(c.a)([Object(y.b)({type:String,json:{origins:{"portal-item":{read:{source:"url"}}}}})],E.prototype,"urlTemplate",void 0),Object(c.a)([Object(m.a)("urlTemplate",["urlTemplate","templateUrl"])],E.prototype,"readUrlTemplate",null),Object(c.a)([Object(v.a)("urlTemplate",{templateUrl:{type:String}})],E.prototype,"writeUrlTemplate",null),Object(c.a)([Object(y.b)({type:k.a,json:{write:!0}})],E.prototype,"wmtsInfo",void 0);var Q=E=Object(c.a)([Object(b.a)("esri.layers.WebTileLayer")],E);t.default=Q},EYBZ:function(e,t,r){"use strict";var n,i=r("hisu"),a=r("yBJb"),s=r("CHlC"),u=r("kMo5"),o=r("P+uj"),c=r("dQW7"),l=r("0n+b"),f=r("0fJP"),h=r("xAIp"),d=(r("wckI"),r("J4Pc"),r("TM+E"),r("iaHD"));function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Object(o.a)(e);if(t){var i=Object(o.a)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Object(u.a)(this,r)}}var y=n=function(e){Object(s.a)(r,e);var t=p(r);function r(e){return Object(i.a)(this,r),t.call(this,e)}return Object(a.a)(r,[{key:"clone",value:function(){return new n({customLayerParameters:Object(f.a)(this.customLayerParameters),customParameters:Object(f.a)(this.customParameters),layerIdentifier:this.layerIdentifier,tileMatrixSet:this.tileMatrixSet,url:this.url})}}]),r}(l.a);Object(c.a)([Object(h.b)({json:{type:Object,write:!0}})],y.prototype,"customLayerParameters",void 0),Object(c.a)([Object(h.b)({json:{type:Object,write:!0}})],y.prototype,"customParameters",void 0),Object(c.a)([Object(h.b)({type:String,json:{write:!0}})],y.prototype,"layerIdentifier",void 0),Object(c.a)([Object(h.b)({type:String,json:{write:!0}})],y.prototype,"tileMatrixSet",void 0),Object(c.a)([Object(h.b)({type:String,json:{write:!0}})],y.prototype,"url",void 0);var m=y=n=Object(c.a)([Object(d.a)("esri.layer.support.WMTSLayerInfo")],y);t.a=m},FXVW:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n=r("6CzD"),i=r("hisu"),a=r("yBJb"),s=r("4Mpa"),u=r("CHlC"),o=r("kMo5"),c=r("P+uj"),l=r("gj5F"),f=r("FNqF");function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Object(c.a)(e);if(t){var i=Object(c.a)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Object(o.a)(this,r)}}var d=function(e){Object(u.a)(r,e);var t=h(r);function r(){return Object(i.a)(this,r),t.apply(this,arguments)}return Object(a.a)(r,[{key:"requiresDedicatedFBO",get:function(){return this.children.some((function(e){return"additive"===e.blendFunction}))}},{key:"prepareRenderPasses",value:function(e){var t=this,i=e.registerRenderPass({name:"bitmap",brushes:[l.a.bitmap],target:function(){return t.children},drawPhase:f.c.MAP});return[].concat(Object(n.a)(Object(s.a)(Object(c.a)(r.prototype),"prepareRenderPasses",this).call(this,e)),[i])}}]),r}(r("UP7e").a)},Lc5R:function(e,t,r){"use strict";var n=r("mK0O"),i=r("eijD"),a=r("yBJb"),s=r("hisu"),u=r("NthX"),o=r.n(u),c=r("Mp7X"),l=r("0fJP"),f=r("7im+"),h=r("ZFo3"),d=r("a1Tm"),p=r("jOoW"),y=r("+MdM"),m=r("XKgO"),b=r("aic5"),v=r("pkWm"),g=r("12QT"),x=r("6CzD"),O=r("5iHx"),j=r("xnqp");function _(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return w(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return w(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(u)throw a}}}}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var I=new(function(){function e(t,r){Object(s.a)(this,e),this._cache=new O.a(t),this._invalidCache=new O.a(r)}return Object(a.a)(e,[{key:"get",value:function(e,t){var r="".concat(t.uid,":").concat(e),n=this._cache.get(r);if(n)return n;if(void 0!==this._invalidCache.get(r))return null;try{var i=j.WhereClause.create(e,t);return this._cache.put(r,i),i}catch(a){return this._invalidCache.put(r,null),null}}}]),e}())(50,500),S="feature-store:unsupported-query",k=new Set(["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeLong","esriFieldTypeDate"]);function A(e,t,r){if(!t)return!0;var n=I.get(t,e);if(!n)throw new c.a(S,"invalid SQL expression",{having:t});if(!n.isAggregate)throw new c.a(S,"having does not contain a valid aggregate function",{having:t});var i=n.fieldNames;if(T(e,i,"having contains missing fields"),!n.getExpressions().every((function(t){var n=t.aggregateType,i=t.field,a=e.has(i)&&e.get(i).name;return r.some((function(t){var r=t.onStatisticField,i=t.statisticType;return(e.has(r)&&e.get(r).name)===a&&i.toLowerCase().trim()===n}))})))throw new c.a(S,"expressions in having should also exist in outStatistics",{having:t});return!0}function F(e,t){return e?I.get(e,t):null}function T(e,t,r){var n,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=[],s=_(t);try{for(s.s();!(n=s.n()).done;){var u=n.value;if("*"!==u&&!e.has(u))if(i){var o=M(u);try{var l=F(o,e);if(!l)throw new c.a(S,"invalid SQL expression",{where:o});if(!l.isStandardized)throw new c.a(S,"expression is not standard",{clause:l});T(e,l.fieldNames,"expression contains missing fields")}catch(h){var f=h&&h.details;if(f&&(f.clause||f.where))throw h;f&&f.missingFields?a.push.apply(a,Object(x.a)(f.missingFields)):a.push(u)}}else a.push(u)}}catch(d){s.e(d)}finally{s.f()}if(a.length)throw new c.a(S,r,{missingFields:a})}function M(e){return e.split(" as ")[0]}function R(e,t){var r=t.get(e);return!!r&&!k.has(r.type)}var B=r("pjVo"),P=r("t+pe"),E=r("z4xm"),Q=r("4WE2"),C=r("AtUV");function D(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return z(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return z(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(u)throw a}}}}function z(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var V=function(){function e(t,r,n){Object(s.a)(this,e),this._fieldDataCache=new Map,this._returnDistinctMap=new Map,this.returnDistinctValues=t.returnDistinctValues,this.fieldsIndex=n,this.featureAdapter=r;var i=t.outFields;if(i&&-1===i.indexOf("*")){this.outFields=i;var a,u=0,o=D(i);try{for(o.s();!(a=o.n()).done;){var c=a.value,l=M(c),f=this.fieldsIndex.get(l),h=f?null:F(l,n),d=f?f.name:c.split(" as ")[1]||"FIELD_EXP_"+u++;this._fieldDataCache.set(c,{alias:d,clause:h})}}catch(p){o.e(p)}finally{o.f()}}}return Object(a.a)(e,[{key:"countDistinctValues",value:function(e){var t=this;return this.returnDistinctValues?(e.forEach((function(e){return t.getAttributes(e)})),this._returnDistinctMap.size):e.length}},{key:"getAttributes",value:function(e){var t=this._processAttributesForOutFields(e);return this._processAttributesForDistinctValues(t)}},{key:"getFieldValue",value:function(e,t,r){var n=r?r.name:t,i=null;return this._fieldDataCache.has(n)?i=this._fieldDataCache.get(n).clause:r||(i=F(t,this.fieldsIndex),this._fieldDataCache.set(n,{alias:n,clause:i})),r?this.featureAdapter.getAttribute(e,n):i.calculateValue(e,this.featureAdapter)}},{key:"getNormalizedValue",value:function(e,t){var r=t.normalizationType,n=t.normalizationTotal,i=this.getFieldValue(e,t.field,t.fieldInfo);if(r&&Number.isFinite(i)){var a=this.getFieldValue(e,t.normalizationField,t.normalizationFieldInfo);i=Object(C.c)(i,r,a,n)}return i}},{key:"getExpressionValue",value:function(e,t,r){var n={attributes:this.featureAdapter.getAttributes(e)},i=r.createExecContext(n,t.viewInfo);return r.executeFunction(t.compiledFunc,i)}},{key:"validateItem",value:function(e,t){return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:F(t,this.fieldsIndex)}),this._fieldDataCache.get(t).clause.testFeature(e,this.featureAdapter)}},{key:"validateItems",value:function(e,t){return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:F(t,this.fieldsIndex)}),this._fieldDataCache.get(t).clause.testSet(e,this.featureAdapter)}},{key:"_processAttributesForOutFields",value:function(e){var t=this.outFields;if(!t||!t.length)return this.featureAdapter.getAttributes(e);var r,n={},i=D(t);try{for(i.s();!(r=i.n()).done;){var a=r.value,s=this._fieldDataCache.get(a),u=s.alias,o=s.clause;n[u]=o?o.calculateValue(e,this.featureAdapter):this.featureAdapter.getAttribute(e,u)}}catch(c){i.e(c)}finally{i.f()}return n}},{key:"_processAttributesForDistinctValues",value:function(e){if(Object(f.h)(e)||!this.returnDistinctValues)return e;var t=this.outFields,r=[];if(t){var n,i=D(t);try{for(i.s();!(n=i.n()).done;){var a=n.value,s=this._fieldDataCache.get(a).alias;r.push(e[s])}}catch(l){i.e(l)}finally{i.f()}}else for(var u in e)r.push(e[u]);var o="".concat((t||["*"]).join(","),"=").concat(r.join(",")),c=this._returnDistinctMap.get(o)||0;return this._returnDistinctMap.set(o,++c),c>1?null:e}}]),e}(),X=r("r99u"),Y=r("7zgW"),N=r("DuP7"),q=r("DE4D");function G(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function L(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?G(Object(r),!0).forEach((function(t){Object(n.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):G(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Z(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return U(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return U(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(u)throw a}}}}function U(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function J(e){return e.substr(24,12)+e.substr(19,4)+e.substr(16,2)+e.substr(14,2)+e.substr(11,2)+e.substr(9,2)+e.substr(6,2)+e.substr(4,2)+e.substr(2,2)+e.substr(0,2)}function W(e,t,r){return(r?e>t:e<t)?-1:(r?e<t:e>t)?1:0}function H(e,t,r){return r?t-e:e-t}function $(e,t,r,n){if(r&&"esriFieldTypeDate"===r.type){var i=new Date(e).getTime(),a=new Date(t).getTime();if(!isNaN(i)&&!isNaN(a))return H(i,a,n)}if("number"==typeof e&&"number"==typeof t)return H(e,t,n);if("string"==typeof e&&"string"==typeof t){var s=e.toUpperCase(),u=t.toUpperCase();return!r||"esriFieldTypeGUID"!==r.type&&"esriFieldTypeGlobalID"!==r.type?W(s,u,n):W(J(s),J(u),n)}return n?1:-1}function K(e,t,r,n,i,a){var s=i-r,u=a-n,o=s*s+u*u,c=(e-r)*s+(t-n)*u,l=Math.min(1,Math.max(0,c/o));return{x:r+s*l,y:n+u*l}}var ee=function(){function e(t,r,n){Object(s.a)(this,e),this.items=t,this.queryGeometry=r,this.definitionExpression=n.definitionExpression,this.geometryType=n.geometryType,this.hasM=n.hasM,this.hasZ=n.hasZ,this.objectIdField=n.objectIdField,this.spatialReference=n.spatialReference,this.fieldsIndex=n.fieldsIndex,this.timeInfo=n.timeInfo,this.featureAdapter=n.featureAdapter,this.aggregateAdapter=n.aggregateAdapter}var t,r,n;return Object(a.a)(e,[{key:"size",get:function(){return this.items.length}},{key:"createQueryResponseForCount",value:function(e){var t=new V(e,this.featureAdapter,this.fieldsIndex);if(!e.outStatistics)return t.countDistinctValues(this.items);var r=e.groupByFieldsForStatistics,n=e.having;if(!(null==r?void 0:r.length))return 1;var i,a=new Map,s=new Map,u=new Set,o=Z(e.outStatistics);try{for(o.s();!(i=o.n()).done;){var c=i.value,l="exceedslimit"!==c.statisticType?c.onStatisticField:void 0;if(!s.has(l)){var f,h=[],d=Z(r);try{for(d.s();!(f=d.n()).done;){var p=f.value,y=this._getAttributeValues(t,p,a);h.push(y)}}catch(j){d.e(j)}finally{d.f()}s.set(l,this._calculateUniqueValues(h))}var m=s.get(l);for(var b in m){var v=m[b],g=v.data,x=v.items,O=g.join(",");n&&!t.validateItems(x,n)||u.add(O)}}}catch(j){o.e(j)}finally{o.f()}return u.size}},{key:"createQueryResponse",value:function(e){var t;return t=e.outStatistics?e.outStatistics.some((function(e){return"exceedslimit"===e.statisticType}))?this._createExceedsLimitQueryResponse(e):this._createStatisticsQueryResponse(e):this._createFeatureQueryResponse(e),e.returnQueryGeometry&&(Object(g.j)(e.outSR)&&!Object(g.c)(this.queryGeometry.spatialReference,e.outSR)?t.queryGeometry=Object(Y.b)(L({spatialReference:e.outSR},Object(B.b)(this.queryGeometry,this.queryGeometry.spatialReference,e.outSR))):t.queryGeometry=Object(Y.b)(L({spatialReference:e.outSR},this.queryGeometry))),t}},{key:"createSnappingResponse",value:function(e,t){var r,n=this.featureAdapter,i=function(e,t){return e?t?4:3:t?3:2}(this.hasZ,this.hasM),a=e.point,s=a.x,u=a.y,o="number"==typeof e.distance?e.distance:e.distance.x,c="number"==typeof e.distance?e.distance:e.distance.y,l={candidates:[]},f="esriGeometryPolygon"===this.geometryType,h=this.getPointCreator(e.point,this.spatialReference,t),d=Z(this.items);try{for(d.s();!(r=d.n()).done;){var p=r.value,y=n.getGeometry(p);if(y){var m=y.coords,b=y.lengths;if(1&e.types)for(var v=0,g=0;g<b.length;g++)for(var x=b[g],O=0;O<x;O++,v+=i){var j=m[v],_=m[v+1];if(O!==x-1){var w=m[v+i],I=m[v+i+1],S=K(s,u,j,_,w,I),k=S.x,A=S.y,F=(s-k)/o,T=(u-A)/c,M=F*F+T*T;M<=1&&l.candidates.push({type:"edge",objectId:n.getObjectId(p),distance:Math.sqrt(M),target:h(k,A),start:h(j,_),end:h(w,I)})}}if(2&e.types)for(var R=f?m.length-i:m.length,B=0;B<R;B+=i){var P=m[B],E=m[B+1],Q=(s-P)/o,C=(u-E)/c,D=Q*Q+C*C;D<=1&&l.candidates.push({type:"vertex",objectId:n.getObjectId(p),distance:Math.sqrt(D),target:h(P,E)})}}}}catch(z){d.e(z)}finally{d.f()}return l.candidates.sort((function(e,t){return e.distance-t.distance})),l}},{key:"getPointCreator",value:function(e,t,r){var n=Object(f.i)(r)&&!Object(g.c)(t,r)?function(e){return Object(B.b)(e,t,r)}:function(e){return e};return null!=e.z&&null!=e.m?function(t,r){return n({x:t,y:r,z:e.z,m:e.m})}:null!=e.z?function(t,r){return n({x:t,y:r,z:e.z})}:null!=e.m?function(t,r){return n({x:t,y:r,m:e.m})}:function(e,t){return n({x:e,y:t})}}},{key:"executeAttributesQuery",value:function(t){var r=F(t.where,this.fieldsIndex);if(!r)return Promise.resolve(this);if(r.isStandardized){var n,i=0,a=[],s=Z(this.items);try{for(s.s();!(n=s.n()).done;){var u=n.value;r.testFeature(u,this.featureAdapter)&&(a[i++]=u)}}catch(c){s.e(c)}finally{s.f()}var o=new e(a,this.queryGeometry,this);return o.definitionExpression=t.where,Promise.resolve(o)}return Promise.reject(new TypeError("Where clause is not standardized"))}},{key:"executeAggregateIdsQuery",value:function(t){if(!t.aggregateIds||!t.aggregateIds.length||Object(f.h)(this.aggregateAdapter))return Promise.resolve(this);var r,n=new Set,i=Z(t.aggregateIds);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.aggregateAdapter.getFeatureObjectIds(a).forEach((function(e){return n.add(e)}))}}catch(u){i.e(u)}finally{i.f()}var s=this.featureAdapter.getObjectId;return Promise.resolve(new e(this.items.filter((function(e){return n.has(s(e))})),this.queryGeometry,this))}},{key:"executeObjectIdsQuery",value:function(t){if(!t.objectIds||!t.objectIds.length)return Promise.resolve(this);var r=new Set(t.objectIds),n=this.featureAdapter.getObjectId;return Promise.resolve(new e(this.items.filter((function(e){return r.has(n(e))})),this.queryGeometry,this))}},{key:"executeTimeQuery",value:function(t){var r=Object(X.b)(this.timeInfo,t.timeExtent,this.featureAdapter);if(!Object(f.i)(r))return Promise.resolve(this);var n=this.items.filter(r);return Promise.resolve(new e(n,this.queryGeometry,this))}},{key:"filterLatest",value:function(){var t,r=this.timeInfo,n=r.trackIdField,i=r.startTimeField,a=r.endTimeField||i,s=new Map,u=this.featureAdapter.getAttribute,o=Z(this.items);try{for(o.s();!(t=o.n()).done;){var c=t.value,l=u(c,n),f=u(c,a),h=s.get(l);(!h||f>u(h,a))&&s.set(l,c)}}catch(p){o.e(p)}finally{o.f()}var d=Array.from(s.values());return Promise.resolve(new e(d,this.queryGeometry,this))}},{key:"project",value:(n=Object(i.a)(o.a.mark((function t(r){var n,i,a=this;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r&&!Object(g.c)(this.spatialReference,r)){t.next=2;break}return t.abrupt("return",this);case 2:return n=this.featureAdapter,t.next=5,Object(B.c)(this.items.map((function(e){return Object(Y.c)(a.geometryType,a.hasZ,a.hasM,n.getGeometry(e))})),this.spatialReference,r);case 5:return i=t.sent.map((function(e,t){return n.cloneWithGeometry(a.items[t],Object(Q.d)(e,a.hasZ,a.hasM))})),t.abrupt("return",new e(i,this.queryGeometry,{definitionExpression:this.definitionExpression,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:r,fieldsIndex:this.fieldsIndex,timeInfo:this.timeInfo,featureAdapter:this.featureAdapter}));case 7:case"end":return t.stop()}}),t,this)}))),function(e){return n.apply(this,arguments)})},{key:"createSummaryStatisticsResponse",value:(r=Object(i.a)(o.a.mark((function e(t,r){var n,i,a,s,u,c,l,f,h,d,p;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.field,i=r.normalizationField,a=r.normalizationType,s=r.normalizationTotal,u=r.minValue,c=r.maxValue,l=new V(t,this.featureAdapter,this.fieldsIndex),f=this.fieldsIndex.isDateField(n),!r.valueExpression){e.next=14;break}return e.next=11,this._getAttributeExpressionValues(l,r.valueExpression,r.viewInfoParams);case 11:e.t0=e.sent,e.next=15;break;case 14:e.t0=this._getAttributeNormalizedValues(l,{field:n,normalizationField:i,normalizationType:a,normalizationTotal:s});case 15:return h=e.t0,d=Object(C.d)({normalizationType:a,normalizationField:i,minValue:u,maxValue:c}),p=Object(N.q)(this.fieldsIndex.get(n))?Object(C.b)({values:h,supportsNullCount:d}):Object(C.a)({values:h,minValue:u,maxValue:c,useSampleStdDev:!a,supportsNullCount:d}),e.abrupt("return",Object(C.e)(p,f));case 19:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"_sortFeatures",value:function(e,t,r){var n=this;if(e.length>1&&t&&t.length){var i,a=Z(t.reverse());try{var s=function(){var t=i.value.split(" "),a=t[0],s=n.fieldsIndex.get(a),u=t[1]&&"desc"===t[1].toLowerCase();e.sort((function(e,t){return $(r(e,a,s),r(t,a,s),s,u)}))};for(a.s();!(i=a.n()).done;)s()}catch(u){a.e(u)}finally{a.f()}}}},{key:"_createFeatureQueryResponse",value:function(e){var t=this,r=this.items,n=this.geometryType,i=this.hasM,a=this.hasZ,s=this.objectIdField,u=this.spatialReference,o=e.outFields,c=e.outSR,l=e.quantizationParameters,f=e.resultRecordCount,h=e.resultOffset,d=e.returnZ,p=e.returnM,y=null!=f&&r.length>(h||0)+f,m=o&&(o.indexOf("*")>-1?Object(x.a)(this.fieldsIndex.fields):o.map((function(e){return t.fieldsIndex.get(e)})));return{exceededTransferLimit:y,features:this._createFeatures(e,r),fields:m,geometryType:n,hasM:i&&p,hasZ:a&&d,objectIdFieldName:s,spatialReference:Object(Y.b)(c||u),transform:l&&Object(E.c)(l)||null}}},{key:"_createFeatures",value:function(e,t){var r=new V(e,this.featureAdapter,this.fieldsIndex),n=this.hasM,i=this.hasZ,a=e.orderByFields,s=e.quantizationParameters,u=e.returnGeometry,o=e.returnCentroid,c=e.maxAllowableOffset,l=e.resultOffset,f=e.resultRecordCount,h=e.returnZ,d=void 0!==h&&h,p=e.returnM,y=i&&d,m=n&&(void 0!==p&&p),b=[],v=0,g=Object(x.a)(t);if(this._sortFeatures(g,a,(function(e,t,n){return r.getFieldValue(e,t,n)})),u||o){var O=Object(E.c)(s);if(u&&!o){var j,_=Z(g);try{for(_.s();!(j=_.n()).done;){var w=j.value;b[v++]={attributes:r.getAttributes(w),geometry:Object(Y.c)(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(w),c,O,y,m)}}}catch(D){_.e(D)}finally{_.f()}}else if(!u&&o){var I,S=Z(g);try{for(S.s();!(I=S.n()).done;){var k=I.value;b[v++]={attributes:r.getAttributes(k),centroid:Object(Y.f)(this,this.featureAdapter.getCentroid(k,this),O)}}}catch(D){S.e(D)}finally{S.f()}}else{var A,F=Z(g);try{for(F.s();!(A=F.n()).done;){var T=A.value;b[v++]={attributes:r.getAttributes(T),centroid:Object(Y.f)(this,this.featureAdapter.getCentroid(T,this),O),geometry:Object(Y.c)(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(T),c,O,y,m)}}}catch(D){F.e(D)}finally{F.f()}}}else{var M,R=Z(g);try{for(R.s();!(M=R.n()).done;){var B=M.value,P=r.getAttributes(B);P&&(b[v++]={attributes:P})}}catch(D){R.e(D)}finally{R.f()}}var Q=l||0;if(null!=f){var C=Q+f;b=b.slice(Q,Math.min(b.length,C))}return b}},{key:"_createExceedsLimitQueryResponse",value:function(e){var t,r=!1,n=Number.POSITIVE_INFINITY,i=Number.POSITIVE_INFINITY,a=Number.POSITIVE_INFINITY,s=Z(e.outStatistics);try{for(s.s();!(t=s.n()).done;){var u=t.value;if("exceedslimit"===u.statisticType){n=null!=u.maxPointCount?u.maxPointCount:Number.POSITIVE_INFINITY,i=null!=u.maxRecordCount?u.maxRecordCount:Number.POSITIVE_INFINITY,a=null!=u.maxVertexCount?u.maxVertexCount:Number.POSITIVE_INFINITY;break}}}catch(l){s.e(l)}finally{s.f()}if("esriGeometryPoint"===this.geometryType)r=this.items.length>n;else if(this.items.length>i)r=!0;else{var o=this.hasZ?this.hasM?4:3:this.hasM?3:2,c=this.featureAdapter;r=this.items.reduce((function(e,t){var r=c.getGeometry(t);return e+(r&&r.coords.length||0)}),0)/o>a}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(r)}}]}}},{key:"_createStatisticsQueryResponse",value:function(e){var t,r=this,n={attributes:{}},i=[],a=new Map,s=new Map,u=new Map,o=new Map,c=new V(e,this.featureAdapter,this.fieldsIndex),l=e.outStatistics,f=e.groupByFieldsForStatistics,h=e.having,d=e.orderByFields,p=f&&f.length,y=!!p,m=y&&f[0],b=y&&!this.fieldsIndex.get(m),v=Z(l);try{for(v.s();!(t=v.n()).done;){var g=t.value,x=g.outStatisticFieldName,O=g.statisticType,j=g,_="exceedslimit"!==O?g.onStatisticField:void 0,w="percentile_disc"===O||"percentile_cont"===O,I=y&&1===p&&(_===m||b)&&"count"===O;if(y){if(!u.has(_)){var S,k=[],A=Z(f);try{for(A.s();!(S=A.n()).done;){var F=S.value,T=this._getAttributeValues(c,F,a);k.push(T)}}catch(Q){A.e(Q)}finally{A.f()}u.set(_,this._calculateUniqueValues(k,c.returnDistinctValues))}var M=u.get(_),R=function(e){var t=M[e],n=t.count,i=t.data,s=t.items,u=t.itemPositions,l=i.join(",");if(!h||c.validateItems(s,h)){var d=o.get(l)||{attributes:{}},p=null;if(I)p=n;else{var y=r._getAttributeValues(c,_,a),m=u.map((function(e){return y[e]}));p=w&&"statisticParameters"in j?r._getPercentileValue(j,m):r._getStatisticValue(j,m)}d.attributes[x]=p,f.forEach((function(e,t){return d.attributes[r.fieldsIndex.get(e)?e:"EXPR_".concat(t+1)]=i[t]})),o.set(l,d)}};for(var B in M)R(B)}else{var P=this._getAttributeValues(c,_,a);n.attributes[x]=w&&"statisticParameters"in j?this._getPercentileValue(j,P):this._getStatisticValue(j,P,s)}i.push({name:x,alias:x,type:"esriFieldTypeDouble"})}}catch(Q){v.e(Q)}finally{v.f()}var E=y?Array.from(o.values()):[n];return this._sortFeatures(E,d,(function(e,t){return e.attributes[t]})),{fields:i,features:E}}},{key:"_getStatisticValue",value:function(e,t,r){var n,i=e.onStatisticField,a=e.statisticType;return n=null!=r&&r.has(i)?r.get(i):Object(N.q)(this.fieldsIndex.get(i))?Object(C.b)({values:t}):Object(C.a)({values:t,minValue:null,maxValue:null,useSampleStdDev:!0}),r&&r.set(i,n),n["var"===a?"variance":a]}},{key:"_getPercentileValue",value:function(e,t){var r=e.onStatisticField,n=e.statisticParameters,i=e.statisticType,a=n.value,s="desc"===n.orderBy,u=this.fieldsIndex.get(r),o=Object(x.a)(t).filter((function(e){return null!=e})).sort((function(e,t){return $(e,t,u,s)}));return this._calculatePercentile(o,a,"percentile_disc"===i)}},{key:"_getAttributeValues",value:function(e,t,r){if(r.has(t))return r.get(t);var n=this.fieldsIndex.get(t),i=this.items.map((function(r){return e.getFieldValue(r,t,n)}));return r.set(t,i),i}},{key:"_getAttributeNormalizedValues",value:function(e,t){var r=this;return this.items.map((function(n){return e.getNormalizedValue(n,{field:t.field,fieldInfo:r.fieldsIndex.get(t.field),normalizationField:t.normalizationField,normalizationFieldInfo:r.fieldsIndex.get(t.normalizationField),normalizationType:t.normalizationType,normalizationTotal:t.normalizationTotal})}))}},{key:"_getAttributeExpressionValues",value:(t=Object(i.a)(o.a.mark((function e(t,r,n){var i,a,s,u;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(q.e)();case 2:return i=e.sent,a=i.arcadeUtils,s=a.createFunction(r),u=n&&a.getViewInfo(n),e.abrupt("return",this.items.map((function(e){return t.getExpressionValue(e,{compiledFunc:s,viewInfo:u},a)})));case 7:case"end":return e.stop()}}),e,this)}))),function(e,r,n){return t.apply(this,arguments)})},{key:"_calculateUniqueValues",value:function(e,t){for(var r={},n=this.items,i=n.length,a=0;a<i;a++){var s,u=n[a],o=[],c=Z(e);try{for(c.s();!(s=c.n()).done;){var l=s.value;o.push(l[a])}}catch(h){c.e(h)}finally{c.f()}var f=o.join(",");t?null==r[f]&&(r[f]={count:1,data:o,items:[u],itemPositions:[a]}):null==r[f]?r[f]={count:1,data:o,items:[u],itemPositions:[a]}:(r[f].count++,r[f].items.push(u),r[f].itemPositions.push(a))}return r}},{key:"_calculatePercentile",value:function(e,t,r){if(0===e.length)return null;if(t<=0)return e[0];if(t>=1)return e[e.length-1];var n=(e.length-1)*t,i=Math.floor(n),a=i+1,s=n%1,u=e[i],o=e[a];return a>=e.length||r||"string"==typeof u||"string"==typeof o?u:u*(1-s)+o*s}}]),e}(),te=r("+Gk0"),re=r("nyn0"),ne=r("juU0"),ie=r("HGlF");function ae(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function se(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ae(Object(r),!0).forEach((function(t){Object(n.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ae(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ue(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return oe(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return oe(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(u)throw a}}}}function oe(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var ce="feature-store:unsupported-query",le=new Set,fe=new h.b(2e6),he=0,de=function(){function e(t){var r=this;Object(s.a)(this,e),this.capabilities={query:P.a},this.geometryType=t.geometryType,this.hasM=t.hasM,this.hasZ=t.hasZ,this.objectIdField=t.objectIdField,this.spatialReference=t.spatialReference,this.definitionExpression=t.definitionExpression,this.featureStore=t.featureStore,this.aggregateAdapter=t.aggregateAdapter,this._changeHandle=this.featureStore.events.on("changed",(function(){return r.clearCache()})),this.timeInfo=t.timeInfo,t.cacheSpatialQueries&&(this._geometryQueryCache=new h.a(he+++"$$",fe)),this.fieldsIndex=new re.a(t.fields),t.scheduler&&t.priority&&(this._frameQueue=new ne.a,this._frameTask=t.scheduler.registerTask(t.priority,this))}var t,r,n,u,x,O,j,_,w,k,F,M,E,Q,C,D;return Object(a.a)(e,[{key:"destroy",value:function(){this._frameTask&&(this._frameTask.remove(),this._frameTask=null,this._frameQueue.cancelAll(),this._frameQueue=null),this.clearCache(),this._geometryQueryCache&&this._geometryQueryCache.destroy(),this._changeHandle&&(this._changeHandle.remove(),this._changeHandle=null),this.fieldsIndex.destroy()}},{key:"featureAdapter",get:function(){return this.featureStore.featureAdapter}},{key:"fullExtent",get:function(){var e=this.featureStore.fullBounds;return e?{xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3],spatialReference:Object(Y.b)(this.spatialReference)}:null}},{key:"timeExtent",get:function(){return this.timeInfo?(this._timeExtent||(this._timeExtent=Object(X.a)(this.timeInfo,this.featureStore)),this._timeExtent):null}},{key:"clearCache",value:function(){this._geometryQueryCache&&this._geometryQueryCache.clear(),this._allItems=null,this._timeExtent=null}},{key:"executeQuery",value:(D=Object(i.a)(o.a.mark((function e(){var t,r,n,i,a=this,s=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:{},r=s.length>1?s[1]:void 0,i=Object(l.a)(t),e.prev=3,e.next=6,this._schedule((function(){return Object(Y.d)(i,a.definitionExpression,a.spatialReference)}),r);case 6:return i=e.sent,e.next=9,this._reschedule((function(){return a._checkQuerySupport(i)}),r);case 9:return i=e.sent,e.next=12,this._reschedule((function(){return a._executeGeometryQuery(i,r)}),r);case 12:return n=e.sent,e.next=15,this._reschedule((function(){return n.executeAggregateIdsQuery(i)}),r);case 15:return n=e.sent,e.next=18,this._reschedule((function(){return n.executeObjectIdsQuery(i)}),r);case 18:return n=e.sent,e.next=21,this._reschedule((function(){return n.executeTimeQuery(i)}),r);case 21:return n=e.sent,e.next=24,this._reschedule((function(){return n.executeAttributesQuery(i)}),r);case 24:n=e.sent,e.next=32;break;case 27:if(e.prev=27,e.t0=e.catch(3),e.t0===Y.a){e.next=31;break}throw e.t0;case 31:n=new ee([],null,this);case 32:return e.abrupt("return",n.createQueryResponse(i));case 33:case"end":return e.stop()}}),e,this,[[3,27]])}))),function(){return D.apply(this,arguments)})},{key:"executeQueryForCount",value:(C=Object(i.a)(o.a.mark((function e(){var t,r,n,i,a=this,s=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:{},r=s.length>1?s[1]:void 0,(i=Object(l.a)(t)).returnGeometry=!1,i.returnCentroid=!1,i.outSR=null,e.prev=4,e.next=7,this._schedule((function(){return Object(Y.d)(i,a.definitionExpression,a.spatialReference)}),r);case 7:return i=e.sent,e.next=10,this._reschedule((function(){return a._checkQuerySupport(i)}),r);case 10:return i=e.sent,e.next=13,this._reschedule((function(){return a._executeGeometryQuery(i,r)}),r);case 13:return n=e.sent,e.next=16,this._reschedule((function(){return n.executeAggregateIdsQuery(i)}),r);case 16:return n=e.sent,e.next=19,this._reschedule((function(){return n.executeObjectIdsQuery(i)}),r);case 19:return n=e.sent,e.next=22,this._reschedule((function(){return n.executeTimeQuery(i)}),r);case 22:return n=e.sent,e.next=25,this._reschedule((function(){return n.executeAttributesQuery(i)}),r);case 25:n=e.sent,e.next=33;break;case 28:if(e.prev=28,e.t0=e.catch(4),e.t0===Y.a){e.next=32;break}throw e.t0;case 32:return e.abrupt("return",0);case 33:return e.abrupt("return",n.createQueryResponseForCount(i));case 34:case"end":return e.stop()}}),e,this,[[4,28]])}))),function(){return C.apply(this,arguments)})},{key:"executeQueryForExtent",value:(Q=Object(i.a)(o.a.mark((function e(){var t,r,n,i,a,s,u,c,f,h,y,m=this,b=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=b.length>0&&void 0!==b[0]?b[0]:{},r=b.length>1?b[1]:void 0,i=Object(l.a)(t),a=i.outSR,e.prev=4,e.next=7,this._schedule((function(){return Object(Y.d)(i,m.definitionExpression,m.spatialReference)}),r);case 7:return i=e.sent,e.next=10,this._reschedule((function(){return m._checkQuerySupport(i)}),r);case 10:return(i=e.sent).returnGeometry=!0,i.returnCentroid=!1,i.outSR=null,e.next=16,this._reschedule((function(){return m._executeGeometryQuery(i,r)}),r);case 16:return n=e.sent,e.next=19,this._reschedule((function(){return n.executeAggregateIdsQuery(i)}),r);case 19:return n=e.sent,e.next=22,this._reschedule((function(){return n.executeObjectIdsQuery(i)}),r);case 22:return n=e.sent,e.next=25,this._reschedule((function(){return n.executeTimeQuery(i)}),r);case 25:return n=e.sent,e.next=28,this._reschedule((function(){return n.executeAttributesQuery(i)}),r);case 28:if(n=e.sent,s=n.size){e.next=32;break}return e.abrupt("return",{count:s,extent:null});case 32:return Object(p.j)(ye,p.a),this.featureStore.forEachBounds(n.items,(function(e){return Object(p.e)(ye,e)}),pe),u={xmin:ye[0],ymin:ye[1],xmax:ye[3],ymax:ye[4],spatialReference:Object(Y.b)(this.spatialReference)},this.hasZ&&isFinite(ye[2])&&isFinite(ye[5])&&(u.zmin=ye[2],u.zmax=ye[5]),(c=Object(B.b)(u,n.spatialReference,a)).spatialReference=Object(Y.b)(a||this.spatialReference),c.xmax-c.xmin==0&&(f=Object(d.d)(c.spatialReference),c.xmin-=f,c.xmax+=f),c.ymax-c.ymin==0&&(h=Object(d.d)(c.spatialReference),c.ymin-=h,c.ymax+=h),this.hasZ&&null!=c.zmin&&null!=c.zmax&&c.zmax-c.zmin==0&&(y=Object(d.d)(c.spatialReference),c.zmin-=y,c.zmax+=y),e.abrupt("return",{count:s,extent:c});case 42:if(e.prev=42,e.t0=e.catch(4),e.t0!==Y.a){e.next=46;break}return e.abrupt("return",{count:0,extent:null});case 46:throw e.t0;case 47:case"end":return e.stop()}}),e,this,[[4,42]])}))),function(){return Q.apply(this,arguments)})},{key:"executeQueryForIds",value:(E=Object(i.a)(o.a.mark((function e(){var t,r,n=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{},r=n.length>1?n[1]:void 0,e.abrupt("return",this.executeQueryForIdSet(t,r).then((function(e){return Array.from(e)})));case 3:case"end":return e.stop()}}),e,this)}))),function(){return E.apply(this,arguments)})},{key:"executeQueryForIdSet",value:(M=Object(i.a)(o.a.mark((function e(){var t,r,n,i,a,s,u=this,c=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.length>0&&void 0!==c[0]?c[0]:{},r=c.length>1?c[1]:void 0,(i=Object(l.a)(t)).returnGeometry=!1,i.returnCentroid=!1,i.outSR=null,e.prev=4,e.next=7,this._schedule((function(){return Object(Y.d)(i,u.definitionExpression,u.spatialReference)}),r);case 7:return i=e.sent,e.next=10,this._reschedule((function(){return u._checkQuerySupport(i)}),r);case 10:return i=e.sent,e.next=13,this._reschedule((function(){return u._executeGeometryQuery(i,r)}),r);case 13:return n=e.sent,e.next=16,this._reschedule((function(){return n.executeAggregateIdsQuery(i)}),r);case 16:return n=e.sent,e.next=19,this._reschedule((function(){return n.executeObjectIdsQuery(i)}),r);case 19:return n=e.sent,e.next=22,this._reschedule((function(){return n.executeTimeQuery(i)}),r);case 22:return n=e.sent,e.next=25,this._reschedule((function(){return n.executeAttributesQuery(i)}),r);case 25:return n=e.sent,a=n.items,s=new Set,e.next=29,this._reschedule((function(){var e,t=ue(a);try{for(t.s();!(e=t.n()).done;){var r=e.value;s.add(n.featureAdapter.getObjectId(r))}}catch(i){t.e(i)}finally{t.f()}}),r);case 29:return e.abrupt("return",s);case 32:if(e.prev=32,e.t0=e.catch(4),e.t0!==Y.a){e.next=36;break}return e.abrupt("return",new Set);case 36:throw e.t0;case 37:case"end":return e.stop()}}),e,this,[[4,32]])}))),function(){return M.apply(this,arguments)})},{key:"executeQueryForSnapping",value:(F=Object(i.a)(o.a.mark((function e(t,r){var n,i,a,s,u,c,l,h,d,p,y,m,x,O,j=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.point,i=t.distance,0!==t.types){e.next=3;break}return e.abrupt("return",{candidates:[]});case 3:return e.next=5,this._reschedule((function(){return j._checkQuerySupport(t.query)}),r);case 5:if(a=e.sent,s=!Object(g.c)(n.spatialReference,this.spatialReference),e.t0=s,!e.t0){e.next=11;break}return e.next=11,Object(B.a)(n.spatialReference,this.spatialReference);case 11:if(u="number"==typeof i?i:i.x,c="number"==typeof i?i:i.y,l={xmin:n.x-u,xmax:n.x+u,ymin:n.y-c,ymax:n.y+c,spatialReference:n.spatialReference},h=s?Object(B.b)(l,this.spatialReference):l){e.next=14;break}return e.abrupt("return",{candidates:[]});case 14:return e.next=16,Object(v.a)(Object(b.a)(n),null,{signal:r});case 16:return d=e.sent[0],e.next=19,Object(v.a)(Object(b.a)(h),null,{signal:r});case 19:if(p=e.sent[0],!Object(f.h)(d)&&!Object(f.h)(p)){e.next=22;break}return e.abrupt("return",{candidates:[]});case 22:return y=new ee(this._searchFeatures(this._getQueryBBoxes(p.toJSON())),null,this),e.next=25,this._reschedule((function(){return y.executeObjectIdsQuery(a)}),r);case 25:return y=e.sent,e.next=28,this._reschedule((function(){return y.executeTimeQuery(a)}),r);case 28:return y=e.sent,e.next=31,this._reschedule((function(){return y.executeAttributesQuery(a)}),r);case 31:return y=e.sent,m=d.toJSON(),x=s?Object(B.b)(m,this.spatialReference):m,O=s?Math.max(h.xmax-h.xmin,h.ymax-h.ymin)/2:i,e.abrupt("return",y.createSnappingResponse(se(se({},t),{},{point:x,distance:O}),n.spatialReference));case 34:case"end":return e.stop()}}),e,this)}))),function(e,t){return F.apply(this,arguments)})},{key:"executeQueryForLatestObservations",value:(k=Object(i.a)(o.a.mark((function e(){var t,r,n,i,a=this,s=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=s.length>0&&void 0!==s[0]?s[0]:{},r=s.length>1?s[1]:void 0,this.timeInfo&&this.timeInfo.trackIdField){e.next=4;break}throw new c.a(ce,"Missing timeInfo or timeInfo.trackIdField",{query:t,timeInfo:this.timeInfo});case 4:return i=Object(l.a)(t),e.prev=5,e.next=8,this._schedule((function(){return Object(Y.d)(i,a.definitionExpression,a.spatialReference)}),r);case 8:return i=e.sent,e.next=11,this._reschedule((function(){return a._checkQuerySupport(i)}),r);case 11:return i=e.sent,e.next=14,this._reschedule((function(){return a._executeGeometryQuery(i,r)}),r);case 14:return n=e.sent,e.next=17,this._reschedule((function(){return n.executeAggregateIdsQuery(i)}),r);case 17:return n=e.sent,e.next=20,this._reschedule((function(){return n.executeObjectIdsQuery(i)}),r);case 20:return n=e.sent,e.next=23,this._reschedule((function(){return n.executeTimeQuery(i)}),r);case 23:return n=e.sent,e.next=26,this._reschedule((function(){return n.executeAttributesQuery(i)}),r);case 26:return n=e.sent,e.next=29,this._reschedule((function(){return n.filterLatest()}),r);case 29:n=e.sent,e.next=37;break;case 32:if(e.prev=32,e.t0=e.catch(5),e.t0===Y.a){e.next=36;break}throw e.t0;case 36:n=new ee([],null,this);case 37:return e.abrupt("return",n.createQueryResponse(i));case 38:case"end":return e.stop()}}),e,this,[[5,32]])}))),function(){return k.apply(this,arguments)})},{key:"executeQueryForSummaryStatistics",value:(w=Object(i.a)(o.a.mark((function e(){var t,r,n,i,a=this,s=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:{},r=s.length>1?s[1]:void 0,n=s.length>2?s[2]:void 0,t=Object(l.a)(t),e.prev=4,e.next=7,this._schedule((function(){return Object(Y.d)(t,a.definitionExpression,a.spatialReference)}),n);case 7:return t=e.sent,e.next=10,this._reschedule((function(){return a._checkSummaryStatisticsSupport(t,r)}),n);case 10:return t=e.sent,e.next=13,this._reschedule((function(){return a._executeGeometryQuery(t,n)}),n);case 13:return i=e.sent,e.next=16,this._reschedule((function(){return i.executeAggregateIdsQuery(t)}),n);case 16:return i=e.sent,e.next=19,this._reschedule((function(){return i.executeObjectIdsQuery(t)}),n);case 19:return i=e.sent,e.next=22,this._reschedule((function(){return i.executeTimeQuery(t)}),n);case 22:return i=e.sent,e.next=25,this._reschedule((function(){return i.executeAttributesQuery(t)}),n);case 25:i=e.sent,e.next=33;break;case 28:if(e.prev=28,e.t0=e.catch(4),e.t0===Y.a){e.next=32;break}throw e.t0;case 32:i=new ee([],null,this);case 33:return e.abrupt("return",i.createSummaryStatisticsResponse(t,r));case 34:case"end":return e.stop()}}),e,this,[[4,28]])}))),function(){return w.apply(this,arguments)})},{key:"_schedule",value:(_=Object(i.a)(o.a.mark((function e(t,r){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._frameQueue?this._frameQueue.push(t,r):t());case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return _.apply(this,arguments)})},{key:"_reschedule",value:(j=Object(i.a)(o.a.mark((function e(t,r){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._frameQueue?this._frameQueue.unshift(t,r):t());case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return j.apply(this,arguments)})},{key:"running",get:function(){return this._frameQueue.length>0}},{key:"runTask",value:function(e){for(this._budget=e;!e.done&&this._frameQueue&&this._frameQueue.process();)e.madeProgress();this._budget=null}},{key:"_getAll",value:function(){if(!this._allItems){var e=[];this.featureStore.forEach((function(t){return e.push(t)})),this._allItems=new ee(e,null,this)}return this._allItems}},{key:"_executeGeometryQuery",value:(O=Object(i.a)(o.a.mark((function e(t,r){var n,a,s,u,c,l,h,d,p,y,m,b,v,x,O,j,_,w,I,S,k,A,F=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.geometry,a=t.outSR,s=t.spatialRel,u=t.returnGeometry,c=t.returnCentroid,l=u||c,h=Object(g.j)(a)&&!Object(g.c)(this.spatialReference,a),!(d=this._geometryQueryCache?h&&l?JSON.stringify({geometry:n,spatialRelationship:s,outSpatialReference:a}):JSON.stringify({geometry:n,spatialRelationship:s}):null)){e.next=5;break}if(p=this._geometryQueryCache.get(d),Object(f.j)(p)){e.next=5;break}return e.abrupt("return",p);case 5:if(y=function(){var e=Object(i.a)(o.a.mark((function e(t){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!h||!l){e.next=5;break}return e.next=3,t.project(a);case 3:return r=e.sent,e.abrupt("return",(d&&F._geometryQueryCache.put(d,r,r.size||1),r));case 5:return e.abrupt("return",(d&&F._geometryQueryCache.put(d,t,t.size||1),t));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n){e.next=8;break}return e.abrupt("return",y(this._getAll()));case 8:if(m=this.featureAdapter,"esriSpatialRelDisjoint"!==s){e.next=23;break}if((b=this._searchFeatures(this._getQueryBBoxes(n))).length){e.next=13;break}return e.abrupt("return",y(this._getAll()));case 13:O=new Set,j=ue(b);try{for(j.s();!(_=j.n()).done;)w=_.value,O.add(m.getObjectId(w))}catch(T){j.e(T)}finally{j.f()}return e.next=18,this._reschedule((function(){var e=0;v=new Array(O.size),F.featureStore.forEach((function(t){return v[e++]=t})),x=O}),r);case 18:return e.t0=y,e.next=21,this._reschedule(Object(i.a)(o.a.mark((function e(){var t,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(te.c)(s,n,F.geometryType,F.hasZ,F.hasM);case 2:return t=e.sent,i=function(e){return!x.has(m.getObjectId(e))||t(m.getGeometry(e))},e.t0=ee,e.next=7,F._runSpatialFilter(v,i,r);case 7:return e.t1=e.sent,e.t2=n,e.t3=F,e.abrupt("return",new e.t0(e.t1,e.t2,e.t3));case 11:case"end":return e.stop()}}),e)}))),r);case 21:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 23:if((I=this._searchFeatures(this._getQueryBBoxes(n))).length){e.next=27;break}return S=new ee([],n,this),e.abrupt("return",(d&&this._geometryQueryCache.put(d,S,S.size||1),S));case 27:if(!this._canExecuteSoloPass(n,t)){e.next=29;break}return e.abrupt("return",y(new ee(I,n,this)));case 29:return e.next=31,Object(te.c)(s,n,this.geometryType,this.hasZ,this.hasM);case 31:return k=e.sent,e.next=34,this._runSpatialFilter(I,(function(e){return k(m.getGeometry(e))}),r);case 34:return A=e.sent,e.abrupt("return",y(new ee(A,n,this)));case 36:case"end":return e.stop()}}),e,this)}))),function(e,t){return O.apply(this,arguments)})},{key:"_runSpatialFilter",value:(x=Object(i.a)(o.a.mark((function e(t,r,n){var a,s,u,c=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return",t);case 2:if(this._budget){e.next=4;break}return e.abrupt("return",t.filter((function(e){return r(e)})));case 4:return a=0,s=new Array,u=function(){var e=Object(i.a)(o.a.mark((function e(){var i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a<t.length)){e.next=10;break}if(i=t[a],r(i)&&s.push(i),e.t0=c._budget.done,!e.t0){e.next=7;break}return e.next=7,c._reschedule((function(){return u()}),n);case 7:++a;case 8:e.next=0;break;case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e.abrupt("return",this._reschedule((function(){return u()}),n).then((function(){return s})));case 7:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return x.apply(this,arguments)})},{key:"_canExecuteSoloPass",value:function(e,t){var r=this.geometryType,n=t.spatialRel;return Object(te.a)(e)&&("esriSpatialRelEnvelopeIntersects"===n||"esriGeometryPoint"===r&&("esriSpatialRelIntersects"===n||"esriSpatialRelContains"===n||"esriSpatialRelWithin"===n))}},{key:"_getQueryBBoxes",value:function(e){if(Object(te.a)(e)){if(Object(b.d)(e))return[Object(y.l)(e.xmin,e.ymin,e.xmax,e.ymax)];if(Object(b.g)(e))return e.rings.map((function(e){return Object(y.l)(Math.min(e[0][0],e[2][0]),Math.min(e[0][1],e[2][1]),Math.max(e[0][0],e[2][0]),Math.max(e[0][1],e[2][1]))}))}return[Object(m.a)(Object(y.g)(),e)]}},{key:"_searchFeatures",value:function(e){var t,r=ue(e);try{for(r.s();!(t=r.n()).done;){var n=t.value;this.featureStore.forEachInBounds(n,(function(e){le.add(e)}))}}catch(s){r.e(s)}finally{r.f()}var i=new Array(le.size),a=0;return le.forEach((function(e){return i[a++]=e})),le.clear(),i}},{key:"_checkSummaryStatisticsSupport",value:(u=Object(i.a)(o.a.mark((function e(t,r){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.distance<0||null!=t.geometryPrecision||t.multipatchOption||t.pixelSize||t.relationParam||t.text||t.outStatistics||t.groupByFieldsForStatistics||t.having||t.orderByFields)){e.next=2;break}throw new c.a(ce,"Unsupported query options",{query:t});case 2:return e.abrupt("return",Promise.all([this._checkAttributesQuerySupport(t),this._checkSummaryStatisticsParamsSupport(r),Object(te.b)(t,this.geometryType,this.spatialReference),Object(B.a)(this.spatialReference,t.outSR)]).then((function(){return t})));case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return u.apply(this,arguments)})},{key:"_checkSummaryStatisticsParamsSupport",value:(n=Object(i.a)(o.a.mark((function e(t){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ie.d)({field:t.field,normalizationField:t.normalizationField,valueExpression:t.valueExpression});case 2:if((r=e.sent).length){e.next=5;break}throw new c.a(ce,"params should have atleast a field or valueExpression",{params:t});case 5:T(this.fieldsIndex,r,"params contains missing fields");case 6:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"_checkQuerySupport",value:(r=Object(i.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.distance<0||null!=t.geometryPrecision||t.multipatchOption||t.pixelSize||t.relationParam||t.text)){e.next=2;break}throw new c.a(ce,"Unsupported query options",{query:t});case 2:return e.abrupt("return",Promise.all([this._checkAttributesQuerySupport(t),this._checkStatisticsQuerySupport(t),Object(te.b)(t,this.geometryType,this.spatialReference),Object(B.a)(this.spatialReference,t.outSR)]).then((function(){return t})));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"_checkAttributesQuerySupport",value:function(e){var t=e.outFields,r=e.orderByFields,n=e.returnDistinctValues,i=e.outStatistics,a=i?i.map((function(e){return e.outStatisticFieldName&&e.outStatisticFieldName.toLowerCase()})):[];if(r&&r.length>0){var s=r.map((function(e){var t=e.toLowerCase();return t.indexOf(" asc")>-1?t.split(" asc")[0]:t.indexOf(" desc")>-1?t.split(" desc")[0]:e})).filter((function(e){return-1===a.indexOf(e)}));T(this.fieldsIndex,s,"orderByFields contains missing fields")}if(t&&t.length>0)T(this.fieldsIndex,t,"outFields contains missing fields");else if(n)throw new c.a(ce,"outFields should be specified for returnDistinctValues",{query:e});!function(e,t){if(!t)return!0;var r=I.get(t,e);if(!r)throw new c.a(S,"invalid SQL expression",{where:t});if(!r.isStandardized)throw new c.a(S,"where clause is not standard",{where:t});T(e,r.fieldNames,"where clause contains missing fields")}(this.fieldsIndex,e.where)}},{key:"_checkStatisticsQuerySupport",value:(t=Object(i.a)(o.a.mark((function e(t){var r,n,i,a,s,u,l,f,h,d,p;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.outStatistics,n=t.groupByFieldsForStatistics,i=t.having,a=n&&n.length,s=r&&r.length,!i){e.next=5;break}if(a&&s){e.next=4;break}throw new c.a(ce,"outStatistics and groupByFieldsForStatistics should be specified with having",{query:t});case 4:A(this.fieldsIndex,i,r);case 5:if(!s){e.next=34;break}if(r.every((function(e){return"exceedslimit"!==e.statisticType}))){e.next=8;break}return e.abrupt("return");case 8:u=r.map((function(e){return e.onStatisticField})),T(this.fieldsIndex,u,"onStatisticFields contains missing fields"),a&&T(this.fieldsIndex,n,"groupByFieldsForStatistics contains missing fields"),l=ue(r),e.prev=11,l.s();case 13:if((f=l.n()).done){e.next=26;break}if(h=f.value,d=h.onStatisticField,"percentile_disc"!==(p=h.statisticType)&&"percentile_cont"!==p||!("statisticParameters"in h)){e.next=22;break}if(h.statisticParameters){e.next=20;break}throw new c.a(ce,"statisticParamters should be set for percentile type",{definition:h,query:t});case 20:e.next=24;break;case 22:if("count"===p||!d||!R(d,this.fieldsIndex)){e.next=24;break}throw new c.a(ce,"outStatistics contains non-numeric fields",{definition:h,query:t});case 24:e.next=13;break;case 26:e.next=31;break;case 28:e.prev=28,e.t0=e.catch(11),l.e(e.t0);case 31:return e.prev=31,l.f(),e.finish(31);case 34:case"end":return e.stop()}}),e,this,[[11,28,31,34]])}))),function(e){return t.apply(this,arguments)})}]),e}(),pe=Object(p.b)(),ye=Object(p.b)();t.a=de},"Lk2+":function(e,t,r){"use strict";var n=r("hisu"),i=r("yBJb"),a=r("Mp7X"),s=r("v3KF"),u=r("TM+E"),o=r("7im+"),c=r("jOoW"),l=r("+MdM"),f=r("4WE2"),h=r("Sl7M"),d=r("Hhu8"),p=r("JBec"),y=r("4zgH"),m={getObjectId:function(e){return e.objectId},getAttributes:function(e){return e.attributes},getAttribute:function(e,t){return e.attributes[t]},cloneWithGeometry:function(e,t){return new p.a(t,e.attributes,null,e.objectId)},getGeometry:function(e){return e.geometry},getCentroid:function(e,t){return e.centroid||(e.centroid=Object(d.a)(new y.a,e.geometry,t.hasZ,t.hasM)),e.centroid}};function b(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return v(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return v(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(u)throw a}}}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var g=function(){function e(t){Object(n.a)(this,e),this.geometryInfo=t,this._boundsStore=new h.a,this._featuresById=new Map,this._markedIds=new Set,this.events=new s.a,this.featureAdapter=m}return Object(i.a)(e,[{key:"geometryType",get:function(){return this.geometryInfo.geometryType}},{key:"hasM",get:function(){return this.geometryInfo.hasM}},{key:"hasZ",get:function(){return this.geometryInfo.hasZ}},{key:"numFeatures",get:function(){return this._featuresById.size}},{key:"fullBounds",get:function(){var e=this;if(!this.numFeatures)return null;var t=Object(l.g)(l.a);return this._featuresById.forEach((function(r){var n=e._boundsStore.get(r.objectId);n&&(t[0]=Math.min(n[0],t[0]),t[1]=Math.min(n[1],t[1]),t[2]=Math.max(n[2],t[2]),t[3]=Math.max(n[3],t[3]))})),t}},{key:"storeStatistics",get:function(){var e=0;return this._featuresById.forEach((function(t){t.geometry&&t.geometry.coords&&(e+=t.geometry.coords.length)})),{featureCount:this._featuresById.size,vertexCount:e/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}}},{key:"add",value:function(e){this._add(e),this._emitChanged()}},{key:"addMany",value:function(e){var t,r=b(e);try{for(r.s();!(t=r.n()).done;){var n=t.value;this._add(n)}}catch(i){r.e(i)}finally{r.f()}this._emitChanged()}},{key:"clear",value:function(){this._featuresById.clear(),this._boundsStore.clear(),this._emitChanged()}},{key:"removeById",value:function(e){var t=this._featuresById.get(e);return t?(this._remove(t),this._emitChanged(),t):null}},{key:"removeManyById",value:function(e){this._boundsStore.invalidateIndex();var t,r=b(e);try{for(r.s();!(t=r.n()).done;){var n=t.value,i=this._featuresById.get(n);i&&this._remove(i)}}catch(a){r.e(a)}finally{r.f()}this._emitChanged()}},{key:"forEachBounds",value:function(e,t,r){var n,i=b(e);try{for(i.s();!(n=i.n()).done;){var a=n.value,s=this._boundsStore.get(a.objectId);s&&t(Object(c.h)(r,s))}}catch(u){i.e(u)}finally{i.f()}}},{key:"getFeature",value:function(e){return this._featuresById.get(e)}},{key:"has",value:function(e){return this._featuresById.has(e)}},{key:"forEach",value:function(e){this._featuresById.forEach((function(t){return e(t)}))}},{key:"forEachInBounds",value:function(e,t){var r=this;this._boundsStore.forEachInBounds(e,(function(e){t(r._featuresById.get(e))}))}},{key:"startMarkingUsedFeatures",value:function(){this._boundsStore.invalidateIndex(),this._markedIds.clear()}},{key:"sweep",value:function(){var e=this,t=!1;this._featuresById.forEach((function(r,n){e._markedIds.has(n)||(t=!0,e._remove(r))})),this._markedIds.clear(),t&&this._emitChanged()}},{key:"_emitChanged",value:function(){this.events.emit("changed",void 0)}},{key:"_add",value:function(e){if(e){var t=e.objectId;if(null!=t){var r,n=this._featuresById.get(t);if(this._markedIds.add(t),n?(e.displayId=n.displayId,r=this._boundsStore.get(t),this._boundsStore.delete(t)):Object(o.i)(this.onFeatureAdd)&&this.onFeatureAdd(e),!e.geometry||!e.geometry.coords||!e.geometry.coords.length)return this._boundsStore.set(t,null),void this._featuresById.set(t,e);r=Object(f.r)(r||Object(l.g)(),e.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),this._boundsStore.set(t,r),this._featuresById.set(t,e)}else u.a.getLogger("esri.layers.graphics.data.FeatureStore").error(new a.a("featurestore:invalid-feature","feature id is missing",{feature:e}))}}},{key:"_remove",value:function(e){return Object(o.i)(this.onFeatureRemove)&&this.onFeatureRemove(e),this._markedIds.delete(e.objectId),this._boundsStore.delete(e.objectId),this._featuresById.delete(e.objectId),e}}]),e}();t.a=g},SDdS:function(e,t,r){"use strict";r.d(t,"a",(function(){return m}));var n=r("hisu"),i=r("yBJb"),a=r("CHlC"),s=r("kMo5"),u=r("P+uj"),o=r("dQW7"),c=(r("ZTBZ"),r("xAIp")),l=(r("J4Pc"),r("wckI"),r("TM+E"),r("mp5+")),f=r("iaHD"),h=r("/L0V"),d=r("7f4O"),p=r("YHXj");function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Object(u.a)(e);if(t){var i=Object(u.a)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Object(s.a)(this,r)}}var m=function(e){var t=function(e){Object(a.a)(r,e);var t=y(r);function r(){var e;return Object(n.a)(this,r),(e=t.apply(this,arguments)).copyright=null,e.minScale=0,e.maxScale=0,e.spatialReference=null,e.tileInfo=null,e.tilemapCache=null,e}return Object(i.a)(r,[{key:"readMinScale",value:function(e,t){return null!=t.minLOD&&null!=t.maxLOD?e:0}},{key:"readMaxScale",value:function(e,t){return null!=t.minLOD&&null!=t.maxLOD?e:0}},{key:"supportsBlankTile",get:function(){return this.version>=10.2}},{key:"readTilemapCache",value:function(e,t){return t.capabilities&&t.capabilities.indexOf("Tilemap")>-1?new d.a({layer:this}):null}}]),r}(e);return Object(o.a)([Object(c.b)({json:{read:{source:"copyrightText"}}})],t.prototype,"copyright",void 0),Object(o.a)([Object(c.b)()],t.prototype,"minScale",void 0),Object(o.a)([Object(l.a)("service","minScale")],t.prototype,"readMinScale",null),Object(o.a)([Object(c.b)()],t.prototype,"maxScale",void 0),Object(o.a)([Object(l.a)("service","maxScale")],t.prototype,"readMaxScale",null),Object(o.a)([Object(c.b)({type:p.a})],t.prototype,"spatialReference",void 0),Object(o.a)([Object(c.b)({readOnly:!0})],t.prototype,"supportsBlankTile",null),Object(o.a)([Object(c.b)(h.b)],t.prototype,"tileInfo",void 0),Object(o.a)([Object(c.b)()],t.prototype,"tilemapCache",void 0),Object(o.a)([Object(l.a)("service","tilemapCache",["capabilities"])],t.prototype,"readTilemapCache",null),Object(o.a)([Object(c.b)()],t.prototype,"version",void 0),t=Object(o.a)([Object(f.a)("esri.layers.mixins.ArcGISCachedService")],t)}},Sl7M:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("hisu"),i=r("yBJb"),a=r("J4Pc"),s=r("gj1o"),u={minX:0,minY:0,maxX:0,maxY:0};var o=function(){function e(){var t=this;Object(n.a)(this,e),this._indexInvalid=!1,this._boundsToLoad=[],this._boundsById=new Map,this._idByBounds=new Map,this._index=new s.a(9,Object(a.a)("csp-restrictions")?function(e){return{minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}}:["[0]","[1]","[2]","[3]"]),this._loadIndex=function(){if(t._indexInvalid){var e=new Array(t._idByBounds.size),r=0;t._idByBounds.forEach((function(t,n){e[r++]=n})),t._indexInvalid=!1,t._index.clear(),t._index.load(e)}else t._boundsToLoad.length&&(t._index.load(t._boundsToLoad.filter((function(e){return t._idByBounds.has(e)}))),t._boundsToLoad.length=0)}}return Object(i.a)(e,[{key:"clear",value:function(){this._indexInvalid=!1,this._boundsToLoad.length=0,this._boundsById.clear(),this._idByBounds.clear(),this._index.clear()}},{key:"delete",value:function(e){var t=this._boundsById.get(e);this._boundsById.delete(e),t&&(this._idByBounds.delete(t),this._indexInvalid||this._index.remove(t))}},{key:"forEachInBounds",value:function(e,t){var r=this;this._loadIndex(),function(e,t,r){u.minX=t[0],u.minY=t[1],u.maxX=t[2],u.maxY=t[3],e.search(u,r)}(this._index,e,(function(e){return t(r._idByBounds.get(e))}))}},{key:"get",value:function(e){return this._boundsById.get(e)}},{key:"has",value:function(e){return this._boundsById.has(e)}},{key:"invalidateIndex",value:function(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}},{key:"set",value:function(e,t){if(!this._indexInvalid){var r=this._boundsById.get(e);r&&(this._index.remove(r),this._idByBounds.delete(r))}this._boundsById.set(e,t),t&&(this._idByBounds.set(t,e),this._indexInvalid||(this._boundsToLoad.push(t),this._boundsToLoad.length>5e4&&this._loadIndex()))}}]),e}()},gj1o:function(e,t,r){"use strict";r.d(t,"a",(function(){return y}));var n=r("CHlC"),i=r("kMo5"),a=r("P+uj"),s=r("hisu"),u=r("yBJb"),o=r("X6u8"),c=r("7im+"),l=r("DVFM"),f=r("bcbt");function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Object(a.a)(e);if(t){var s=Object(a.a)(this).constructor;r=Reflect.construct(n,arguments,s)}else r=n.apply(this,arguments);return Object(i.a)(this,r)}}function d(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return p(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return p(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(u)throw a}}}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var y=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:9,r=arguments.length>1?arguments[1]:void 0;Object(s.a)(this,e),this.compareMinX=g,this.compareMinY=x,this.toBBox=function(e){return e},this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),r&&("function"==typeof r?this.toBBox=r:this._initFormat(r)),this.clear()}return Object(u.a)(e,[{key:"destroy",value:function(){this.clear(),A.prune(),F.prune(),T.prune(),M.prune()}},{key:"all",value:function(e){this._all(this.data,e)}},{key:"search",value:function(e,t){var r=this.data,n=this.toBBox;if(S(e,r))for(A.clear();r;){for(var i=0,a=r.children.length;i<a;i++){var s=r.children[i],u=r.leaf?n(s):s;S(e,u)&&(r.leaf?t(s):I(e,u)?this._all(s,t):A.push(s))}r=A.pop()}}},{key:"collides",value:function(e){var t=this.data,r=this.toBBox;if(!S(e,t))return!1;for(A.clear();t;){for(var n=0,i=t.children.length;n<i;n++){var a=t.children[n],s=t.leaf?r(a):a;if(S(e,s)){if(t.leaf||I(e,s))return!0;A.push(a)}}t=A.pop()}return!1}},{key:"load",value:function(e){if(!e.length)return this;if(e.length<this._minEntries){for(var t=0,r=e.length;t<r;t++)this.insert(e[t]);return this}var n=this._build(e.slice(0,e.length),0,e.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var i=this.data;this.data=n,n=i}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this}},{key:"insert",value:function(e){return e&&this._insert(e,this.data.height-1),this}},{key:"clear",value:function(){return this.data=new B([]),this}},{key:"remove",value:function(e){if(!e)return this;var t,r=this.data,n=null,i=0,a=!1,s=this.toBBox(e);for(T.clear(),M.clear();r||T.length>0;){var u;if(r||(r=Object(c.c)(T.pop()),n=T.data[T.length-1],i=null!=(u=M.pop())?u:0,a=!0),r.leaf&&-1!==(t=Object(o.e)(r.children,e,r.children.length,r.indexHint)))return r.children.splice(t,1),T.push(r),this._condense(T),this;a||r.leaf||!I(r,s)?n?(i++,r=n.children[i],a=!1):r=null:(T.push(r),M.push(i),i=0,n=r,r=r.children[0])}return this}},{key:"toJSON",value:function(){return this.data}},{key:"fromJSON",value:function(e){return this.data=e,this}},{key:"_all",value:function(e,t){var r=e;for(F.clear();r;){var n;if(!0===r.leaf){var i,a=d(r.children);try{for(a.s();!(i=a.n()).done;){t(i.value)}}catch(s){a.e(s)}finally{a.f()}}else F.pushArray(r.children);r=null!=(n=F.pop())?n:null}}},{key:"_build",value:function(e,t,r,n){var i=r-t+1,a=this._maxEntries;if(i<=a){var s=new B(e.slice(t,r+1));return m(s,this.toBBox),s}n||(n=Math.ceil(Math.log(i)/Math.log(a)),a=Math.ceil(i/Math.pow(a,n-1)));var u=new P([]);u.height=n;var o=Math.ceil(i/a),c=o*Math.ceil(Math.sqrt(a));k(e,t,r,c,this.compareMinX);for(var l=t;l<=r;l+=c){var f=Math.min(l+c-1,r);k(e,l,f,o,this.compareMinY);for(var h=l;h<=f;h+=o){var d=Math.min(h+o-1,f);u.children.push(this._build(e,h,d,n-1))}}return m(u,this.toBBox),u}},{key:"_chooseSubtree",value:function(e,t,r,n){for(;n.push(t),!0!==t.leaf&&n.length-1!==r;){for(var i=void 0,a=1/0,s=1/0,u=0,o=t.children.length;u<o;u++){var c=t.children[u],l=O(c),f=_(e,c)-l;f<s?(s=f,a=l<a?l:a,i=c):f===s&&l<a&&(a=l,i=c)}t=i||t.children[0]}return t}},{key:"_insert",value:function(e,t,r){var n=this.toBBox,i=r?e:n(e);T.clear();var a=this._chooseSubtree(i,this.data,t,T);for(a.children.push(e),v(a,i);t>=0&&T.data[t].children.length>this._maxEntries;)this._split(T,t),t--;this._adjustParentBBoxes(i,T,t)}},{key:"_split",value:function(e,t){var r=e.data[t],n=r.children.length,i=this._minEntries;this._chooseSplitAxis(r,i,n);var a=this._chooseSplitIndex(r,i,n);if(a){var s=r.children.splice(a,r.children.length-a),u=r.leaf?new B(s):new P(s);u.height=r.height,m(r,this.toBBox),m(u,this.toBBox),t?e.data[t-1].children.push(u):this._splitRoot(r,u)}else console.log("  Error: assertion failed at PooledRBush._split: no valid split index")}},{key:"_splitRoot",value:function(e,t){this.data=new P([e,t]),this.data.height=e.height+1,m(this.data,this.toBBox)}},{key:"_chooseSplitIndex",value:function(e,t,r){var n,i,a;n=i=1/0;for(var s=t;s<=r-t;s++){var u=b(e,0,s,this.toBBox),o=b(e,s,r,this.toBBox),c=w(u,o),l=O(u)+O(o);c<n?(n=c,a=s,i=l<i?l:i):c===n&&l<i&&(i=l,a=s)}return a}},{key:"_chooseSplitAxis",value:function(e,t,r){var n=e.leaf?this.compareMinX:g,i=e.leaf?this.compareMinY:x;this._allDistMargin(e,t,r,n)<this._allDistMargin(e,t,r,i)&&e.children.sort(n)}},{key:"_allDistMargin",value:function(e,t,r,n){e.children.sort(n);for(var i=this.toBBox,a=b(e,0,t,i),s=b(e,r-t,r,i),u=j(a)+j(s),o=t;o<r-t;o++){var c=e.children[o];v(a,e.leaf?i(c):c),u+=j(a)}for(var l=r-t-1;l>=t;l--){var f=e.children[l];v(s,e.leaf?i(f):f),u+=j(s)}return u}},{key:"_adjustParentBBoxes",value:function(e,t,r){for(var n=r;n>=0;n--)v(t.data[n],e)}},{key:"_condense",value:function(e){for(var t=e.length-1;t>=0;t--){var r=e.data[t];if(0===r.children.length)if(t>0){var n=e.data[t-1],i=n.children;i.splice(Object(o.e)(i,r,i.length,n.indexHint),1)}else this.clear();else m(r,this.toBBox)}}},{key:"_initFormat",value:function(e){var t=["return a"," - b",";"];this.compareMinX=new Function("a","b",t.join(e[0])),this.compareMinY=new Function("a","b",t.join(e[1])),this.toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}}]),e}();function m(e,t){b(e,0,e.children.length,t,e)}function b(e,t,r,n,i){i||(i=new B([])),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var a,s=t;s<r;s++)a=e.children[s],v(i,e.leaf?n(a):a);return i}function v(e,t){e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY)}function g(e,t){return e.minX-t.minX}function x(e,t){return e.minY-t.minY}function O(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function j(e){return e.maxX-e.minX+(e.maxY-e.minY)}function _(e,t){return(Math.max(t.maxX,e.maxX)-Math.min(t.minX,e.minX))*(Math.max(t.maxY,e.maxY)-Math.min(t.minY,e.minY))}function w(e,t){var r=Math.max(e.minX,t.minX),n=Math.max(e.minY,t.minY),i=Math.min(e.maxX,t.maxX),a=Math.min(e.maxY,t.maxY);return Math.max(0,i-r)*Math.max(0,a-n)}function I(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function S(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function k(e,t,r,n,i){for(var a=[t,r];a.length;){var s=Object(c.c)(a.pop()),u=Object(c.c)(a.pop());if(!(s-u<=n)){var o=u+Math.ceil((s-u)/n/2)*n;Object(f.a)(e,o,u,s,i),a.push(u,o,o,s)}}}var A=new l.a,F=new l.a,T=new l.a,M=new l.a({deallocator:void 0}),R=function(e){Object(n.a)(r,e);var t=h(r);function r(){var e;return Object(s.a)(this,r),(e=t.apply(this,arguments)).height=1,e.indexHint=new o.a,e}return r}((function e(){Object(s.a)(this,e),this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0})),B=function(e){Object(n.a)(r,e);var t=h(r);function r(e){var n;return Object(s.a)(this,r),(n=t.call(this)).children=e,n.leaf=!0,n}return r}(R),P=function(e){Object(n.a)(r,e);var t=h(r);function r(e){var n;return Object(s.a)(this,r),(n=t.call(this)).children=e,n.leaf=!1,n}return r}(R)},hNi2:function(e,t,r){"use strict";r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return y})),r.d(t,"c",(function(){return _})),r.d(t,"d",(function(){return v})),r.d(t,"e",(function(){return x}));var n=r("eijD"),i=r("hisu"),a=r("NthX"),s=r.n(a),u=r("12QT"),o=r("DuP7");function c(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(u)throw a}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var f=function e(){Object(i.a)(this,e),this.code=null,this.description=null},h=function e(t){Object(i.a)(this,e),this.error=new f,this.globalId=null,this.objectId=null,this.success=!1,this.uniqueId=null,this.error.description=t};function d(e){return new h(e)}var p=function e(t){Object(i.a)(this,e),this.globalId=null,this.success=!0,this.objectId=this.uniqueId=t};function y(e){return new p(e)}var m,b=new Set;function v(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5?arguments[5]:void 0;for(var s in b.clear(),r){var u=e.get(s);if(u){var l=r[s],f=g(u,l);if(f!==l&&a&&a.push({name:"invalid-value-type",message:"attribute value was converted to match the field type",details:{field:u,originalValue:l,sanitizedValue:f}}),b.add(u.name),u&&(i||u.editable)){var h=Object(o.u)(u,f);if(h)return d(Object(o.v)(h,u,f));t[u.name]=f}}}if(n){var p,y=c(n);try{for(y.s();!(p=y.n()).done;){var m=p.value;if(!b.has(m.name))return d('missing required field "'.concat(m.name,'"'))}}catch(v){y.e(v)}finally{y.f()}}return null}function g(e,t){var r=t;return"string"==typeof t&&Object(o.p)(e)?r=parseFloat(t):null!=t&&Object(o.q)(e)&&"string"!=typeof t&&(r=String(t)),Object(o.s)(r)}function x(e,t){if(!e||!Object(u.j)(t))return e;if("rings"in e||"paths"in e){if(!m)throw new TypeError("geometry engine not loaded");return m.simplify(t,e)}return e}function O(){return j.apply(this,arguments)}function j(){return(j=Object(n.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=m,e.t0){e.next=6;break}return e.next=4,Promise.all([r.e(7),r.e(1),r.e(10)]).then(r.bind(null,"TK+P"));case 4:m=e.sent,e.t0=m;case 6:return e.abrupt("return",e.t0);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(e,t){return w.apply(this,arguments)}function w(){return(w=Object(n.a)(s.a.mark((function e(t,r){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=!Object(u.j)(t)||"esriGeometryPolygon"!==r&&"esriGeometryPolyline"!==r,e.t0){e.next=4;break}return e.next=4,O();case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}}}]);
//# sourceMappingURL=750cd0e9940a54dd4a7a0dc6241a730a102d9ca1-578b32a8977fd9356ff3.js.map