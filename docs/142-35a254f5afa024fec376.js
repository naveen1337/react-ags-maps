(window.webpackJsonp=window.webpackJsonp||[]).push([[142],{rVxD:function(e,t,r){"use strict";r.r(t);var n=r("eijD"),a=r("hisu"),u=r("yBJb"),s=r("NthX"),i=r.n(s),o=r("Mp7X"),c=r("TM+E"),p=r("7im+"),h=r("IH5m"),l=r("12QT"),f=r("4WE2"),y=r("Lk2+"),d=r("pjVo"),g=r("Lc5R"),m=r("hrIl"),b=r("hNi2"),v=r("8AP4"),_=r("nyn0");function w(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return j(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return j(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var u,s=!0,i=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){i=!0,u=e},f:function(){try{s||null==r.return||r.return()}finally{if(i)throw u}}}}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var x=function(){function e(){var t=this;Object(a.a)(this,e),this._queryEngine=null,this._customParameters=null,this._snapshotFeatures=function(){var e=Object(n.a)(i.a.mark((function e(r){var n,a,u,s,o,c,p,y,g,_,j;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t._queryEngine.objectIdField,e.next=3,Object(v.d)(t._getFeatureUrl,t._featureType.typeName,t._getFeatureOutputFormat,{customParameters:t._customParameters,dateFields:t._queryEngine.fieldsIndex.dateFields.map((function(e){return e.name})),signal:r});case 3:return a=e.sent,e.next=6,Object(m.d)(a);case 6:if(Object(h.v)(r),u=Object(m.a)(a,{geometryType:t._queryEngine.geometryType,hasZ:!1,objectIdField:n}),!Object(l.c)(t._queryEngine.spatialReference,l.a)){s=w(u);try{for(s.s();!(o=s.n()).done;)(c=o.value).geometry&&(c.geometry=Object(f.d)(Object(d.b)(Object(f.k)(c.geometry,t._queryEngine.geometryType,!1,!1),l.a,t._queryEngine.spatialReference)))}catch(i){s.e(i)}finally{s.f()}}p=1,y=w(u);try{for(y.s();!(g=y.n()).done;)_=g.value,j={},Object(b.d)(t._fieldsIndex,j,_.attributes,null,!0),_.attributes=j,null==_.attributes[n]&&(_.objectId=_.attributes[n]=p++)}catch(i){y.e(i)}finally{y.f()}return e.abrupt("return",u);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}var t,r,s,j,x,k,O,E,q,F;return Object(u.a)(e,[{key:"destroy",value:function(){var e;null==(e=this._queryEngine)||e.destroy(),this._queryEngine=null}},{key:"load",value:(F=Object(n.a)(i.a.mark((function e(t,r){var n,a,u,s,o,c,l,f,d;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.getFeatureUrl,a=t.getFeatureOutputFormat,u=t.spatialReference,s=t.fields,o=t.geometryType,c=t.featureType,l=t.objectIdField,f=t.customParameters,this._featureType=c,this._customParameters=f,this._getFeatureUrl=n,this._getFeatureOutputFormat=a,this._fieldsIndex=new _.a(s),e.next=8,this._checkProjection(u);case 8:return Object(h.v)(r),this._queryEngine=new g.a({fields:s,geometryType:o,hasM:!1,hasZ:!1,objectIdField:l,spatialReference:u,timeInfo:null,featureStore:new y.a({geometryType:o,hasM:!1,hasZ:!1})}),e.next=12,this._snapshotFeatures(Object(p.p)(r.signal));case 12:return d=e.sent,e.abrupt("return",(this._queryEngine.featureStore.addMany(d),{extent:this._queryEngine.fullExtent}));case 14:case"end":return e.stop()}}),e,this)}))),function(e,t){return F.apply(this,arguments)})},{key:"applyEdits",value:(q=Object(n.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new o.a("wfs-source:editing-not-supported","applyEdits() is not supported on WFSLayer");case 1:case"end":return e.stop()}}),e)}))),function(){return q.apply(this,arguments)})},{key:"queryFeatures",value:(E=Object(n.a)(i.a.mark((function e(){var t,r,n=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{},r=n.length>1&&void 0!==n[1]?n[1]:{},e.next=4,this._waitSnapshotComplete();case 4:return e.abrupt("return",this._queryEngine.executeQuery(t,r.signal));case 5:case"end":return e.stop()}}),e,this)}))),function(){return E.apply(this,arguments)})},{key:"queryFeatureCount",value:(O=Object(n.a)(i.a.mark((function e(){var t,r,n=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{},r=n.length>1&&void 0!==n[1]?n[1]:{},e.next=4,this._waitSnapshotComplete();case 4:return e.abrupt("return",this._queryEngine.executeQueryForCount(t,r.signal));case 5:case"end":return e.stop()}}),e,this)}))),function(){return O.apply(this,arguments)})},{key:"queryObjectIds",value:(k=Object(n.a)(i.a.mark((function e(){var t,r,n=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{},r=n.length>1&&void 0!==n[1]?n[1]:{},e.next=4,this._waitSnapshotComplete();case 4:return e.abrupt("return",this._queryEngine.executeQueryForIds(t,r.signal));case 5:case"end":return e.stop()}}),e,this)}))),function(){return k.apply(this,arguments)})},{key:"queryExtent",value:(x=Object(n.a)(i.a.mark((function e(){var t,r,n=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{},r=n.length>1&&void 0!==n[1]?n[1]:{},e.next=4,this._waitSnapshotComplete();case 4:return e.abrupt("return",this._queryEngine.executeQueryForExtent(t,r.signal));case 5:case"end":return e.stop()}}),e,this)}))),function(){return x.apply(this,arguments)})},{key:"querySnapping",value:(j=Object(n.a)(i.a.mark((function e(t){var r,n=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.length>1&&void 0!==n[1]?n[1]:{},e.next=3,this._waitSnapshotComplete();case 3:return e.abrupt("return",this._queryEngine.executeQueryForSnapping(t,r.signal));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return j.apply(this,arguments)})},{key:"setCustomParameters",value:function(e){this._customParameters=e}},{key:"refresh",value:(s=Object(n.a)(i.a.mark((function e(){var t,r=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null==(t=this._snapshotTask)||t.abort(),this._snapshotTask=Object(h.h)(this._snapshotFeatures),this._snapshotTask.promise.then((function(e){r._queryEngine.featureStore.clear(),e&&r._queryEngine.featureStore.addMany(e)}),(function(e){r._queryEngine.featureStore.clear(),Object(h.m)(e)||c.a.getLogger("esri.layers.WFSLayer").error(new o.a("wfs-layer:getfeature-error","An error occurred during the GetFeature request",{error:e}))})),e.next=5,this._waitSnapshotComplete();case 5:return e.abrupt("return",{extent:this._queryEngine.fullExtent});case 6:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"_waitSnapshotComplete",value:(r=Object(n.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._snapshotTask||this._snapshotTask.finished){e.next=9;break}return e.prev=1,e.next=4,this._snapshotTask.promise;case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:return e.abrupt("return",this._waitSnapshotComplete());case 9:case"end":return e.stop()}}),e,this,[[1,6]])}))),function(){return r.apply(this,arguments)})},{key:"_checkProjection",value:(t=Object(n.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(d.a)(l.a,t);case 3:e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(0),new o.a("unsupported-projection","Projection not supported",{spatialReference:t});case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),function(e){return t.apply(this,arguments)})}]),e}();t.default=x}}]);
//# sourceMappingURL=142-35a254f5afa024fec376.js.map