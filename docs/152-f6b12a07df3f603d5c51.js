(window.webpackJsonp=window.webpackJsonp||[]).push([[152],{lIN5:function(e,t,r){"use strict";r.r(t);var n=r("eijD"),a=r("mK0O"),i=r("hisu"),o=r("yBJb"),c=r("CHlC"),u=r("kMo5"),s=r("P+uj"),l=r("NthX"),f=r.n(l),p=r("dQW7"),b=r("7i+s"),y=r("xAIp"),d=(r("J4Pc"),r("wckI")),m=(r("TM+E"),r("iaHD")),h=r("6CzD"),v=r("sc0P"),O=r("g+AA"),g=r("DGz/"),j=r("Mp7X"),x=r("7im+"),w=r("frPA"),S=r("z9dv"),k=r("cFtQ"),P=r("0F8f"),D=r("hZBP"),I=r("nd5+"),R=r("YHXj");function G(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return Object(u.a)(this,r)}}var L=function(e){Object(c.a)(r,e);var t=G(r);function r(){var e;return Object(i.a)(this,r),(e=t.apply(this,arguments)).outSpatialReference=null,e.processExtent=null,e.processSpatialReference=null,e.returnFeatureCollection=!1,e.returnM=!1,e.returnZ=!1,e}return r}(D.a);Object(p.a)([Object(y.b)({type:R.a})],L.prototype,"outSpatialReference",void 0),Object(p.a)([Object(y.b)({type:I.a})],L.prototype,"processExtent",void 0),Object(p.a)([Object(y.b)({type:R.a})],L.prototype,"processSpatialReference",void 0),Object(p.a)([Object(y.b)({nonNullable:!0})],L.prototype,"returnFeatureCollection",void 0),Object(p.a)([Object(y.b)({nonNullable:!0})],L.prototype,"returnM",void 0),Object(p.a)([Object(y.b)({nonNullable:!0})],L.prototype,"returnZ",void 0),(L=Object(p.a)([Object(m.a)("esri/rest/geoprocessor/GPOptions")],L)).from=Object(d.m)(L);var M=L,V=r("pkWm"),T=r("SPOG"),J=r("0n+b");function N(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return Object(u.a)(this,r)}}var F=function(e){Object(c.a)(r,e);var t=N(r);function r(){var e;return Object(i.a)(this,r),(e=t.apply(this,arguments)).extent=null,e.height=null,e.href=null,e.opacity=1,e.rotation=0,e.scale=null,e.visible=!0,e.width=null,e}return r}(J.a);Object(p.a)([Object(y.b)({type:I.a})],F.prototype,"extent",void 0),Object(p.a)([Object(y.b)()],F.prototype,"height",void 0),Object(p.a)([Object(y.b)()],F.prototype,"href",void 0),Object(p.a)([Object(y.b)()],F.prototype,"opacity",void 0),Object(p.a)([Object(y.b)()],F.prototype,"rotation",void 0),Object(p.a)([Object(y.b)()],F.prototype,"scale",void 0),Object(p.a)([Object(y.b)()],F.prototype,"visible",void 0),Object(p.a)([Object(y.b)()],F.prototype,"width",void 0);var A=F=Object(p.a)([Object(m.a)("esri.layer.support.MapImage")],F),E=r("/xo8");function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return Object(u.a)(this,r)}}var U=function(e){Object(c.a)(r,e);var t=C(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).itemId=null,n.url=null,n}return r}(J.a);Object(p.a)([Object(y.b)({type:String,json:{read:{source:"itemID"},write:{target:"itemID"}}})],U.prototype,"itemId",void 0),Object(p.a)([Object(y.b)({type:String,json:{write:!0}})],U.prototype,"url",void 0);var B=U=Object(p.a)([Object(m.a)("esri.rest.support.DataFile")],U),_=r("kJId");function z(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return Object(u.a)(this,r)}}var q=new b.a({esriMeters:"meters",esriFeet:"feet",esriKilometers:"kilometers",esriMiles:"miles",esriNauticalMiles:"nautical-miles",esriYards:"yards"},{ignoreUnknown:!1}),K=function(e){Object(c.a)(r,e);var t=z(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).distance=0,n.units=null,n}return r}(J.a);Object(p.a)([Object(y.b)({json:{write:!0}})],K.prototype,"distance",void 0),Object(p.a)([Object(y.b)({json:{read:q.read,write:q.write}})],K.prototype,"units",void 0);var W=K=Object(p.a)([Object(m.a)("esri/rest/support/LinearUnit")],K);function Z(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return Object(u.a)(this,r)}}var H=new b.a({GPBoolean:"boolean",GPDataFile:"data-file",GPDate:"date",GPDouble:"double",GPFeatureRecordSetLayer:"feature-record-set-layer",GPField:"field",GPLinearUnit:"linear-unit",GPLong:"long",GPRasterData:"raster-data",GPRasterDataLayer:"raster-data-layer",GPRecordSet:"record-set",GPString:"string","GPMultiValue:GPBoolean":"multi-value","GPMultiValue:GPDataFile":"multi-value","GPMultiValue:GPDate":"multi-value","GPMultiValue:GPDouble":"multi-value","GPMultiValue:GPFeatureRecordSetLayer":"multi-value","GPMultiValue:GPField":"multi-value","GPMultiValue:GPLinearUnit":"multi-value","GPMultiValue:GPLong":"multi-value","GPMultiValue:GPRasterData":"multi-value","GPMultiValue:GPRasterDataLayer":"multi-value","GPMultiValue:GPRecordSet":"multi-value","GPMultiValue:GPString":"multi-value"}),Y=function(e){Object(c.a)(r,e);var t=Z(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).dataType=null,n.value=null,n}return r}(J.a);Object(p.a)([Object(y.b)({json:{read:H.read,write:H.write}})],Y.prototype,"dataType",void 0),Object(p.a)([Object(y.b)()],Y.prototype,"value",void 0);var Q=Y=Object(p.a)([Object(m.a)("esri.rest.support.ParameterValue")],Y);function X(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return Object(u.a)(this,r)}}var $=function(e){Object(c.a)(r,e);var t=X(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).format=null,n.itemId=null,n.url=null,n}return r}(J.a);Object(p.a)([Object(y.b)()],$.prototype,"format",void 0),Object(p.a)([Object(y.b)({json:{read:{source:"itemID"},write:{target:"itemID"}}})],$.prototype,"itemId",void 0),Object(p.a)([Object(y.b)()],$.prototype,"url",void 0);var ee=$=Object(p.a)([Object(m.a)("esri/rest/support/RasterData")],$);function te(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function re(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?te(Object(r),!0).forEach((function(t){Object(a.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):te(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ne(e,t,r,n,a){return ae.apply(this,arguments)}function ae(){return(ae=Object(n.a)(f.a.mark((function e(t,r,n,a,i){var o,c,u;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o={},c={},u=[],e.abrupt("return",(ie(a,u,o),Object(V.a)(u).then((function(e){var u=n.outSpatialReference,s=n.processExtent,l=n.processSpatialReference,f=n.returnFeatureCollection,p=n.returnM,b=n.returnZ,y=Object(E.c)(t).path;for(var d in o){var m=o[d];c[d]=e.slice(m[0],m[1])}var h=u?u.wkid||u:null,v=l?l.wkid||l:null,O="execute"===r?{returnFeatureCollection:f||void 0,returnM:p||void 0,returnZ:b||void 0}:null,j=ce(re(re(re(re({},s?{context:{extent:s,outSR:h,processSR:v}}:{"env:outSR":h,"env:processSR":v}),a),O),{},{f:"json"}),null,c),x=re(re({},i),{},{query:j});return Object(g.default)("".concat(y,"/").concat(r),x)}))));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ie(e,t,r){for(var n in e){var a=e[n];if(a&&"object"==typeof a&&a instanceof _.default){var i=a.features;r[n]=[t.length,t.length+i.length],i.forEach((function(e){t.push(e.geometry)}))}}}function oe(e){var t=e.dataType,r=Q.fromJSON(e);switch(t){case"GPBoolean":case"GPDouble":case"GPLong":case"GPString":return r;case"GPDate":r.value=new Date(r.value);break;case"GPDataFile":r.value=B.fromJSON(r.value);break;case"GPLinearUnit":r.value=W.fromJSON(r.value);break;case"GPFeatureRecordSetLayer":case"GPRecordSet":var n=e.value.url;r.value=n?B.fromJSON(r.value):_.default.fromJSON(r.value);break;case"GPRasterData":case"GPRasterDataLayer":var a=e.value.mapImage;r.value=a?A.fromJSON(a):ee.fromJSON(r.value);break;case"GPField":r.value=T.a.fromJSON(r.value);break;case"GPMultiValue:GPBoolean":case"GPMultiValue:GPDouble":case"GPMultiValue:GPLong":case"GPMultiValue:GPString":return r;case"GPMultiValue:GPDate":var i=r.value;r.value=i.map((function(e){return new Date(e)}));break;case"GPMultiValue:GPDataFile":r.value=r.value.map((function(e){return B.fromJSON(e)}));break;case"GPMultiValue:GPLinearUnit":r.value=r.value.map((function(e){return W.fromJSON(e)}));break;case"GPMultiValue:GPFeatureRecordSetLayer":case"GPMultiValue:GPRecordSet":r.value=r.value.map((function(e){return _.default.fromJSON(e)}));break;case"GPMultiValue:GPRasterData":case"GPMultiValue:GPRasterDataLayer":r.value=r.value.map((function(e){return e?A.fromJSON(e):ee.fromJSON(r.value)}));break;case"GPMultiValue:GPField":r.value=r.value.map((function(e){return T.a.fromJSON(e)}))}return r}function ce(e,t,r){for(var n in e){var a=e[n];Array.isArray(a)?e[n]=JSON.stringify(a.map((function(e){return ce({item:e},!0).item}))):a instanceof Date&&(e[n]=a.getTime())}return Object(E.b)(e,t,r)}var ue=r("lDyH");function se(e,t,r,n){return le.apply(this,arguments)}function le(){return(le=Object(n.a)(f.a.mark((function e(t,r,n,a){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(n=M.from(n||{}),ne(t,"execute",n,r,a).then((function(e){var t=e.data.results||[],r=e.data.messages||[];return{results:t.map(oe),messages:r.map((function(e){return ue.a.fromJSON(e)}))}}))));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var fe,pe=r("IH5m");function be(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ye(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?be(Object(r),!0).forEach((function(t){Object(a.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):be(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function de(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return Object(u.a)(this,r)}}var me=new b.a({esriJobCancelled:"job-cancelled",esriJobCancelling:"job-cancelling",esriJobDeleted:"job-deleted",esriJobDeleting:"job-deleting",esriJobTimedOut:"job-timed-out",esriJobExecuting:"job-executing",esriJobFailed:"job-failed",esriJobNew:"job-new",esriJobSubmitted:"job-submitted",esriJobSucceeded:"job-succeeded",esriJobWaiting:"job-waiting"}),he=fe=function(e){Object(c.a)(s,e);var t,a,u=de(s);function s(e){var t;return Object(i.a)(this,s),(t=u.call(this,e)).jobId=null,t.jobStatus=null,t.messages=null,t.requestOptions=null,t.sourceUrl=null,t._timer=null,t}return Object(o.a)(s,[{key:"cancelJob",value:function(e){var t=this,r=this.jobId,n=this.sourceUrl,a=Object(E.c)(n).path,i=ye(ye(ye({},this.requestOptions),e),{},{query:{f:"json"}});return this._clearTimer(),Object(g.default)("".concat(a,"/jobs/").concat(r,"/cancel"),i).then((function(e){var r=fe.fromJSON(e.data);return t.messages=r.messages,t.jobStatus=r.jobStatus,t}))}},{key:"destroy",value:function(){clearInterval(this._timer)}},{key:"checkJobStatus",value:function(e){var t=this,r=Object(E.c)(this.sourceUrl).path,n=ye(ye(ye({},this.requestOptions),e),{},{query:{f:"json"}}),a="".concat(r,"/jobs/").concat(this.jobId);return Object(g.default)(a,n).then((function(e){var r=e.data,n=fe.fromJSON(r);return t.messages=n.messages,t.jobStatus=n.jobStatus,t}))}},{key:"fetchResultData",value:function(e,t,r){var n=t=M.from(t||{}),a=n.returnFeatureCollection,i=n.returnM,o=n.returnZ,c=n.outSpatialReference,u=Object(E.c)(this.sourceUrl).path,s=ce({returnFeatureCollection:a,returnM:i,returnZ:o,outSR:c,returnType:"data",f:"json"},null),l=ye(ye(ye({},this.requestOptions),r),{},{query:s}),f="".concat(u,"/jobs/").concat(this.jobId,"/results/").concat(e);return Object(g.default)(f,l).then((function(e){return oe(e.data)}))}},{key:"fetchResultImage",value:function(e,t,r){var n=Object(E.c)(this.sourceUrl).path,a=ce(ye(ye({},t.toJSON()),{},{f:"json"})),i=ye(ye(ye({},this.requestOptions),r),{},{query:a}),o="".concat(n,"/jobs/").concat(this.jobId,"/results/").concat(e);return Object(g.default)(o,i).then((function(e){return oe(e.data)}))}},{key:"fetchResultMapImageLayer",value:(a=Object(n.a)(f.a.mark((function e(){var t,n,a,i;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Object(E.c)(this.sourceUrl),n=t.path,a=n.indexOf("/GPServer/"),i="".concat(n.substring(0,a),"/MapServer/jobs/").concat(this.jobId),e.next=4,Promise.resolve().then(r.bind(null,"2LA6"));case 4:return e.t0=e.sent.default,e.t1={url:i},e.abrupt("return",new e.t0(e.t1));case 7:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"waitForJobCompletion",value:(t=Object(n.a)(f.a.mark((function e(){var t,r,n,a,i,o=this,c=arguments;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.length>0&&void 0!==c[0]?c[0]:{},r=t.interval,n=void 0===r?1e3:r,a=t.signal,i=t.statusCallback,e.abrupt("return",new Promise((function(e,t){Object(pe.q)(a,(function(){o._clearTimer(),t(Object(pe.e)())})),o._clearTimer();var r=setInterval((function(){o._timer||t(Object(pe.e)()),o.checkJobStatus(o.requestOptions).then((function(r){var n=r.jobStatus;switch(o.jobStatus=n,n){case"job-succeeded":o._clearTimer(),e(o);break;case"job-submitted":case"job-executing":case"job-waiting":case"job-new":i&&i(o);break;case"job-cancelled":case"job-cancelling":case"job-deleted":case"job-deleting":case"job-timed-out":case"job-failed":o._clearTimer(),t(o)}}))}),n);o._timer=r})));case 3:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})},{key:"_clearTimer",value:function(){this._timer&&(clearInterval(this._timer),this._timer=null)}}]),s}(J.a);Object(p.a)([Object(y.b)()],he.prototype,"jobId",void 0),Object(p.a)([Object(y.b)({json:{read:me.read}})],he.prototype,"jobStatus",void 0),Object(p.a)([Object(y.b)({type:[ue.a]})],he.prototype,"messages",void 0),Object(p.a)([Object(y.b)()],he.prototype,"requestOptions",void 0),Object(p.a)([Object(y.b)({json:{write:!0}})],he.prototype,"sourceUrl",void 0);var ve=he=fe=Object(p.a)([Object(m.a)("esri.rest.support.JobInfo")],he);function Oe(e,t,r,n){return ge.apply(this,arguments)}function ge(){return(ge=Object(n.a)(f.a.mark((function e(t,r,n,a){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(n=M.from(n||{}),ne(t,"submitJob",n,r,a).then((function(e){var r=ve.fromJSON(e.data);return r.sourceUrl=t,r}))));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var je=new b.a({PDF:"pdf",PNG32:"png32",PNG8:"png8",JPG:"jpg",GIF:"gif",EPS:"eps",SVG:"svg",SVGZ:"svgz"}),xe=(je.fromJSON.bind(je),je.toJSON.bind(je)),we=new b.a({MAP_ONLY:"map-only","A3 Landscape":"a3-landscape","A3 Portrait":"a3-portrait","A4 Landscape":"a4-landscape","A4 Portrait":"a4-portrait","Letter ANSI A Landscape":"letter-ansi-a-landscape","Letter ANSI A Portrait":"letter-ansi-a-portrait","Tabloid ANSI B Landscape":"tabloid-ansi-b-landscape","Tabloid ANSI B Portrait":"tabloid-ansi-b-portrait"}),Se=(we.fromJSON.bind(we),we.toJSON.bind(we));function ke(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return Pe(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Pe(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){c=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(c)throw i}}}}function Pe(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function De(e,t){var r=t.graphic,n=t.renderer,a=t.symbol,i=a.type;if("text"!==i&&"shield-label-symbol"!==i&&"visualVariables"in n&&n.visualVariables){var o=n.getVisualVariablesForType("size"),c=n.getVisualVariablesForType("color"),u=n.getVisualVariablesForType("opacity"),s=n.getVisualVariablesForType("rotation"),l=o&&o[0],f=c&&c[0],p=u&&u[0],b=s&&s[0];if(l){var y="simple-marker"===i?a.style:null,d=Object(P.getSize)(l,r,{shape:y});null!=d&&("simple-marker"===i?e.size=Object(w.d)(d):"picture-marker"===i?(e.width=Object(w.d)(d),e.height=Object(w.d)(d)):"simple-line"===i?e.width=Object(w.d)(d):e.outline&&(e.outline.width=Object(w.d)(d)))}if(f){var m=Object(P.getColor)(f,r);(m&&"simple-marker"===i||"simple-line"===i||"simple-fill"===i)&&(e.color=m?m.toJSON():void 0)}if(p){var h=Object(P.getOpacity)(p,r);null!=h&&e.color&&(e.color[3]=Math.round(255*h))}b&&(e.angle=-Object(P.getRotationAngle)(n,r))}}function Ie(e){var t,r,n,a,i,o,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15,u=e.canvas.width,s=e.canvas.height,l=e.getImageData(0,0,u,s).data;e:for(r=s;r--;)for(t=u;t--;)if(l[4*(u*r+t)+3]>c){o=r;break e}if(!o)return null;e:for(t=u;t--;)for(r=o+1;r--;)if(l[4*(u*r+t)+3]>c){i=t;break e}e:for(t=0;t<=i;++t)for(r=o+1;r--;)if(l[4*(u*r+t)+3]>c){n=t;break e}e:for(r=0;r<=o;++r)for(t=n;t<=i;++t)if(l[4*(u*r+t)+3]>c){a=r;break e}return{x:n,y:a,width:i-n,height:o-a}}function Re(e,t){var r=e.allLayerViews.items;if(t===e.scale)return r.filter((function(e){return!e.suspended}));var n,a=new Array,i=ke(r);try{for(i.s();!(n=i.n()).done;){var o=n.value;Ne(o.parent)&&!a.includes(o.parent)||!o.visible||t&&"isVisibleAtScale"in o&&!o.isVisibleAtScale(t)||a.push(o)}}catch(c){i.e(c)}finally{i.f()}return a}function Ge(e){return e&&"bing-maps"===e.type}function Le(e){return e&&"csv"===e.type}function Me(e){return e&&"feature"===e.type}function Ve(e){return e&&"geojson"===e.type}function Te(e){return e&&"graphics"===e.type}function Je(e){return e&&"group"===e.type}function Ne(e){return e&&"esri.views.2d.layers.GroupLayerView2D"===e.declaredClass}function Fe(e){return e&&"imagery"===e.type}function Ae(e){return e&&"kml"===e.type}function Ee(e){return e&&"map-image"===e.type}function Ce(e){return e&&"map-notes"===e.type}function Ue(e){return e&&"open-street-map"===e.type}function Be(e){return e&&"stream"===e.type}function _e(e){return e&&"tile"===e.type}function ze(e){return e&&"vector-tile"===e.type}function qe(e){return e&&"web-tile"===e.type}function Ke(e){return e&&"wms"===e.type}function We(e){return e&&"wmts"===e.type}function Ze(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return Object(u.a)(this,r)}}var He=function(e){Object(c.a)(r,e);var t=Ze(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).attributionVisible=!0,n.exportOptions={width:800,height:1100,dpi:96},n.forceFeatureAttributes=!1,n.format="png32",n.label=null,n.layout="map-only",n.layoutOptions=null,n.outScale=0,n.scalePreserved=!0,n.showLabels=!0,n}return r}(D.a);Object(p.a)([Object(y.b)()],He.prototype,"attributionVisible",void 0),Object(p.a)([Object(y.b)()],He.prototype,"exportOptions",void 0),Object(p.a)([Object(y.b)()],He.prototype,"forceFeatureAttributes",void 0),Object(p.a)([Object(y.b)()],He.prototype,"format",void 0),Object(p.a)([Object(y.b)()],He.prototype,"label",void 0),Object(p.a)([Object(y.b)()],He.prototype,"layout",void 0),Object(p.a)([Object(y.b)()],He.prototype,"layoutOptions",void 0),Object(p.a)([Object(y.b)()],He.prototype,"outScale",void 0),Object(p.a)([Object(y.b)()],He.prototype,"scalePreserved",void 0),Object(p.a)([Object(y.b)()],He.prototype,"showLabels",void 0);var Ye=He=Object(p.a)([Object(m.a)("esri.rest.support.PrintTemplate")],He),Qe=r("hdDo"),Xe=r("YrWv");function $e(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function et(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?$e(Object(r),!0).forEach((function(t){Object(a.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$e(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function tt(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return rt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return rt(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){c=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(c)throw i}}}}function rt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var nt={Feet:"ft",Kilometers:"km",Meters:"m",Miles:"mi"},at=new b.a({esriFeet:"Feet",esriKilometers:"Kilometers",esriMeters:"Meters",esriMiles:"Miles"}),it=new b.a({esriExecutionTypeSynchronous:"sync",esriExecutionTypeAsynchronous:"async"}),ot=new Qe.a({returnGeometry:!0}),ct=new Map;function ut(){return(ut=Object(n.a)(f.a.mark((function e(t,r,n){var a,i;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=bt(t),i=ct.get(a),e.abrupt("return",Promise.resolve().then((function(){return i?{data:i.gpMetadata}:(i={gpServerUrl:a,is11xService:!1,legendLayerNameMap:[],legendLayers:[]},Object(g.default)(a,{query:{f:"json"}}))})).then((function(e){return i.gpMetadata=e.data,i.cimVersion=i.gpMetadata.cimVersion,i.is11xService=!!i.cimVersion,ct.set(a,i),st(r,i)})).then((function(e){var a,o=Yt(i),c=function(e){return"sync"===o?e.results&&e.results[0]&&e.results[0].value:a.fetchResultData("Output_File",null,n).then((function(e){return e.value}))};return"async"===o?Oe(t,e,null,n).then((function(e){return a=e,e.waitForJobCompletion({interval:r.updateDelay}).then(c)})):se(t,e,null,n).then(c)})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function st(e,t){return lt.apply(this,arguments)}function lt(){return(lt=Object(n.a)(f.a.mark((function e(t,r){var n,a,i,o,c,u,s,l,p,b,y,d,m,h,v,O,g;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=r||{is11xService:!1,legendLayerNameMap:[],legendLayers:[]},null==(n=t.template||new Ye).showLabels&&(n.showLabels=!0),a=n.exportOptions,o=Se(n.layout),a&&(i={dpi:a.dpi},("map_only"===o.toLowerCase()||""===o)&&(c=a.width,u=a.height,i.outputSize=[c,u])),(s=n.layoutOptions)&&("Miles"===s.scalebarUnit||"Kilometers"===s.scalebarUnit?(p="Kilometers",b="Miles"):"Meters"!==s.scalebarUnit&&"Feet"!==s.scalebarUnit||(p="Meters",b="Feet"),l={titleText:s.titleText,authorText:s.authorText,copyrightText:s.copyrightText,customTextElements:s.customTextElements,scaleBarOptions:{metricUnit:at.toJSON(p),metricLabel:nt[p],nonMetricUnit:at.toJSON(b),nonMetricLabel:nt[b]}}),y=null,s&&s.legendLayers&&(y=s.legendLayers.map((function(e){r.legendLayerNameMap[e.layerId]=e.title;var t={id:e.layerId};return e.subLayerIds&&(t.subLayerIds=e.subLayerIds),t}))),e.next=12,ft(t,n,r);case 12:return(d=e.sent).operationalLayers&&(m=new RegExp("[\\u4E00-\\u9FFF\\u0E00-\\u0E7F\\u0900-\\u097F\\u3040-\\u309F\\u30A0-\\u30FF\\u31F0-\\u31FF]"),h=/[\u0600-\u06FF]/,v=function(e){var t=e.text,r=e.font,n=r&&r.family&&r.family.toLowerCase();t&&r&&("arial"===n||"arial unicode ms"===n)&&(r.family=m.test(t)?"Arial Unicode MS":"Arial","normal"!==r.style&&h.test(t)&&(r.family="Arial Unicode MS"))},O=function(){throw new j.a("print-task:cim-symbol-unsupported","CIMSymbol is not supported by a print service published from ArcMap")},d.operationalLayers.forEach((function(e){var t,n,a;null!=(t=e.featureCollection)&&t.layers?e.featureCollection.layers.forEach((function(e){var t,n,a,i;if(null!=(t=e.layerDefinition)&&null!=(n=t.drawingInfo)&&null!=(a=n.renderer)&&a.symbol){var o=e.layerDefinition.drawingInfo.renderer;"esriTS"===o.symbol.type?v(o.symbol):"CIMSymbolReference"!==o.symbol.type||r.is11xService||O()}null!=(i=e.featureSet)&&i.features&&e.featureSet.features.forEach((function(e){e.symbol&&("esriTS"===e.symbol.type?v(e.symbol):"CIMSymbolReference"!==e.symbol.type||r.is11xService||O())}))})):!r.is11xService&&null!=(n=e.layerDefinition)&&null!=(a=n.drawingInfo)&&a.renderer&&JSON.stringify(e.layerDefinition.drawingInfo.renderer).includes('"type":"CIMSymbolReference"')&&O()}))),t.outSpatialReference&&(d.mapOptions.spatialReference=t.outSpatialReference.toJSON()),Object.assign(d,{exportOptions:i,layoutOptions:l||{}}),Object.assign(d.layoutOptions,{legendOptions:{operationalLayers:null!=y?y:r.legendLayers.slice()}}),r.legendLayers.length=0,ct.set(r.gpServerUrl,r),g={Web_Map_as_JSON:JSON.stringify(d),Format:xe(n.format),Layout_Template:o},e.abrupt("return",(t.extraParameters&&Object.assign(g,t.extraParameters),g));case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ft(e,t,r){return pt.apply(this,arguments)}function pt(){return(pt=Object(n.a)(f.a.mark((function e(t,r,n){var a,i,o,c,u,s;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.view,i=a.spatialReference,e.next=4,yt(a,r,n);case 4:return e.t0=e.sent,o={operationalLayers:e.t0},c=n.ssExtent||t.extent||a.extent,i&&i.isWrappable&&(c=c.clone()._normalize(!0),i=c.spatialReference),o.mapOptions={extent:c&&c.toJSON(),spatialReference:i&&i.toJSON(),showAttribution:r.attributionVisible},n.ssExtent=null,a.background&&(o.background=a.background.toJSON()),a.rotation&&(o.mapOptions.rotation=-a.rotation),r.scalePreserved&&(o.mapOptions.scale=r.outScale||a.scale),a.timeExtent&&(u=Object(x.i)(a.timeExtent.start)?a.timeExtent.start.getTime():null,s=Object(x.i)(a.timeExtent.end)?a.timeExtent.end.getTime():null,o.mapOptions.time=[u,s]),e.abrupt("return",o);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function bt(e){var t=e,r=t.lastIndexOf("/GPServer/");return r>0&&(t=t.slice(0,r+9)),t}function yt(e,t,r){return dt.apply(this,arguments)}function dt(){return(dt=Object(n.a)(f.a.mark((function e(t,r,n){var a,i,o,c,u,s,l,p,b,y;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=[],i={layerView:null,printTemplate:r,view:t},o=0,r.scalePreserved&&(o=r.outScale||t.scale),c=Re(t,o),u=tt(c),e.prev=5,u.s();case 7:if((s=u.n()).done){e.next=116;break}if(l=s.value,(p=l.layer).loaded&&!Je(p)){e.next=12;break}return e.abrupt("continue",114);case 12:if(b=void 0,i.layerView=l,!Ge(p)){e.next=18;break}e.t0=mt(p),e.next=112;break;case 18:if(!Le(p)){e.next=24;break}return e.next=21,ht(p,i,n);case 21:e.t1=e.sent,e.next=111;break;case 24:if(!Me(p)){e.next=30;break}return e.next=27,jt(p,i,n);case 27:e.t2=e.sent,e.next=110;break;case 30:if(!Ve(p)){e.next=36;break}return e.next=33,wt(p,i,n);case 33:e.t3=e.sent,e.next=109;break;case 36:if(!Te(p)){e.next=42;break}return e.next=39,kt(p,i,n);case 39:e.t4=e.sent,e.next=108;break;case 42:if(!Fe(p)){e.next=46;break}e.t5=Dt(p,n),e.next=107;break;case 46:if(!Ae(p)){e.next=52;break}return e.next=49,It(p,i,n);case 49:e.t6=e.sent,e.next=106;break;case 52:if(!Ee(p)){e.next=56;break}e.t7=Gt(p,i,n),e.next=105;break;case 56:if(!Ce(p)){e.next=62;break}return e.next=59,Lt(i,n);case 59:e.t8=e.sent,e.next=104;break;case 62:if(!Ue(p)){e.next=66;break}e.t9={type:"OpenStreetMap"},e.next=103;break;case 66:if(!Be(p)){e.next=72;break}return e.next=69,Jt(p,i,n);case 69:e.t10=e.sent,e.next=102;break;case 72:if(!_e(p)){e.next=76;break}e.t11=Ft(p),e.next=101;break;case 76:if(!ze(p)){e.next=82;break}return e.next=79,At(p,i,n);case 79:e.t12=e.sent,e.next=100;break;case 82:if(!qe(p)){e.next=86;break}e.t13=Ct(p),e.next=99;break;case 86:if(!Ke(p)){e.next=90;break}e.t14=Ut(p),e.next=98;break;case 90:if(!We(p)){e.next=94;break}e.t15=Bt(p),e.next=97;break;case 94:return e.next=96,Vt(p,i,n);case 96:e.t15=e.sent;case 97:e.t14=e.t15;case 98:e.t13=e.t14;case 99:e.t12=e.t13;case 100:e.t11=e.t12;case 101:e.t10=e.t11;case 102:e.t9=e.t10;case 103:e.t8=e.t9;case 104:e.t7=e.t8;case 105:e.t6=e.t7;case 106:e.t5=e.t6;case 107:e.t4=e.t5;case 108:e.t3=e.t4;case 109:e.t2=e.t3;case 110:e.t1=e.t2;case 111:e.t0=e.t1;case 112:(b=e.t0)&&(Array.isArray(b)?a.push.apply(a,Object(h.a)(b)):(b.id=p.id,b.title=n.legendLayerNameMap[p.id]||p.title,b.opacity=p.opacity,b.minScale=p.minScale||0,b.maxScale=p.maxScale||0,a.push(b)));case 114:e.next=7;break;case 116:e.next=121;break;case 118:e.prev=118,e.t16=e.catch(5),u.e(e.t16);case 121:return e.prev=121,u.f(),e.finish(121);case 124:if(o&&a.forEach((function(e){e.minScale=0,e.maxScale=0})),!t.graphics||!t.graphics.length){e.next=129;break}return e.next=127,Ot(null,t.graphics,r,n);case 127:(y=e.sent)&&a.push(y);case 129:return e.abrupt("return",a);case 130:case"end":return e.stop()}}),e,null,[[5,118,121,124]])})))).apply(this,arguments)}function mt(e){return{culture:e.culture,key:e.key,type:"BingMaps"+("aerial"===e.style?"Aerial":"hybrid"===e.style?"Hybrid":"Road")}}function ht(e,t,r){return vt.apply(this,arguments)}function vt(){return(vt=Object(n.a)(f.a.mark((function e(t,r,n){var a,i,o;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=r.layerView,i=r.printTemplate,n.legendLayers&&n.legendLayers.push({id:t.id}),n.is11xService){e.next=10;break}return e.t0=Ot,e.t1=t,e.next=6,Zt(a);case 6:return e.t2=e.sent,e.t3=i,e.t4=n,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3,e.t4));case 10:return e.abrupt("return",(o={type:"CSV"},t.write(o,{origin:"web-map"}),delete o.popupInfo,delete o.layerType,o.showLabels=i.showLabels&&t.labelsVisible,o));case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ot(e,t,r,n){return gt.apply(this,arguments)}function gt(){return(gt=Object(n.a)(f.a.mark((function e(t,r,n,a){var i,o,c,u,s,l,p,b,y,d,m,h,v,O,g,j,x,w,S,P,D,I,R,G,L,M,V;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o={layerDefinition:{name:"polygonLayer",geometryType:"esriGeometryPolygon",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPolygon",features:[]}},c={layerDefinition:{name:"polylineLayer",geometryType:"esriGeometryPolyline",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPolyline",features:[]}},u={layerDefinition:{name:"pointLayer",geometryType:"esriGeometryPoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPoint",features:[]}},s={layerDefinition:{name:"multipointLayer",geometryType:"esriGeometryMultipoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryMultipoint",features:[]}},(l={layerDefinition:{name:"pointLayer",geometryType:"esriGeometryPoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPoint",features:[]}}).layerDefinition.name="textLayer",delete l.layerDefinition.drawingInfo,t&&("esri.layers.FeatureLayer"===t.declaredClass||"esri.layers.StreamLayer"===t.declaredClass?o.layerDefinition.name=c.layerDefinition.name=u.layerDefinition.name=s.layerDefinition.name=a.legendLayerNameMap[t.id]||t.get("arcgisProps.title")||t.title:"esri.layers.GraphicsLayer"===t.declaredClass&&(r=t.graphics.items),t.renderer&&(p=t.renderer.toJSON(),o.layerDefinition.drawingInfo.renderer=p,c.layerDefinition.drawingInfo.renderer=p,u.layerDefinition.drawingInfo.renderer=p,s.layerDefinition.drawingInfo.renderer=p),n.showLabels&&t.labelsVisible&&"function"==typeof t.write&&(d=null==(b=t.write({},{origin:"web-map"}).layerDefinition)||null==(y=b.drawingInfo)?void 0:y.labelingInfo)&&(i=!0,o.layerDefinition.drawingInfo.labelingInfo=d,c.layerDefinition.drawingInfo.labelingInfo=d,u.layerDefinition.drawingInfo.labelingInfo=d,s.layerDefinition.drawingInfo.labelingInfo=d)),null!=t&&t.renderer||i||(delete o.layerDefinition.drawingInfo,delete c.layerDefinition.drawingInfo,delete u.layerDefinition.drawingInfo,delete s.layerDefinition.drawingInfo),h=null==t?void 0:t.fieldsIndex,v=null==t?void 0:t.renderer,!h){e.next=12;break}if(!v||"function"!=typeof v.collectRequiredFields){e.next=10;break}return O=new Set,e.next=9,v.collectRequiredFields(O,h);case 9:m=Array.from(O);case 10:g=h.fields.map((function(e){return e.toJSON()})),o.layerDefinition.fields=g,c.layerDefinition.fields=g,u.layerDefinition.fields=g,s.layerDefinition.fields=g;case 12:j=r&&r.length,w=0;case 14:if(!(w<j)){e.next=46;break}if(!1!==(S=r[w]||r.getItemAt(w)).visible&&S.geometry){e.next=18;break}return e.abrupt("continue",43);case 18:if((x=S.toJSON()).hasOwnProperty("popupTemplate")&&delete x.popupTemplate,x.geometry&&x.geometry.z&&delete x.geometry.z,!x.symbol||!x.symbol.outline||"esriCLS"!==x.symbol.outline.type||a.is11xService){e.next=20;break}return e.abrupt("continue",43);case 20:if(!a.is11xService&&x.symbol&&x.symbol.outline&&x.symbol.outline.color&&x.symbol.outline.color[3]&&(x.symbol.outline.color[3]=255),P=t&&t.renderer&&("valueExpression"in t.renderer&&t.renderer.valueExpression||"hasVisualVariables"in t.renderer&&t.renderer.hasVisualVariables()),x.symbol||!t||!t.renderer||!P||a.is11xService){e.next=30;break}return D=t.renderer,e.next=26,D.getSymbolAsync(S);case 26:if(I=e.sent){e.next=29;break}return e.abrupt("continue",43);case 29:x.symbol=I.toJSON(),"hasVisualVariables"in D&&D.hasVisualVariables()&&De(x.symbol,{renderer:D,graphic:S,symbol:I});case 30:if(e.t0=x.symbol,!e.t0){e.next=40;break}if(x.symbol.angle||delete x.symbol.angle,!Qt(x.symbol)){e.next=39;break}return e.next=36,zt(x.symbol,a);case 36:x.symbol=e.sent,e.next=40;break;case 39:x.symbol.text&&delete x.attributes;case 40:if(n&&n.forceFeatureAttributes||!m||!m.length){e.next=42;break}!function(){var e={};m.forEach((function(t){x.attributes&&x.attributes.hasOwnProperty(t)&&(e[t]=x.attributes[t])})),x.attributes=e}();case 42:"polygon"===S.geometry.type?o.featureSet.features.push(x):"polyline"===S.geometry.type?c.featureSet.features.push(x):"point"===S.geometry.type?x.symbol&&x.symbol.text?l.featureSet.features.push(x):u.featureSet.features.push(x):"multipoint"===S.geometry.type?s.featureSet.features.push(x):"extent"===S.geometry.type&&(x.geometry=k.a.fromExtent(S.geometry).toJSON(),o.featureSet.features.push(x));case 43:w++,e.next=14;break;case 46:R=[o,c,s,u,l].filter((function(e){return e.featureSet.features.length>0})),G=tt(R),e.prev=48,G.s();case 50:if((L=G.n()).done){e.next=61;break}if(M=L.value,!(V=M.featureSet.features.every((function(e){return e.symbol})))||n&&n.forceFeatureAttributes||M.featureSet.features.forEach((function(e){delete e.attributes})),V&&delete M.layerDefinition.drawingInfo,e.t1=M.layerDefinition.drawingInfo&&M.layerDefinition.drawingInfo.renderer,!e.t1){e.next=59;break}return e.next=59,Kt(M.layerDefinition.drawingInfo.renderer,a);case 59:e.next=50;break;case 61:e.next=66;break;case 63:e.prev=63,e.t2=e.catch(48),G.e(e.t2);case 66:return e.prev=66,G.f(),e.finish(66);case 69:return e.abrupt("return",R.length?{featureCollection:{layers:R},showLabels:i}:null);case 70:case"end":return e.stop()}}),e,null,[[48,63,66,69]])})))).apply(this,arguments)}function jt(e,t,r){return xt.apply(this,arguments)}function xt(){return(xt=Object(n.a)(f.a.mark((function e(t,r,n){var a,i,o,c,u,s,l,p,b,y,d,m,h,v,O;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.legendLayers&&n.legendLayers.push({id:t.id}),c=t.renderer,!(t.featureReduction||c&&"dot-density"===c.type&&(!n.is11xService||parseFloat(n.cimVersion)<2.6))){e.next=4;break}return e.abrupt("return",Vt(t,r,n));case 4:if(u=r.layerView,s=r.printTemplate,l=r.view,p=c&&("valueExpression"in c&&c.valueExpression||"hasVisualVariables"in c&&c.hasVisualVariables()),b="feature-layer"!==(null==(a=t.source)?void 0:a.type)&&"ogc-feature"!==(null==(i=t.source)?void 0:i.type),!(!n.is11xService&&p||t.featureReduction||b)&&c&&(!("field"in c)||null==c.field||"string"==typeof c.field&&t.getField(c.field))){e.next=14;break}return e.next=8,Zt(u);case 8:return y=e.sent,e.next=11,Ot(t,y,s,n);case 11:o=e.sent,e.next=27;break;case 14:if((o={id:(O=t.write()).id,title:O.title,opacity:O.opacity,minScale:O.minScale,maxScale:O.maxScale,url:O.url,layerDefinition:O.layerDefinition}).showLabels=s.showLabels&&t.labelsVisible,_t(o,t),e.t0=null!=(d=o.layerDefinition)&&null!=(m=d.drawingInfo)&&m.renderer,!e.t0){e.next=24;break}return delete o.layerDefinition.minScale,delete o.layerDefinition.maxScale,e.next=23,Kt(o.layerDefinition.drawingInfo.renderer,n);case 23:e.t0="visualVariables"in c&&c.visualVariables&&c.visualVariables[0];case 24:if(!e.t0){e.next=27;break}"size"===(h=c.visualVariables[0]).type&&h.maxSize&&"number"!=typeof h.maxSize&&h.minSize&&"number"!=typeof h.minSize&&(v=Object(P.getSizeRangeAtScale)(h,l.scale),o.layerDefinition.drawingInfo.renderer.visualVariables[0].minSize=v.minSize,o.layerDefinition.drawingInfo.renderer.visualVariables[0].maxSize=v.maxSize);case 27:return e.abrupt("return",o);case 28:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function wt(e,t,r){return St.apply(this,arguments)}function St(){return(St=Object(n.a)(f.a.mark((function e(t,r,n){var a,i;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.layerView,i=r.printTemplate,n.legendLayers&&n.legendLayers.push({id:t.id}),e.t0=Ot,e.t1=t,e.next=6,Zt(a);case 6:return e.t2=e.sent,e.t3=i,e.t4=n,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3,e.t4));case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function kt(e,t,r){return Pt.apply(this,arguments)}function Pt(){return(Pt=Object(n.a)(f.a.mark((function e(t,r,n){var a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.printTemplate,e.abrupt("return",Ot(t,null,a,n));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Dt(e,t){t.legendLayers&&t.legendLayers.push({id:e.id});var r={bandIds:e.bandIds,compressionQuality:e.compressionQuality,format:e.format,interpolation:e.interpolation};if((e.mosaicRule||e.definitionExpression)&&(r.mosaicRule=e.exportImageServiceParameters.mosaicRule.toJSON()),e.renderingRule||e.renderer)if(t.is11xService)e.renderingRule&&(r.renderingRule=e.renderingRule.toJSON()),e.renderer&&(r.layerDefinition=r.layerDefinition||{},r.layerDefinition.drawingInfo=r.layerDefinition.drawingInfo||{},r.layerDefinition.drawingInfo.renderer=e.renderer.toJSON());else{var n=e.exportImageServiceParameters.combineRendererWithRenderingRule();n&&(r.renderingRule=n.toJSON())}return _t(r,e),r}function It(e,t,r){return Rt.apply(this,arguments)}function Rt(){return(Rt=Object(n.a)(f.a.mark((function e(t,r,n){var a,i,o,c,u,s;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=r.printTemplate,!n.is11xService){e.next=4;break}return i={type:"kml"},e.abrupt("return",(t.write(i,{origin:"web-map"}),delete i.layerType,i.url=Object(S.D)(t.url),i));case 4:return o=[],(c=r.layerView).allVisibleMapImages.forEach((function(e,r){var n={id:"".concat(t.id,"_image").concat(r),type:"image",title:t.id,minScale:t.minScale||0,maxScale:t.maxScale||0,opacity:t.opacity,extent:e.extent};"data:image/png;base64,"===e.href.substr(0,22)?n.imageData=e.href.substr(22):n.url=e.href,o.push(n)})),u=[].concat(Object(h.a)(c.allVisiblePoints.items),Object(h.a)(c.allVisiblePolylines.items),Object(h.a)(c.allVisiblePolygons.items)),e.t0=et,e.t1={id:t.id},e.next=11,Ot(null,u,a,n);case 11:return e.t2=e.sent,s=(0,e.t0)(e.t1,e.t2),e.abrupt("return",(o.push(s),o));case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Gt(e,t,r){var n,a=t.view,i={id:e.id,subLayerIds:[]},o=[],c=a.scale;return e.sublayers&&e.sublayers.forEach((function e(t){var r=0===c,n=0===t.minScale||c<=t.minScale,a=0===t.maxScale||c>=t.maxScale;if(t.visible&&(r||n&&a))if(t.sublayers)t.sublayers.forEach(e);else{var u=t.toExportImageJSON(),s={id:t.id,name:t.title,layerDefinition:{drawingInfo:u.drawingInfo,definitionExpression:u.definitionExpression,source:u.source}};o.unshift(s),i.subLayerIds.push(t.id)}})),o.length&&(_t(n={layers:o=o.map((function(e){return{id:e.id,name:e.name,layerDefinition:e.layerDefinition}})),visibleLayers:e.capabilities.exportMap.supportsDynamicLayers?void 0:i.subLayerIds},e),r.legendLayers.push(i)),n}function Lt(e,t){return Mt.apply(this,arguments)}function Mt(){return(Mt=Object(n.a)(f.a.mark((function e(t,r){var n,a,i,o,c,u,s,l,p,b,y,d;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.layerView,a=t.printTemplate,i=[],o=n.layer,!Object(x.i)(o.featureCollections)){e.next=24;break}c=tt(o.featureCollections),e.prev=4,c.s();case 6:if((u=c.n()).done){e.next=14;break}return s=u.value,e.next=10,Ot(s,s.source,a,r);case 10:(l=e.sent)&&i.push.apply(i,Object(h.a)(l.featureCollection.layers));case 12:e.next=6;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(4),c.e(e.t0);case 19:return e.prev=19,c.f(),e.finish(19);case 22:e.next=44;break;case 24:if(!Object(x.i)(o.sublayers)){e.next=44;break}p=tt(o.sublayers),e.prev=26,p.s();case 28:if((b=p.n()).done){e.next=36;break}return y=b.value,e.next=32,Ot(null,y.graphics,a,r);case 32:(d=e.sent)&&i.push.apply(i,Object(h.a)(d.featureCollection.layers));case 34:e.next=28;break;case 36:e.next=41;break;case 38:e.prev=38,e.t1=e.catch(26),p.e(e.t1);case 41:return e.prev=41,p.f(),e.finish(41);case 44:return e.abrupt("return",{featureCollection:{layers:i}});case 45:case"end":return e.stop()}}),e,null,[[4,16,19,22],[26,38,41,44]])})))).apply(this,arguments)}function Vt(e,t,r){return Tt.apply(this,arguments)}function Tt(){return(Tt=Object(n.a)(f.a.mark((function e(t,r,n){var a,i,o,c,u,s,l,p,b,y,d,m,h;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.printTemplate,i=r.view,o={type:"image"},c={format:"png",ignoreBackground:!0,layers:[t],rotation:0},u=n.ssExtent||i.extent.clone(),s=96,l=!0,p=!0,a.exportOptions&&((b=a.exportOptions).dpi>0&&(s=b.dpi),b.width>0&&(l=b.width%2==i.width%2),b.height>0&&(p=b.height%2==i.height%2)),"map-only"!==a.layout||!a.scalePreserved||a.outScale&&a.outScale!==i.scale||96!==s||l&&p||(c.area={x:0,y:0,width:i.width,height:i.height},l||(c.area.width-=1),p||(c.area.height-=1),n.ssExtent)||(y=i.toMap(Object(w.a)(c.area.width,c.area.height)),u.ymin=y.y,u.xmax=y.x,n.ssExtent=u),o.extent=u.clone()._normalize(!0).toJSON(),e.next=8,i.takeScreenshot(c);case 8:return d=e.sent,m=Object(S.i)(d.dataUrl),h=m.data,e.abrupt("return",(o.imageData=h,o));case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Jt(e,t,r){return Nt.apply(this,arguments)}function Nt(){return(Nt=Object(n.a)(f.a.mark((function e(t,r,n){var a,i;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.layerView,i=r.printTemplate,n.legendLayers&&n.legendLayers.push({id:t.id}),e.t0=Ot,e.t1=t,e.next=6,Zt(a);case 6:return e.t2=e.sent,e.t3=i,e.t4=n,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3,e.t4));case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ft(e){var t={customParameters:e.customParameters};return _t(t,e),t}function At(e,t,r){return Et.apply(this,arguments)}function Et(){return(Et=Object(n.a)(f.a.mark((function e(t,r,n){var a,i,o;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n.is11xService&&t.serviceUrl&&t.styleUrl)){e.next=5;break}if(a=O.b&&O.b.findCredential(t.styleUrl),i=O.b&&O.b.findCredential(t.serviceUrl),(a||i)&&"2.1.0"===n.cimVersion){e.next=5;break}return o={type:"VectorTileLayer"},e.abrupt("return",(o.styleUrl=Object(S.D)(t.styleUrl),a&&(o.token=a.token),i&&i.token!==o.token&&(o.additionalTokens=[{url:t.serviceUrl,token:i.token}]),o));case 5:return e.abrupt("return",Vt(t,r,n));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ct(e){var t={type:"WebTiledLayer",urlTemplate:e.urlTemplate.replace(/\${/g,"{"),credits:e.copyright};return e.subDomains&&e.subDomains.length>0&&(t.subDomains=e.subDomains),t}function Ut(e){var t,r=[];return e.sublayers&&e.sublayers.forEach((function e(t){t.visible&&(t.sublayers?t.sublayers.forEach(e):t.name&&r.unshift(t.name))})),r.length&&(t={type:"wms",customLayerParameters:e.customLayerParameters,customParameters:e.customParameters,transparentBackground:e.imageTransparency,visibleLayers:r,url:Object(S.D)(e.url),version:e.version}),t}function Bt(e){var t=e.activeLayer;return{type:"wmts",customLayerParameters:e.customLayerParameters,customParameters:e.customParameters,format:t.imageFormat,layer:t.id,style:t.styleId,tileMatrixSet:t.tileMatrixSetId,url:Object(S.D)(e.url)}}function _t(e,t){if(t.url)if(e.url=Object(S.D)(e.url||t.url),"apiKey"in t&&t.apiKey)e.token=t.apiKey;else if(v.a.apiKey&&Object(Xe.a)(t.url))e.token=v.a.apiKey;else{var r,n;e.token=null==(r=O.b)||null==(n=r.findCredential(t.url))?void 0:n.token}}function zt(e,t){return qt.apply(this,arguments)}function qt(){return(qt=Object(n.a)(f.a.mark((function e(t,r){var n,a,i,o,c,u,s,l,p,b,y,d,m,h,v;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.canvas||(r.canvas=document.createElement("canvas")),n=1024,r.canvas.width=n,r.canvas.height=n,a=r.canvas.getContext("2d"),!t.path){e.next=20;break}if((u=new Path2D(t.path)).closePath(),a.fillStyle=Array.isArray(t.color)?"rgba(".concat(t.color[0],",").concat(t.color[1],",").concat(t.color[2],",").concat(t.color[3]/255,")"):"rgb(0,0,0)",a.fill(u),s=Ie(a)){e.next=10;break}return e.abrupt("return",null);case 10:a.clearRect(0,0,n,n),l=Object(w.c)(t.size)/Math.max(s.width,s.height),a.scale(l,l),b=(p=n/l)/2-s.width/2-s.x,y=p/2-s.height/2-s.y,a.translate(b,y),Array.isArray(t.color)&&a.fill(u),null!=(c=t.outline)&&c.width&&Array.isArray(t.outline.color)&&(d=t.outline,a.lineWidth=Object(w.c)(d.width)/l,a.lineJoin="round",a.strokeStyle="rgba(".concat(d.color[0],",").concat(d.color[1],",").concat(d.color[2],",").concat(d.color[3]/255,")"),a.stroke(u),s.width+=a.lineWidth,s.height+=a.lineWidth),s.width*=l,s.height*=l,m=a.getImageData(n/2-s.width/2,n/2-s.height/2,Math.ceil(s.width),Math.ceil(s.height)),i=m.width,o=m.height,a.canvas.width=i,a.canvas.height=o,a.putImageData(m,0,0),e.next=25;break;case 20:return h="image/svg+xml"===t.contentType?"data:image/svg+xml;base64,"+t.imageData:t.url,e.next=23,Object(g.default)(h,{responseType:"image"});case 23:v=e.sent.data,i=Object(w.c)(t.width),o=Object(w.c)(t.height),a.canvas.width=i,a.canvas.height=o,a.drawImage(v,0,0,a.canvas.width,a.canvas.height);case 25:return e.abrupt("return",{type:"esriPMS",imageData:a.canvas.toDataURL("image/png").substr(22),angle:t.angle,contentType:"image/png",height:l(o),width:l(i),xoffset:t.xoffset,yoffset:t.yoffset});case 26:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Kt(e,t){return Wt.apply(this,arguments)}function Wt(){return(Wt=Object(n.a)(f.a.mark((function e(t,r){var n,a,i,o,c;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("simple"!==(n=t.type)||!Qt(t.symbol)){e.next=7;break}return e.next=4,zt(t.symbol,r);case 4:t.symbol=e.sent,e.next=35;break;case 7:if("uniqueValue"!==n&&"classBreaks"!==n){e.next=35;break}if(e.t0=Qt(t.defaultSymbol),!e.t0){e.next=13;break}return e.next=12,zt(t.defaultSymbol,r);case 12:t.defaultSymbol=e.sent;case 13:if(!(a=t["uniqueValue"===n?"uniqueValueInfos":"classBreakInfos"])){e.next=35;break}i=tt(a),e.prev=16,i.s();case 18:if((o=i.n()).done){e.next=27;break}if(c=o.value,e.t1=Qt(c.symbol),!e.t1){e.next=25;break}return e.next=24,zt(c.symbol,r);case 24:c.symbol=e.sent;case 25:e.next=18;break;case 27:e.next=32;break;case 29:e.prev=29,e.t2=e.catch(16),i.e(e.t2);case 32:return e.prev=32,i.f(),e.finish(32);case 35:case"end":return e.stop()}}),e,null,[[16,29,32,35]])})))).apply(this,arguments)}function Zt(e){return Ht.apply(this,arguments)}function Ht(){return(Ht=Object(n.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.queryFeatures(ot).then((function(e){return e.features})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Yt(e){return e.gpMetadata&&e.gpMetadata.executionType?it.fromJSON(e.gpMetadata.executionType):"sync"}function Qt(e){return e&&(e.path||"image/svg+xml"===e.contentType||e.url&&e.url.endsWith(".svg"))}var Xt=r("F8mY");function $t(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function er(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?$t(Object(r),!0).forEach((function(t){Object(a.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$t(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function tr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return Object(u.a)(this,r)}}var rr=new b.a({esriExecutionTypeSynchronous:"sync",esriExecutionTypeAsynchronous:"async"}),nr=function(e){Object(c.a)(a,e);var t,r=tr(a);function a(){var e;Object(i.a)(this,a);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.call.apply(r,[this].concat(n)))._gpMetadata=null,e.updateDelay=1e3,e}return Object(o.a)(a,[{key:"mode",get:function(){return this._gpMetadata&&this._gpMetadata.executionType?rr.fromJSON(this._gpMetadata.executionType):"sync"}},{key:"execute",value:function(e,t){return e&&(e.updateDelay=this.updateDelay),function(e,t,r){return ut.apply(this,arguments)}(this.url,e,er(er({},this.requestOptions),t))}},{key:"_getGpPrintParams",value:(t=Object(n.a)(f.a.mark((function e(t){var r,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=bt(this.url),n=ct.get(r),e.abrupt("return",st(t,n));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),a}(Xt.a);Object(p.a)([Object(y.b)()],nr.prototype,"_gpMetadata",void 0),Object(p.a)([Object(y.b)({readOnly:!0})],nr.prototype,"mode",null),Object(p.a)([Object(y.b)()],nr.prototype,"updateDelay",void 0);var ar=nr=Object(p.a)([Object(m.a)("esri.tasks.PrintTask")],nr);t.default=ar}}]);
//# sourceMappingURL=152-f6b12a07df3f603d5c51.js.map