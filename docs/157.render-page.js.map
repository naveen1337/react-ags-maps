{"version":3,"sources":["webpack://lib/C:/Users/chubs/development/react-ags-maps/node_modules/@arcgis/core/layers/graphics/sources/WFSSourceWorker.js","webpack://lib/C:/Users/chubs/development/react-ags-maps/node_modules/@arcgis/core/layers/graphics/sources/support/sourceUtils.js"],"names":[],"mappings":";;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAC2xB,QAAQ,cAAc,oFAAoF,MAAM,gBAAgB,2BAA2B,oEAAC,8EAA8E,sHAAsH,EAAE,MAAM,2EAAC,IAAI,4EAAC,IAAI,QAAQ,mFAAC,IAAI,oEAAoE,EAAE,IAAI,yFAAC,oCAAoC,gFAAC,2CAA2C,sFAAC,CAAC,0EAAC,CAAC,oFAAC,kDAAkD,gFAAC,uCAAuC,QAAQ,kBAAkB,WAAW,8EAAC,kHAAkH,UAAU,UAAU,MAAM,gEAAgE,gBAAgB,MAAM,qIAAqI,GAAG,wHAAwH,gEAAC,mCAAmC,4EAAC,0BAA0B,4DAAC,EAAE,0GAA0G,6DAAC,EAAE,+BAA+B,EAAE,EAAE,qCAAqC,6DAAC,YAAY,kDAAkD,qCAAqC,mBAAmB,UAAU,sDAAC,iFAAiF,wBAAwB,KAAK,EAAE,qFAAqF,4BAA4B,KAAK,EAAE,6FAA6F,yBAAyB,KAAK,EAAE,2FAA2F,sBAAsB,KAAK,EAAE,8FAA8F,0BAA0B,EAAE,gGAAgG,uBAAuB,yBAAyB,gBAAgB,MAAM,kEAAkE,wEAAC,8DAA8D,oFAAoF,OAAO,uCAAuC,0EAAC,KAAK,uDAAC,6CAA6C,sDAAC,iFAAiF,QAAQ,GAAG,uCAAuC,qCAAqC,8BAA8B,qDAAqD,IAAI,iCAAiC,OAAO,qCAAqC,0BAA0B,IAAI,MAAM,yFAAC,CAAC,gFAAC,IAAI,MAAM,UAAU,sDAAC,sDAAsD,mBAAmB,IAAmB,gEAAC,EAAC;;;;;;;;;;;;;ACJhzH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACoP,QAAQ,cAAc,sCAAsC,QAAQ,eAAe,oHAAoH,cAAc,gBAAgB,QAAQ,eAAe,kEAAkE,cAAc,gBAAgB,gBAAgB,2BAA2B,UAAU,kBAAkB,iBAAiB,eAAe,sBAAsB,qBAAqB,mGAAmG,0CAA0C,oCAAoC,QAAQ,iFAAC,MAAM,cAAc,sFAAC,SAAS,aAAa,4EAA4E,OAAO,IAAI,YAAY,gBAAgB,QAAQ,0BAA0B,6EAAC,6BAA6B,4EAAC,uCAAuC,qFAAC,IAAI,MAAM,gBAAgB,QAAQ,0FAAC,aAAa,6BAA6B,wDAAwD,uBAAuB,SAAS,mBAAmB,mBAAmB,2OAAoD,IAAI,sBAAsB,CAAC,0FAAC,sEAAgP","file":"157.render-page.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport e from\"../../../core/Error.js\";import t from\"../../../core/Logger.js\";import{unwrap as r}from\"../../../core/maybe.js\";import{throwIfAborted as s,createTask as a,isAbortError as i}from\"../../../core/promiseUtils.js\";import{equals as n,WGS84 as o}from\"../../../geometry/support/spatialReferenceUtils.js\";import{convertFromGeometry as u,convertToGeometry as p}from\"../featureConversionUtils.js\";import h from\"../data/FeatureStore.js\";import{project as y,checkProjectionSupport as l}from\"../data/projectionSupport.js\";import m from\"../data/QueryEngine.js\";import{validateGeoJSON as c,createOptimizedFeatures as g}from\"./geojson/geojson.js\";import{mixAttributes as _}from\"./support/sourceUtils.js\";import{getFeature as f}from\"../../ogc/wfsUtils.js\";import d from\"../../support/FieldsIndex.js\";class w{constructor(){this._queryEngine=null,this._customParameters=null,this._snapshotFeatures=async e=>{const{objectIdField:t}=this._queryEngine,r=await f(this._getFeatureUrl,this._featureType.typeName,this._getFeatureOutputFormat,{customParameters:this._customParameters,dateFields:this._queryEngine.fieldsIndex.dateFields.map((e=>e.name)),signal:e});await c(r),s(e);const a=g(r,{geometryType:this._queryEngine.geometryType,hasZ:!1,objectIdField:t});if(!n(this._queryEngine.spatialReference,o))for(const s of a)s.geometry&&(s.geometry=u(y(p(s.geometry,this._queryEngine.geometryType,!1,!1),o,this._queryEngine.spatialReference)));let i=1;for(const s of a){const e={};_(this._fieldsIndex,e,s.attributes,null,!0),s.attributes=e,null==s.attributes[t]&&(s.objectId=s.attributes[t]=i++)}return a}}destroy(){var e;null==(e=this._queryEngine)||e.destroy(),this._queryEngine=null}async load(e,t){const{getFeatureUrl:a,getFeatureOutputFormat:i,spatialReference:n,fields:o,geometryType:u,featureType:p,objectIdField:y,customParameters:l}=e;this._featureType=p,this._customParameters=l,this._getFeatureUrl=a,this._getFeatureOutputFormat=i,this._fieldsIndex=new d(o),await this._checkProjection(n),s(t),this._queryEngine=new m({fields:o,geometryType:u,hasM:!1,hasZ:!1,objectIdField:y,spatialReference:n,timeInfo:null,featureStore:new h({geometryType:u,hasM:!1,hasZ:!1})});const c=await this._snapshotFeatures(r(t.signal));return this._queryEngine.featureStore.addMany(c),{extent:this._queryEngine.fullExtent}}async applyEdits(){throw new e(\"wfs-source:editing-not-supported\",\"applyEdits() is not supported on WFSLayer\")}async queryFeatures(e={},t={}){return await this._waitSnapshotComplete(),this._queryEngine.executeQuery(e,t.signal)}async queryFeatureCount(e={},t={}){return await this._waitSnapshotComplete(),this._queryEngine.executeQueryForCount(e,t.signal)}async queryObjectIds(e={},t={}){return await this._waitSnapshotComplete(),this._queryEngine.executeQueryForIds(e,t.signal)}async queryExtent(e={},t={}){return await this._waitSnapshotComplete(),this._queryEngine.executeQueryForExtent(e,t.signal)}async querySnapping(e,t={}){return await this._waitSnapshotComplete(),this._queryEngine.executeQueryForSnapping(e,t.signal)}setCustomParameters(e){this._customParameters=e}async refresh(){var r;return null==(r=this._snapshotTask)||r.abort(),this._snapshotTask=a(this._snapshotFeatures),this._snapshotTask.promise.then((e=>{this._queryEngine.featureStore.clear(),e&&this._queryEngine.featureStore.addMany(e)}),(r=>{this._queryEngine.featureStore.clear(),i(r)||t.getLogger(\"esri.layers.WFSLayer\").error(new e(\"wfs-layer:getfeature-error\",\"An error occurred during the GetFeature request\",{error:r}))})),await this._waitSnapshotComplete(),{extent:this._queryEngine.fullExtent}}async _waitSnapshotComplete(){if(this._snapshotTask&&!this._snapshotTask.finished){try{await this._snapshotTask.promise}catch{}return this._waitSnapshotComplete()}}async _checkProjection(t){try{await l(o,t)}catch{throw new e(\"unsupported-projection\",\"Projection not supported\",{spatialReference:t})}}}export default w;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{isValid as t}from\"../../../../geometry/support/spatialReferenceUtils.js\";import{sanitizeNullFieldValue as e,validateFieldValue as n,validationErrorToString as i,isNumericField as r,isStringField as s}from\"../../../support/fieldUtils.js\";class o{constructor(){this.code=null,this.description=null}}class l{constructor(t){this.error=new o,this.globalId=null,this.objectId=null,this.success=!1,this.uniqueId=null,this.error.description=t}}function u(t){return new l(t)}class a{constructor(t){this.globalId=null,this.success=!0,this.objectId=this.uniqueId=t}}function c(t){return new a(t)}const f=new Set;function d(t,e,r,s,o=!1,l){f.clear();for(const a in r){const s=t.get(a);if(!s)continue;const c=r[a],d=m(s,c);if(d!==c&&l&&l.push({name:\"invalid-value-type\",message:\"attribute value was converted to match the field type\",details:{field:s,originalValue:c,sanitizedValue:d}}),f.add(s.name),s&&(o||s.editable)){const t=n(s,d);if(t)return u(i(t,s,d));e[s.name]=d}}if(s)for(const n of s)if(!f.has(n.name))return u(`missing required field \"${n.name}\"`);return null}function m(t,n){let i=n;return\"string\"==typeof n&&r(t)?i=parseFloat(n):null!=n&&s(t)&&\"string\"!=typeof n&&(i=String(n)),e(i)}let p;function h(e,n){if(!e||!t(n))return e;if(\"rings\"in e||\"paths\"in e){if(!p)throw new TypeError(\"geometry engine not loaded\");return p.simplify(n,e)}return e}async function g(){return p||(p=await import(\"../../../../geometry/geometryEngineJSON.js\"),p)}async function y(e,n){!t(e)||\"esriGeometryPolygon\"!==n&&\"esriGeometryPolyline\"!==n||await g()}export{u as createFeatureEditErrorResult,c as createFeatureEditSuccessResult,g as loadGeometryEngine,y as loadGeometryEngineForSimplify,d as mixAttributes,h as simplify};\n"],"sourceRoot":""}