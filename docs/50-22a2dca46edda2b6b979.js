(window.webpackJsonp=window.webpackJsonp||[]).push([[50],{"46Wt":function(e,t,r){"use strict";var i=r("mK0O"),n=r("Mp7X"),a=r("TM+E"),o=r("z4xm");function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){Object(i.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var c=new Map;function u(e,t,r){var i=r.transform,s=r.hasZ,u=r.hasM;c.has(t)||c.set(t,function(e){var t={};switch(e){case"esriGeometryPoint":return function(e,r,i,n){return Object(o.e)(r,t,e,i,n)};case"esriGeometryPolygon":return function(e,r,i,n){return Object(o.f)(r,t,e,i,n)};case"esriGeometryPolyline":return function(e,r,i,n){return Object(o.g)(r,t,e,i,n)};case"esriGeometryMultipoint":return function(e,r,i,n){return Object(o.d)(r,t,e,i,n)};default:return a.a.getLogger("esri.views.2d.support.arcadeOnDemand").error(new n.a("mapview-arcade","Unable to handle geometryType: ".concat(e))),function(e){return e}}}(t));var f=c.get(t)(e.geometry,i,s,u);return l(l({},e),{},{geometry:f})}t.a=function(e,t,r,i,n){var o=e.referencesGeometry()&&n?u(t,i,n):t,s=e.repurposeFeature(o);try{return e.evaluate(l(l({},r),{},{$feature:s}))}catch(c){return a.a.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",c),null}}},"8t8S":function(e,t,r){"use strict";r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return m})),r.d(t,"c",(function(){return c})),r.d(t,"d",(function(){return v}));var i=r("aNYv"),n=r("7im+"),a=r("sE9J"),o=180/Math.PI,s=function(e){return e&&"esri.layers.support.PixelBlock"===e.declaredClass&&e.pixels&&e.pixels.length>0},l=new Map;function c(e,t){return l.get(e)/l.get(t)||1}function u(e){return(450-e)%360}function f(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"geographic",r=Object(i.a)(e,2),n=r[0],a=r[1],s=Math.sqrt(n*n+a*a),l=Math.atan2(a,n)*o;return l=(360+l)%360,"geographic"===t&&(l=u(l)),[s,l]}function h(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"geographic",r=e[1];"geographic"===t&&(r=u(r)),r%=360;var i=e[0];return[i*Math.cos(r/o),i*Math.sin(r/o)]}function p(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"geographic",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;if(!s(e))return e;for(var o=e.pixels,l=e.width,c=e.height,u=l*c,p=o[0],m=o[1],v=a.a.createEmptyBand(e.pixelType,u),d=a.a.createEmptyBand(e.pixelType,u),y=0,x=0;x<c;x++)for(var g=0;g<l;g++){var b,w,O,k;"vector-uv"===t?(b=f([p[y],m[y]],r),w=Object(i.a)(b,2),v[y]=w[0],d[y]=w[1],v[y]*=n):(O=h([p[y],m[y]],r),k=Object(i.a)(O,2),v[y]=k[0],d[y]=k[1],v[y]*=n,d[y]*=n),y++}var j=new a.a({pixelType:e.pixelType,width:e.width,height:e.height,mask:e.mask,validPixelCount:e.validPixelCount,maskIsAlpha:e.maskIsAlpha,pixels:[v,d]});return j.updateStatistics(),j}function m(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(1===r||!s(e))return e;for(var i=e.clone(),n=i.pixels,a=i.width,o=i.height,l=n[0],c=n[1],u=0,f=0;f<o;f++)for(var h=0;h<a;h++)"vector-uv"===t?(l[u]*=r,c[u]*=r):l[u]*=r,u++;return i.updateStatistics(),i}function v(e,t,r,i,a){if(!Object(n.i)(a)||!a.spatialReference.equals(e.spatialReference))return{extent:e,width:t,height:r,resolution:e.width/t};var o=a.xmin,s=a.ymax;i=Math.max(i||0,30);var l=Math.ceil(t*(1/i)),c=Math.ceil(r*(1/i)),u=((e.xmax-e.xmin)/l+(e.ymax-e.ymin)/c)/2;return e.xmin=o+Math.floor((e.xmin-o)/u)*u,e.xmax=o+Math.ceil((e.xmax-o)/u)*u,e.ymin=s+Math.floor((e.ymin-s)/u)*u,e.ymax=s+Math.ceil((e.ymax-s)/u)*u,{extent:e,width:Math.round(e.width/u),height:Math.round(e.height/u),resolution:u}}l.set("meter-per-second",1),l.set("kilometer-per-hour",.277778),l.set("knots",.514444),l.set("feet-per-second",.3048),l.set("mile-per-hour",.44704)},"Hl/n":function(e,t,r){"use strict";r.d(t,"a",(function(){return W})),r.d(t,"b",(function(){return P}));var i=r("mK0O"),n=r("aNYv"),a=r("eijD"),o=r("NthX"),s=r.n(o),l=r("WYis"),c=r("TM+E"),u=r("frPA"),f=r("lZmO"),h=r("DE4D"),p=r("jCQE"),m=r("hQel"),v=r("g9+Q"),d=r("46Wt");function y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function x(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach((function(t){Object(i.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function g(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return b(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return b(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}var w=c.a.getLogger("esri.symbols.cim.cimAnalyzer");function O(e){switch(e){case"Butt":return 0;case"Square":return 2;case"Round":default:return 1}}function k(e){switch(e){case"Bevel":return 0;case"Miter":return 2;case"Round":default:return 1}}function j(e){switch(e){case"Left":default:return"left";case"Right":return"right";case"Center":return"center";case"Justify":return"justify"}}function M(e){switch(e){case"Top":default:return"top";case"Center":return"middle";case"Baseline":return"baseline";case"Bottom":return"bottom"}}function S(e,t,r,i){var n;e[t]?n=e[t]:(n={},e[t]=n),n[r]=i}function R(e){var t=e.markerPlacement;return t&&t.angleToLine?1:0}function P(e,t,r,i){return C.apply(this,arguments)}function C(){return(C=Object(a.a)(s.a.mark((function e(t,r,i,n){var a,o,l,c,u,f,p,m;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=null!=i?i:[],t){e.next=3;break}return e.abrupt("return",a);case 3:if(c={},"CIMSymbolReference"===t.type){e.next=6;break}return e.abrupt("return",(w.error("Expect cim type to be 'CIMSymbolReference'"),a));case 6:if(o=t.symbol,!(l=t.primitiveOverrides)){e.next=12;break}u=[],f=g(l);try{for(m=function(){var e=p.value,t=e.valueExpressionInfo;if(t&&r){var i=t.expression,n=Object(h.d)(i,r.spatialReference,r.fields).then((function(t){t&&S(c,e.primitiveName,e.propertyName,t)}));u.push(n)}else null!=e.value&&S(c,e.primitiveName,e.propertyName,e.value)},f.s();!(p=f.n()).done;)m()}catch(s){f.e(s)}finally{f.f()}return e.next=12,Promise.all(u);case 12:switch(o.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":A(o,l,c,r,a,n)}return e.abrupt("return",a);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(e,t,r,i,n,a){if(e){var o=e.symbolLayers;if(o){var s,l=p.a.getSize(e);"CIMPointSymbol"===e.type&&"Map"===e.angleAlignment&&(s=1);for(var c=o.length;c--;){var u=o[c];if(u&&!1!==u.enable){var f=[];switch(p.b.findApplicableOverrides(u,t,f),u.type){case"CIMSolidFill":N(u,r,f,i,n);break;case"CIMPictureFill":I(u,r,f,i,n);break;case"CIMHatchFill":B(u,r,f,i,n);break;case"CIMGradientFill":_(u,r,f,i,n);break;case"CIMSolidStroke":T(u,r,f,i,n,"CIMPolygonSymbol"===e.type,l);break;case"CIMPictureStroke":E(u,r,f,i,n,"CIMPolygonSymbol"===e.type,l);break;case"CIMGradientStroke":U(u,r,f,i,n,"CIMPolygonSymbol"===e.type,l);break;case"CIMCharacterMarker":if(L(u,r,f,i,n))break;break;case"CIMPictureMarker":if(L(u,r,f,i,n))break;"CIMLineSymbol"===e.type&&(s=R(u)),D(u,r,f,i,n,s,l);break;case"CIMVectorMarker":if(L(u,r,f,i,n))break;"CIMLineSymbol"===e.type&&(s=R(u)),F(u,r,f,i,n,s,l,a);break;default:w.error("Cannot analyze CIM layer",u.type)}}}}}}function N(e,t,r,i,a){var o=e.primitiveName,s=Object(v.e)(e.color),l=Y(r,o),c=Object(n.a)(l,2),u=c[0],h=c[1],p=Object(f.b)(JSON.stringify(e)+h).toString();a.push({type:"fill",templateHash:p,materialHash:u?function(){return p}:p,cim:e,materialOverrides:null,colorLocked:e.colorLocked,color:q(o,t,"Color",i,s,H),height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,effects:e.effects})}function I(e,t,r,i,a){var o=e.primitiveName,s=e.tintColor?Object(v.e)(e.tintColor):{r:255,g:255,b:255,a:1},l=Y(r,o),c=Object(n.a)(l,2),u=c[0],h=c[1],p=Object(f.b)(JSON.stringify(e)+h).toString(),m=Object(f.b)("".concat(e.url).concat(JSON.stringify(e.colorSubstitutions))).toString();a.push({type:"fill",templateHash:p,materialHash:u?function(){return m}:m,cim:e,materialOverrides:null,colorLocked:e.colorLocked,effects:e.effects,color:q(o,t,"TintColor",i,s,H),height:q(o,t,"Height",i,e.height),scaleX:q(o,t,"ScaleX",i,e.scaleX),angle:q(o,t,"Rotation",i,e.rotation),offsetX:q(o,t,"OffsetX",i,e.offsetX),offsetY:q(o,t,"OffsetY",i,e.offsetY)})}function B(e,t,r,i,a){var o=["Rotation","OffsetX","OffsetY"],s=r.filter((function(t){return t.primitiveName!==e.primitiveName&&-1===o.indexOf(t.propertyName)})),l=e.primitiveName,c=Y(r,l),u=Object(n.a)(c,2),h=u[0],p=u[1],m=Object(f.b)(JSON.stringify(e)+p).toString(),v=Object(f.b)("".concat(e.separation).concat(JSON.stringify(e.lineSymbol))).toString();a.push({type:"fill",templateHash:m,materialHash:h?G(v,t,s,i):v,cim:e,materialOverrides:s,colorLocked:e.colorLocked,effects:e.effects,color:{r:255,g:255,b:255,a:1},height:q(l,t,"Separation",i,e.separation),scaleX:1,angle:q(l,t,"Rotation",i,e.rotation),offsetX:q(l,t,"OffsetX",i,e.offsetX),offsetY:q(l,t,"OffsetY",i,e.offsetY)})}function _(e,t,r,i,a){var o=Y(r,e.primitiveName),s=Object(n.a)(o,2),l=s[0],c=s[1],u=Object(f.b)(JSON.stringify(e)+c).toString();a.push({type:"fill",templateHash:u,materialHash:l?G(u,t,r,i):u,cim:e,materialOverrides:null,colorLocked:e.colorLocked,effects:e.effects,color:{r:128,g:128,b:128,a:1},height:0,angle:0,offsetX:0,offsetY:0,scaleX:1})}function T(e,t,r,i,a,o,s){var l=e.primitiveName,c=Object(v.e)(e.color),u=void 0!==e.width?e.width:4,h=O(e.capStyle),p=k(e.joinStyle),m=e.miterLimit,d=Y(r,l),y=Object(n.a)(d,2),x=y[0],g=y[1],b=Object(f.b)(JSON.stringify(e)+g).toString();a.push({type:"line",templateHash:b,materialHash:x?function(){return b}:b,cim:e,materialOverrides:null,isOutline:o,colorLocked:e.colorLocked,effects:e.effects,color:q(l,t,"Color",i,c,H),width:q(l,t,"Width",i,u),cap:q(l,t,"CapStyle",i,h),join:q(l,t,"JoinStyle",i,p),miterLimit:q(l,t,"MiterLimit",i,m),referenceWidth:s,zOrder:X(e.name),isDashed:!1})}function E(e,t,r,i,a,o,s){var l=Object(f.b)("".concat(e.url).concat(JSON.stringify(e.colorSubstitutions))).toString(),c=e.primitiveName,u=Object(v.e)(e.tintColor),h=void 0!==e.width?e.width:4,p=O(e.capStyle),m=k(e.joinStyle),d=e.miterLimit,y=Y(r,c),x=Object(n.a)(y,2),g=x[0],b=x[1],w=Object(f.b)(JSON.stringify(e)+b).toString();a.push({type:"line",templateHash:w,materialHash:g?function(){return l}:l,cim:e,materialOverrides:null,isOutline:o,colorLocked:e.colorLocked,effects:e.effects,color:q(c,t,"TintColor",i,u,H),width:q(c,t,"Width",i,h),cap:q(c,t,"CapStyle",i,p),join:q(c,t,"JoinStyle",i,m),miterLimit:q(c,t,"MiterLimit",i,d),referenceWidth:s,zOrder:X(e.name),isDashed:!1})}function U(e,t,r,i,a,o,s){var l=e.primitiveName,c=void 0!==e.width?e.width:4,u=O(e.capStyle),h=k(e.joinStyle),p=e.miterLimit,m=Y(r,l),v=Object(n.a)(m,2),d=v[0],y=v[1],x=Object(f.b)(JSON.stringify(e)+y).toString();a.push({type:"line",templateHash:x,materialHash:d?G(x,t,r,i):x,cim:e,materialOverrides:null,isOutline:o,colorLocked:e.colorLocked,effects:e.effects,color:{r:128,g:128,b:128,a:1},width:q(l,t,"Width",i,c),cap:q(l,t,"CapStyle",i,u),join:q(l,t,"JoinStyle",i,h),miterLimit:q(l,t,"MiterLimit",i,p),referenceWidth:s,zOrder:X(e.name),isDashed:!1})}function L(e,t,r,i,a){var o=e.markerPlacement;if(!o||"CIMMarkerPlacementInsidePolygon"!==o.type)return!1;var s=o,l=["Rotation","OffsetX","OffsetY"],c=r.filter((function(t){return t.primitiveName!==e.primitiveName&&-1===l.indexOf(t.propertyName)})),u=Y(r,s.primitiveName),h=Object(n.a)(u,2),p=h[0],m=h[1],v=Object(f.b)(JSON.stringify(e)+m).toString();return a.push({type:"fill",templateHash:v,materialHash:p?G(v,t,c,i):v,cim:e,materialOverrides:c,colorLocked:e.colorLocked,effects:e.effects,color:{r:255,g:255,b:255,a:1},height:q(s.primitiveName,t,"StepY",i,s.stepY),scaleX:1,angle:q(s.primitiveName,t,"GridAngle",i,s.gridAngle),offsetX:q(s.primitiveName,t,"OffsetX",i,s.offsetX),offsetY:q(s.primitiveName,t,"OffsetY",i,s.offsetY)}),!0}function D(e,t,r,i,a,o,s){var l=e.primitiveName,c=e.size,u=e.scaleX,h=e.rotation,p=e.offsetX,m=e.offsetY,d=Object(v.e)(e.tintColor),y=Object(f.b)("".concat(e.url).concat(JSON.stringify(e.colorSubstitutions))).toString(),x=Y(r,l),g=Object(n.a)(x,2),b=g[0],w=g[1],O=Object(f.b)(JSON.stringify(e)+w).toString();a.push({type:"marker",templateHash:O,materialHash:b?function(){return y}:y,cim:e,materialOverrides:null,colorLocked:e.colorLocked,effects:e.effects,scaleSymbolsProportionally:!1,alignment:o,size:q(l,t,"Size",i,c),scaleX:q(l,t,"ScaleX",i,u),rotation:q(l,t,"Rotation",i,h),offsetX:q(l,t,"OffsetX",i,p),offsetY:q(l,t,"OffsetY",i,m),color:q(l,t,"TintColor",i,d,H),anchorPoint:e.anchorPoint,isAbsoluteAnchorPoint:"Relative"!==e.anchorPointUnits,outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,frameHeight:0,rotateClockwise:e.rotateClockwise,referenceSize:s,sizeRatio:1,markerPlacement:e.markerPlacement})}function F(e,t,r,i,n,a,o,s){var l=e.markerGraphics;if(l){var c=0;if(e.scaleSymbolsProportionally){var u=e.frame;u&&(c=u.ymax-u.ymin)}var f,h=g(l);try{for(h.s();!(f=h.n()).done;){var p=f.value;if(p){var m=p.symbol;if(!m)continue;switch(m.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":J(e,p,r,t,i,n,a,o,c,s);break;case"CIMTextSymbol":z(e,p,t,r,i,n,a,o,c)}}}}catch(v){h.e(v)}finally{h.f()}}}function z(e,t,r,i,n,a,o,s,l){p.b.findApplicableOverrides(t,i,[]);var c=t.geometry;if("x"in c&&"y"in c){var u=t.symbol,h=function(e){return e.underline?"underline":e.strikethrough?"line-through":"none"}(u),m=function(e){var t="normal",r="normal";if(e){var i=e.toLowerCase();-1!==i.indexOf("italic")?t="italic":-1!==i.indexOf("oblique")&&(t="oblique"),-1!==i.indexOf("bold")?r="bold":-1!==i.indexOf("light")&&(r="lighter")}return{style:t,weight:r}}(u.fontStyleName);u.font=x({family:u.fontFamilyName,decoration:h},m);var d=e.frame,y=c.x-.5*(d.xmin+d.xmax),b=c.y-.5*(d.ymin+d.ymax),w=e.size/l,O=e.primitiveName,k=(u.height||0)*w,S=u.angle||0,R=((u.offsetX||0)+y)*w,P=((u.offsetY||0)+b)*w,C=Object(v.e)(p.a.getFillColor(u)),A=Object(v.e)(p.a.getStrokeColor(u)),N=p.a.getStrokeWidth(u);N||(A=Object(v.e)(p.a.getFillColor(u.haloSymbol)),N=u.haloSize*w);var I,B="",_=g(i);try{for(_.s();!(I=_.n()).done;){var T=I.value;T.primitiveName===O&&void 0!==T.value&&(B+="-".concat(T.primitiveName,"-").concat(T.propertyName,"-").concat(JSON.stringify(T.value)))}}catch(L){_.e(L)}finally{_.f()}var E=JSON.stringify(e.effects)+Number(e.colorLocked)+JSON.stringify(e.anchorPoint)+e.anchorPointUnits+JSON.stringify(e.markerPlacement),U=Object(f.b)(JSON.stringify(t)+E+B).toString();a.push({type:"text",templateHash:U,materialHash:function(){return Object(f.b)(JSON.stringify(u.font)).toString()},cim:u,materialOverrides:null,colorLocked:e.colorLocked,effects:e.effects,alignment:o,anchorPoint:{x:e.anchorPoint?e.anchorPoint.x:0,y:e.anchorPoint?e.anchorPoint.y:0},isAbsoluteAnchorPoint:"Relative"!==e.anchorPointUnits,fontName:u.fontFamilyName,decoration:"none",weight:"normal",style:"normal",size:q(O,r,"Size",n,k),angle:q(O,r,"Rotation",n,S),offsetX:q(O,r,"OffsetX",n,R),offsetY:q(O,r,"OffsetY",n,P),horizontalAlignment:j(u.horizontalAlignment),verticalAlignment:M(u.verticalAlignment),text:q(t.primitiveName,r,"TextString",n,t.textString,v.a,u.textCase),color:C,outlineColor:A,outlineSize:N,referenceSize:s,sizeRatio:1,markerPlacement:e.markerPlacement})}}function J(e,t,r,i,a,o,s,l,c,u){var h=t.symbol,d=t.geometry;if(d){var y=h.symbolLayers;if(y)if(u)V(e,t,i,r,a,o,s,l,c);else for(var b=y.length;b--;){var w=y[b];if(w&&!1!==w.enable)switch(w.type){case"CIMSolidFill":case"CIMSolidStroke":var O=function(){var u=Object(m.b)(d);if(!u)return"continue";var h=Object(m.d)(u,e.frame,e.size,e.anchorPoint,"Relative"!==e.anchorPointUnits),y=Object(n.a)(h,3),b=y[0],O=y[1],k=y[2],j="CIMSolidFill"===w.type,M={type:"sdf",geom:d,asFill:j},S=e.primitiveName,R=e.size,P=e.rotation||0,C=e.offsetX,A=e.offsetY,N=w.primitiveName,I=Object(v.e)(j?p.a.getFillColor(w):p.a.getStrokeColor(w)),B=j?{r:0,g:0,b:0,a:0}:Object(v.e)(p.a.getStrokeColor(w)),_=p.a.getStrokeWidth(w);if(!j&&!_)return"break";var T,E=!1,U="",L=g(r);try{for(L.s();!(T=L.n()).done;){var D=T.value;D.primitiveName!==N&&D.primitiveName!==S||(void 0!==D.value?U+="-".concat(D.primitiveName,"-").concat(D.propertyName,"-").concat(JSON.stringify(D.value)):D.valueExpressionInfo&&(E=!0))}}catch(V){L.e(V)}finally{L.f()}var F=JSON.stringify(x(x({},e),{},{markerGraphics:null})),z=Object(f.b)(JSON.stringify(M)).toString(),J={type:"marker",templateHash:Object(f.b)(JSON.stringify(t)+JSON.stringify(w)+F+U).toString(),materialHash:E?function(){return z}:z,cim:M,materialOverrides:null,colorLocked:e.colorLocked,effects:e.effects,scaleSymbolsProportionally:e.scaleSymbolsProportionally,alignment:s,anchorPoint:{x:O,y:k},isAbsoluteAnchorPoint:!1,size:q(e.primitiveName,i,"Size",a,R),rotation:q(e.primitiveName,i,"Rotation",a,P),offsetX:q(e.primitiveName,i,"OffsetX",a,C),offsetY:q(e.primitiveName,i,"OffsetY",a,A),scaleX:1,frameHeight:c,rotateClockwise:e.rotateClockwise,referenceSize:l,sizeRatio:b,color:q(N,i,"Color",a,I,H),outlineColor:q(N,i,"Color",a,B,H),outlineWidth:q(N,i,"Width",a,_),markerPlacement:e.markerPlacement};return o.push(J),"break"}();if("continue"===O)continue;if("break"===O)break;default:V(e,t,i,r,a,o,s,l,c)}}}}function V(e,t,r,i,a,o,s,l,c){var h,m=function(e,t){return{type:e.type,enable:!0,name:e.name,colorLocked:e.colorLocked,primitiveName:e.primitiveName,anchorPoint:e.anchorPoint,anchorPointUnits:e.anchorPointUnits,offsetX:0,offsetY:0,rotateClockwise:e.rotateClockwise,rotation:0,size:e.size,billboardMode3D:e.billboardMode3D,depth3D:e.depth3D,frame:e.frame,markerGraphics:[t],scaleSymbolsProportionally:e.scaleSymbolsProportionally,respectFrame:e.respectFrame,clippingPath:e.clippingPath,effects:e.effects}}(e,t),v=["Rotation","OffsetX","OffsetY"];h=i.filter((function(t){return t.primitiveName!==e.primitiveName||-1===v.indexOf(t.propertyName)}));var d,y="",x=g(i);try{for(x.s();!(d=x.n()).done;){var b=d.value;void 0!==b.value&&(y+="-".concat(b.primitiveName,"-").concat(b.propertyName,"-").concat(JSON.stringify(b.value)))}}catch(I){x.e(I)}finally{x.f()}var w=p.a.getTextureAnchor(m),O=Object(n.a)(w,3),k=O[0],j=O[1],M=O[2],S=e.primitiveName,R=e.rotation||0,P=e.offsetX||0,C=e.offsetY||0,A=Object(f.b)(JSON.stringify(m)+y).toString(),N={type:"marker",templateHash:A,materialHash:0===h.length?A:G(A,r,h,a),cim:m,materialOverrides:h,colorLocked:e.colorLocked,effects:e.effects,scaleSymbolsProportionally:e.scaleSymbolsProportionally,alignment:s,anchorPoint:{x:k,y:j},isAbsoluteAnchorPoint:!1,size:e.size,rotation:q(S,r,"Rotation",a,R),offsetX:q(S,r,"OffsetX",a,P),offsetY:q(S,r,"OffsetY",a,C),color:{r:0,g:0,b:0,a:0},outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,scaleX:1,frameHeight:c,rotateClockwise:e.rotateClockwise,referenceSize:l,sizeRatio:M/Object(u.c)(e.size),markerPlacement:e.markerPlacement};o.push(N)}function X(e){if(e&&0===e.indexOf("Level_")){var t=parseInt(e.substr(6),10);if(NaN!==t)return t}return 0}function H(e){if(!e||0===e.length)return null;var t=new l.a(e).toRgba();return{r:t[0],g:t[1],b:t[2],a:t[3]}}function q(e,t,r,i,n,a,o){var s=t[e];if(s){var l=s[r];if("string"==typeof l||"number"==typeof l||l instanceof Array)return a?a.call(null,l,o):l;if(null!=l&&l instanceof h.a)return function(e,t,r){var s=Object(d.a)(l,e,{$view:r},i.geometryType,t);return null!==s&&a&&(s=a.call(null,s,o)),null!==s?s:n}}return n}function G(e,t,r,i){var n,a=g(r);try{for(a.s();!(n=a.n()).done;){var o=n.value;o.valueExpressionInfo&&function(){var e=t[o.primitiveName]&&t[o.primitiveName][o.propertyName];e instanceof h.a&&(o.fn=function(t,r,n){return Object(d.a)(e,t,{$view:n},i.geometryType,r)})}()}}catch(s){a.e(s)}finally{a.f()}return function(t,i,n){var a,o=g(r);try{for(o.s();!(a=o.n()).done;){var l=a.value;l.fn&&(l.value=l.fn(t,i,n))}}catch(s){o.e(s)}finally{o.f()}return Object(f.b)(e+p.b.buildOverrideKey(r)).toString()}}function W(e,t){if(!t||0===t.length)return e;var r=JSON.parse(JSON.stringify(e));return p.b.applyOverrides(r,t),r}function Y(e,t){var r,i=!1,n="",a=g(e);try{for(a.s();!(r=a.n()).done;){var o=r.value;o.primitiveName===t&&(void 0!==o.value?n+="-".concat(o.primitiveName,"-").concat(o.propertyName,"-").concat(JSON.stringify(o.value)):o.valueExpressionInfo&&(i=!0))}}catch(s){a.e(s)}finally{a.f()}return[i,n]}},Jrv3:function(e,t,r){"use strict";r.d(t,"a",(function(){return g}));var i=r("aNYv"),n=r("hisu"),a=r("yBJb"),o=r("0942"),s=r("4Mpa"),l=r("CHlC"),c=r("kMo5"),u=r("P+uj"),f=r("+MBG"),h=r("Tkaf"),p=r("0s7n"),m=(r("a1c8"),r("iwTS"),r("J4Pc"),r("B2Uc"),r("cY28"),r("IxxH"),r("0fR5")),v=(r("H8zE"),r("PFYi")),d=r("Zw7s");function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,i=Object(u.a)(e);if(t){var n=Object(u.a)(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return Object(c.a)(this,r)}}function x(e,t,r){var i={target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071};return t&&r&&(i.width=t,i.height=r),new m.a(e,i)}var g=function(e){Object(l.a)(r,e);var t=y(r);function r(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=arguments.length>1?arguments[1]:void 0,s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return Object(n.a)(this,r),(e=t.call(this)).requestRenderOnSourceChangedEnabled=s,e._textureInvalidated=!0,e.stencilRef=0,e.coordScale=[1,1],e._height=void 0,e.pixelRatio=1,e.resolution=0,e.rotation=0,e._source=null,e._width=void 0,e.x=0,e.y=0,e.transforms={dvs:Object(h.b)()},e.blendFunction=a,e.source=i,e.requestRender=e.requestRender.bind(Object(o.a)(e)),e}return Object(a.a)(r,[{key:"destroy",value:function(){this._texture&&(this._texture.dispose(),this._texture=null)}},{key:"isSourceScaled",get:function(){return this.width!==this.sourceWidth||this.height!==this.sourceHeight}},{key:"height",get:function(){return void 0!==this._height?this._height:this.sourceHeight},set:function(e){this._height=e}},{key:"source",get:function(){return this._source},set:function(e){this._source=e,this.invalidateTexture()}},{key:"sourceHeight",get:function(){return this._source instanceof HTMLImageElement?this._source.naturalHeight:this._source.height}},{key:"sourceWidth",get:function(){return this._source instanceof HTMLImageElement?this._source.naturalWidth:this._source.width}},{key:"width",get:function(){return void 0!==this._width?this._width:this.sourceWidth},set:function(e){this._width=e}},{key:"beforeRender",value:function(e){Object(s.a)(Object(u.a)(r.prototype),"beforeRender",this).call(this,e),this.updateTexture(e.context)}},{key:"invalidateTexture",value:function(){this._textureInvalidated||(this._textureInvalidated=!0,this.requestRenderOnSourceChangedEnabled&&this.requestRender())}},{key:"setTransform",value:function(e){var t=Object(f.b)(this.transforms.dvs),r=e.toScreenNoRotation([0,0],this.x,this.y),n=Object(i.a)(r,2),a=n[0],o=n[1],s=this.resolution/this.pixelRatio/e.resolution,l=s*this.width,c=s*this.height,u=Math.PI*this.rotation/180;Object(f.c)(t,t,Object(p.b)(a,o)),Object(f.c)(t,t,Object(p.b)(l/2,c/2)),Object(f.j)(t,t,-u),Object(f.c)(t,t,Object(p.b)(-l/2,-c/2)),Object(f.g)(t,t,Object(p.b)(l,c)),Object(f.h)(this.transforms.dvs,e.displayViewMat3,t)}},{key:"setSamplingProfile",value:function(e){this._texture&&(e.mips&&!this._texture.descriptor.hasMipmap&&this._texture.generateMipmap(),this._texture.setSamplingMode(e.samplingMode))}},{key:"bind",value:function(e,t){this._texture&&e.bindTexture(this._texture,t)}},{key:"updateTexture",value:function(e){var t;if(!this.stage)return null==(t=this._texture)||t.dispose(),void(this._texture=null);if(this._textureInvalidated){this._textureInvalidated=!1,this._texture||(this.source?this._texture=x(e,this.sourceWidth,this.sourceHeight):this._texture=x(e));var r=this.source;if(r){if(this._texture.resize(this.sourceWidth,this.sourceHeight),function(e){return e&&"render"in e}(r))if(r instanceof d.a){var i=r.getRenderedRasterPixels();this._texture.setData(i.renderedRasterPixels)}else this._texture.setData(function(e){var t=document.createElement("canvas");return t.width=e.width,t.height=e.height,e.render(t.getContext("2d")),t}(r));else(function(e){return e&&!("render"in e)})(r)&&this._texture.setData(r);this.ready()}else this._texture.setData(null)}}},{key:"onAttach",value:function(){this.invalidateTexture()}},{key:"onDetach",value:function(){this.invalidateTexture()}}]),r}(v.a)},QowV:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));r("Kp6J");function i(e,t,r,i){var n=e.clone(),a=1<<n.level,o=n.col+t,s=n.row+r;return i&&o<0?(n.col=o+a,n.world-=1):o>=a?(n.col=o-a,n.world+=1):n.col=o,n.row=s,n}},VHll:function(e,t,r){"use strict";r.r(t);var i=r("eijD"),n=r("hisu"),a=r("yBJb"),o=r("CHlC"),s=r("kMo5"),l=r("P+uj"),c=r("NthX"),u=r.n(c),f=r("dQW7"),h=r("j56I"),p=r("xAIp"),m=(r("J4Pc"),r("wckI"),r("TM+E")),v=r("iaHD"),d=r("55C+"),y=r("aNYv"),x=r("4VMI"),g=r("DGz/"),b=r("hZBP"),w=r("7im+"),O=r("IH5m"),k=r("frPA"),j=r("vo12"),M=r("nd5+"),S=r("lWwP"),R=r("8t8S"),P=r("KmCB"),C=r("x8wo"),A=r("F0Fd"),N=r("KA0i");function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,i=Object(l.a)(e);if(t){var n=Object(l.a)(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return Object(s.a)(this,r)}}var B=m.a.getLogger("esri.views.2d.layers.imagery.ImageryGraphicsView2D"),_=function(e){Object(o.a)(s,e);var t,r=I(s);function s(){var e;return Object(n.a)(this,s),(e=r.apply(this,arguments)).attached=!1,e.container=new C.a,e.updateRequested=!1,e._graphicsView=null,e._projectFullExtentPromise=null,e._previousExtents=[],e._previousSymbolTileResolution=0,e._previousRendererSignature="",e.type="Graphics",e._graphics=new P.b,e._updateGraphics=Object(O.i)(function(){var t=Object(i.a)(u.a.mark((function t(r,i){var n,a,o,s,l,c,f,h,p,m,v,d,x,g,b,O,k,j,S,P,C,A,N,I,B;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.stationary){t.next=2;break}return t.abrupt("return");case 2:return n=r.state,a=new M.a({xmin:n.extent.xmin,ymin:n.extent.ymin,xmax:n.extent.xmax,ymax:n.extent.ymax,spatialReference:n.spatialReference}),o=Object(y.a)(r.state.size,2),s=o[0],l=o[1],(c={}).timeExtent=e.timeExtent,c.requestAsImageElement=!1,c.signal=i,null==e._projectFullExtentPromise&&(e._projectFullExtentPromise=e._getProjectedFullExtent(a.spatialReference)),f="vector-field"===e.layer.renderer.type?e.layer.renderer.symbolTileSize:50,t.next=7,e._projectFullExtentPromise;case 7:return h=t.sent,p=Object(R.d)(a,s,l,f,h),m=p.extent,v=p.resolution,d=p.width,x=p.height,t.next=15,e.layer.fetchImage(m,d,x,c);case 15:if(g=t.sent,"vector-field"!==(b=e.layer.renderer).type){t.next=31;break}return O=g.pixelData.pixelBlock,(k=b.sizeVariables[0]).minDataValue&&k.maxDataValue||(k.minDataValue=O.statistics[0].minValue,k.maxDataValue=O.statistics[0].maxValue),e._pixelData={extent:m,pixelBlock:g.pixelData.pixelBlock},j=JSON.stringify(e.layer.renderer),S=e._previousRendererSignature===j,P=Math.abs(e._previousSymbolTileResolution-v)/v<.01,C=m.clone().normalize(),A=e._previousExtents.some((function(e){return C.some((function(t){return e.intersects(t)}))})),N=S&&P&&A?e._previousExtents:[],t.next=28,b.getGraphicsFromPixelData(g.pixelData,"vector-uv"===e.layer.rasterInfo.dataType,N);case 28:I=t.sent,N.length?(B=e._graphics.items.filter((function(e){return Object(w.i)(e.geometry)&&N.some((function(t){return t.intersects(e.geometry)}))&&!C.some((function(t){return t.intersects(e.geometry)}))})),e._graphics.removeMany(B),e._graphics.addMany(I)):e._graphics.set("items",I),e._graphicsView.update(r),e._previousExtents=C,e._previousRendererSignature=j,e._previousSymbolTileResolution=v;case 31:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}()),e}return Object(a.a)(s,[{key:"destroy",value:function(){this.attached&&(this.detach(),this.attached=!1),this.updateRequested=!1}},{key:"updating",get:function(){return!this.attached||this.isUpdating()}},{key:"update",value:function(e){this._updateGraphics(e).catch((function(e){Object(O.m)(e)||B.error(e)}))}},{key:"hitTest",value:function(e,t){var r=this.view.toMap(Object(k.a)(e,t));return Promise.resolve(new x.a({attributes:{},geometry:r,layer:this.layer}))}},{key:"attach",value:function(){var e=this;this._graphicsView=new N.a({view:this.view,graphics:this._graphics,requestUpdateCallback:function(){return e.requestUpdate()},container:new A.a(this.view.featuresTilingScheme)}),this.attached=!0}},{key:"detach",value:function(){this._graphics.destroy(),this._graphicsView.destroy(),this.container.removeChild(this._graphicsView.container),this._graphicsView=null}},{key:"moveStart",value:function(){}},{key:"viewChange",value:function(){}},{key:"moveEnd",value:function(){}},{key:"install",value:function(e){this.container.addChild(this._graphicsView.container),e.addChild(this.container)}},{key:"uninstall",value:function(e){this.container.removeChild(this._graphicsView.container),e.removeChild(this.container)}},{key:"isUpdating",value:function(){return this._graphicsView.updating||this.updateRequested}},{key:"getPixelData",value:function(){return this.updating?null:this._pixelData}},{key:"redraw",value:function(){}},{key:"requestUpdate",value:function(){this.updateRequested||(this.updateRequested=!0,this.view.requestUpdate())}},{key:"_getProjectedFullExtent",value:(t=Object(i.a)(u.a.mark((function e(t){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(S.g)(this.layer.fullExtent,t);case 3:return e.abrupt("return",e.sent);case 6:return e.prev=6,e.t0=e.catch(0),e.prev=8,e.next=11,Object(g.default)(this.layer.url,{query:{option:"footprints",outSR:t.wkid||JSON.stringify(t.toJSON()),f:"json"}});case 11:return r=e.sent.data.featureCollection.layers[0].layerDefinition.extent,e.abrupt("return",r?M.a.fromJSON(r):null);case 15:return e.prev=15,e.t1=e.catch(8),e.abrupt("return",null);case 18:case"end":return e.stop()}}),e,this,[[0,6],[8,15]])}))),function(e){return t.apply(this,arguments)})}]),s}(b.a);Object(f.a)([Object(p.b)()],_.prototype,"attached",void 0),Object(f.a)([Object(p.b)()],_.prototype,"container",void 0),Object(f.a)([Object(p.b)()],_.prototype,"layer",void 0),Object(f.a)([Object(p.b)()],_.prototype,"timeExtent",void 0),Object(f.a)([Object(p.b)()],_.prototype,"view",void 0),Object(f.a)([Object(p.b)()],_.prototype,"updateRequested",void 0),Object(f.a)([Object(p.b)()],_.prototype,"updating",null),Object(f.a)([Object(j.a)({graphics:"Graphics"})],_.prototype,"type",void 0);var T=_=Object(f.a)([Object(v.a)("esri.views.2d.layers.imagery.ImageryGraphicsView2D")],_),E=r("WBSb"),U=r("FXVW"),L=r("Zw7s"),D=r("dnRo");function F(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,i=Object(l.a)(e);if(t){var n=Object(l.a)(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return Object(s.a)(this,r)}}var z=m.a.getLogger("esri.views.2d.layers.imagery.ImageryView2D"),J=function(e){Object(o.a)(r,e);var t=F(r);function r(){var e;return Object(n.a)(this,r),(e=t.apply(this,arguments)).attached=!1,e.container=new C.a,e.updateRequested=!1,e.type="Imagery",e._bitmapView=null,e}return Object(a.a)(r,[{key:"destroy",value:function(){this.attached&&(this.detach(),this.attached=!1),this.updateRequested=!1}},{key:"updating",get:function(){return!this.attached||this.isUpdating()}},{key:"update",value:function(e){this.strategy.update(e).catch((function(e){Object(O.m)(e)||z.error(e)}))}},{key:"detach",value:function(){this.strategy.destroy(),this._bitmapView.removeAllChildren(),this.container.removeAllChildren()}},{key:"hitTest",value:function(e,t){var r=this.view.toMap(Object(k.a)(e,t));return Promise.resolve(new x.a({attributes:{},geometry:r,layer:this.layer}))}},{key:"attach",value:function(){var e=this,t=this.layer.version>=10,r=this.layer.version>=10.1?this.layer.imageMaxHeight:2048,i=this.layer.version>=10.1?this.layer.imageMaxWidth:2048;this._bitmapView=new U.a,this.strategy=new D.a({container:this._bitmapView,imageNormalizationSupported:t,imageMaxHeight:r,imageMaxWidth:i,fetchSource:this._fetchImage.bind(this),requestUpdate:function(){return e.requestUpdate()}}),this.attached=!0}},{key:"moveStart",value:function(){}},{key:"viewChange",value:function(){}},{key:"moveEnd",value:function(){}},{key:"install",value:function(e){this.container.addChild(this._bitmapView),e.addChild(this.container)}},{key:"uninstall",value:function(e){this.container.removeChild(this._bitmapView),e.removeChild(this.container)}},{key:"redraw",value:function(){var e=this;this.strategy.updateExports((function(t){t.source instanceof HTMLImageElement?t.requestRender():e.layer.applyRenderer({pixelBlock:t.source.pixelBlock}).then((function(r){var i=t.source;i.pixelBlock=r.pixelBlock,i.filter=function(t){return e.layer.applyFilter(t)},e.container.requestRender()}))}))}},{key:"requestUpdate",value:function(){this.updateRequested||(this.updateRequested=!0,this.view.requestUpdate())}},{key:"isUpdating",value:function(){return this.strategy.updating||this.updateRequested}},{key:"getPixelData",value:function(){if(this.updating)return null;var e=this.strategy.bitmaps;if(1===e.length&&e[0].source)return{extent:e[0].source.extent,pixelBlock:e[0].source.originalPixelBlock};if(e.length>1){var t=this.view.extent,r=e.map((function(e){return e.source})).filter((function(e){return e.extent&&e.extent.intersects(t)})).map((function(e){return{extent:e.extent,pixelBlock:e.originalPixelBlock}})),i=Object(E.k)(r,t);return i?{extent:i.extent,pixelBlock:i.pixelBlock}:null}return null}},{key:"_fetchImage",value:function(e,t,r,i){var n=this;return(i=i||{}).timeExtent=this.timeExtent,i.requestAsImageElement=!0,this.layer.fetchImage(e,t,r,i).then((function(e){return e.imageElement?e.imageElement:n.layer.applyRenderer(e.pixelData,{signal:i.signal}).then((function(t){var r=new L.a(t.pixelBlock,t.extent.clone(),e.pixelData.pixelBlock);return r.filter=function(e){return n.layer.applyFilter(e)},r}))}))}}]),r}(b.a);Object(f.a)([Object(p.b)()],J.prototype,"attached",void 0),Object(f.a)([Object(p.b)()],J.prototype,"container",void 0),Object(f.a)([Object(p.b)()],J.prototype,"layer",void 0),Object(f.a)([Object(p.b)()],J.prototype,"strategy",void 0),Object(f.a)([Object(p.b)()],J.prototype,"timeExtent",void 0),Object(f.a)([Object(p.b)()],J.prototype,"view",void 0),Object(f.a)([Object(p.b)()],J.prototype,"updateRequested",void 0),Object(f.a)([Object(p.b)()],J.prototype,"updating",null),Object(f.a)([Object(j.a)({imagery:"Imagery"})],J.prototype,"type",void 0);var V=J=Object(f.a)([Object(v.a)("esri.views.2d.layers.imagery.ImageryView2D")],J),X=r("4Mpa"),H=r("Mp7X"),q=r("OTJA"),G=r("NRoO"),W=r("hdDo"),Y=r("eTpk");function Z(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,i=Object(l.a)(e);if(t){var n=Object(l.a)(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return Object(s.a)(this,r)}}var Q=function(e){var t=function(e){Object(o.a)(s,e);var t,r=Z(s);function s(){var e;return Object(n.a)(this,s),(e=r.apply(this,arguments)).view=null,e}return Object(a.a)(s,[{key:"fetchPopupFeatures",value:(t=Object(i.a)(u.a.mark((function e(t,r){var i,n,a,o,s,l,c,f,h,p,m;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.layer,t){e.next=3;break}throw new H.a("imagerylayerview:fetchPopupFeatures","Nothing to fetch without area",{layer:i});case 3:if(n=i.popupEnabled,a=Object(Y.a)(i,r),n&&Object(w.i)(a)){e.next=6;break}throw new H.a("imagerylayerview:fetchPopupFeatures","Missing required popupTemplate or popupEnabled",{popupEnabled:n,popupTemplate:a});case 6:return e.next=8,a.getRequiredFields();case 8:return o=e.sent,(s=new W.a).timeExtent=this.timeExtent,s.geometry=t,s.outFields=o,s.outSpatialReference=t.spatialReference,l=this.view.resolution,c="2d"===this.view.type?new q.a(l,l,this.view.spatialReference):new q.a(.5*l,.5*l,this.view.spatialReference),f=a.layerOptions||{returnTopmostRaster:!0,showNoDataRecords:!1},h=f.returnTopmostRaster,p=f.showNoDataRecords,m={returnDomainValues:!0,returnTopmostRaster:h,pixelSize:c,showNoDataRecords:p,signal:Object(w.i)(r)?r.signal:null},e.abrupt("return",i.queryVisibleRasters(s,m).then((function(e){return e})));case 13:case"end":return e.stop()}}),e,this)}))),function(e,r){return t.apply(this,arguments)})},{key:"canResume",value:function(){var e;return!(!Object(X.a)(Object(l.a)(s.prototype),"canResume",this).call(this)||null!=(e=this.timeExtent)&&e.isEmpty)}}]),s}(e);return Object(f.a)([Object(p.b)()],t.prototype,"layer",void 0),Object(f.a)([Object(p.b)()],t.prototype,"suspended",void 0),Object(f.a)([Object(p.b)(G.a)],t.prototype,"timeExtent",void 0),Object(f.a)([Object(p.b)()],t.prototype,"view",void 0),t=Object(f.a)([Object(v.a)("esri.views.layers.ImageryLayerView")],t)},K=r("bPf0"),$=r("TRFF");function ee(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,i=Object(l.a)(e);if(t){var n=Object(l.a)(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return Object(s.a)(this,r)}}var te=function(e){Object(o.a)(s,e);var t,r=ee(s);function s(){var e;return Object(n.a)(this,s),(e=r.apply(this,arguments))._exportImageVersion=-1,e}return Object(a.a)(s,[{key:"initialize",value:function(){var e=this;this.handles.add(Object(h.a)(this,["layer.blendMode"],(function(t){e.subview&&(e.subview.container.blendMode=t)}),!0))}},{key:"pixelData",get:function(){return this.updating?null:this.subview.getPixelData()}},{key:"updating",get:function(){return!(this.subview&&!this.subview.updating)}},{key:"hitTest",value:function(e,t){return this.suspended||!this.subview?Promise.resolve(null):this.subview.hitTest(e,t)}},{key:"update",value:function(e){var t;null==(t=this.subview)||t.update(e)}},{key:"attach",value:function(){var e=this;this.layer.increaseRasterJobHandlerUsage(),this._setSubView(),this.handles.add([Object(h.a)(this,"layer.exportImageServiceParameters.version",(function(t){e._exportImageVersion!==t&&(e._exportImageVersion=t,e.requestUpdate())})),this.watch("timeExtent",(function(){e.subview.timeExtent=e.timeExtent,e.requestUpdate()})),this.layer.on("redraw",(function(){return e.subview.redraw()})),Object(h.d)(this.layer,"renderer",(function(){return e._setSubView()}))],"imagerylayerview-update")}},{key:"detach",value:function(){this.layer.decreaseRasterJobHandlerUsage(),this.subview.destroy(),this.handles.remove("imagerylayerview-update"),this._exportImageVersion=-1}},{key:"moveStart",value:function(){}},{key:"viewChange",value:function(){}},{key:"moveEnd",value:function(){this.requestUpdate()}},{key:"doRefresh",value:(t=Object(i.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.requestUpdate();case 1:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"isUpdating",value:function(){return!this.subview||!this.suspended&&this.subview.isUpdating()}},{key:"_setSubView",value:function(){var e,t,r,i="Imagery";"vector-field"===(null==(e=this.layer.renderer)?void 0:e.type)&&"lerc"===this.layer.format&&(i="Graphics"),this.subview&&this.subview.type===i||(null==(t=this.subview)||t.uninstall(this.container),null==(r=this.subview)||r.destroy(),this.subview="Imagery"===i?new V({layer:this.layer,view:this.view,timeExtent:this.timeExtent}):new T({layer:this.layer,view:this.view,timeExtent:this.timeExtent}),this.subview.attach(),this.subview.install(this.container),this.subview.container.blendMode=this.layer.blendMode),this.requestUpdate()}}]),s}(Q(Object($.a)(Object(d.a)(K.a))));Object(f.a)([Object(p.b)()],te.prototype,"pixelData",null),Object(f.a)([Object(p.b)({readOnly:!0})],te.prototype,"updating",null),Object(f.a)([Object(p.b)()],te.prototype,"subview",void 0);var re=te=Object(f.a)([Object(v.a)("esri.views.2d.layers.ImageryLayerView2D")],te);t.default=re},WBSb:function(e,t,r){"use strict";r.d(t,"a",(function(){return S})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return f})),r.d(t,"e",(function(){return u})),r.d(t,"f",(function(){return c})),r.d(t,"g",(function(){return l})),r.d(t,"h",(function(){return a})),r.d(t,"i",(function(){return p})),r.d(t,"j",(function(){return y})),r.d(t,"k",(function(){return v})),r.d(t,"l",(function(){return m})),r.d(t,"m",(function(){return x})),r.d(t,"n",(function(){return M})),r.d(t,"o",(function(){return h}));var i=r("sE9J"),n=function(e){return e&&"esri.layers.support.PixelBlock"===e.declaredClass&&e.pixels&&e.pixels.length>0};function a(e,t){if(null==t||!t.length||!n(e))return e;var r=e.pixels.length;return t&&t.some((function(e){return e>=r}))||1===r&&1===t.length&&0===t[0]?e:r!==t.length||t.some((function(e,t){return e!==t}))?new i.a({pixelType:e.pixelType,width:e.width,height:e.height,mask:e.mask,validPixelCount:e.validPixelCount,maskIsAlpha:e.maskIsAlpha,pixels:t.map((function(t){return e.pixels[t]})),statistics:e.statistics&&t.map((function(t){return e.statistics[t]}))}):e}function o(e){if(e){var t=e.colormap;if(t&&0!==t.length){var r=t.sort((function(e,t){return e[0]-t[0]})),i=0;r[0][0]<0&&(i=r[0][0]);var n,a=Math.max(256,r[r.length-1][0]-i+1),o=new Uint8Array(4*a),s=[],l=0,c=0,u=5===r[0].length;if(a>65536)return r.forEach((function(e){s[e[0]-i]=u?e.slice(1):e.slice(1).concat([255])})),{indexed2DColormap:s,offset:i,alphaSpecified:u};if(e.fillUnspecified)for(l=(n=r[c])[0]-i;l<a;l++)o[4*l]=n[1],o[4*l+1]=n[2],o[4*l+2]=n[3],o[4*l+3]=u?n[4]:255,l===n[0]-i&&(n=c===r.length-1?n:r[++c]);else for(l=0;l<r.length;l++)o[c=4*((n=r[l])[0]-i)]=n[1],o[c+1]=n[2],o[c+2]=n[3],o[c+3]=u?n[4]:255;return{indexedColormap:o,offset:i,alphaSpecified:u}}}}function s(e,t){if(!n(e))return e;if(!t&&(t.indexedColormap||t.indexed2DColormap))return e;var r=e.clone(),i=r.pixels,a=r.mask,o=r.width*r.height;if(1!==i.length)return e;var s,l=t.indexedColormap,c=t.indexed2DColormap,u=t.offset,f=t.alphaSpecified,h=l.length-1,p=0,m=i[0],v=new Uint8Array(m.length),d=new Uint8Array(m.length),y=new Uint8Array(m.length),x=0;if(l)if(a)for(p=0;p<o;p++)a[p]&&((x=4*(m[p]-u))<u||x>h?a[p]=0:(v[p]=l[x],d[p]=l[x+1],y[p]=l[x+2],a[p]=l[x+3]));else{for(a=new Uint8Array(o),p=0;p<o;p++)(x=4*(m[p]-u))<u||x>h?a[p]=0:(v[p]=l[x],d[p]=l[x+1],y[p]=l[x+2],a[p]=l[x+3]);r.mask=a}else if(a)for(p=0;p<o;p++)a[p]&&(s=c[m[p]],v[p]=s[0],d[p]=s[1],y[p]=s[2],a[p]=s[3]);else{for(a=new Uint8Array(o),p=0;p<o;p++)s=c[m[p]],v[p]=s[0],d[p]=s[1],y[p]=s[2],a[p]=s[3];r.mask=a}return r.pixels=[v,d,y],r.statistics=null,r.pixelType="u8",r.maskIsAlpha=f,r}function l(e){if(!n(e))return null;e.statistics||e.updateStatistics();var t,r,i,a,o,s,l,c,u,f,h,p,m,v,d=e.pixels,y=e.mask,x=e.pixelType,g=e.statistics,b=e.width*e.height,w=d.length,O=[],k=[],j=256;for(a=0;a<w;a++){if(s=new Uint32Array(j),c=d[a],"u8"===x)if(t=-.5,r=255.5,y)for(o=0;o<b;o++)y[o]&&s[c[o]]++;else for(o=0;o<b;o++)s[c[o]]++;else{if(t=g[a].minValue,i=((r=g[a].maxValue)-t)/j,l=new Uint32Array(257),y)for(o=0;o<b;o++)y[o]&&l[Math.floor((c[o]-t)/i)]++;else for(o=0;o<b;o++)l[Math.floor((c[o]-t)/i)]++;for(o=0;o<255;o++)s[o]=l[o];s[255]=l[255]+l[256]}for(O.push({min:t,max:r,size:j,counts:s}),u=0,f=0,m=0,o=0;o<j;o++)u+=s[o],f+=o*s[o];for(v=f/u,o=0;o<j;o++)m+=s[o]*Math.pow(o-v,2);h=(v+.5)*(i=(r-t)/j)+t,p=Math.sqrt(m/(u-1))*i,k.push({min:t,max:r,avg:h,stddev:p})}return{statistics:k,histograms:O}}function c(e){for(var t=[],r=0;r<e.length;r++){for(var i=e[r],n=i.min,a=i.max,o=i.size,s=i.counts,l=0,c=0,u=0;u<o;u++)l+=s[u],c+=u*s[u];for(var f=c/l,h=0,p=0;p<o;p++)h+=s[p]*Math.pow(p-f,2);var m=(a-n)/o,v=(f+.5)*m+n,d=Math.sqrt(h/(l-1))*m;t.push({min:n,max:a,avg:v,stddev:d})}return t}function u(e){var t=e.minCutOff,r=e.maxCutOff,i=e.gamma,n=e.pixelType,a=e.outMin||0,o=e.outMax||255;if(-1===["u8","u16","s8","s16"].indexOf(n))return null;var s,l,c=t.length,u=0;"s8"===n?u=-127:"s16"===n&&(u=-32767);var f=256;["u16","s16"].indexOf(n)>-1&&(f=65536);var h=[],p=[],m=o-a;for(s=0;s<c;s++)p[s]=r[s]-t[s],h[s]=m/(r[s]-t[s]);var v,d=i&&i.length>=c,y=[];if(d)for(s=0;s<c;s++)i[s]>1?i[s]>2?y[s]=6.5+Math.pow(i[s]-2,2.5):y[s]=6.5+100*Math.pow(2-i[s],4):y[s]=1;var x,g,b,w=[];if(d)for(s=0;s<c;s++){for(b=[],l=0;l<f;l++)v=((x=l+u)-t[s])/p[s],g=1,i[s]>1&&(g-=Math.pow(1/m,v*y[s])),x<r[s]&&x>t[s]?b[l]=Math.floor(g*m*Math.pow(v,1/i[s]))+a:x>=r[s]?b[l]=o:b[l]=a;w[s]=b}else for(s=0;s<c;s++){for(b=[],l=0;l<f;l++)(x=l+u)<=t[s]?b[l]=a:x>=r[s]?b[l]=o:b[l]=Math.floor((x-t[s])/p[s]*m)+a;w[s]=b}if(null!=e.contrastOffset){var O=function(e,t){var r,i,n=Math.min(Math.max(e,-100),100),a=Math.min(Math.max(t,-100),100),o=255,s=new Uint8Array(256);for(r=0;r<256;r++)n>0&&n<100?i=(200*r-25500+510*a)/(2*(100-n))+128:n<=0&&n>-100?i=(200*r-25500+510*a)*(100+n)/2e4+128:100===n?i=(i=200*r-25500+256*(100-n)+510*a)>0?o:0:-100===n&&(i=128),s[r]=i>o?o:i<0?0:i;return s}(e.contrastOffset,e.brightnessOffset);for(s=0;s<c;s++)for(b=w[s],l=0;l<f;l++)b[l]=O[b[l]]}return{lut:w,offset:u}}function f(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:256;t=Math.min(t,256);for(var r=e.size,i=e.counts,n=new Uint8Array(r),a=i.reduce((function(e,r){return e+r/t}),0),o=0,s=0,l=0,c=a,u=0;u<r;u++)if(l+=i[u],!(u<r-1&&l+i[u+1]<c)){for(;o<t-1&&c<l;)o++,c+=a;for(var f=s;f<=u;f++)n[f]=o;s=u+1}for(var h=s;h<r;h++)n[h]=t-1;return n}function h(e,t){if(!n(e))return null;var r,i,a,o,s,l=e.clone(),c=l.pixels,u=l.mask,f=t.minCutOff,h=t.maxCutOff,p=t.gamma,m=t.outMin||0,v=t.outMax||255,d=l.width*l.height,y=c.length,x=v-m,g=[],b=[];for(r=0;r<y;r++)b[r]=h[r]-f[r],g[r]=x/(h[r]-f[r]);var w=p&&p.length>=y,O=[];if(w)for(r=0;r<y;r++)p[r]>1?p[r]>2?O[r]=6.5+Math.pow(p[r]-2,2.5):O[r]=6.5+100*Math.pow(2-p[r],4):O[r]=1;if(w)if(null!=u){for(i=0;i<d;i++)if(u[i])for(r=0;r<y;r++)s=((a=c[r][i])-f[r])/b[r],o=1,p[r]>1&&(o-=Math.pow(1/x,s*O[r])),a<h[r]&&a>f[r]?c[r][i]=Math.floor(o*x*Math.pow(s,1/p[r]))+m:a>=h[r]?c[r][i]=v:c[r][i]=m}else for(i=0;i<d;i++)for(r=0;r<y;r++)s=((a=c[r][i])-f[r])/b[r],o=1,p[r]>1&&(o-=Math.pow(1/x,s*O[r])),a<h[r]&&a>f[r]?c[r][i]=Math.floor(o*x*Math.pow(s,1/p[r]))+m:a>=h[r]?c[r][i]=v:c[r][i]=m;else if(null!=u){for(i=0;i<d;i++)if(u[i])for(r=0;r<y;r++)(a=c[r][i])<h[r]&&a>f[r]?c[r][i]=Math.floor((a-f[r])/b[r]*x)+m:a>=h[r]?c[r][i]=v:c[r][i]=m}else for(i=0;i<d;i++)for(r=0;r<y;r++)(a=c[r][i])<h[r]&&a>f[r]?c[r][i]=Math.floor((a-f[r])/b[r]*x)+m:a>=h[r]?c[r][i]=v:c[r][i]=m;return l.pixelType="u8",l.updateStatistics(),l}function p(e,t){if(!n(e))return null;var r,a,o=e.pixels,s=e.mask,l=e.width*e.height,c=o.length,u=t.lut,f=t.offset;u&&1===u[0].length&&(u=o.map((function(){return u})));var h,p,m,v=[];if(f)if(null==s)for(r=0;r<c;r++){for(h=o[r],p=u[r],m=new Uint8Array(l),a=0;a<l;a++)m[a]=p[h[a]-f];v.push(m)}else for(r=0;r<c;r++){for(h=o[r],p=u[r],m=new Uint8Array(l),a=0;a<l;a++)s[a]&&(m[a]=p[h[a]-f]);v.push(m)}else if(null==s)for(r=0;r<c;r++){for(h=o[r],p=u[r],m=new Uint8Array(l),a=0;a<l;a++)m[a]=p[h[a]];v.push(m)}else for(r=0;r<c;r++){for(h=o[r],p=u[r],m=new Uint8Array(l),a=0;a<l;a++)s[a]&&(m[a]=p[h[a]]);v.push(m)}var d=new i.a({width:e.width,height:e.height,pixels:v,mask:s,pixelType:"u8"});return d.updateStatistics(),d}function m(e,t){if(!n(e))return null;var r,i,a,o,s,l,c=e.clone(),u=c.pixels,f=c.width*c.height,h=t.length,p=Math.floor(h/2),m=t[Math.floor(p)],v=u[0],d=!1,y=new Uint8Array(f),x=new Uint8Array(f),g=new Uint8Array(f),b=c.mask,w=4===t[0].mappedColor.length;for(b||((b=new Uint8Array(f)).fill(w?255:1),c.mask=b),s=0;s<f;s++)if(b[s]){for(r=v[s],d=!1,l=p,i=m,a=0,o=h-1;o-a>1;){if(r===i.value){d=!0;break}r>i.value?a=l:o=l,l=Math.floor((a+o)/2),i=t[Math.floor(l)]}d||(r===t[a].value?(i=t[a],d=!0):r===t[o].value?(i=t[o],d=!0):r<t[a].value?(d=!1,i=null):r>t[a].value&&(r<t[o].value?(i=t[a],d=!0):o===h-1?(d=!1,i=null):(i=t[o],d=!0))),d?(y[s]=i.mappedColor[0],x[s]=i.mappedColor[1],g[s]=i.mappedColor[2],b[s]=i.mappedColor[3]):y[s]=x[s]=g[s]=b[s]=0}return c.pixels=[y,x,g],c.mask=b,c.pixelType="u8",c.maskIsAlpha=w,c}function v(e,t){if(!e||0===e.length)return null;var r=e.filter((function(e){return e.pixelBlock}))[0];if(!r)return null;var i=(r.extent.xmax-r.extent.xmin)/r.pixelBlock.width,n=(r.extent.ymax-r.extent.ymin)/r.pixelBlock.height,a=.01*Math.min(i,n),o=e.sort((function(e,t){return Math.abs(e.extent.ymax-t.extent.ymax)>a?t.extent.ymax-e.extent.ymax:Math.abs(e.extent.xmin-t.extent.xmin)>a?e.extent.xmin-t.extent.xmin:0})),s=Math.min.apply(null,o.map((function(e){return e.extent.xmin}))),l=Math.min.apply(null,o.map((function(e){return e.extent.ymin}))),c=Math.max.apply(null,o.map((function(e){return e.extent.xmax}))),u=Math.max.apply(null,o.map((function(e){return e.extent.ymax}))),f={x:Math.round((t.xmin-s)/i),y:Math.round((u-t.ymax)/n)},h={width:Math.round((c-s)/i),height:Math.round((u-l)/n)},p={width:Math.round((t.xmax-t.xmin)/i),height:Math.round((t.ymax-t.ymin)/n)};return Math.round(h.width/r.pixelBlock.width)*Math.round(h.height/r.pixelBlock.height)!==o.length||f.x<0||f.y<0||h.width<p.width||h.height<p.height?null:{extent:t,pixelBlock:y(o.map((function(e){return e.pixelBlock})),h,f,p)}}function d(e,t,r,i,n,a){var o=r.block,s=o.width,l=o.height,c=r.offset,u=c.x,f=c.y,h=r.mosaic,p=h.width,m=function(e,t,r,i,n,a,o,s){return{xmin:n<=r*e?0:n<r*e+e?n-r*e:e,ymin:a<=i*t?0:a<i*t+t?a-i*t:t,xmax:n+o<=r*e?0:n+o<r*e+e?n+o-r*e:e,ymax:a+s<=i*t?0:a+s<i*t+t?a+s-i*t:t}}(s,l,i,n,u,f,p,h.height),v=0,d=0;if(a){var y=a.hasGCSSShiftTransform?360:a.halfWorldWidth,x=s*a.resolutionX,g=a.startX+i*x;g<y&&g+x>y?d=a.rightPadding:g>=y&&(v=a.leftMargin-a.rightPadding,d=0)}if(m.xmax-=d,"number"!=typeof t)for(var b=m.ymin;b<m.ymax;b++)for(var w=(n*l+b-f)*p+(i*s-u)+v,O=b*s,k=m.xmin;k<m.xmax;k++)e[w+k]=t[O+k];else for(var j=m.ymin;j<m.ymax;j++)for(var M=(n*l+j-f)*p+(i*s-u)+v,S=m.xmin;S<m.xmax;S++)e[M+S]=t}function y(e,t,r,a,o){var s=e.filter((function(e){return n(e)}))[0];if(null==s)return null;for(var l,c,u=a?a.width:t.width,f=a?a.height:t.height,h=s.width,p=s.height,m=t.width/h,v=t.height/p,y={offset:r||{x:0,y:0},mosaic:a||t,block:{width:h,height:p}},x=s.pixelType,g=i.a.getPixelArrayConstructor(x),b=s.pixels.length,w=[],O=0;O<b;O++){l=new g(u*f);for(var k=0;k<v;k++)for(var j=0;j<m;j++){var M=e[k*m+j];n(M)&&d(l,M.pixels[O],y,j,k,o)}w.push(l)}if(e.some((function(e){return null==e||e.mask&&e.mask.length>0}))){c=new Uint8Array(u*f);for(var S=0;S<v;S++)for(var R=0;R<m;R++){var P=e[S*m+R];d(c,(P?P.mask:null)||(P?1:0),y,R,S,o)}}var C=new i.a({width:u,height:f,pixels:w,pixelType:x,mask:c});return C.updateStatistics(),C}function x(e,t,r){if(!n(e))return null;var i=e.width,a=e.height,o=t.x,s=t.y,l=r.width+o,c=r.height+s;if(o<0||s<0||l>i||c>a)return e;if(0===o&&0===s&&l===i&&c===a)return e;e.mask||(e.mask=new Uint8Array(i*a));for(var u=e.mask,f=0;f<a;f++)for(var h=f*i,p=0;p<i;p++)u[h+p]=f<s||f>=c||p<o||p>=l?0:1;return e.updateStatistics(),e}function g(e){if(!n(e))return null;for(var t=e.clone(),r=e.width,i=e.height,a=e.pixels,o=e.mask,s=a[0],l=t.pixels[0],c=2;c<i-1;c++){for(var u=new Map,f=c-2;f<c+2;f++)for(var h=0;h<4;h++){var p=f*r+h;O(u,s[p],o?o[p]:1)}l[c*r]=b(u),l[c*r+1]=l[c*r+2]=l[c*r];for(var m=3;m<r-1;m++){var v=(c-2)*r+m+1;O(u,s[v],o?o[v]:1),O(u,s[v=(c-1)*r+m+1],o?o[v]:1),O(u,s[v=c*r+m+1],o?o[v]:1),O(u,s[v=(c+1)*r+m+1],o?o[v]:1),w(u,s[v=(c-2)*r+m-3],o?o[v]:1),w(u,s[v=(c-1)*r+m-3],o?o[v]:1),w(u,s[v=c*r+m-3],o?o[v]:1),w(u,s[v=(c+1)*r+m-3],o?o[v]:1),l[c*r+m]=b(u)}l[c*r+m+1]=l[c*r+m]}for(var d=0;d<r;d++)l[d]=l[r+d]=l[2*r+d],l[(i-1)*r+d]=l[(i-2)*r+d];return t.updateStatistics(),t}function b(e){if(0===e.size)return 0;for(var t=0,r=-1,i=0,n=e.keys(),a=n.next();!a.done;)(i=e.get(a.value))>t&&(r=a.value,t=i),a=n.next();return r}function w(e,t,r){if(0!==r){var i=e.get(t);1===i?e.delete(t):e.set(t,i-1)}}function O(e,t,r){0!==r&&e.set(t,e.has(t)?e.get(t)+1:1)}function k(e,t,r){var a=t.x,o=t.y,s=r.width,l=r.height;if(0===a&&0===o&&l===e.height&&s===e.width)return e;var c=e.width,u=e.height,f=Math.max(0,o),h=Math.max(0,a),p=Math.min(a+s,c),m=Math.min(o+l,u);if(p<0||m<0||!n(e))return null;a=Math.max(0,-a),o=Math.max(0,-o);for(var v=e.pixels,d=e.mask,y=s*l,x=v.length,g=[],b=0;b<x;b++){for(var w=v[b],O=i.a.createEmptyBand(e.pixelType,y),k=f;k<m;k++)for(var j=k*c,M=(k+o-f)*s+a,S=h;S<p;S++)O[M++]=w[j+S];g.push(O)}for(var R=new Uint8Array(y),P=f;P<m;P++)for(var C=P*c,A=(P+o-f)*s+a,N=h;N<p;N++)R[A++]=d?d[C+N]:1;var I=new i.a({width:r.width,height:r.height,pixelType:e.pixelType,pixels:g,mask:R});return I.updateStatistics(),I}function j(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!n(e))return null;for(var r=e.pixels,a=e.width,o=e.height,s=e.mask,l=e.pixelType,c=[],u=Math.round(a/2),f=Math.round(o/2),h=o-1,p=a-1,m=0;m<r.length;m++){for(var v=r[m],d=i.a.createEmptyBand(l,u*f),y=0,x=0;x<o;x+=2)for(var g=0;g<a;g+=2){var b=v[x*a+g];if(t){var w=g===p?b:v[x*a+g+1],O=x===h?b:v[x*a+g+a],k=g===p?O:x===h?w:v[x*a+g+a+1];d[y++]=(b+w+O+k)/4}else d[y++]=b}c.push(d)}var j=null;if(s){j=new Uint8Array(u*f);for(var M=0,S=0;S<o;S+=2)for(var R=0;R<a;R+=2){var P=s[S*a+R];if(t){var C=R===p?P:s[S*a+R+1],A=S===h?P:s[S*a+R+a],N=R===p?A:S===h?C:s[S*a+R+a+1];j[M++]=P*C*A*N?1:0}else j[M++]=P}}return new i.a({width:u,height:f,pixelType:l,pixels:c,mask:j})}function M(e,t,r){if(!n(e))return null;for(var i=t.width,a=t.height,o=e.width,s=e.height,l=new Map,c={x:0,y:0},u=null==r?1:1+r,f=e,h=0;h<u;h++){for(var p=Math.ceil(o/i),m=Math.ceil(s/a),v=0;v<m;v++){c.y=v*a;for(var d=0;d<p;d++){c.x=d*i;var y=k(f,c,t);l.set("".concat(h,"/").concat(v,"/").concat(d),y)}}h<u-1&&(f=j(f)),o=Math.round(o/2),s=Math.round(s/2)}return l}function S(e,t,r,a){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"nearest";if(!n(e))return null;"majority"===o&&(e=g(e));for(var s,l,c,u,f,h,p,m=e,v=m.pixels,d=m.mask,y=m.pixelType,x=e.width,b=e.height,w=i.a.getPixelArrayConstructor(y),O=v.length,k=t.width,j=t.height,M=a.cols,S=a.rows,R=Math.ceil(k/M),P=Math.ceil(j/S),C=!1,A=0;A<r.length;A+=3)-1===r[A]&&-1===r[A+1]&&-1===r[A+2]&&(C=!0);for(var N,I,B=new Float32Array(k*j),_=new Float32Array(k*j),T=0,E="majority"===o?0:.5,U=0;U<P;U++)for(var L=0;L<R;L++){l=r[s=12*(U*R+L)],c=r[s+1],u=r[s+2],f=r[s+3],h=r[s+4],p=r[s+5];for(var D=0;D<S;D++){T=(U*S+D)*k+L*M,I=(D+.5)/S;for(var F=0;F<D;F++)N=(F+.5)/M,B[T+F]=Math.round((l*N+c*I+u)*x-E),_[T+F]=Math.round((f*N+h*I+p)*b-E)}l=r[s+=6],c=r[s+1],u=r[s+2],f=r[s+3],h=r[s+4],p=r[s+5];for(var z=0;z<S;z++){T=(U*S+z)*k+L*M,I=(z+.5)/S;for(var J=z;J<M;J++)N=(J+.5)/M,B[T+J]=Math.round((l*N+c*I+u)*x-E),_[T+J]=Math.round((f*N+h*I+p)*b-E)}}for(var V,X=function(e,t){for(var r=0;r<j;r++){s=r*k;for(var i=0;i<k;i++)B[s]<0||_[s]<0?e[s]=0:e[s]=t[B[s]+_[s]*x],s++}},H=[],q=0;q<O;q++)X(V=new w(k*j),v[q]),H.push(V);var G=new i.a({width:k,height:j,pixelType:y,pixels:H});if(d)G.mask=new Uint8Array(k*j),X(G.mask,d);else if(C){G.mask=new Uint8Array(k*j);for(var W=0;W<k*j;W++)G.mask[W]=B[W]<0||_[W]<0?0:1}return G.updateStatistics(),G}},Zw7s:function(e,t,r){"use strict";var i=r("hisu"),n=r("yBJb"),a=function(){function e(t,r,n){Object(i.a)(this,e),this.pixelBlock=t,this.extent=r,this.originalPixelBlock=n}return Object(n.a)(e,[{key:"width",get:function(){return this.pixelBlock?this.pixelBlock.width:0}},{key:"height",get:function(){return this.pixelBlock?this.pixelBlock.height:0}},{key:"render",value:function(e){var t=this.pixelBlock;if(t){var r=this.filter({pixelBlock:t}),i=r.pixelBlock.getAsRGBA(),n=e.createImageData(r.pixelBlock.width,r.pixelBlock.height);n.data.set(i),e.putImageData(n,0,0)}}},{key:"getRenderedRasterPixels",value:function(){var e=this.filter({pixelBlock:this.pixelBlock});return{width:e.pixelBlock.width,height:e.pixelBlock.height,renderedRasterPixels:new Uint8Array(e.pixelBlock.getAsRGBA().buffer)}}}]),e}();t.a=a},hQel:function(e,t,r){"use strict";r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return f})),r.d(t,"c",(function(){return c})),r.d(t,"d",(function(){return h}));var i=r("aNYv"),n=r("aic5"),a=r("zEHB"),o=r("vlc1");function s(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function c(e){if(!e)return null;switch(e.type){case"CIMPointSymbol":var t=e.symbolLayers;return t&&1===t.length?c(t[0]):null;case"CIMVectorMarker":var r=e.markerGraphics;if(!r||1!==r.length)return null;var i=r[0];if(!i)return null;var n=i.geometry;if(!n)return null;var a=i.symbol;return!a||"CIMPolygonSymbol"!==a.type&&"CIMLineSymbol"!==a.type?null:{geom:n,asFill:"CIMPolygonSymbol"===a.type};case"sdf":return{geom:e.geom,asFill:e.asFill}}return null}function u(e){var t,r=1/0,i=-1/0,n=1/0,a=-1/0,o=s(e);try{for(o.s();!(t=o.n()).done;){var l,c=s(t.value);try{for(c.s();!(l=c.n()).done;){var u=l.value;u[0]<r&&(r=u[0]),u[0]>i&&(i=u[0]),u[1]<n&&(n=u[1]),u[1]>a&&(a=u[1])}}catch(f){c.e(f)}finally{c.f()}}}catch(f){o.e(f)}finally{o.f()}return[r,n,i,a]}function f(e){return e?e.rings?u(e.rings):e.paths?u(e.paths):Object(n.d)(e)?[e.xmin,e.ymin,e.xmax,e.ymax]:null:null}function h(e,t,r,n,a){var o=Object(i.a)(e,4),s=o[0],l=o[1],c=o[2],u=o[3];if(c<s||u<l)return[0,0,0];var f=c-s,h=u-l,p=Math.floor(31.5),m=(128-2*(p+1))/Math.max(f,h),v=Math.round(f*m)+2*p,d=Math.round(h*m)+2*p,y=1;t&&(y=d/m/(t.ymax-t.ymin));var x=0,g=0;if(n)if(a){if(t&&r&&t.ymax-t.ymin>0){var b=(t.xmax-t.xmin)/(t.ymax-t.ymin);x=n.x/(r*b),g=n.y/r}}else x=n.x,g=n.y;return x=.5*(t.xmax+t.xmin)+x*(t.xmax-t.xmin),g=.5*(t.ymax+t.ymin)+g*(t.ymax-t.ymin),x-=s,g-=l,x*=m,g*=m,[y,(x+=p)/v-.5,-((g+=p)/d-.5)]}function p(e){var t,r=function(e){return e?e.rings?e.rings:e.paths?e.paths:void 0!==e.xmin&&void 0!==e.ymin&&void 0!==e.xmax&&void 0!==e.ymax?[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]]:null:null}(e.geom),n=function(e){var t,r=1/0,i=-1/0,n=1/0,a=-1/0,l=s(e);try{for(l.s();!(t=l.n()).done;){var c,u=s(t.value);try{for(u.s();!(c=u.n()).done;){var f=c.value;f[0]<r&&(r=f[0]),f[0]>i&&(i=f[0]),f[1]<n&&(n=f[1]),f[1]>a&&(a=f[1])}}catch(h){u.e(h)}finally{u.f()}}}catch(h){l.e(h)}finally{l.f()}return new o.a(r,n,i-r,a-n)}(r),a=Math.floor(31.5),l=(128-2*(a+1))/Math.max(n.width,n.height),c=Math.round(n.width*l)+2*a,u=Math.round(n.height*l)+2*a,f=[],h=s(r);try{for(h.s();!(t=h.n()).done;){var p=t.value;if(p&&p.length>1){var v,d=[],y=s(p);try{for(y.s();!(v=y.n()).done;){var x=v.value,g=Object(i.a)(x,2),b=g[0],w=g[1];b-=n.x,w-=n.y,b*=l,w*=l,b+=a-.5,w+=a-.5,d.push([b,w])}}catch(j){y.e(j)}finally{y.f()}if(e.asFill){var O=d.length-1;d[0][0]===d[O][0]&&d[0][1]===d[O][1]||d.push(d[0])}f.push(d)}}}catch(j){h.e(j)}finally{h.f()}var k=function(e,t,r,i){for(var n=t*r,a=new Array(n),o=i*i+1,l=0;l<n;++l)a[l]=o;var c,u=s(e);try{for(u.s();!(c=u.n()).done;)for(var f=c.value,h=f.length,p=1;p<h;++p){var m=f[p-1],v=f[p],d=void 0,y=void 0,x=void 0,g=void 0;m[0]<v[0]?(d=m[0],y=v[0]):(d=v[0],y=m[0]),m[1]<v[1]?(x=m[1],g=v[1]):(x=v[1],g=m[1]);var b=Math.floor(d)-i,w=Math.floor(y)+i,O=Math.floor(x)-i,k=Math.floor(g)+i;b<0&&(b=0),w>t&&(w=t),O<0&&(O=0),k>r&&(k=r);for(var M=v[0]-m[0],S=v[1]-m[1],R=M*M+S*S,P=b;P<w;P++)for(var C=O;C<k;C++){var A=void 0,N=void 0,I=(P-m[0])*M+(C-m[1])*S;I<0?(A=m[0],N=m[1]):I>R?(A=v[0],N=v[1]):(I/=R,A=m[0]+I*M,N=m[1]+I*S);var B=(P-A)*(P-A)+(C-N)*(C-N),_=(r-C-1)*t+P;B<a[_]&&(a[_]=B)}}}catch(j){u.e(j)}finally{u.f()}for(var T=0;T<n;++T)a[T]=Math.sqrt(a[T]);return a}(f,c,u,a);return e.asFill&&function(e,t,r,i,n){var a,o=s(e);try{for(o.s();!(a=o.n()).done;)for(var l=a.value,c=l.length,u=1;u<c;++u){var f=l[u-1],h=l[u],p=void 0,m=void 0,v=void 0,d=void 0;f[0]<h[0]?(p=f[0],m=h[0]):(p=h[0],m=f[0]),f[1]<h[1]?(v=f[1],d=h[1]):(v=h[1],d=f[1]);var y=Math.floor(p),x=Math.floor(m)+1,g=Math.floor(v),b=Math.floor(d)+1;y<i&&(y=i),x>t-i&&(x=t-i),g<i&&(g=i),b>r-i&&(b=r-i);for(var w=g;w<b;++w)if(f[1]>w!=h[1]>w){for(var O=(r-w-1)*t,k=y;k<x;++k)k<(h[0]-f[0])*(w-f[1])/(h[1]-f[1])+f[0]&&(n[O+k]=-n[O+k]);for(var M=i;M<y;++M)n[O+M]=-n[O+M]}}}catch(j){o.e(j)}finally{o.f()}}(f,c,u,a,k),[m(k,a),c,u]}function m(e,t){for(var r=2*t,i=e.length,n=new Uint8Array(4*i),o=0;o<i;++o){var s=.5-e[o]/r;Object(a.a)(s,n,4*o)}return n}},lWwP:function(e,t,r){"use strict";r.d(t,"a",(function(){return T})),r.d(t,"b",(function(){return b})),r.d(t,"c",(function(){return I})),r.d(t,"d",(function(){return N})),r.d(t,"e",(function(){return A})),r.d(t,"f",(function(){return x})),r.d(t,"g",(function(){return M})),r.d(t,"h",(function(){return k})),r.d(t,"i",(function(){return w})),r.d(t,"j",(function(){return B})),r.d(t,"k",(function(){return _}));var i=r("aNYv"),n=r("eijD"),a=r("NthX"),o=r.n(a),s=(r("ZTBZ"),r("Mp7X")),l=r("7im+"),c=r("a1Tm"),u=r("B9Yk"),f=r("3p7a"),h=r("nd5+"),p=r("OTJA"),m=5e-4,v=function(e,t){var r=(e.isWGS84||e.isWebMercator)&&(t.isWGS84||t.isWebMercator);return!(e.equals(t)||r)},d=function(e,t){var r=(e[0]+e[4]+e[4*t.cols]+e[4*t.cols+4])/4,i=(e[1]+e[5]+e[4*t.rows+1]+e[4*t.rows+5])/4;return[Math.abs(r-e[2*t.rows+2]),Math.abs(i-e[2*t.rows+3])]},y={3395:20037508.342789244,3410:17334193.943686873,3832:3339584.723798206,3857:20037508.342788905,3975:17367530.445161372,4087:20037508.342789244,4088:20015108.787169147,6933:17367530.445161372,8858:7396237.374497803,8859:2465412.4581659334,32662:20037508.342789244,53001:20015086.79602057,53002:10007543.39801029,53003:20015086.79602057,53004:20015086.79602057,53016:14152803.599503474,53017:17333573.624304302,53025:7276828.3848298555,53031:10384677.558821043,53034:20015086.79602057,53036:7389443.187332862,53037:2463147.729110953,53079:20015114.352186374,53080:20015114.352186374,54001:20037508.342789244,54002:10018754.171394624,54003:20037508.342789244,54004:20037508.342789244,54016:14168658.027268292,54017:17367530.44516137,54025:7311399.09166516,54031:10396310.810074743,54034:20037508.342789244,54050:808820.9223376509,54053:1920897.3915568967,54079:20037508.342789244,54080:20037508.342789244,54099:13524439.768288724,54100:20037508.342789244,54101:20037508.342789244,102038:4297258.582585486,102299:5013965.117483125};function x(){return g.apply(this,arguments)}function g(){return(g=Object(n.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Object(u.f)()&&Object(u.g)()){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,Object(u.h)();case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(e,t,r){if(!v(e.spatialReference,t))return null;if(!Object(u.f)())throw new s.a("rasterprojectionhelper-projectResolution","projection engine is not loaded");return r?Object(u.d)(t,e.spatialReference,e):Object(u.d)(e.spatialReference,t,e)}function w(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(e.spatialReference.equals(t))return e;var n=v(e.spatialReference,t);if(n&&!Object(u.f)())throw new s.a("rasterprojectionhelper-projectResolution","projection engine is not loaded");var a=r.center,o=new h.a({xmin:a.x-e.x/2,xmax:a.x+e.x/2,ymin:a.y-e.y/2,ymax:a.y+e.y/2,spatialReference:e.spatialReference}),l=n?Object(u.i)(o,t,i):Object(f.d)(o,t);return null==l?null:{x:l.xmax-l.xmin,y:l.ymax-l.ymin}}function O(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.01;return Object(c.d)(e)?t/Object(c.d)(e):0}function k(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=e.spatialReference;if(a.equals(t))return e;var o=v(a,t);if(o&&!Object(u.f)())throw new s.a("rasterprojectionhelper-projectResolution","projection engine is not loaded");var l=o?Object(u.i)(e,t,r):Object(f.d)(e,t);if(l&&n&&t.isGeographic){var c=P(a,!0),h=Object(i.a)(c,2),p=h[0],d=h[1],y=O(a);y&&null!=p&&null!=d&&(Math.abs(e.x-p)<y&&Math.abs(180-l.x)<m?l.x-=360:Math.abs(e.x-d)<y&&Math.abs(180+l.x)<m&&(l.x+=360))}return l}function j(e){var t=R(e[0].spatialReference);if(e.length<2||!Object(l.i)(t))return e[0];for(var r=e[0],i=r.xmin,n=r.xmax,a=r.ymin,o=r.ymax,s=1;s<e.length;s++){var c=e[s];n=c.xmax+t*s,a=Math.min(a,c.ymin),o=Math.max(o,c.ymax)}return new h.a({xmin:i,xmax:n,ymin:a,ymax:o,spatialReference:e[0].spatialReference})}function M(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(e.spatialReference.equals(t))return e;var n=A(e),a=R(e.spatialReference,!0);return Object(l.i)(a)&&0!==n?j(e.clone().normalize().map((function(e){return S(e,t,r,i)}))):S(e,t,r,i)}function S(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=e.spatialReference;if(a.equals(t))return e;var o=v(a,t);if(o&&!Object(u.f)())throw new s.a("rasterprojectionhelper-projectExtent","projection engine is not loaded");var l=o?Object(u.i)(e,t,r):Object(f.d)(e,t),c=P(a,!0),h=Object(i.a)(c,2),d=h[0],y=h[1];if(l&&n&&a.isWebMercator&&t.isGeographic&&null!=d&&null!=y){var x=.001,g=1e3;if(Math.abs(e.xmin-d)<x&&Math.abs(y-e.xmax)>g&&Math.abs(180-l.xmax)<m){l.xmin=-180;var b=[];b.push(new p.a(e.xmax,e.ymin,a)),b.push(new p.a(e.xmax,(e.ymin+e.ymax)/2,a)),b.push(new p.a(e.xmax,e.ymax,a));var w=b.map((function(e){return k(e,t,r)})).filter((function(e){return!isNaN(null==e?void 0:e.x)})).map((function(e){return e.x}));l.xmax=Math.max.apply(null,w)}if(Math.abs(e.xmax-y)<x&&Math.abs(d-e.xmin)>g&&Math.abs(180+l.xmin)<m){l.xmax=180;var j=[];j.push(new p.a(e.xmin,e.ymin,a)),j.push(new p.a(e.xmin,(e.ymin+e.ymax)/2,a)),j.push(new p.a(e.xmin,e.ymax,a));var M=j.map((function(e){return k(e,t,r)})).filter((function(e){return!isNaN(null==e?void 0:e.x)})).map((function(e){return e.x}));l.xmin=Math.min.apply(null,M)}}var S=P(t,!0),R=Object(i.a)(S,2);d=R[0],y=R[1];var C=O(t);return C&&null!=d&&null!=y&&(Math.abs(l.xmin-d)<C&&(l.xmin=d),Math.abs(l.xmax-y)<C&&(l.xmax=y)),l}function R(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=t?20037508.342787:20037508.342788905;return e.isWebMercator?2*r:e.wkid&&e.isGeographic?360:2*y[e.wkid]||null}function P(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=[],i=R(e,t);return Object(l.i)(i)&&(r.push(-i/2),r.push(i/2)),r}function C(e,t,r,i){var n=(e-t)/r;return n-Math.floor(n)!=0?n=Math.floor(n):i&&(n-=1),n}function A(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=R(e.spatialReference);if(!Object(l.i)(r))return 0;var i=t?0:-r/2;return C(e.xmax,i,r,!0)-C(e.xmin,i,r,!1)}function N(e){var t=e.storageInfo.origin.x,r=R(e.spatialReference,!0);if(!Object(l.i)(r))return{originX:t,halfWorldWidth:null,pyramidsInfo:null};for(var i=r/2,n=e.nativePixelSize,a=e.storageInfo,o=e.extent,s=a.maximumPyramidLevel,c=a.blockWidth,u=a.pyramidScalingFactor,f=n.x,h=[],p=Object(l.i)(e.transform)&&"gcs-shift"===e.transform.type,m=t+i,v=p?r-t:i-t,d=0;d<=s;d++){var y=(o.xmax-t)/f/c,x=y-Math.floor(y)==0?y:Math.ceil(y),g=(r/2-t)/f/c,b=g-Math.floor(g)==0?g:Math.ceil(g),w=Math.floor(m/f/c),O=Math.round(m/f)%c,k=(c-Math.round(v/f)%c)%c;h.push({resolutionX:f,blockWidth:c,datsetColumnCount:x,worldColumnCountFromOrigin:b,leftMargin:O,rightPadding:k,originColumnOffset:w}),f*=u}return{originX:t,halfWorldWidth:i,pyramidsInfo:h,hasGCSSShiftTransform:p}}function I(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[32,32];if(v(e.spatialReference,t.spatialReference)&&!Object(u.f)())throw new s.a("rasterprojectionhelper-projectResolution","projection engine is not loaded");if(!(e&&t&&r))return null;var c=e.xmin,f=e.ymin,h=e.xmax,m=e.ymax,y=e.spatialReference,x=t.spatialReference,g=R(x);a=a||"gcs-shift"===(null==n?void 0:n.type);for(var b,w={x:o[0]*r.x,y:o[1]*r.y},O={cols:Math.ceil((h-c)/w.x-.1)+1,rows:Math.ceil((m-f)/w.y-.1)+1},j=w.x,M=w.y,S=[],P=!1,C=0;C<O.cols;C++){for(var A=[],N=0;N<O.rows;N++){var I=k(new p.a({x:c+j*C,y:m-M*N,spatialReference:y}),x,i);n&&(I=n.inverseTransform(I)),A.push(I),C>0&&a&&I&&b[N]&&Object(l.i)(g)&&I.x<b[N].x&&(I.x+=g),I?(S.push((I.x-t.xmin)/(t.xmax-t.xmin)),S.push((t.ymax-I.y)/(t.ymax-t.ymin))):(S.push(NaN),S.push(NaN),P=!0)}b=A}for(var B=d(S,O),_=new Float32Array((O.cols-1)*(O.rows-1)*2*6),T=new Float32Array([-0,-1,1,-1,1,-0,1,-0,-0]),E=new Float32Array([-1,1,0,0,-1,1,1,0,0]),U=0;U<O.cols-1;U++){for(var L=0;L<O.rows-1;L++){for(var D=U*O.rows*2+2*L,F=S[D],z=S[D+1],J=S[D+2],V=S[D+3],X=S[D+=2*O.rows],H=S[D+1],q=S[D+2],G=S[D+3],W=0,Y=12*(L*(O.cols-1)+U),Z=0;Z<3;Z++)_[Y++]=T[W++]*F+T[W++]*J+T[W++]*q;W=0;for(var Q=0;Q<3;Q++)_[Y++]=T[W++]*z+T[W++]*V+T[W++]*G;W=0;for(var K=0;K<3;K++)_[Y++]=E[W++]*F+E[W++]*X+E[W++]*q;W=0;for(var $=0;$<3;$++)_[Y++]=E[W++]*z+E[W++]*H+E[W++]*G}if(P)for(var ee=0;ee<_.length;ee++)isNaN(_[ee])&&(_[ee]=-1)}return{offsets:S,error:B,coefficients:_,spacing:o,size:[O.cols-1,O.rows-1]}}function B(e){var t=e.clone().normalize();return 1===t.length?t[0]:j(t)}function _(e,t,r){var i,n=t.storageInfo,a=t.pixelSize,o=!1,s=n.pyramidResolutions;if(Object(l.i)(s)&&s.length){var c=(e.x+e.y)/2,u=s[s.length-1],f=(u.x+u.y)/2,h=(a.x+a.y)/2;if(c<=h)i=0;else if(c>=f)i=s.length,o=c/f>8;else for(var m,v=h,d=1;d<=s.length;d++){if(c<=(m=(s[d-1].x+s[d-1].y)/2)){c===m?i=d:"down"===r?(i=d-1,o=c/v>8):i="up"===r||c-v>m-c||c/v>2?d:d-1;break}v=m}var y=0===i?a:s[i-1];return{pyramidLevel:i,pyramidResolution:new p.a({x:y.x,y:y.y,spatialReference:t.spatialReference}),excessiveReading:o}}var x=Math.log(e.x/a.x)/Math.LN2,g=Math.log(e.y/a.y)/Math.LN2,b=t.storageInfo.maximumPyramidLevel||0;(i="down"===r?Math.floor(Math.min(x,g)):"up"===r?Math.ceil(Math.max(x,g)):Math.round((x+g)/2))<0?i=0:i>b&&(o=i>b+3,i=b);var w=Math.pow(2,i);return{pyramidLevel:i,pyramidResolution:new p.a({x:w*t.nativePixelSize.x,y:w*t.nativePixelSize.y,spatialReference:t.spatialReference}),excessiveReading:o}}function T(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:512,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],n=e.extent,a=e.spatialReference,o=e.pixelSize,s=w(new p.a({x:o.x,y:o.y,spatialReference:a}),t,n);if(null==s)return{projectedPixelSize:null,scales:null,srcResolutions:null,isCustomTilingScheme:!1};var l=(s.x+s.y)/2,u=Object(c.d)(t),f=l*u*96*39.37,h=t.isGeographic?256/r*295828763.7958547:256/r*591657527.591555,m=!1,v=M(n,t);i&&(t.isGeographic||t.isWebMercator)&&(m=v.xmin*v.xmax<0);var d,y=f,x=1.001;if(m){y=h;var g=t.isGeographic?1341104507446289e-21:.29858214164761665,b=g*(96*u*39.37),O=t.isGeographic?4326:3857;(d=w(new p.a({x:g,y:g,spatialReference:{wkid:O}}),a,v)).x*=y/b,d.y*=y/b}else{d={x:o.x,y:o.y};for(var k=Math.ceil(Math.log(Math.min(e.width,e.height)/32)/Math.LN2),j=0;y<h*(x/2)&&j<k;)j++,y*=2,d.x*=2,d.y*=2;Math.max(y,h)/Math.min(y,h)<=x&&(y=h)}for(var S=[y],R=[{x:d.x,y:d.y}],P=70.5310735,C=Math.min(P,f)/x;y>=C;)y/=2,d.x/=2,d.y/=2,S.push(y),R.push({x:d.x,y:d.y});return{projectedPixelSize:s,scales:S,srcResolutions:R,isCustomTilingScheme:!m}}},sE9J:function(e,t,r){"use strict";var i,n=r("aNYv"),a=r("hisu"),o=r("yBJb"),s=r("CHlC"),l=r("kMo5"),c=r("P+uj"),u=r("dQW7"),f=(r("J4Pc"),r("Mp7X")),h=r("0n+b"),p=r("0fJP"),m=r("TM+E"),v=r("7im+"),d=r("xAIp"),y=r("gljZ"),x=r("iaHD");function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,i=Object(c.a)(e);if(t){var n=Object(c.a)(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return Object(l.a)(this,r)}}var b=m.a.getLogger("esri.layers.support.PixelBlock"),w=i=function(e){Object(s.a)(r,e);var t=g(r);function r(e){var i;return Object(a.a)(this,r),(i=t.call(this,e)).width=null,i.height=null,i.pixelType="f32",i.validPixelCount=null,i.mask=null,i.maskIsAlpha=!1,i.pixels=null,i.statistics=null,i}return Object(o.a)(r,[{key:"castPixelType",value:function(e){if(!e)return"f32";var t=e.toLowerCase();return["u1","u2","u4"].indexOf(t)>-1?t="u8":-1===["unknown","u8","s8","u16","s16","u32","s32","f32","f64"].indexOf(t)&&(t="f32"),t}},{key:"getPlaneCount",value:function(){return this.pixels&&this.pixels.length}},{key:"addData",value:function(e){if(!e.pixels||e.pixels.length!==this.width*this.height)throw new f.a("pixelblock:invalid-or-missing-pixels","add data requires valid pixels array that has same length defined by pixel block width * height");this.pixels||(this.pixels=[]),this.statistics||(this.statistics=[]),this.pixels.push(e.pixels),this.statistics.push(e.statistics||{minValue:null,maxValue:null})}},{key:"getAsRGBA",value:function(){var e=new ArrayBuffer(this.width*this.height*4);switch(this.pixelType){case"s8":case"s16":case"u16":case"s32":case"u32":case"f32":case"f64":this._fillFromNon8Bit(e);break;default:this._fillFrom8Bit(e)}return new Uint8ClampedArray(e)}},{key:"getAsRGBAFloat",value:function(){var e=new Float32Array(this.width*this.height*4);return this._fillFrom32Bit(e),e}},{key:"updateStatistics",value:function(){var e=this;this.statistics=this.pixels.map((function(t){return e._calculateBandStatistics(t,e.mask)}));var t=this.mask,r=0;if(t)for(var i=0;i<t.length;i++)t[i]&&r++;else r=this.width*this.height;this.validPixelCount=r}},{key:"clamp",value:function(e){if(e&&"f64"!==e&&"f32"!==e){var t;switch(e){case"u8":t=[0,255];break;case"u16":t=[0,65535];break;case"u32":t=[0,4294967295];break;case"s8":t=[-128,127];break;case"s16":t=[-32768,32767];break;case"s32":t=[-2147483648,2147483647];break;default:t=[-34e38,34e38]}for(var r,a,o,s=t,l=Object(n.a)(s,2),c=l[0],u=l[1],f=this.pixels,h=this.width*this.height,p=f.length,m=[],v=0;v<p;v++){o=i.createEmptyBand(e,h),r=f[v];for(var d=0;d<h;d++)a=r[d],o[d]=a>u?u:a<c?c:a;m.push(o)}this.pixels=m,this.pixelType=e}}},{key:"extractBands",value:function(e){var t=this;if(Object(v.h)(e)||0===e.length||null==this.pixels||0===this.pixels.length)return this;var r=this.pixels.length,n=e.some((function(e){return e>=t.pixels.length})),a=r===e.length&&!e.some((function(e,t){return e!==t}));return n||a?this:new i({pixelType:this.pixelType,width:this.width,height:this.height,mask:this.mask,validPixelCount:this.validPixelCount,maskIsAlpha:this.maskIsAlpha,pixels:e.map((function(e){return t.pixels[e]})),statistics:this.statistics&&e.map((function(e){return t.statistics[e]}))})}},{key:"clone",value:function(){var e,t=new i({width:this.width,height:this.height,pixelType:this.pixelType,maskIsAlpha:this.maskIsAlpha,validPixelCount:this.validPixelCount});this.mask&&(this.mask instanceof Uint8Array?t.mask=new Uint8Array(this.mask):t.mask=this.mask.slice(0));var r=i.getPixelArrayConstructor(this.pixelType);if(this.pixels&&this.pixels.length>0){t.pixels=[];var n=this.pixels[0].slice;for(e=0;e<this.pixels.length;e++)t.pixels[e]=n?this.pixels[e].slice(0,this.pixels[e].length):new r(this.pixels[e])}if(this.statistics)for(t.statistics=[],e=0;e<this.statistics.length;e++)t.statistics[e]=Object(p.a)(this.statistics[e]);return t}},{key:"_fillFrom8Bit",value:function(e){var t=this.mask,r=this.maskIsAlpha,i=this.pixels;if(e&&i&&i.length){var n,a,o,s;n=a=o=i[0],i.length>=3?(a=i[1],o=i[2]):2===i.length&&(a=i[1]);var l=new Uint32Array(e),c=this.width*this.height;if(n.length===c)if(t&&t.length===c)if(r)for(s=0;s<c;s++)t[s]&&(l[s]=t[s]<<24|o[s]<<16|a[s]<<8|n[s]);else for(s=0;s<c;s++)t[s]&&(l[s]=255<<24|o[s]<<16|a[s]<<8|n[s]);else for(s=0;s<c;s++)l[s]=255<<24|o[s]<<16|a[s]<<8|n[s];else b.error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.")}else b.error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.")}},{key:"_fillFromNon8Bit",value:function(e){var t=this.pixels,r=this.mask,i=this.statistics;if(e&&t&&t.length){var n=this.pixelType,a=1,o=0;if(i&&i.length>0)o=i.map((function(e){return e.minValue})).reduce((function(e,t){return Math.min(e,t)})),a=255/i.map((function(e){return e.maxValue-e.minValue})).reduce((function(e,t){return Math.max(e,t)}));else{var s=255;"s8"===n?(o=-128,s=127):"u16"===n?s=65535:"s16"===n?(o=-32768,s=32767):"u32"===n?s=4294967295:"s32"===n?(o=-2147483648,s=2147483647):"f32"===n?(o=-34e38,s=34e38):"f64"===n&&(o=-Number.MAX_VALUE,s=Number.MAX_VALUE),a=255/(s-o)}var l,c,u,f,h,p=new Uint32Array(e),m=this.width*this.height;if((l=c=u=t[0]).length!==m)return b.error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");if(t.length>=2)if(c=t[1],t.length>=3&&(u=t[2]),r&&r.length===m)for(f=0;f<m;f++)r[f]&&(p[f]=255<<24|(u[f]-o)*a<<16|(c[f]-o)*a<<8|(l[f]-o)*a);else for(f=0;f<m;f++)p[f]=255<<24|(u[f]-o)*a<<16|(c[f]-o)*a<<8|(l[f]-o)*a;else if(r&&r.length===m)for(f=0;f<m;f++)h=(l[f]-o)*a,r[f]&&(p[f]=255<<24|h<<16|h<<8|h);else for(f=0;f<m;f++)h=(l[f]-o)*a,p[f]=255<<24|h<<16|h<<8|h}else b.error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.")}},{key:"_fillFrom32Bit",value:function(e){var t,r,i,n,a=this.pixels,o=this.mask;if(!e||!a||!a.length)return b.error("getAsRGBAFloat()","Unable to convert to RGBA. The input pixel block is empty.");t=r=i=a[0],a.length>=3?(r=a[1],i=a[2]):2===a.length&&(r=a[1]);var s=this.width*this.height;if(t.length!==s)return b.error("getAsRGBAFloat()","Unable to convert to RGBA. The pixelblock is invalid.");var l=0;if(o&&o.length===s)for(n=0;n<s;n++)e[l++]=t[n],e[l++]=r[n],e[l++]=i[n],e[l++]=1&o[n];else for(n=0;n<s;n++)e[l++]=t[n],e[l++]=r[n],e[l++]=i[n],e[l++]=1}},{key:"_calculateBandStatistics",value:function(e,t){var r,i=1/0,n=-1/0,a=e.length,o=0;if(t)for(r=0;r<a;r++)t[r]&&(i=(o=e[r])<i?o:i,n=o>n?o:n);else for(r=0;r<a;r++)i=(o=e[r])<i?o:i,n=o>n?o:n;return{minValue:i,maxValue:n}}}],[{key:"createEmptyBand",value:function(e,t){return new(i.getPixelArrayConstructor(e))(t)}},{key:"getPixelArrayConstructor",value:function(e){var t;switch(e){case"u1":case"u2":case"u4":case"u8":t=Uint8Array;break;case"u16":t=Uint16Array;break;case"u32":t=Uint32Array;break;case"s8":t=Int8Array;break;case"s16":t=Int16Array;break;case"s32":t=Int32Array;break;case"u32":t=Uint32Array;break;case"f32":t=Float32Array;break;case"f64":t=Float64Array;break;case"c64":case"c128":case"unknown":t=Float32Array}return t}}]),r}(h.a);Object(u.a)([Object(d.b)({json:{write:!0}})],w.prototype,"width",void 0),Object(u.a)([Object(d.b)({json:{write:!0}})],w.prototype,"height",void 0),Object(u.a)([Object(d.b)({json:{write:!0}})],w.prototype,"pixelType",void 0),Object(u.a)([Object(y.a)("pixelType")],w.prototype,"castPixelType",null),Object(u.a)([Object(d.b)({json:{write:!0}})],w.prototype,"validPixelCount",void 0),Object(u.a)([Object(d.b)({json:{write:!0}})],w.prototype,"mask",void 0),Object(u.a)([Object(d.b)({json:{write:!0}})],w.prototype,"maskIsAlpha",void 0),Object(u.a)([Object(d.b)({json:{write:!0}})],w.prototype,"pixels",void 0),Object(u.a)([Object(d.b)({json:{write:!0}})],w.prototype,"statistics",void 0);var O=w=i=Object(u.a)([Object(x.a)("esri.layers.support.PixelBlock")],w);t.a=O}}]);
//# sourceMappingURL=50-22a2dca46edda2b6b979.js.map