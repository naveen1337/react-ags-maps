(window.webpackJsonp=window.webpackJsonp||[]).push([[52],{"5ZAw":function(e,t,r){"use strict";var n,i,a,o=r("hisu"),s=r("yBJb"),l=r("TM+E"),u={exports:{}};n=u,i=function(){var e={DEBUG:!1,assert:function(t,r){if(e.DEBUG&&!t)throw new Error("Assertion failed"+(r?": "+r:""))},GLU_TESS_MAX_COORD:1e150,TRUE_PROJECT:!1,GLU_TESS_DEFAULT_TOLERANCE:0,windingRule:{GLU_TESS_WINDING_ODD:100130,GLU_TESS_WINDING_NONZERO:100131,GLU_TESS_WINDING_POSITIVE:100132,GLU_TESS_WINDING_NEGATIVE:100133,GLU_TESS_WINDING_ABS_GEQ_TWO:100134},primitiveType:{GL_LINE_LOOP:2,GL_TRIANGLES:4,GL_TRIANGLE_STRIP:5,GL_TRIANGLE_FAN:6},errorType:{GLU_TESS_MISSING_BEGIN_POLYGON:100151,GLU_TESS_MISSING_END_POLYGON:100153,GLU_TESS_MISSING_BEGIN_CONTOUR:100152,GLU_TESS_MISSING_END_CONTOUR:100154,GLU_TESS_COORD_TOO_LARGE:100155,GLU_TESS_NEED_COMBINE_CALLBACK:100156},gluEnum:{GLU_TESS_BEGIN:100100,GLU_TESS_VERTEX:100101,GLU_TESS_END:100102,GLU_TESS_ERROR:100103,GLU_TESS_EDGE_FLAG:100104,GLU_TESS_COMBINE:100105,GLU_TESS_BEGIN_DATA:100106,GLU_TESS_VERTEX_DATA:100107,GLU_TESS_END_DATA:100108,GLU_TESS_ERROR_DATA:100109,GLU_TESS_EDGE_FLAG_DATA:100110,GLU_TESS_COMBINE_DATA:100111,GLU_TESS_MESH:100112,GLU_TESS_TOLERANCE:100142,GLU_TESS_WINDING_RULE:100140,GLU_TESS_BOUNDARY_ONLY:100141,GLU_INVALID_ENUM:100900,GLU_INVALID_VALUE:100901},geom:{}};return e.geom.vertEq=function(e,t){return e.s===t.s&&e.t===t.t},e.geom.vertLeq=function(e,t){return e.s<t.s||e.s===t.s&&e.t<=t.t},e.geom.edgeEval=function(t,r,n){e.assert(e.geom.vertLeq(t,r)&&e.geom.vertLeq(r,n));var i=r.s-t.s,a=n.s-r.s;return i+a>0?i<a?r.t-t.t+(t.t-n.t)*(i/(i+a)):r.t-n.t+(n.t-t.t)*(a/(i+a)):0},e.geom.edgeSign=function(t,r,n){e.assert(e.geom.vertLeq(t,r)&&e.geom.vertLeq(r,n));var i=r.s-t.s,a=n.s-r.s;return i+a>0?(r.t-n.t)*i+(r.t-t.t)*a:0},e.geom.transLeq=function(e,t){return e.t<t.t||e.t===t.t&&e.s<=t.s},e.geom.transEval=function(t,r,n){e.assert(e.geom.transLeq(t,r)&&e.geom.transLeq(r,n));var i=r.t-t.t,a=n.t-r.t;return i+a>0?i<a?r.s-t.s+(t.s-n.s)*(i/(i+a)):r.s-n.s+(n.s-t.s)*(a/(i+a)):0},e.geom.transSign=function(t,r,n){e.assert(e.geom.transLeq(t,r)&&e.geom.transLeq(r,n));var i=r.t-t.t,a=n.t-r.t;return i+a>0?(r.s-n.s)*i+(r.s-t.s)*a:0},e.geom.edgeGoesLeft=function(t){return e.geom.vertLeq(t.dst(),t.org)},e.geom.edgeGoesRight=function(t){return e.geom.vertLeq(t.org,t.dst())},e.geom.vertL1dist=function(e,t){return Math.abs(e.s-t.s)+Math.abs(e.t-t.t)},e.geom.vertCCW=function(e,t,r){return e.s*(t.t-r.t)+t.s*(r.t-e.t)+r.s*(e.t-t.t)>=0},e.geom.interpolate_=function(e,t,r,n){return(e=e<0?0:e)<=(r=r<0?0:r)?0===r?(t+n)/2:t+e/(e+r)*(n-t):n+r/(e+r)*(t-n)},e.geom.edgeIntersect=function(t,r,n,i,a){var o,s,l;e.geom.vertLeq(t,r)||(l=t,t=r,r=l),e.geom.vertLeq(n,i)||(l=n,n=i,i=l),e.geom.vertLeq(t,n)||(l=t,t=n,n=l,l=r,r=i,i=l),e.geom.vertLeq(n,r)?e.geom.vertLeq(r,i)?((o=e.geom.edgeEval(t,n,r))+(s=e.geom.edgeEval(n,r,i))<0&&(o=-o,s=-s),a.s=e.geom.interpolate_(o,n.s,s,r.s)):((o=e.geom.edgeSign(t,n,r))+(s=-e.geom.edgeSign(t,i,r))<0&&(o=-o,s=-s),a.s=e.geom.interpolate_(o,n.s,s,i.s)):a.s=(n.s+r.s)/2,e.geom.transLeq(t,r)||(l=t,t=r,r=l),e.geom.transLeq(n,i)||(l=n,n=i,i=l),e.geom.transLeq(t,n)||(l=t,t=n,n=l,l=r,r=i,i=l),e.geom.transLeq(n,r)?e.geom.transLeq(r,i)?((o=e.geom.transEval(t,n,r))+(s=e.geom.transEval(n,r,i))<0&&(o=-o,s=-s),a.t=e.geom.interpolate_(o,n.t,s,r.t)):((o=e.geom.transSign(t,n,r))+(s=-e.geom.transSign(t,i,r))<0&&(o=-o,s=-s),a.t=e.geom.interpolate_(o,n.t,s,i.t)):a.t=(n.t+r.t)/2},e.mesh={},e.mesh.makeEdge=function(t){var r=e.mesh.makeEdgePair_(t.eHead);return e.mesh.makeVertex_(r,t.vHead),e.mesh.makeVertex_(r.sym,t.vHead),e.mesh.makeFace_(r,t.fHead),r},e.mesh.meshSplice=function(t,r){var n=!1,i=!1;t!==r&&(r.org!==t.org&&(i=!0,e.mesh.killVertex_(r.org,t.org)),r.lFace!==t.lFace&&(n=!0,e.mesh.killFace_(r.lFace,t.lFace)),e.mesh.splice_(r,t),i||(e.mesh.makeVertex_(r,t.org),t.org.anEdge=t),n||(e.mesh.makeFace_(r,t.lFace),t.lFace.anEdge=t))},e.mesh.deleteEdge=function(t){var r=t.sym,n=!1;t.lFace!==t.rFace()&&(n=!0,e.mesh.killFace_(t.lFace,t.rFace())),t.oNext===t?e.mesh.killVertex_(t.org,null):(t.rFace().anEdge=t.oPrev(),t.org.anEdge=t.oNext,e.mesh.splice_(t,t.oPrev()),n||e.mesh.makeFace_(t,t.lFace)),r.oNext===r?(e.mesh.killVertex_(r.org,null),e.mesh.killFace_(r.lFace,null)):(t.lFace.anEdge=r.oPrev(),r.org.anEdge=r.oNext,e.mesh.splice_(r,r.oPrev())),e.mesh.killEdge_(t)},e.mesh.addEdgeVertex=function(t){var r=e.mesh.makeEdgePair_(t),n=r.sym;return e.mesh.splice_(r,t.lNext),r.org=t.dst(),e.mesh.makeVertex_(n,r.org),r.lFace=n.lFace=t.lFace,r},e.mesh.splitEdge=function(t){var r=e.mesh.addEdgeVertex(t).sym;return e.mesh.splice_(t.sym,t.sym.oPrev()),e.mesh.splice_(t.sym,r),t.sym.org=r.org,r.dst().anEdge=r.sym,r.sym.lFace=t.rFace(),r.winding=t.winding,r.sym.winding=t.sym.winding,r},e.mesh.connect=function(t,r){var n=!1,i=e.mesh.makeEdgePair_(t),a=i.sym;return r.lFace!==t.lFace&&(n=!0,e.mesh.killFace_(r.lFace,t.lFace)),e.mesh.splice_(i,t.lNext),e.mesh.splice_(a,r),i.org=t.dst(),a.org=r.org,i.lFace=a.lFace=t.lFace,t.lFace.anEdge=a,n||e.mesh.makeFace_(i,t.lFace),i},e.mesh.zapFace=function(t){var r,n=t.anEdge,i=n.lNext;do{if(i=(r=i).lNext,r.lFace=null,null===r.rFace()){r.oNext===r?e.mesh.killVertex_(r.org,null):(r.org.anEdge=r.oNext,e.mesh.splice_(r,r.oPrev()));var a=r.sym;a.oNext===a?e.mesh.killVertex_(a.org,null):(a.org.anEdge=a.oNext,e.mesh.splice_(a,a.oPrev())),e.mesh.killEdge_(r)}}while(r!==n);var o=t.prev,s=t.next;s.prev=o,o.next=s},e.mesh.meshUnion=function(e,t){var r=e.fHead,n=e.vHead,i=e.eHead,a=t.fHead,o=t.vHead,s=t.eHead;return a.next!==a&&(r.prev.next=a.next,a.next.prev=r.prev,a.prev.next=r,r.prev=a.prev),o.next!==o&&(n.prev.next=o.next,o.next.prev=n.prev,o.prev.next=n,n.prev=o.prev),s.next!==s&&(i.sym.next.sym.next=s.next,s.next.sym.next=i.sym.next,s.sym.next.sym.next=i,i.sym.next=s.sym.next),e},e.mesh.deleteMesh=function(e){},e.mesh.makeEdgePair_=function(t){var r=new e.GluHalfEdge,n=new e.GluHalfEdge,i=t.sym.next;return n.next=i,i.sym.next=r,r.next=t,t.sym.next=n,r.sym=n,r.oNext=r,r.lNext=n,n.sym=r,n.oNext=n,n.lNext=r,r},e.mesh.splice_=function(e,t){var r=e.oNext,n=t.oNext;r.sym.lNext=t,n.sym.lNext=e,e.oNext=n,t.oNext=r},e.mesh.makeVertex_=function(t,r){var n=r.prev,i=new e.GluVertex(r,n);n.next=i,r.prev=i,i.anEdge=t;var a=t;do{a.org=i,a=a.oNext}while(a!==t)},e.mesh.makeFace_=function(t,r){var n=r.prev,i=new e.GluFace(r,n);n.next=i,r.prev=i,i.anEdge=t,i.inside=r.inside;var a=t;do{a.lFace=i,a=a.lNext}while(a!==t)},e.mesh.killEdge_=function(e){var t=e.next,r=e.sym.next;t.sym.next=r,r.sym.next=t},e.mesh.killVertex_=function(e,t){var r=e.anEdge,n=r;do{n.org=t,n=n.oNext}while(n!==r);var i=e.prev,a=e.next;a.prev=i,i.next=a},e.mesh.killFace_=function(e,t){var r=e.anEdge,n=r;do{n.lFace=t,n=n.lNext}while(n!==r);var i=e.prev,a=e.next;a.prev=i,i.next=a},e.normal={},e.normal.S_UNIT_X_=1,e.normal.S_UNIT_Y_=0,e.normal.projectPolygon=function(t,r,n,i){var a=!1,o=[r,n,i];0===r&&0===n&&0===i&&(e.normal.computeNormal_(t,o),a=!0);var s,l=e.normal.longAxis_(o),u=t.mesh.vHead;if(e.TRUE_PROJECT){e.normal.normalize_(o);var c=[0,0,0],h=[0,0,0];c[l]=0,c[(l+1)%3]=e.normal.S_UNIT_X_,c[(l+2)%3]=e.normal.S_UNIT_Y_;var f=e.normal.dot_(c,o);for(c[0]-=f*o[0],c[1]-=f*o[1],c[2]-=f*o[2],e.normal.normalize_(c),h[0]=o[1]*c[2]-o[2]*c[1],h[1]=o[2]*c[0]-o[0]*c[2],h[2]=o[0]*c[1]-o[1]*c[0],e.normal.normalize_(h),s=u.next;s!==u;s=s.next)s.s=e.normal.dot_(s.coords,c),s.t=e.normal.dot_(s.coords,h)}else{var y=(l+1)%3,p=(l+2)%3,d=o[l]>0?1:-1;for(s=u.next;s!==u;s=s.next)s.s=s.coords[y],s.t=d*s.coords[p]}a&&e.normal.checkOrientation_(t)},e.normal.dot_=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},e.normal.normalize_=function(t){var r=t[0]*t[0]+t[1]*t[1]+t[2]*t[2];e.assert(r>0),r=Math.sqrt(r),t[0]/=r,t[1]/=r,t[2]/=r},e.normal.longAxis_=function(e){var t=0;return Math.abs(e[1])>Math.abs(e[0])&&(t=1),Math.abs(e[2])>Math.abs(e[t])&&(t=2),t},e.normal.computeNormal_=function(t,r){var n,i=[-2*e.GLU_TESS_MAX_COORD,-2*e.GLU_TESS_MAX_COORD,-2*e.GLU_TESS_MAX_COORD],a=[2*e.GLU_TESS_MAX_COORD,2*e.GLU_TESS_MAX_COORD,2*e.GLU_TESS_MAX_COORD],o=[],s=[],l=t.mesh.vHead;for(n=l.next;n!==l;n=n.next)for(var u=0;u<3;++u){var c=n.coords[u];c<a[u]&&(a[u]=c,s[u]=n),c>i[u]&&(i[u]=c,o[u]=n)}var h=0;if(i[1]-a[1]>i[0]-a[0]&&(h=1),i[2]-a[2]>i[h]-a[h]&&(h=2),a[h]>=i[h])return r[0]=0,r[1]=0,void(r[2]=1);var f=0,y=s[h],p=o[h],d=[0,0,0],v=[y.coords[0]-p.coords[0],y.coords[1]-p.coords[1],y.coords[2]-p.coords[2]],g=[0,0,0];for(n=l.next;n!==l;n=n.next){g[0]=n.coords[0]-p.coords[0],g[1]=n.coords[1]-p.coords[1],g[2]=n.coords[2]-p.coords[2],d[0]=v[1]*g[2]-v[2]*g[1],d[1]=v[2]*g[0]-v[0]*g[2],d[2]=v[0]*g[1]-v[1]*g[0];var m=d[0]*d[0]+d[1]*d[1]+d[2]*d[2];m>f&&(f=m,r[0]=d[0],r[1]=d[1],r[2]=d[2])}f<=0&&(r[0]=r[1]=r[2]=0,r[e.normal.longAxis_(v)]=1)},e.normal.checkOrientation_=function(e){for(var t=0,r=e.mesh.fHead,n=r.next;n!==r;n=n.next){var i=n.anEdge;if(!(i.winding<=0))do{t+=(i.org.s-i.dst().s)*(i.org.t+i.dst().t),i=i.lNext}while(i!==n.anEdge)}if(t<0)for(var a=e.mesh.vHead,o=a.next;o!==a;o=o.next)o.t=-o.t},e.render={},e.render.renderMesh=function(t,r,n){for(var i=!1,a=-1,o=r.fHead.prev;o!==r.fHead;o=o.prev)if(o.inside){i||(t.callBeginCallback(e.primitiveType.GL_TRIANGLES),i=!0);var s=o.anEdge;e.assert(s.lNext.lNext.lNext===s,"renderMesh called with non-triangulated mesh");do{if(n){var l=s.rFace().inside?0:1;a!==l&&(a=l,t.callEdgeFlagCallback(!!a))}t.callVertexCallback(s.org.data),s=s.lNext}while(s!==o.anEdge)}i&&t.callEndCallback()},e.render.renderBoundary=function(t,r){for(var n=r.fHead.next;n!==r.fHead;n=n.next)if(n.inside){t.callBeginCallback(e.primitiveType.GL_LINE_LOOP);var i=n.anEdge;do{t.callVertexCallback(i.org.data),i=i.lNext}while(i!==n.anEdge);t.callEndCallback()}},e.sweep={},e.sweep.SENTINEL_COORD_=4*e.GLU_TESS_MAX_COORD,e.sweep.TOLERANCE_NONZERO_=!1,e.sweep.computeInterior=function(t){var r;for(t.fatalError=!1,e.sweep.removeDegenerateEdges_(t),e.sweep.initPriorityQ_(t),e.sweep.initEdgeDict_(t);null!==(r=t.pq.extractMin());){for(;;){var n=t.pq.minimum();if(null===n||!e.geom.vertEq(n,r))break;n=t.pq.extractMin(),e.sweep.spliceMergeVertices_(t,r.anEdge,n.anEdge)}e.sweep.sweepEvent_(t,r)}var i=t.dict.getMin().getKey();t.event=i.eUp.org,e.sweep.doneEdgeDict_(t),e.sweep.donePriorityQ_(t),e.sweep.removeDegenerateFaces_(t.mesh),t.mesh.checkMesh()},e.sweep.addWinding_=function(e,t){e.winding+=t.winding,e.sym.winding+=t.sym.winding},e.sweep.edgeLeq_=function(t,r,n){var i=t.event,a=r.eUp,o=n.eUp;return a.dst()===i?o.dst()===i?e.geom.vertLeq(a.org,o.org)?e.geom.edgeSign(o.dst(),a.org,o.org)<=0:e.geom.edgeSign(a.dst(),o.org,a.org)>=0:e.geom.edgeSign(o.dst(),i,o.org)<=0:o.dst()===i?e.geom.edgeSign(a.dst(),i,a.org)>=0:e.geom.edgeEval(a.dst(),i,a.org)>=e.geom.edgeEval(o.dst(),i,o.org)},e.sweep.deleteRegion_=function(t,r){r.fixUpperEdge&&e.assert(0===r.eUp.winding),r.eUp.activeRegion=null,t.dict.deleteNode(r.nodeUp),r.nodeUp=null},e.sweep.fixUpperEdge_=function(t,r){e.assert(t.fixUpperEdge),e.mesh.deleteEdge(t.eUp),t.fixUpperEdge=!1,t.eUp=r,r.activeRegion=t},e.sweep.topLeftRegion_=function(t){var r=t.eUp.org;do{t=t.regionAbove()}while(t.eUp.org===r);if(t.fixUpperEdge){var n=e.mesh.connect(t.regionBelow().eUp.sym,t.eUp.lNext);e.sweep.fixUpperEdge_(t,n),t=t.regionAbove()}return t},e.sweep.topRightRegion_=function(e){var t=e.eUp.dst();do{e=e.regionAbove()}while(e.eUp.dst()===t);return e},e.sweep.addRegionBelow_=function(t,r,n){var i=new e.ActiveRegion;return i.eUp=n,i.nodeUp=t.dict.insertBefore(r.nodeUp,i),n.activeRegion=i,i},e.sweep.isWindingInside_=function(t,r){switch(t.windingRule){case e.windingRule.GLU_TESS_WINDING_ODD:return 0!=(1&r);case e.windingRule.GLU_TESS_WINDING_NONZERO:return 0!==r;case e.windingRule.GLU_TESS_WINDING_POSITIVE:return r>0;case e.windingRule.GLU_TESS_WINDING_NEGATIVE:return r<0;case e.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:return r>=2||r<=-2}return e.assert(!1),!1},e.sweep.computeWinding_=function(t,r){r.windingNumber=r.regionAbove().windingNumber+r.eUp.winding,r.inside=e.sweep.isWindingInside_(t,r.windingNumber)},e.sweep.finishRegion_=function(t,r){var n=r.eUp,i=n.lFace;i.inside=r.inside,i.anEdge=n,e.sweep.deleteRegion_(t,r)},e.sweep.finishLeftRegions_=function(t,r,n){for(var i=r,a=r.eUp;i!==n;){i.fixUpperEdge=!1;var o=i.regionBelow(),s=o.eUp;if(s.org!==a.org){if(!o.fixUpperEdge){e.sweep.finishRegion_(t,i);break}s=e.mesh.connect(a.lPrev(),s.sym),e.sweep.fixUpperEdge_(o,s)}a.oNext!==s&&(e.mesh.meshSplice(s.oPrev(),s),e.mesh.meshSplice(a,s)),e.sweep.finishRegion_(t,i),a=o.eUp,i=o}return a},e.sweep.addRightEdges_=function(t,r,n,i,a,o){var s=!0,l=n;do{e.assert(e.geom.vertLeq(l.org,l.dst())),e.sweep.addRegionBelow_(t,r,l.sym),l=l.oNext}while(l!==i);null===a&&(a=r.regionBelow().eUp.rPrev());for(var u,c=r,h=a;(l=(u=c.regionBelow()).eUp.sym).org===h.org;)l.oNext!==h&&(e.mesh.meshSplice(l.oPrev(),l),e.mesh.meshSplice(h.oPrev(),l)),u.windingNumber=c.windingNumber-l.winding,u.inside=e.sweep.isWindingInside_(t,u.windingNumber),c.dirty=!0,!s&&e.sweep.checkForRightSplice_(t,c)&&(e.sweep.addWinding_(l,h),e.sweep.deleteRegion_(t,c),e.mesh.deleteEdge(h)),s=!1,c=u,h=l;c.dirty=!0,e.assert(c.windingNumber-l.winding===u.windingNumber),o&&e.sweep.walkDirtyRegions_(t,c)},e.sweep.callCombine_=function(t,r,n,i,a){var o=[r.coords[0],r.coords[1],r.coords[2]];r.data=null,r.data=t.callCombineCallback(o,n,i),null===r.data&&(a?t.fatalError||(t.callErrorCallback(e.errorType.GLU_TESS_NEED_COMBINE_CALLBACK),t.fatalError=!0):r.data=n[0])},e.sweep.spliceMergeVertices_=function(t,r,n){var i=[null,null,null,null];i[0]=r.org.data,i[1]=n.org.data,e.sweep.callCombine_(t,r.org,i,[.5,.5,0,0],!1),e.mesh.meshSplice(r,n)},e.sweep.vertexWeights_=function(t,r,n,i,a){var o=e.geom.vertL1dist(r,t),s=e.geom.vertL1dist(n,t),l=a,u=a+1;i[l]=.5*s/(o+s),i[u]=.5*o/(o+s),t.coords[0]+=i[l]*r.coords[0]+i[u]*n.coords[0],t.coords[1]+=i[l]*r.coords[1]+i[u]*n.coords[1],t.coords[2]+=i[l]*r.coords[2]+i[u]*n.coords[2]},e.sweep.getIntersectData_=function(t,r,n,i,a,o){var s=[0,0,0,0],l=[n.data,i.data,a.data,o.data];r.coords[0]=r.coords[1]=r.coords[2]=0,e.sweep.vertexWeights_(r,n,i,s,0),e.sweep.vertexWeights_(r,a,o,s,2),e.sweep.callCombine_(t,r,l,s,!0)},e.sweep.checkForRightSplice_=function(t,r){var n=r.regionBelow(),i=r.eUp,a=n.eUp;if(e.geom.vertLeq(i.org,a.org)){if(e.geom.edgeSign(a.dst(),i.org,a.org)>0)return!1;e.geom.vertEq(i.org,a.org)?i.org!==a.org&&(t.pq.remove(i.org.pqHandle),e.sweep.spliceMergeVertices_(t,a.oPrev(),i)):(e.mesh.splitEdge(a.sym),e.mesh.meshSplice(i,a.oPrev()),r.dirty=n.dirty=!0)}else{if(e.geom.edgeSign(i.dst(),a.org,i.org)<0)return!1;r.regionAbove().dirty=r.dirty=!0,e.mesh.splitEdge(i.sym),e.mesh.meshSplice(a.oPrev(),i)}return!0},e.sweep.checkForLeftSplice_=function(t,r){var n,i=r.regionBelow(),a=r.eUp,o=i.eUp;if(e.assert(!e.geom.vertEq(a.dst(),o.dst())),e.geom.vertLeq(a.dst(),o.dst())){if(e.geom.edgeSign(a.dst(),o.dst(),a.org)<0)return!1;r.regionAbove().dirty=r.dirty=!0,n=e.mesh.splitEdge(a),e.mesh.meshSplice(o.sym,n),n.lFace.inside=r.inside}else{if(e.geom.edgeSign(o.dst(),a.dst(),o.org)>0)return!1;r.dirty=i.dirty=!0,n=e.mesh.splitEdge(o),e.mesh.meshSplice(a.lNext,o.sym),n.rFace().inside=r.inside}return!0},e.sweep.checkForIntersect_=function(t,r){var n=r.regionBelow(),i=r.eUp,a=n.eUp,o=i.org,s=a.org,l=i.dst(),u=a.dst(),c=new e.GluVertex;if(e.assert(!e.geom.vertEq(u,l)),e.assert(e.geom.edgeSign(l,t.event,o)<=0),e.assert(e.geom.edgeSign(u,t.event,s)>=0),e.assert(o!==t.event&&s!==t.event),e.assert(!r.fixUpperEdge&&!n.fixUpperEdge),o===s)return!1;if(Math.min(o.t,l.t)>Math.max(s.t,u.t))return!1;if(e.geom.vertLeq(o,s)){if(e.geom.edgeSign(u,o,s)>0)return!1}else if(e.geom.edgeSign(l,s,o)<0)return!1;e.geom.edgeIntersect(l,o,u,s,c),e.assert(Math.min(o.t,l.t)<=c.t),e.assert(c.t<=Math.max(s.t,u.t)),e.assert(Math.min(u.s,l.s)<=c.s),e.assert(c.s<=Math.max(s.s,o.s)),e.geom.vertLeq(c,t.event)&&(c.s=t.event.s,c.t=t.event.t);var h=e.geom.vertLeq(o,s)?o:s;if(e.geom.vertLeq(h,c)&&(c.s=h.s,c.t=h.t),e.geom.vertEq(c,o)||e.geom.vertEq(c,s))return e.sweep.checkForRightSplice_(t,r),!1;if(!e.geom.vertEq(l,t.event)&&e.geom.edgeSign(l,t.event,c)>=0||!e.geom.vertEq(u,t.event)&&e.geom.edgeSign(u,t.event,c)<=0){if(u===t.event)return e.mesh.splitEdge(i.sym),e.mesh.meshSplice(a.sym,i),i=(r=e.sweep.topLeftRegion_(r)).regionBelow().eUp,e.sweep.finishLeftRegions_(t,r.regionBelow(),n),e.sweep.addRightEdges_(t,r,i.oPrev(),i,i,!0),!0;if(l===t.event){e.mesh.splitEdge(a.sym),e.mesh.meshSplice(i.lNext,a.oPrev()),n=r;var f=(r=e.sweep.topRightRegion_(r)).regionBelow().eUp.rPrev();return n.eUp=a.oPrev(),a=e.sweep.finishLeftRegions_(t,n,null),e.sweep.addRightEdges_(t,r,a.oNext,i.rPrev(),f,!0),!0}return e.geom.edgeSign(l,t.event,c)>=0&&(r.regionAbove().dirty=r.dirty=!0,e.mesh.splitEdge(i.sym),i.org.s=t.event.s,i.org.t=t.event.t),e.geom.edgeSign(u,t.event,c)<=0&&(r.dirty=n.dirty=!0,e.mesh.splitEdge(a.sym),a.org.s=t.event.s,a.org.t=t.event.t),!1}return e.mesh.splitEdge(i.sym),e.mesh.splitEdge(a.sym),e.mesh.meshSplice(a.oPrev(),i),i.org.s=c.s,i.org.t=c.t,i.org.pqHandle=t.pq.insert(i.org),e.sweep.getIntersectData_(t,i.org,o,l,s,u),r.regionAbove().dirty=r.dirty=n.dirty=!0,!1},e.sweep.walkDirtyRegions_=function(t,r){for(var n=r.regionBelow();;){for(;n.dirty;)r=n,n=n.regionBelow();if(!r.dirty&&(n=r,null===(r=r.regionAbove())||!r.dirty))return;r.dirty=!1;var i=r.eUp,a=n.eUp;if(i.dst()!==a.dst()&&e.sweep.checkForLeftSplice_(t,r)&&(n.fixUpperEdge?(e.sweep.deleteRegion_(t,n),e.mesh.deleteEdge(a),a=(n=r.regionBelow()).eUp):r.fixUpperEdge&&(e.sweep.deleteRegion_(t,r),e.mesh.deleteEdge(i),i=(r=n.regionAbove()).eUp)),i.org!==a.org)if(i.dst()===a.dst()||r.fixUpperEdge||n.fixUpperEdge||i.dst()!==t.event&&a.dst()!==t.event)e.sweep.checkForRightSplice_(t,r);else if(e.sweep.checkForIntersect_(t,r))return;i.org===a.org&&i.dst()===a.dst()&&(e.sweep.addWinding_(a,i),e.sweep.deleteRegion_(t,r),e.mesh.deleteEdge(i),r=n.regionAbove())}},e.sweep.connectRightVertex_=function(t,r,n){var i,a=n.oNext,o=r.regionBelow(),s=r.eUp,l=o.eUp,u=!1;s.dst()!==l.dst()&&e.sweep.checkForIntersect_(t,r),e.geom.vertEq(s.org,t.event)&&(e.mesh.meshSplice(a.oPrev(),s),a=(r=e.sweep.topLeftRegion_(r)).regionBelow().eUp,e.sweep.finishLeftRegions_(t,r.regionBelow(),o),u=!0),e.geom.vertEq(l.org,t.event)&&(e.mesh.meshSplice(n,l.oPrev()),n=e.sweep.finishLeftRegions_(t,o,null),u=!0),u?e.sweep.addRightEdges_(t,r,n.oNext,a,a,!0):(i=e.geom.vertLeq(l.org,s.org)?l.oPrev():s,i=e.mesh.connect(n.lPrev(),i),e.sweep.addRightEdges_(t,r,i,i.oNext,i.oNext,!1),i.sym.activeRegion.fixUpperEdge=!0,e.sweep.walkDirtyRegions_(t,r))},e.sweep.connectLeftDegenerate_=function(t,r,n){var i=r.eUp;if(e.geom.vertEq(i.org,n))return e.assert(e.sweep.TOLERANCE_NONZERO_),void(e.sweep.TOLERANCE_NONZERO_&&e.sweep.spliceMergeVertices_(t,i,n.anEdge));if(!e.geom.vertEq(i.dst(),n))return e.mesh.splitEdge(i.sym),r.fixUpperEdge&&(e.mesh.deleteEdge(i.oNext),r.fixUpperEdge=!1),e.mesh.meshSplice(n.anEdge,i),void e.sweep.sweepEvent_(t,n);if(e.assert(e.sweep.TOLERANCE_NONZERO_),e.sweep.TOLERANCE_NONZERO_){var a=(r=e.sweep.topRightRegion_(r)).regionBelow(),o=a.eUp.sym,s=o.oNext,l=s;a.fixUpperEdge&&(e.assert(s!==o),e.sweep.deleteRegion_(t,a),e.mesh.deleteEdge(o),o=s.oPrev()),e.mesh.meshSplice(n.anEdge,o),e.geom.edgeGoesLeft(s)||(s=null),e.sweep.addRightEdges_(t,r,o.oNext,l,s,!0)}},e.sweep.connectLeftVertex_=function(t,r){var n=new e.ActiveRegion;n.eUp=r.anEdge.sym;var i=t.dict.search(n).getKey(),a=i.regionBelow(),o=i.eUp,s=a.eUp;if(0!==e.geom.edgeSign(o.dst(),r,o.org)){var l,u=e.geom.vertLeq(s.dst(),o.dst())?i:a;i.inside||u.fixUpperEdge?(l=u===i?e.mesh.connect(r.anEdge.sym,o.lNext):e.mesh.connect(s.dNext(),r.anEdge).sym,u.fixUpperEdge?e.sweep.fixUpperEdge_(u,l):e.sweep.computeWinding_(t,e.sweep.addRegionBelow_(t,i,l)),e.sweep.sweepEvent_(t,r)):e.sweep.addRightEdges_(t,i,r.anEdge,r.anEdge,null,!0)}else e.sweep.connectLeftDegenerate_(t,i,r)},e.sweep.sweepEvent_=function(t,r){t.event=r;for(var n=r.anEdge;null===n.activeRegion;)if((n=n.oNext)===r.anEdge)return void e.sweep.connectLeftVertex_(t,r);var i=e.sweep.topLeftRegion_(n.activeRegion),a=i.regionBelow(),o=a.eUp,s=e.sweep.finishLeftRegions_(t,a,null);s.oNext===o?e.sweep.connectRightVertex_(t,i,s):e.sweep.addRightEdges_(t,i,s.oNext,o,o,!0)},e.sweep.addSentinel_=function(t,r){var n=new e.ActiveRegion,i=e.mesh.makeEdge(t.mesh);i.org.s=e.sweep.SENTINEL_COORD_,i.org.t=r,i.dst().s=-e.sweep.SENTINEL_COORD_,i.dst().t=r,t.event=i.dst(),n.eUp=i,n.windingNumber=0,n.inside=!1,n.fixUpperEdge=!1,n.sentinel=!0,n.dirty=!1,n.nodeUp=t.dict.insert(n)},e.sweep.initEdgeDict_=function(t){t.dict=new e.Dict(t,e.sweep.edgeLeq_),e.sweep.addSentinel_(t,-e.sweep.SENTINEL_COORD_),e.sweep.addSentinel_(t,e.sweep.SENTINEL_COORD_)},e.sweep.doneEdgeDict_=function(t){for(var r,n=0;null!==(r=t.dict.getMin().getKey());)r.sentinel||(e.assert(r.fixUpperEdge),e.assert(1==++n)),e.assert(0===r.windingNumber),e.sweep.deleteRegion_(t,r);t.dict=null},e.sweep.removeDegenerateEdges_=function(t){for(var r,n=t.mesh.eHead,i=n.next;i!==n;i=r){r=i.next;var a=i.lNext;e.geom.vertEq(i.org,i.dst())&&i.lNext.lNext!==i&&(e.sweep.spliceMergeVertices_(t,a,i),e.mesh.deleteEdge(i),a=(i=a).lNext),a.lNext===i&&(a!==i&&(a!==r&&a!==r.sym||(r=r.next),e.mesh.deleteEdge(a)),i!==r&&i!==r.sym||(r=r.next),e.mesh.deleteEdge(i))}},e.sweep.initPriorityQ_=function(t){var r=new e.PriorityQ;t.pq=r;var n,i=t.mesh.vHead;for(n=i.next;n!==i;n=n.next)n.pqHandle=r.insert(n);r.init()},e.sweep.donePriorityQ_=function(e){e.pq.deleteQ(),e.pq=null},e.sweep.removeDegenerateFaces_=function(t){for(var r,n=t.fHead.next;n!==t.fHead;n=r){r=n.next;var i=n.anEdge;e.assert(i.lNext!==i),i.lNext.lNext===i&&(e.sweep.addWinding_(i.oNext,i),e.mesh.deleteEdge(i))}},e.tessmono={},e.tessmono.tessellateMonoRegion_=function(t){var r=t.anEdge;for(e.assert(r.lNext!==r&&r.lNext.lNext!==r);e.geom.vertLeq(r.dst(),r.org);r=r.lPrev());for(;e.geom.vertLeq(r.org,r.dst());r=r.lNext);for(var n,i=r.lPrev();r.lNext!==i;)if(e.geom.vertLeq(r.dst(),i.org)){for(;i.lNext!==r&&(e.geom.edgeGoesLeft(i.lNext)||e.geom.edgeSign(i.org,i.dst(),i.lNext.dst())<=0);)i=(n=e.mesh.connect(i.lNext,i)).sym;i=i.lPrev()}else{for(;i.lNext!==r&&(e.geom.edgeGoesRight(r.lPrev())||e.geom.edgeSign(r.dst(),r.org,r.lPrev().org)>=0);)n=e.mesh.connect(r,r.lPrev()),r=n.sym;r=r.lNext}for(e.assert(i.lNext!==r);i.lNext.lNext!==r;)i=(n=e.mesh.connect(i.lNext,i)).sym},e.tessmono.tessellateInterior=function(t){for(var r,n=t.fHead.next;n!==t.fHead;n=r)r=n.next,n.inside&&e.tessmono.tessellateMonoRegion_(n)},e.tessmono.discardExterior=function(t){for(var r,n=t.fHead.next;n!==t.fHead;n=r)r=n.next,n.inside||e.mesh.zapFace(n)},e.tessmono.setWindingNumber=function(t,r,n){for(var i,a=t.eHead.next;a!==t.eHead;a=i)i=a.next,a.rFace().inside!==a.lFace.inside?a.winding=a.lFace.inside?r:-r:n?e.mesh.deleteEdge(a):a.winding=0},e.Dict=function(t,r){this.head_=new e.DictNode,this.frame_=t,this.leq_=r},e.Dict.prototype.deleteDict_=function(){},e.Dict.prototype.insertBefore=function(t,r){do{t=t.prev}while(null!==t.key&&!this.leq_(this.frame_,t.key,r));var n=new e.DictNode(r,t.next,t);return t.next.prev=n,t.next=n,n},e.Dict.prototype.insert=function(e){return this.insertBefore(this.head_,e)},e.Dict.prototype.deleteNode=function(e){e.next.prev=e.prev,e.prev.next=e.next},e.Dict.prototype.search=function(e){var t=this.head_;do{t=t.next}while(null!==t.key&&!this.leq_(this.frame_,e,t.key));return t},e.Dict.prototype.getMin=function(){return this.head_.next},e.Dict.prototype.getMax=function(){return this.head_.prev},e.DictNode=function(e,t,r){this.key=e||null,this.next=t||this,this.prev=r||this},e.DictNode.prototype.getKey=function(){return this.key},e.DictNode.prototype.getSuccessor=function(){return this.next},e.DictNode.prototype.getPredecessor=function(){return this.prev},e.GluTesselator=function(){this.state_=e.GluTesselator.tessState_.T_DORMANT,this.lastEdge_=null,this.mesh=null,this.errorCallback_=null,this.normal_=[0,0,0],this.windingRule=e.windingRule.GLU_TESS_WINDING_ODD,this.fatalError=!1,this.dict=null,this.pq=null,this.event=null,this.combineCallback_=null,this.boundaryOnly_=!1,this.beginCallback_=null,this.edgeFlagCallback_=null,this.vertexCallback_=null,this.endCallback_=null,this.meshCallback_=null,this.polygonData_=null},e.GluTesselator.tessState_={T_DORMANT:0,T_IN_POLYGON:1,T_IN_CONTOUR:2},e.GluTesselator.prototype.gluDeleteTess=function(){this.requireState_(e.GluTesselator.tessState_.T_DORMANT)},e.GluTesselator.prototype.gluTessProperty=function(t,r){switch(t){case e.gluEnum.GLU_TESS_TOLERANCE:return;case e.gluEnum.GLU_TESS_WINDING_RULE:var n=r;switch(n){case e.windingRule.GLU_TESS_WINDING_ODD:case e.windingRule.GLU_TESS_WINDING_NONZERO:case e.windingRule.GLU_TESS_WINDING_POSITIVE:case e.windingRule.GLU_TESS_WINDING_NEGATIVE:case e.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:return void(this.windingRule=n)}break;case e.gluEnum.GLU_TESS_BOUNDARY_ONLY:return void(this.boundaryOnly_=!!r);default:return void this.callErrorCallback(e.gluEnum.GLU_INVALID_ENUM)}this.callErrorCallback(e.gluEnum.GLU_INVALID_VALUE)},e.GluTesselator.prototype.gluGetTessProperty=function(t){switch(t){case e.gluEnum.GLU_TESS_TOLERANCE:return 0;case e.gluEnum.GLU_TESS_WINDING_RULE:var r=this.windingRule;return e.assert(r===e.windingRule.GLU_TESS_WINDING_ODD||r===e.windingRule.GLU_TESS_WINDING_NONZERO||r===e.windingRule.GLU_TESS_WINDING_POSITIVE||r===e.windingRule.GLU_TESS_WINDING_NEGATIVE||r===e.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO),r;case e.gluEnum.GLU_TESS_BOUNDARY_ONLY:return e.assert(!0===this.boundaryOnly_||!1===this.boundaryOnly_),this.boundaryOnly_;default:this.callErrorCallback(e.gluEnum.GLU_INVALID_ENUM)}return!1},e.GluTesselator.prototype.gluTessNormal=function(e,t,r){this.normal_[0]=e,this.normal_[1]=t,this.normal_[2]=r},e.GluTesselator.prototype.gluTessCallback=function(t,r){var n=r||null;switch(t){case e.gluEnum.GLU_TESS_BEGIN:case e.gluEnum.GLU_TESS_BEGIN_DATA:return void(this.beginCallback_=n);case e.gluEnum.GLU_TESS_EDGE_FLAG:case e.gluEnum.GLU_TESS_EDGE_FLAG_DATA:return void(this.edgeFlagCallback_=n);case e.gluEnum.GLU_TESS_VERTEX:case e.gluEnum.GLU_TESS_VERTEX_DATA:return void(this.vertexCallback_=n);case e.gluEnum.GLU_TESS_END:case e.gluEnum.GLU_TESS_END_DATA:return void(this.endCallback_=n);case e.gluEnum.GLU_TESS_ERROR:case e.gluEnum.GLU_TESS_ERROR_DATA:return void(this.errorCallback_=n);case e.gluEnum.GLU_TESS_COMBINE:case e.gluEnum.GLU_TESS_COMBINE_DATA:return void(this.combineCallback_=n);case e.gluEnum.GLU_TESS_MESH:return void(this.meshCallback_=n);default:return void this.callErrorCallback(e.gluEnum.GLU_INVALID_ENUM)}},e.GluTesselator.prototype.gluTessVertex=function(t,r){var n=!1,i=[0,0,0];this.requireState_(e.GluTesselator.tessState_.T_IN_CONTOUR);for(var a=0;a<3;++a){var o=t[a];o<-e.GLU_TESS_MAX_COORD&&(o=-e.GLU_TESS_MAX_COORD,n=!0),o>e.GLU_TESS_MAX_COORD&&(o=e.GLU_TESS_MAX_COORD,n=!0),i[a]=o}n&&this.callErrorCallback(e.errorType.GLU_TESS_COORD_TOO_LARGE),this.addVertex_(i,r)},e.GluTesselator.prototype.gluTessBeginPolygon=function(t){this.requireState_(e.GluTesselator.tessState_.T_DORMANT),this.state_=e.GluTesselator.tessState_.T_IN_POLYGON,this.mesh=new e.GluMesh,this.polygonData_=t},e.GluTesselator.prototype.gluTessBeginContour=function(){this.requireState_(e.GluTesselator.tessState_.T_IN_POLYGON),this.state_=e.GluTesselator.tessState_.T_IN_CONTOUR,this.lastEdge_=null},e.GluTesselator.prototype.gluTessEndContour=function(){this.requireState_(e.GluTesselator.tessState_.T_IN_CONTOUR),this.state_=e.GluTesselator.tessState_.T_IN_POLYGON},e.GluTesselator.prototype.gluTessEndPolygon=function(){if(this.requireState_(e.GluTesselator.tessState_.T_IN_POLYGON),this.state_=e.GluTesselator.tessState_.T_DORMANT,e.normal.projectPolygon(this,this.normal_[0],this.normal_[1],this.normal_[2]),e.sweep.computeInterior(this),!this.fatalError){var t=this.mesh;if(this.boundaryOnly_?e.tessmono.setWindingNumber(t,1,!0):e.tessmono.tessellateInterior(t),this.mesh.checkMesh(),this.beginCallback_||this.endCallback_||this.vertexCallback_||this.edgeFlagCallback_)if(this.boundaryOnly_)e.render.renderBoundary(this,this.mesh);else{var r=!!this.edgeFlagCallback_;e.render.renderMesh(this,this.mesh,r)}if(this.meshCallback_)return e.tessmono.discardExterior(this.mesh),this.meshCallback_(this.mesh),this.mesh=null,void(this.polygonData_=null)}e.mesh.deleteMesh(this.mesh),this.polygonData_=null,this.mesh=null},e.GluTesselator.prototype.requireState_=function(e){this.state_!==e&&this.gotoState_(e)},e.GluTesselator.prototype.gotoState_=function(t){for(;this.state_!==t;)if(this.state_<t)switch(this.state_){case e.GluTesselator.tessState_.T_DORMANT:this.callErrorCallback(e.errorType.GLU_TESS_MISSING_BEGIN_POLYGON),this.gluTessBeginPolygon(null);break;case e.GluTesselator.tessState_.T_IN_POLYGON:this.callErrorCallback(e.errorType.GLU_TESS_MISSING_BEGIN_CONTOUR),this.gluTessBeginContour()}else switch(this.state_){case e.GluTesselator.tessState_.T_IN_CONTOUR:this.callErrorCallback(e.errorType.GLU_TESS_MISSING_END_CONTOUR),this.gluTessEndContour();break;case e.GluTesselator.tessState_.T_IN_POLYGON:this.callErrorCallback(e.errorType.GLU_TESS_MISSING_END_POLYGON),this.gluTessEndPolygon()}},e.GluTesselator.prototype.addVertex_=function(t,r){var n=this.lastEdge_;null===n?(n=e.mesh.makeEdge(this.mesh),e.mesh.meshSplice(n,n.sym)):(e.mesh.splitEdge(n),n=n.lNext),n.org.data=r,n.org.coords[0]=t[0],n.org.coords[1]=t[1],n.org.coords[2]=t[2],n.winding=1,n.sym.winding=-1,this.lastEdge_=n},e.GluTesselator.prototype.callBeginCallback=function(e){this.beginCallback_&&this.beginCallback_(e,this.polygonData_)},e.GluTesselator.prototype.callVertexCallback=function(e){this.vertexCallback_&&this.vertexCallback_(e,this.polygonData_)},e.GluTesselator.prototype.callEdgeFlagCallback=function(e){this.edgeFlagCallback_&&this.edgeFlagCallback_(e,this.polygonData_)},e.GluTesselator.prototype.callEndCallback=function(){this.endCallback_&&this.endCallback_(this.polygonData_)},e.GluTesselator.prototype.callCombineCallback=function(e,t,r){return this.combineCallback_&&this.combineCallback_(e,t,r,this.polygonData_)||null},e.GluTesselator.prototype.callErrorCallback=function(e){this.errorCallback_&&this.errorCallback_(e,this.polygonData_)},e.GluFace=function(e,t){this.next=e||this,this.prev=t||this,this.anEdge=null,this.inside=!1},e.GluHalfEdge=function(e){this.next=e||this,this.sym=null,this.oNext=null,this.lNext=null,this.org=null,this.lFace=null,this.activeRegion=null,this.winding=0},e.GluHalfEdge.prototype.rFace=function(){return this.sym.lFace},e.GluHalfEdge.prototype.dst=function(){return this.sym.org},e.GluHalfEdge.prototype.oPrev=function(){return this.sym.lNext},e.GluHalfEdge.prototype.lPrev=function(){return this.oNext.sym},e.GluHalfEdge.prototype.dPrev=function(){return this.lNext.sym},e.GluHalfEdge.prototype.rPrev=function(){return this.sym.oNext},e.GluHalfEdge.prototype.dNext=function(){return this.rPrev().sym},e.GluHalfEdge.prototype.rNext=function(){return this.oPrev().sym},e.GluMesh=function(){this.vHead=new e.GluVertex,this.fHead=new e.GluFace,this.eHead=new e.GluHalfEdge,this.eHeadSym=new e.GluHalfEdge,this.eHead.sym=this.eHeadSym,this.eHeadSym.sym=this.eHead},e.GluMesh.prototype.checkMesh=function(){if(e.DEBUG){var t,r,n,i=this.fHead,a=this.vHead,o=this.eHead,s=i;for(s=i;(r=s.next)!==i;s=r){e.assert(r.prev===s),t=r.anEdge;do{e.assert(t.sym!==t),e.assert(t.sym.sym===t),e.assert(t.lNext.oNext.sym===t),e.assert(t.oNext.sym.lNext===t),e.assert(t.lFace===r),t=t.lNext}while(t!==r.anEdge)}e.assert(r.prev===s&&null===r.anEdge);var l=a;for(l=a;(n=l.next)!==a;l=n){e.assert(n.prev===l),t=n.anEdge;do{e.assert(t.sym!==t),e.assert(t.sym.sym===t),e.assert(t.lNext.oNext.sym===t),e.assert(t.oNext.sym.lNext===t),e.assert(t.org===n),t=t.oNext}while(t!==n.anEdge)}e.assert(n.prev===l&&null===n.anEdge&&null===n.data);var u=o;for(u=o;(t=u.next)!==o;u=t)e.assert(t.sym.next===u.sym),e.assert(t.sym!==t),e.assert(t.sym.sym===t),e.assert(null!==t.org),e.assert(null!==t.dst()),e.assert(t.lNext.oNext.sym===t),e.assert(t.oNext.sym.lNext===t);e.assert(t.sym.next===u.sym&&t.sym===this.eHeadSym&&t.sym.sym===t&&null===t.org&&null===t.dst()&&null===t.lFace&&null===t.rFace())}},e.GluVertex=function(e,t){this.next=e||this,this.prev=t||this,this.anEdge=null,this.data=null,this.coords=[0,0,0],this.s=0,this.t=0,this.pqHandle=0},e.PriorityQ=function(){this.verts_=[],this.order_=null,this.size_=0,this.initialized_=!1,this.heap_=new e.PriorityQHeap},e.PriorityQ.prototype.deleteQ=function(){this.heap_=null,this.order_=null,this.verts_=null},e.PriorityQ.prototype.init=function(){this.order_=[];for(var t=0;t<this.size_;t++)this.order_[t]=t;var r,n=(r=this.verts_,function(t,n){return e.geom.vertLeq(r[t],r[n])?1:-1});if(this.order_.sort(n),this.initialized_=!0,this.heap_.init(),e.DEBUG){var i=0+this.size_-1;for(t=0;t<i;++t)e.assert(e.geom.vertLeq(this.verts_[this.order_[t+1]],this.verts_[this.order_[t]]))}},e.PriorityQ.prototype.insert=function(e){if(this.initialized_)return this.heap_.insert(e);var t=this.size_++;return this.verts_[t]=e,-(t+1)},e.PriorityQ.prototype.extractMin=function(){if(0===this.size_)return this.heap_.extractMin();var t=this.verts_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var r=this.heap_.minimum();if(e.geom.vertLeq(r,t))return this.heap_.extractMin()}do{--this.size_}while(this.size_>0&&null===this.verts_[this.order_[this.size_-1]]);return t},e.PriorityQ.prototype.minimum=function(){if(0===this.size_)return this.heap_.minimum();var t=this.verts_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var r=this.heap_.minimum();if(e.geom.vertLeq(r,t))return r}return t},e.PriorityQ.prototype.remove=function(t){if(t>=0)this.heap_.remove(t);else for(t=-(t+1),e.assert(t<this.verts_.length&&null!==this.verts_[t]),this.verts_[t]=null;this.size_>0&&null===this.verts_[this.order_[this.size_-1]];)--this.size_},e.PriorityQHeap=function(){this.heap_=e.PriorityQHeap.reallocNumeric_([0],e.PriorityQHeap.INIT_SIZE_+1),this.verts_=[null,null],this.handles_=[0,0],this.size_=0,this.max_=e.PriorityQHeap.INIT_SIZE_,this.freeList_=0,this.initialized_=!1,this.heap_[1]=1},e.PriorityQHeap.INIT_SIZE_=32,e.PriorityQHeap.reallocNumeric_=function(e,t){for(var r=new Array(t),n=0;n<e.length;n++)r[n]=e[n];for(;n<t;n++)r[n]=0;return r},e.PriorityQHeap.prototype.init=function(){for(var e=this.size_;e>=1;--e)this.floatDown_(e);this.initialized_=!0},e.PriorityQHeap.prototype.insert=function(t){var r,n=++this.size_;return 2*n>this.max_&&(this.max_*=2,this.handles_=e.PriorityQHeap.reallocNumeric_(this.handles_,this.max_+1)),0===this.freeList_?r=n:(r=this.freeList_,this.freeList_=this.handles_[this.freeList_]),this.verts_[r]=t,this.handles_[r]=n,this.heap_[n]=r,this.initialized_&&this.floatUp_(n),r},e.PriorityQHeap.prototype.isEmpty=function(){return 0===this.size_},e.PriorityQHeap.prototype.minimum=function(){return this.verts_[this.heap_[1]]},e.PriorityQHeap.prototype.extractMin=function(){var e=this.heap_,t=this.verts_,r=this.handles_,n=e[1],i=t[n];return this.size_>0&&(e[1]=e[this.size_],r[e[1]]=1,t[n]=null,r[n]=this.freeList_,this.freeList_=n,--this.size_>0&&this.floatDown_(1)),i},e.PriorityQHeap.prototype.remove=function(t){var r=this.heap_,n=this.verts_,i=this.handles_;e.assert(t>=1&&t<=this.max_&&null!==n[t]);var a=i[t];if(r[a]=r[this.size_],i[r[a]]=a,a<=--this.size_)if(a<=1)this.floatDown_(a);else{var o=n[r[a]],s=n[r[a>>1]];e.geom.vertLeq(s,o)?this.floatDown_(a):this.floatUp_(a)}n[t]=null,i[t]=this.freeList_,this.freeList_=t},e.PriorityQHeap.prototype.floatDown_=function(t){for(var r=this.heap_,n=this.verts_,i=this.handles_,a=t,o=r[a];;){var s=a<<1;s<this.size_&&e.geom.vertLeq(n[r[s+1]],n[r[s]])&&(s+=1),e.assert(s<=this.max_);var l=r[s];if(s>this.size_||e.geom.vertLeq(n[o],n[l]))return r[a]=o,void(i[o]=a);r[a]=l,i[l]=a,a=s}},e.PriorityQHeap.prototype.floatUp_=function(t){for(var r=this.heap_,n=this.verts_,i=this.handles_,a=t,o=r[a];;){var s=a>>1,l=r[s];if(0===s||e.geom.vertLeq(n[l],n[o]))return r[a]=o,void(i[o]=a);r[a]=l,i[l]=a,a=s}},e.ActiveRegion=function(){this.eUp=null,this.nodeUp=null,this.windingNumber=0,this.inside=!1,this.sentinel=!1,this.dirty=!1,this.fixUpperEdge=!1},e.ActiveRegion.prototype.regionBelow=function(){return this.nodeUp.getPredecessor().getKey()},e.ActiveRegion.prototype.regionAbove=function(){return this.nodeUp.getSuccessor().getKey()},e},void 0!==(a=i())&&(n.exports=a);var c=l.a.getLogger("esri.views.2d.engine.webgl.mesh.templates.Tesselator"),h=function(){function e(){Object(o.a)(this,e),this._currentVertexIndex=0,this._indexCounter=0,this._triangleIndices=[-1,-1,-1],this.glu=new u.exports.GluTesselator,this.glu.gluTessCallback(u.exports.gluEnum.GLU_TESS_BEGIN,this._begincallback.bind(this)),this.glu.gluTessCallback(u.exports.gluEnum.GLU_TESS_VERTEX_DATA,this._vertexCallback.bind(this)),this.glu.gluTessCallback(u.exports.gluEnum.GLU_TESS_END,this._endcallback.bind(this)),this.glu.gluTessCallback(u.exports.gluEnum.GLU_TESS_COMBINE,this._combinecallback.bind(this)),this.glu.gluTessCallback(u.exports.gluEnum.GLU_TESS_ERROR,this._errorcallback.bind(this)),this.glu.gluTessCallback(u.exports.gluEnum.GLU_TESS_EDGE_FLAG,this._edgeCallback.bind(this)),this.glu.gluTessProperty(u.exports.gluEnum.GLU_TESS_WINDING_RULE,u.exports.windingRule.GLU_TESS_WINDING_ODD)}return Object(s.a)(e,[{key:"beginPolygon",value:function(e,t){this._triangleIndices[0]=-1,this._triangleIndices[1]=-1,this._triangleIndices[2]=-1,this._currentVertexIndex=0,this._indexCounter=0,this.glu.gluTessBeginPolygon(e),this._indices=t}},{key:"endPolygon",value:function(){this.glu.gluTessEndPolygon()}},{key:"beginContour",value:function(){this.glu.gluTessBeginContour()}},{key:"endContour",value:function(){this.glu.gluTessEndContour()}},{key:"addVertex",value:function(e,t){this.glu.gluTessVertex(e,t)}},{key:"_vertexCallback",value:function(e,t){if(t[t.length]=e[0],t[t.length]=e[1],this._triangleIndices[this._currentVertexIndex]=-1,this._currentVertexIndex>=2){for(var r=0;r<3;r++)-1===this._triangleIndices[r]&&(this._triangleIndices[r]=this._indexCounter++),this._indices[this._indices.length]=this._triangleIndices[r];this._currentVertexIndex=0}else this._currentVertexIndex++}},{key:"_begincallback",value:function(){this._triangleIndices[0]=-1,this._triangleIndices[1]=-1,this._triangleIndices[2]=-1,this._currentVertexIndex=0}},{key:"_endcallback",value:function(){this._currentVertexIndex=0}},{key:"_errorcallback",value:function(e){c.error("Encountered error during tesselation: ".concat(e))}},{key:"_combinecallback",value:function(e){return[e[0],e[1],e[2]]}},{key:"_edgeCallback",value:function(){}}]),e}();t.a=h},"9wAn":function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return n})),r.d(t,"d",(function(){return i})),r.d(t,"e",(function(){return f})),r.d(t,"f",(function(){return h})),r.d(t,"g",(function(){return u})),r.d(t,"h",(function(){return c}));var n=Number.POSITIVE_INFINITY,i=Math.PI,a=2*i,o=128/i,s=i/180,l=1/Math.LN2;function u(e,t){return(e%=t)>=0?e:e+t}function c(e){return u(e*o,256)}function h(e){return Math.log(e)*l}function f(e,t,r){return e*(1-r)+t*r}},"FA+R":function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r("hisu"),i=r("yBJb"),a=function(){function e(t,r){Object(n.a)(this,e),this.x=t,this.y=r}return Object(i.a)(e,[{key:"clone",value:function(){return new e(this.x,this.y)}},{key:"equals",value:function(e,t){return e===this.x&&t===this.y}},{key:"isEqual",value:function(e){return e.x===this.x&&e.y===this.y}},{key:"setCoords",value:function(e,t){this.x=e,this.y=t}},{key:"normalize",value:function(){var e=this.x,t=this.y,r=Math.sqrt(e*e+t*t);this.x/=r,this.y/=r}},{key:"rightPerpendicular",value:function(){var e=this.x;this.x=this.y,this.y=-e}},{key:"move",value:function(e,t){this.x+=e,this.y+=t}},{key:"assign",value:function(e){this.x=e.x,this.y=e.y}},{key:"assignAdd",value:function(e,t){this.x=e.x+t.x,this.y=e.y+t.y}},{key:"assignSub",value:function(e,t){this.x=e.x-t.x,this.y=e.y-t.y}},{key:"rotate",value:function(e,t){var r=this.x,n=this.y;this.x=r*e-n*t,this.y=r*t+n*e}},{key:"scale",value:function(e){this.x*=e,this.y*=e}},{key:"length",value:function(){var e=this.x,t=this.y;return Math.sqrt(e*e+t*t)}}],[{key:"distance",value:function(e,t){var r=t.x-e.x,n=t.y-e.y;return Math.sqrt(r*r+n*n)}},{key:"add",value:function(t,r){return new e(t.x+r.x,t.y+r.y)}},{key:"sub",value:function(t,r){return new e(t.x-r.x,t.y-r.y)}}]),e}()},IjGd:function(e,t,r){"use strict";var n=r("hisu"),i=r("yBJb"),a=r("W32V");function o(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return s(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){l=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(l)throw a}}}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var l=function(){function e(t,r){var i=this;if(Object(n.a)(this,e),this._style=t,this.backgroundBucketIds=[],this._uidToLayer=new Map,this._layerByName={},this._runningId=0,t.layers||(t.layers=[]),this.version=parseFloat(t.version),this.sprite=r?r.spriteUrl:t.sprite,this.glyphs=r?r.glyphsUrl:t.glyphs,this.layers=t.layers.map((function(e,t,r){return i._create(e,t,r)})),this.layers)for(var a,o=0;o<this.layers.length;o++)a=this.layers[o],this._layerByName[a.id.toLowerCase()]=a,this._uidToLayer.set(a.uid,a),0===a.type&&this.backgroundBucketIds.push(a.id);this._identifyRefLayers()}return Object(i.a)(e,[{key:"isPainterDataDriven",value:function(e){var t=this._layerByName[e.toLowerCase()];return!!t&&t.isPainterDataDriven()}},{key:"getStyleLayerId",value:function(e){return e>=this.layers.length?null:this.layers[e].id}},{key:"getStyleLayerByUID",value:function(e){var t=this._uidToLayer.get(e);return null!=t?t:null}},{key:"getStyleLayerIndex",value:function(e){var t=this._layerByName[e.toLowerCase()];return t?this.layers.indexOf(t):-1}},{key:"setStyleLayer",value:function(t,r){if(t&&t.id){var n=this._style;null!=r&&r>=this.layers.length&&(r=this.layers.length-1);var i,a=!0,o=this._layerByName[t.id.toLowerCase()];if(o){var s=this.layers.indexOf(o);r||(r=s),r===s?(a=!1,i=e._recreateLayer(t,o),this.layers[r]=i,n.layers[r]=t):(this.layers.splice(s,1),n.layers.splice(s,1),i=this._create(t,r,this.layers),this.layers.splice(r,0,i),n.layers.splice(r,0,t))}else i=this._create(t,r,this.layers),!r||r>=this.layers.length?(this.layers.push(i),n.layers.push(t)):(this.layers.splice(r,0,i),n.layers.splice(r,0,t));this._layerByName[t.id.toLowerCase()]=i,this._uidToLayer.set(i.uid,i),a&&this._recomputeZValues(),this._identifyRefLayers()}}},{key:"getStyleLayer",value:function(e){var t=this._layerByName[e.toLowerCase()];return t?{type:t.typeName,id:t.id,source:t.source,"source-layer":t.sourceLayer,minzoom:t.minzoom,maxzoom:t.maxzoom,filter:t.filter,layout:t.layout,paint:t.paint}:null}},{key:"deleteStyleLayer",value:function(e){var t=this._layerByName[e.toLowerCase()];if(t){delete this._layerByName[e.toLowerCase()],this._uidToLayer.delete(t.uid);var r=this.layers.indexOf(t);this.layers.splice(r,1),this._style.layers.splice(r,1),this._recomputeZValues(),this._identifyRefLayers()}}},{key:"getLayerById",value:function(e){return this._layerByName[e.toLowerCase()]}},{key:"getLayoutProperties",value:function(e){var t=this._layerByName[e.toLowerCase()];return t?t.layout:null}},{key:"getPaintProperties",value:function(e){var t=this._layerByName[e.toLowerCase()];return t?t.paint:null}},{key:"setPaintProperties",value:function(t,r){var n=this._layerByName[t.toLowerCase()];if(n){var i={type:n.typeName,id:n.id,source:n.source,"source-layer":n.sourceLayer,minzoom:n.minzoom,maxzoom:n.maxzoom,filter:n.filter,layout:n.layout,paint:r},a=e._recreateLayer(i,n),o=this.layers.indexOf(n);this.layers[o]=a,this._style.layers[o].paint=r,this._layerByName[n.id.toLowerCase()]=a,this._uidToLayer.set(n.uid,a)}}},{key:"setLayoutProperties",value:function(t,r){var n=this._layerByName[t.toLowerCase()];if(n){var i={type:n.typeName,id:n.id,source:n.source,"source-layer":n.sourceLayer,minzoom:n.minzoom,maxzoom:n.maxzoom,filter:n.filter,layout:r,paint:n.paint},a=e._recreateLayer(i,n),o=this.layers.indexOf(n);this.layers[o]=a,this._style.layers[o].layout=r,this._layerByName[n.id.toLowerCase()]=a,this._uidToLayer.set(n.uid,a)}}},{key:"setStyleLayerVisibility",value:function(t,r){var n=this._layerByName[t.toLowerCase()];if(n){var i=n.layout||{};i.visibility=r;var a={type:n.typeName,id:n.id,source:n.source,"source-layer":n.sourceLayer,minzoom:n.minzoom,maxzoom:n.maxzoom,filter:n.filter,layout:i,paint:n.paint},o=e._recreateLayer(a,n),s=this.layers.indexOf(n);this.layers[s]=o,this._style.layers[s].layout=i,this._layerByName[n.id.toLowerCase()]=o,this._uidToLayer.set(n.uid,o)}}},{key:"getStyleLayerVisibility",value:function(e){var t,r=this._layerByName[e.toLowerCase()];if(!r)return"none";var n=r.layout;return null!=(t=null==n?void 0:n.visibility)?t:"visible"}},{key:"_recomputeZValues",value:function(){for(var e=this.layers,t=1/(e.length+1),r=0;r<e.length;r++)e[r].z=1-(1+r)*t}},{key:"_identifyRefLayers",value:function(){var e,t=[],r=[],n=0,i=o(this.layers);try{for(i.s();!(e=i.n()).done;){var a=e.value,s=a.layout;if(1===a.type){var l,u=a,c=a.source+"|"+a.sourceLayer;c+=null!=(l="|"+(null==s?void 0:s.visibility))?l:"",c+="|"+a.minzoom,c+="|"+a.maxzoom,c+="|"+JSON.stringify(a.filter),(u.hasDataDrivenFill||u.hasDataDrivenOutline)&&(c+="|"+n),t.push({key:c,layer:a})}else if(2===a.type){var h,f=a,y=a.source+"|"+a.sourceLayer;y+=null!=(h="|"+(null==s?void 0:s.visibility))?h:"",y+="|"+a.minzoom,y+="|"+a.maxzoom,y+="|"+JSON.stringify(a.filter),y+="|"+(void 0!==s?s["line-cap"]:""),y+="|"+(void 0!==s?s["line-join"]:""),f.hasDataDrivenLine&&(y+="|"+n),r.push({key:y,layer:a})}++n}}catch(p){i.e(p)}finally{i.f()}this._assignRefLayers(t),this._assignRefLayers(r)}},{key:"_assignRefLayers",value:function(e){var t,r;e.sort((function(e,t){return e.key<t.key?-1:e.key>t.key?1:0}));for(var n=e.length,i=0;i<n;i++){var a=e[i];if(a.key===t)a.layer.refLayerId=r;else if(t=a.key,r=a.layer.id,1===a.layer.type){if(!a.layer.getPaintProperty("fill-outline-color"))for(var o=i+1;o<n;o++){var s=e[o];if(s.key!==t)break;if(s.layer.getPaintProperty("fill-outline-color")){e[i]=s,e[o]=a,r=s.layer.id;break}}}else if(2===a.layer.type)for(var l=a.layer,u=i+1;u<n;u++){var c=e[u];if(c.key!==t)break;var h=c.layer;(l.canUseThinTessellation&&!h.canUseThinTessellation||!l.canUseThinTessellation&&(h.getPaintProperty("line-pattern")||h.getPaintProperty("line-dasharray")))&&(l=h,e[i]=c,e[u]=a,r=c.layer.id)}}}},{key:"_create",value:function(e,t,r){var n=1-(1+t)*(1/(r.length+1)),i=this._runningId++;switch(e.type){case"background":return new a.a(0,e,n,i);case"fill":return new a.c(1,e,n,i);case"line":return new a.e(2,e,n,i);case"symbol":return new a.f(3,e,n,i);case"raster":throw new Error("Unsupported vector tile raster layer");case"circle":return new a.b(4,e,n,i)}throw new Error("Unknown vector tile layer")}}],[{key:"_recreateLayer",value:function(e,t){switch(e.type){case"background":return new a.a(0,e,t.z,t.uid);case"fill":return new a.c(1,e,t.z,t.uid);case"line":return new a.e(2,e,t.z,t.uid);case"symbol":return new a.f(3,e,t.z,t.uid);case"raster":throw new Error("Unsupported vector tile raster layer");case"circle":return new a.b(4,e,t.z,t.uid)}}}]),e}();t.a=l},KMaQ:function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return u}));var n=r("yBJb"),i=r("hisu"),a=r("PmOk"),o=r("FA+R"),s=r("ghNS"),l=function e(t,r,n){Object(i.a)(this,e),this.ratio=t,this.x=r,this.y=n},u=function(){function e(t,r,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:8;Object(i.a)(this,e),this.lines=[],this.starts=[],this.validateTessellation=!0,this.pixelRatio=o,this.pixelMargin=s,this.tileSize=a.E*o,this.dz=t,this.yPos=r,this.xPos=n}return Object(n.a)(e,[{key:"setPixelMargin",value:function(e){e!==this.pixelMargin&&(this.pixelMargin=e,this.setExtent(this._extent))}},{key:"setExtent",value:function(e){this._extent=e,this.finalRatio=this.tileSize/e*(1<<this.dz);var t=this.pixelRatio*this.pixelMargin;t/=this.finalRatio;var r=e>>this.dz;t>r&&(t=r),this.margin=t,this.xmin=r*this.xPos-t,this.ymin=r*this.yPos-t,this.xmax=this.xmin+r+2*t,this.ymax=this.ymin+r+2*t}},{key:"reset",value:function(e){this.type=e,this.lines=[],this.starts=[],this.line=null,this.start=0}},{key:"moveTo",value:function(e,t){this._pushLine(),this._prevIsIn=this._isIn(e,t),this._moveTo(e,t,this._prevIsIn),this._prevPt=new o.a(e,t),this._firstPt=new o.a(e,t),this._dist=0}},{key:"lineTo",value:function(e,t){var r,n,i,a,s,u,c,h,f=this._isIn(e,t),y=new o.a(e,t),p=o.a.distance(this._prevPt,y);if(f)this._prevIsIn?this._lineTo(e,t,!0):(r=this._prevPt,n=y,i=this._intersect(n,r),this.start=this._dist+p*(1-this._r),this._lineTo(i.x,i.y,!0),this._lineTo(n.x,n.y,!0));else if(this._prevIsIn)n=this._prevPt,r=y,i=this._intersect(n,r),this._lineTo(i.x,i.y,!0),this._lineTo(r.x,r.y,!1);else{var d=this._prevPt,v=y;if(d.x<=this.xmin&&v.x<=this.xmin||d.x>=this.xmax&&v.x>=this.xmax||d.y<=this.ymin&&v.y<=this.ymin||d.y>=this.ymax&&v.y>=this.ymax)this._lineTo(v.x,v.y,!1);else{var g=[];if((d.x<this.xmin&&v.x>this.xmin||d.x>this.xmin&&v.x<this.xmin)&&(a=(this.xmin-d.x)/(v.x-d.x),(h=d.y+a*(v.y-d.y))<=this.ymin?u=!1:h>=this.ymax?u=!0:g.push(new l(a,this.xmin,h))),(d.x<this.xmax&&v.x>this.xmax||d.x>this.xmax&&v.x<this.xmax)&&(a=(this.xmax-d.x)/(v.x-d.x),(h=d.y+a*(v.y-d.y))<=this.ymin?u=!1:h>=this.ymax?u=!0:g.push(new l(a,this.xmax,h))),(d.y<this.ymin&&v.y>this.ymin||d.y>this.ymin&&v.y<this.ymin)&&(a=(this.ymin-d.y)/(v.y-d.y),(c=d.x+a*(v.x-d.x))<=this.xmin?s=!1:c>=this.xmax?s=!0:g.push(new l(a,c,this.ymin))),(d.y<this.ymax&&v.y>this.ymax||d.y>this.ymax&&v.y<this.ymax)&&(a=(this.ymax-d.y)/(v.y-d.y),(c=d.x+a*(v.x-d.x))<=this.xmin?s=!1:c>=this.xmax?s=!0:g.push(new l(a,c,this.ymax))),0===g.length)s?u?this._lineTo(this.xmax,this.ymax,!0):this._lineTo(this.xmax,this.ymin,!0):u?this._lineTo(this.xmin,this.ymax,!0):this._lineTo(this.xmin,this.ymin,!0);else if(g.length>1&&g[0].ratio>g[1].ratio)this.start=this._dist+p*g[1].ratio,this._lineTo(g[1].x,g[1].y,!0),this._lineTo(g[0].x,g[0].y,!0);else{this.start=this._dist+p*g[0].ratio;for(var m=0;m<g.length;m++)this._lineTo(g[m].x,g[m].y,!0)}this._lineTo(v.x,v.y,!1)}}this._dist+=p,this._prevIsIn=f,this._prevPt=y}},{key:"close",value:function(){if(this.line.length>2){var e=this._firstPt,t=this._prevPt;e.x===t.x&&e.y===t.y||this.lineTo(e.x,e.y);for(var r=this.line,n=r.length;n>=4&&(r[0].x===r[1].x&&r[0].x===r[n-2].x||r[0].y===r[1].y&&r[0].y===r[n-2].y);)r.pop(),r[0].x=r[n-2].x,r[0].y=r[n-2].y,--n}}},{key:"result",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._pushLine(),0===this.lines.length?null:(3===this.type&&e&&h.simplify(this.tileSize,this.margin*this.finalRatio,this.lines),this.lines)}},{key:"resultWithStarts",value:function(){if(2!==this.type)throw new Error("Only valid for lines");this._pushLine();var e=this.lines,t=e.length;if(0===t)return null;for(var r=[],n=0;n<t;n++)r.push({line:e[n],start:this.starts[n]||0});return r}},{key:"_isIn",value:function(e,t){return e>=this.xmin&&e<=this.xmax&&t>=this.ymin&&t<=this.ymax}},{key:"_intersect",value:function(e,t){var r,n,i;if(t.x>=this.xmin&&t.x<=this.xmax)i=((n=t.y<=this.ymin?this.ymin:this.ymax)-e.y)/(t.y-e.y),r=e.x+i*(t.x-e.x);else if(t.y>=this.ymin&&t.y<=this.ymax)i=((r=t.x<=this.xmin?this.xmin:this.xmax)-e.x)/(t.x-e.x),n=e.y+i*(t.y-e.y);else{n=t.y<=this.ymin?this.ymin:this.ymax;var a=((r=t.x<=this.xmin?this.xmin:this.xmax)-e.x)/(t.x-e.x),s=(n-e.y)/(t.y-e.y);a<s?(i=a,n=e.y+a*(t.y-e.y)):(i=s,r=e.x+s*(t.x-e.x))}return this._r=i,new o.a(r,n)}},{key:"_pushLine",value:function(){this.line&&(1===this.type?this.line.length>0&&(this.lines.push(this.line),this.starts.push(this.start)):2===this.type?this.line.length>1&&(this.lines.push(this.line),this.starts.push(this.start)):3===this.type&&this.line.length>3&&(this.lines.push(this.line),this.starts.push(this.start))),this.line=[],this.start=0}},{key:"_moveTo",value:function(e,t,r){3!==this.type?r&&(e=Math.round((e-(this.xmin+this.margin))*this.finalRatio),t=Math.round((t-(this.ymin+this.margin))*this.finalRatio),this.line.push(new o.a(e,t))):(r||(e<this.xmin&&(e=this.xmin),e>this.xmax&&(e=this.xmax),t<this.ymin&&(t=this.ymin),t>this.ymax&&(t=this.ymax)),e=Math.round((e-(this.xmin+this.margin))*this.finalRatio),t=Math.round((t-(this.ymin+this.margin))*this.finalRatio),this.line.push(new o.a(e,t)),this._is_h=!1,this._is_v=!1)}},{key:"_lineTo",value:function(e,t,r){var n,i;if(3!==this.type)if(r){if(e=Math.round((e-(this.xmin+this.margin))*this.finalRatio),t=Math.round((t-(this.ymin+this.margin))*this.finalRatio),this.line.length>0&&(n=this.line[this.line.length-1]).equals(e,t))return;this.line.push(new o.a(e,t))}else this.line&&this.line.length>0&&this._pushLine();else if(r||(e<this.xmin&&(e=this.xmin),e>this.xmax&&(e=this.xmax),t<this.ymin&&(t=this.ymin),t>this.ymax&&(t=this.ymax)),e=Math.round((e-(this.xmin+this.margin))*this.finalRatio),t=Math.round((t-(this.ymin+this.margin))*this.finalRatio),this.line&&this.line.length>0){var a=(n=this.line[this.line.length-1]).x===e,s=n.y===t;if(a&&s)return;this._is_h&&a||this._is_v&&s?(n.x=e,n.y=t,(i=this.line[this.line.length-2]).x===e&&i.y===t?(this.line.pop(),this.line.length<=1?(this._is_h=!1,this._is_v=!1):(i=this.line[this.line.length-2],this._is_h=i.x===e,this._is_v=i.y===t)):(this._is_h=i.x===e,this._is_v=i.y===t)):(this.line.push(new o.a(e,t)),this._is_h=a,this._is_v=s)}else this.line.push(new o.a(e,t))}}]),e}(),c=function(){function e(){Object(i.a)(this,e)}return Object(n.a)(e,[{key:"setExtent",value:function(e){this._ratio=4096===e?1:4096/e}},{key:"validateTessellation",get:function(){return this._ratio<1}},{key:"reset",value:function(e){this.lines=[],this.line=null}},{key:"moveTo",value:function(e,t){this.line&&this.lines.push(this.line),this.line=[];var r=this._ratio;this.line.push(new o.a(e*r,t*r))}},{key:"lineTo",value:function(e,t){var r=this._ratio;this.line.push(new o.a(e*r,t*r))}},{key:"close",value:function(){var e=this.line;e&&!e[0].isEqual(e[e.length-1])&&e.push(e[0])}},{key:"result",value:function(){return this.line&&this.lines.push(this.line),0===this.lines.length?null:this.lines}}]),e}(),h=function(){function e(){Object(i.a)(this,e)}return Object(n.a)(e,null,[{key:"simplify",value:function(t,r,n){if(n){for(var i=-r,a=t+r,o=-r,s=t+r,l=[],u=[],c=n.length,h=0;h<c;++h){var f=n[h];if(f&&!(f.length<2))for(var y=void 0,p=f[0],d=f.length,v=1;v<d;++v)y=f[v],p.x===y.x&&(p.x<=i&&(p.y>y.y?(l.push(h),l.push(v),l.push(0),l.push(-1)):(u.push(h),u.push(v),u.push(0),u.push(-1))),p.x>=a&&(p.y<y.y?(l.push(h),l.push(v),l.push(1),l.push(-1)):(u.push(h),u.push(v),u.push(1),u.push(-1)))),p.y===y.y&&(p.y<=o&&(p.x<y.x?(l.push(h),l.push(v),l.push(2),l.push(-1)):(u.push(h),u.push(v),u.push(2),u.push(-1))),p.y>=s&&(p.x>y.x?(l.push(h),l.push(v),l.push(3),l.push(-1)):(u.push(h),u.push(v),u.push(3),u.push(-1)))),p=y}if(0!==l.length&&0!==u.length){e.fillParent(n,u,l),e.fillParent(n,l,u);var g=[];e.calcDeltas(g,u,l),e.calcDeltas(g,l,u),e.addDeltas(g,n)}}}},{key:"fillParent",value:function(e,t,r){for(var n=r.length,i=t.length,a=0;a<i;a+=4){for(var o=t[a],l=t[a+1],u=t[a+2],c=e[o][l-1],h=e[o][l],f=8092,y=-1,p=0;p<n;p+=4)if(r[p+2]===u){var d=r[p],v=r[p+1],g=e[d][v-1],m=e[d][v];switch(u){case 0:case 1:if(Object(s.a)(c.y,g.y,m.y)&&Object(s.a)(h.y,g.y,m.y)){var _=Math.abs(m.y-g.y);_<f&&(f=_,y=p)}break;case 2:case 3:if(Object(s.a)(c.x,g.x,m.x)&&Object(s.a)(h.x,g.x,m.x)){var x=Math.abs(m.x-g.x);x<f&&(f=x,y=p)}}}t[a+3]=y}}},{key:"calcDeltas",value:function(t,r,n){for(var i=r.length,a=0;a<i;a+=4){var o=e.calcDelta(a,r,n,[]);t.push(r[a]),t.push(r[a+1]),t.push(r[a+2]),t.push(o)}}},{key:"calcDelta",value:function(t,r,n,i){var a=r[t+3];if(-1===a)return 0;var o=i.length;return o>1&&i[o-2]===a?0:(i.push(a),e.calcDelta(a,n,r,i)+1)}},{key:"addDeltas",value:function(e,t){for(var r=e.length,n=0,i=0;i<r;i+=4){var a=e[i+3];a>n&&(n=a)}for(var o=0;o<r;o+=4){var s=t[e[o]],l=e[o+1],u=n-e[o+3];switch(e[o+2]){case 0:s[l-1].x-=u,s[l].x-=u,1===l&&(s[s.length-1].x-=u),l===s.length-1&&(s[0].x-=u);break;case 1:s[l-1].x+=u,s[l].x+=u,1===l&&(s[s.length-1].x+=u),l===s.length-1&&(s[0].x+=u);break;case 2:s[l-1].y-=u,s[l].y-=u,1===l&&(s[s.length-1].y-=u),l===s.length-1&&(s[0].y-=u);break;case 3:s[l-1].y+=u,s[l].y+=u,1===l&&(s[s.length-1].y+=u),l===s.length-1&&(s[0].y+=u)}}}}]),e}()},W32V:function(e,t,r){"use strict";r.d(t,"a",(function(){return st})),r.d(t,"b",(function(){return ht})),r.d(t,"c",(function(){return lt})),r.d(t,"d",(function(){return ft})),r.d(t,"e",(function(){return ut})),r.d(t,"f",(function(){return ct})),r.d(t,"g",(function(){return yt}));var n=r("CHlC"),i=r("kMo5"),a=r("P+uj"),o=r("hisu"),s=r("yBJb"),l=r("mK0O"),u=r("7im+"),c=r("r9FC");function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach((function(t){Object(l.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function y(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return p(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return p(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var d=function(){function e(t){Object(o.a)(this,e),this._locations=new Map,this._key=t}return Object(s.a)(e,[{key:"key",get:function(){return this._key}},{key:"type",get:function(){return 7&this._key}},{key:"defines",value:function(){return[]}},{key:"getStride",value:function(){return this._layoutInfo||this._buildAttributesInfo(),this._stride}},{key:"getAttributeLocations",value:function(){return 0===this._locations.size&&this._buildAttributesInfo(),this._locations}},{key:"getLayoutInfo",value:function(){return this._layoutInfo||this._buildAttributesInfo(),this._layoutInfo}},{key:"getEncodingInfos",value:function(){return this._propertyEncodingInfo||this._buildAttributesInfo(),this._propertyEncodingInfo}},{key:"getUniforms",value:function(){return this._uniforms||this._buildAttributesInfo(),this._uniforms}},{key:"getShaderHeader",value:function(){return this._shaderHeader||this._buildAttributesInfo(),this._shaderHeader}},{key:"getShaderMain",value:function(){return this._shaderMain||this._buildAttributesInfo(),this._shaderMain}},{key:"setDataUniforms",value:function(e,t,r,n,i){var a,o=y(this.getUniforms());try{for(o.s();!(a=o.n()).done;){var s=a.value,l=s.name,u=s.type,c=(0,s.getValue)(r,t,n,i);if(null!==c)switch(u){case"float":e.setUniform1f(l,c);break;case"vec2":e.setUniform2fv(l,c);break;case"vec4":e.setUniform4fv(l,c)}}}catch(h){o.e(h)}finally{o.f()}}},{key:"encodeAttributes",value:function(e,t,r,n){for(var i=this.attributesInfo(),a=this.getEncodingInfos(),o=[],s=0,l=0,u=0,c=Object.keys(a);u<c.length;u++){var h,f,p=c[u],d=a[p],v=i[p],g=v.type,m=v.precisionFactor,_=v.isLayout?r.getLayoutProperty(p):r.getPaintProperty(p),x=null==(h=_.interpolator)?void 0:h.getInterpolationRange(t),b=0,w=y(d);try{for(w.s();!(f=w.n()).done;){var k=f.value,E=k.offset,I=k.bufferElementsToAdd;if(I>0){for(var O=0;O<I;O++)o.push(0);s+=l,l=k.bufferElementsToAdd}var T=null!=n?n:_.getValue(x?x[b]:t,e);switch(g){case 0:case 1:o[s]|=this._encodeByte(T*(m||1),8*E);break;case 2:case 3:o[s]|=this._encodeShort(T*(m||1),8*E);break;case 4:case 5:o[s]|=this._encodeByte(T*(m||1),8*E),o[s]|=this._encodeByte(T*(m||1),8*E+8);break;case 6:case 7:o[s]|=this._encodeShort(T*(m||1),8*E),o[s]|=this._encodeShort(T*(m||1),8*E+16);break;case 8:case 9:o[s]|=this._encodeByte(T*(m||1),8*E),o[s]|=this._encodeByte(T*(m||1),8*E+8),o[s]|=this._encodeByte(T*(m||1),8*E+16),o[s]|=this._encodeByte(T*(m||1),8*E+24);break;case 10:o[s]=this._encodeColor(T);break;case 11:case 12:this._encodePattern(s,o,T);break;default:throw new Error("Unsupported encoding type")}b++}}catch(S){w.e(S)}finally{w.f()}}return o}},{key:"getAtributeState",value:function(e){var t=0,r=3+2*e;return t|=this._bit(r),t|=this._bit(r+1)<<1}},{key:"_buildAttributesInfo",value:function(){var t,r=[],n={},i={},a=-1,o=this.attributesInfo(),s=-1,l=y(this.attributes());try{for(l.s();!(t=l.n()).done;){var u=t.value;s++;var c=this.getAtributeState(s);if(0!==c&&3!==c){var h=o[u],f=[];n[u]=f;for(var p=h.type,d=0;d<c;d++){var v=e._encodingInfo[p],g=v.dataType,m=v.bytesPerElement,_=v.count,x=v.normalized,b=m*_,w=i[g],k=0;if(!w||w.count+_>4)w={dataIndex:++a,count:0,offset:0},4!==_&&(i[g]=w),r.push({location:-1,name:"a_data_"+a,count:_,type:g,normalized:x}),k=Math.ceil(Math.max(b/4,1));else{var E=r[w.dataIndex];E.count+=_,k=Math.ceil(Math.max(E.count*m/4,1))-Math.ceil(Math.max(w.offset/4,1))}f.push({dataIndex:w.dataIndex,offset:w.offset,bufferElementsToAdd:k}),w.offset+=b,w.count+=_}}}}catch(U){l.e(U)}finally{l.f()}for(var I=0,O=r;I<O.length;I++){var T=O[I];switch(T.type){case 5120:case 5121:T.count=4;case 5122:case 5123:T.count+=T.count%2}}this._buildVertexBufferLayout(r);var S,L=0,P=y(this._layoutInfo.geometry);try{for(P.s();!(S=P.n()).done;){var D=S.value;this._locations.set(D.name,L++)}}catch(U){P.e(U)}finally{P.f()}var N=this._layoutInfo.opacity;if(N){var A,j=y(N);try{for(j.s();!(A=j.n()).done;){var R=A.value;this._locations.set(R.name,L++)}}catch(U){j.e(U)}finally{j.f()}}this._buildShaderInfo(r,n),this._propertyEncodingInfo=n}},{key:"_buildVertexBufferLayout",value:function(e){var t={},r=this.geometryInfo(),n=r[0].stride;if(0===e.length)t.geometry=r;else{var i,a=[],o=n,s=y(e);try{for(s.s();!(i=s.n()).done;){var l=i.value;n+=v(l.type)*l.count}}catch(m){s.e(m)}finally{s.f()}var u,c=y(r);try{for(c.s();!(u=c.n()).done;){var h=f({},u.value);h.stride=n,a.push(h)}}catch(m){c.e(m)}finally{c.f()}var p,d=y(e);try{for(d.s();!(p=d.n()).done;){var g=p.value;a.push({name:g.name,count:g.count,type:g.type,offset:o,stride:n,normalized:g.normalized||!1,divisor:0}),o+=v(g.type)*g.count}}catch(m){d.e(m)}finally{d.f()}t.geometry=a}this.opacityInfo()&&(t.opacity=this.opacityInfo()),this._layoutInfo=t,this._stride=n}},{key:"_buildShaderInfo",value:function(t,r){var n,i=this,a="\n",o="\n",s=[],l=y(t);try{for(l.s();!(n=l.n()).done;){var c=n.value;a+="attribute ".concat(this._getType(c.count)," ").concat(c.name,";\n")}}catch(_){l.e(_)}finally{l.f()}var h,f=this.attributes(),p=this.attributesInfo(),d=-1,v=y(f);try{var m=function(){var t=h.value;d++;var n=p[t],l=n.name,c=n.type,f=n.precisionFactor,y=n.isLayout,v=f&&1!==f?" * "+1/f:"",m=e._encodingInfo[c],_=m.bytesPerElement,x=m.count,b=function(e){return"a_data_".concat(e.dataIndex).concat(g(x,e.offset,_))};switch(i.getAtributeState(d)){case 0:var w=i._getType(x),k="u_".concat(l);s.push({name:k,type:w,getValue:function(e,r,n,i){var a=y?e.getLayoutValue(t,r):e.getPaintValue(t,r);if(11===c){var o=e.getDashKey(a,e.getLayoutValue("line-cap",r)),s=i.getMosaicItemPosition(o,!1);if(Object(u.h)(s))return null;var l=s.tl,h=s.br;return[l[0],h[1],h[0],l[1]]}if(12===c){var f=i.getMosaicItemPosition(a,-1===t.indexOf("line-"));if(Object(u.h)(f))return null;var p=f.tl,d=f.br;return[p[0],d[1],d[0],p[1]]}if(10===c){var v=a[3];return[v*a[0],v*a[1],v*a[2],v]}return a}}),a+="uniform ".concat(w," ").concat(k,";\n"),o+="".concat(w," ").concat(l," = ").concat(k,";\n");break;case 1:var E=b(r[t][0]);o+="".concat(i._getType(x)," ").concat(l," = ").concat(E).concat(v,";\n");break;case 2:var I="u_t_".concat(l);s.push({name:I,type:"float",getValue:function(e,r,n,i){return(y?e.getLayoutProperty(t):e.getPaintProperty(t)).interpolator.interpolationUniformValue(n,r)}}),a+="uniform float ".concat(I,";\n");var O=b(r[t][0]),T=b(r[t][1]);o+="".concat(i._getType(x)," ").concat(l," = mix(").concat(O).concat(v,", ").concat(T).concat(v,", ").concat(I,");\n")}};for(v.s();!(h=v.n()).done;)m()}catch(_){v.e(_)}finally{v.f()}this._shaderHeader=a,this._shaderMain=o,this._uniforms=s}},{key:"_bit",value:function(e){return(this._key&1<<e)>>e}},{key:"_getType",value:function(e){switch(e){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4"}throw new Error("Invalid count")}},{key:"_encodeColor",value:function(e){var t=255*e[3];return c.a.i8888to32(e[0]*t,e[1]*t,e[2]*t,t)}},{key:"_encodePattern",value:function(e,t,r){if(r&&r.rect){var n=r.rect,i=r.width,a=r.height;t[e]=this._encodeShort(n.x+2,0),t[e]|=this._encodeShort(n.y+2+a,16),t[e+1]=this._encodeShort(n.x+2+i,0),t[e+1]|=this._encodeShort(n.y+2,16)}}},{key:"_encodeByte",value:function(e,t){return(255&e)<<t}},{key:"_encodeShort",value:function(e,t){return(65535&e)<<t}}]),e}();d._encodingInfo={0:{dataType:5120,bytesPerElement:1,count:1,normalized:!1},1:{dataType:5121,bytesPerElement:1,count:1,normalized:!1},2:{dataType:5122,bytesPerElement:2,count:1,normalized:!1},3:{dataType:5123,bytesPerElement:2,count:1,normalized:!1},4:{dataType:5120,bytesPerElement:1,count:2,normalized:!1},5:{dataType:5121,bytesPerElement:1,count:2,normalized:!1},6:{dataType:5122,bytesPerElement:2,count:2,normalized:!1},7:{dataType:5123,bytesPerElement:2,count:2,normalized:!1},8:{dataType:5120,bytesPerElement:1,count:4,normalized:!1},9:{dataType:5121,bytesPerElement:1,count:4,normalized:!1},10:{dataType:5121,bytesPerElement:1,count:4,normalized:!0},11:{dataType:5123,bytesPerElement:2,count:4,normalized:!1},12:{dataType:5123,bytesPerElement:2,count:4,normalized:!1}};var v=function(e){switch(e){case 5126:case 5124:case 5125:return 4;case 5122:case 5123:return 2;case 5120:case 5121:return 1}},g=function(e,t,r){var n=t/r;if(1===e)switch(n){case 0:return".x";case 1:return".y";case 2:return".z";case 3:return".w"}else if(2===e)switch(n){case 0:return".xy";case 1:return".yz";case 2:return".zw"}else if(3===e)switch(n){case 0:return".xyz";case 1:return".yzw"}return""};function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Object(a.a)(e);if(t){var o=Object(a.a)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Object(i.a)(this,r)}}var _=function(e){Object(n.a)(r,e);var t=m(r);function r(e){return Object(o.a)(this,r),t.call(this,e)}return Object(s.a)(r,[{key:"geometryInfo",value:function(){return r.GEOMETRY_LAYOUT}},{key:"opacityInfo",value:function(){return null}},{key:"attributes",value:function(){return r.ATTRIBUTES}},{key:"attributesInfo",value:function(){return r.ATTRIBUTES_INFO}}]),r}(d);function x(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Object(a.a)(e);if(t){var o=Object(a.a)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Object(i.a)(this,r)}}_.ATTRIBUTES=[],_.GEOMETRY_LAYOUT=[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}],_.ATTRIBUTES_INFO={};var b=function(e){Object(n.a)(r,e);var t=x(r);function r(e){return Object(o.a)(this,r),t.call(this,e)}return Object(s.a)(r,[{key:"geometryInfo",value:function(){return r.GEOMETRY_LAYOUT}},{key:"opacityInfo",value:function(){return null}},{key:"attributes",value:function(){return r.ATTRIBUTES}},{key:"attributesInfo",value:function(){return r.ATTRIBUTES_INFO}}]),r}(d);function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Object(a.a)(e);if(t){var o=Object(a.a)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Object(i.a)(this,r)}}b.ATTRIBUTES=["circle-radius","circle-color","circle-opacity","circle-stroke-width","circle-stroke-color","circle-stroke-opacity","circle-blur"],b.GEOMETRY_LAYOUT=[{name:"a_pos",count:2,type:5122,offset:0,stride:4,normalized:!1,divisor:0}],b.ATTRIBUTES_INFO={"circle-radius":{name:"radius",type:1},"circle-color":{name:"color",type:10},"circle-opacity":{name:"opacity",type:1,precisionFactor:100},"circle-stroke-width":{name:"stroke_width",type:1,precisionFactor:4},"circle-stroke-color":{name:"stroke_color",type:10},"circle-stroke-opacity":{name:"stroke_opacity",type:1,precisionFactor:100},"circle-blur":{name:"blur",type:1,precisionFactor:32}};var k=function(e){Object(n.a)(r,e);var t=w(r);function r(e){return Object(o.a)(this,r),t.call(this,e)}return Object(s.a)(r,[{key:"geometryInfo",value:function(){return r.GEOMETRY_LAYOUT}},{key:"opacityInfo",value:function(){return null}},{key:"attributes",value:function(){return r.ATTRIBUTES}},{key:"attributesInfo",value:function(){return r.ATTRIBUTES_INFO}}]),r}(d);k.ATTRIBUTES=["fill-color","fill-opacity","fill-pattern"],k.GEOMETRY_LAYOUT=[{name:"a_pos",count:2,type:5122,offset:0,stride:4,normalized:!1,divisor:0}],k.ATTRIBUTES_INFO={"fill-color":{name:"color",type:10},"fill-opacity":{name:"opacity",type:1,precisionFactor:100},"fill-pattern":{name:"tlbr",type:12,isOptional:!0}};var E=function(e){Object(n.a)(r,e);var t=w(r);function r(e,n){var i;return Object(o.a)(this,r),(i=t.call(this,e)).usefillColor=n,i}return Object(s.a)(r,[{key:"geometryInfo",value:function(){return r.GEOMETRY_LAYOUT}},{key:"opacityInfo",value:function(){return null}},{key:"attributes",value:function(){return this.usefillColor?r.ATTRIBUTES_FILL:r.ATTRIBUTES_OUTLINE}},{key:"attributesInfo",value:function(){return this.usefillColor?r.ATTRIBUTES_INFO_FILL:r.ATTRIBUTES_INFO_OUTLINE}}]),r}(d);function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Object(a.a)(e);if(t){var o=Object(a.a)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Object(i.a)(this,r)}}E.ATTRIBUTES_OUTLINE=["fill-outline-color","fill-opacity"],E.ATTRIBUTES_FILL=["fill-color","fill-opacity"],E.GEOMETRY_LAYOUT=[{name:"a_pos",count:2,type:5122,offset:0,stride:8,normalized:!1,divisor:0},{name:"a_offset",count:2,type:5120,offset:4,stride:8,normalized:!1,divisor:0},{name:"a_xnormal",count:2,type:5120,offset:6,stride:8,normalized:!1,divisor:0}],E.ATTRIBUTES_INFO_OUTLINE={"fill-outline-color":{name:"color",type:10},"fill-opacity":{name:"opacity",type:1,precisionFactor:100}},E.ATTRIBUTES_INFO_FILL={"fill-color":{name:"color",type:10},"fill-opacity":{name:"opacity",type:1,precisionFactor:100}};var O=function(e){Object(n.a)(r,e);var t=I(r);function r(e){return Object(o.a)(this,r),t.call(this,e)}return Object(s.a)(r,[{key:"geometryInfo",value:function(){return r.GEOMETRY_LAYOUT}},{key:"opacityInfo",value:function(){return null}},{key:"attributes",value:function(){return r.ATTRIBUTES}},{key:"attributesInfo",value:function(){return r.ATTRIBUTES_INFO}}]),r}(d);function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Object(a.a)(e);if(t){var o=Object(a.a)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Object(i.a)(this,r)}}O.ATTRIBUTES=["line-blur","line-color","line-gap-width","line-offset","line-opacity","line-width","line-pattern","line-dasharray"],O.GEOMETRY_LAYOUT=[{name:"a_pos",count:2,type:5122,offset:0,stride:16,normalized:!1,divisor:0},{name:"a_extrude_offset",count:4,type:5120,offset:4,stride:16,normalized:!1,divisor:0},{name:"a_dir_normal",count:4,type:5120,offset:8,stride:16,normalized:!1,divisor:0},{name:"a_accumulatedDistance",count:2,type:5123,offset:12,stride:16,normalized:!1,divisor:0}],O.ATTRIBUTES_INFO={"line-width":{name:"width",type:1,precisionFactor:2},"line-gap-width":{name:"gap_width",type:1,precisionFactor:2},"line-offset":{name:"offset",type:0,precisionFactor:2},"line-color":{name:"color",type:10},"line-opacity":{name:"opacity",type:1,precisionFactor:100},"line-blur":{name:"blur",type:1,precisionFactor:4},"line-pattern":{name:"tlbr",type:12,isOptional:!0},"line-dasharray":{name:"tlbr",type:11,isOptional:!0}};var S=[{name:"a_pos",count:2,type:5122,offset:0,stride:16,normalized:!1,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:4,stride:16,normalized:!1,divisor:0},{name:"a_texAngleRange",count:4,type:5121,offset:8,stride:16,normalized:!1,divisor:0},{name:"a_levelInfo",count:4,type:5121,offset:12,stride:16,normalized:!1,divisor:0}],L=[{name:"a_opacityInfo",count:1,type:5121,offset:0,stride:1,normalized:!1,divisor:0}],P=function(e){Object(n.a)(r,e);var t=T(r);function r(e){return Object(o.a)(this,r),t.call(this,e)}return Object(s.a)(r,[{key:"geometryInfo",value:function(){return S}},{key:"opacityInfo",value:function(){return L}},{key:"attributes",value:function(){return r.ATTRIBUTES}},{key:"attributesInfo",value:function(){return r.ATTRIBUTES_INFO}}]),r}(d);P.ATTRIBUTES=["icon-color","icon-opacity","icon-halo-blur","icon-halo-color","icon-halo-width","icon-size"],P.ATTRIBUTES_INFO={"icon-color":{name:"color",type:10},"icon-opacity":{name:"opacity",type:1,precisionFactor:100},"icon-halo-color":{name:"halo_color",type:10},"icon-halo-width":{name:"halo_width",type:1,precisionFactor:4},"icon-halo-blur":{name:"halo_blur",type:1,precisionFactor:4},"icon-size":{name:"size",type:1,precisionFactor:32,isLayout:!0}};var D=function(e){Object(n.a)(r,e);var t=T(r);function r(e){return Object(o.a)(this,r),t.call(this,e)}return Object(s.a)(r,[{key:"geometryInfo",value:function(){return S}},{key:"opacityInfo",value:function(){return L}},{key:"attributes",value:function(){return r.ATTRIBUTES}},{key:"attributesInfo",value:function(){return r.ATTRIBUTES_INFO}}]),r}(d);D.ATTRIBUTES=["text-color","text-opacity","text-halo-blur","text-halo-color","text-halo-width","text-size"],D.ATTRIBUTES_INFO={"text-color":{name:"color",type:10},"text-opacity":{name:"opacity",type:1,precisionFactor:100},"text-halo-color":{name:"halo_color",type:10},"text-halo-width":{name:"halo_width",type:1,precisionFactor:4},"text-halo-blur":{name:"halo_blur",type:1,precisionFactor:4},"text-size":{name:"size",type:1,isLayout:!0}};var N=r("6CzD"),A=r("WYis"),j=r("jaCC"),R=r("r5cT"),U=r("9wAn");function M(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return B(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return B(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function B(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var C={kind:"null"},G={kind:"number"},V={kind:"string"},F={kind:"boolean"},z={kind:"color"},q={kind:"object"},H={kind:"value"};function W(e,t){return{kind:"array",itemType:e,n:t}}var Y=[C,G,V,F,z,q,W(H)];function K(e){if("array"===e.kind){var t=K(e.itemType);return"number"==typeof e.n?"array<".concat(t,", ").concat(e.n,">"):"value"===e.itemType.kind?"array":"array<".concat(t,">")}return e.kind}function Q(e){if(null===e)return C;if("string"==typeof e)return V;if("boolean"==typeof e)return F;if("number"==typeof e)return G;if(e instanceof A.a)return z;if(Array.isArray(e)){var t,r,n=M(e);try{for(n.s();!(r=n.n()).done;){var i=Q(r.value);if(t){if(t!==i){t=H;break}}else t=i}}catch(a){n.e(a)}finally{n.f()}return W(t||H,e.length)}return"object"==typeof e?q:H}function Z(e,t){if("array"===t.kind)return"array"===e.kind&&(0===e.n&&"value"===e.itemType.kind||Z(e.itemType,t.itemType))&&("number"!=typeof t.n||t.n===e.n);if("value"===t.kind){var r,n=M(Y);try{for(n.s();!(r=n.n()).done;){if(Z(e,r.value))return!0}}catch(i){n.e(i)}finally{n.f()}}return t.kind===e.kind}function $(e){if(null===e)return"";var t=typeof e;return"string"===t?e:"number"===t||"boolean"===t?String(e):e instanceof A.a?e.toString():JSON.stringify(e)}function X(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function J(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?X(Object(r),!0).forEach((function(t){Object(l.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):X(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ee(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return te(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return te(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function te(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function re(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Object(a.a)(e);if(t){var o=Object(a.a)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Object(i.a)(this,r)}}var ne=function(){function e(t){Object(o.a)(this,e),this.parent=t,this.vars={}}return Object(s.a)(e,[{key:"add",value:function(e,t){this.vars[e]=t}},{key:"get",value:function(e){return this.vars[e]?this.vars[e]:this.parent?this.parent.get(e):null}}]),e}(),ie=function(){function e(){Object(o.a)(this,e),this.type=H}return Object(s.a)(e,[{key:"evaluate",value:function(e,t){return null==e?void 0:e.id}}],[{key:"parse",value:function(t){if(t.length>1)throw new Error('"id" does not expect arguments');return new e}}]),e}(),ae=function(){function e(){Object(o.a)(this,e),this.type=V}return Object(s.a)(e,[{key:"evaluate",value:function(e,t){if(!e)return null;switch(e.type){case 1:return"Point";case 2:return"LineString";case 3:return"Polygon";default:return null}}}],[{key:"parse",value:function(t){if(t.length>1)throw new Error('"geometry-type" does not expect arguments');return new e}}]),e}(),oe=function(){function e(){Object(o.a)(this,e),this.type=q}return Object(s.a)(e,[{key:"evaluate",value:function(e,t){return null==e?void 0:e.values}}],[{key:"parse",value:function(t){if(t.length>1)throw new Error('"properties" does not expect arguments');return new e}}]),e}(),se=function(){function e(){Object(o.a)(this,e),this.type=G}return Object(s.a)(e,[{key:"evaluate",value:function(e,t){return t}}],[{key:"parse",value:function(t){if(t.length>1)throw new Error('"zoom" does not expect arguments');return new e}}]),e}(),le=function(){function e(t,r,n){Object(o.a)(this,e),this.lhs=t,this.rhs=r,this.compare=n,this.type=F}return Object(s.a)(e,[{key:"evaluate",value:function(e,t){return this.compare(this.lhs.evaluate(e,t),this.rhs.evaluate(e,t))}}],[{key:"parse",value:function(t,r,n){if(3!==t.length&&4!==t.length)throw new Error('"'.concat(t[0],'" expects 2 or 3 arguments'));if(4===t.length)throw new Error('"'.concat(t[0],'" collator not supported'));return new e(Qe(t[1],r),Qe(t[2],r),n)}}]),e}(),ue=function(e){Object(n.a)(r,e);var t=re(r);function r(){return Object(o.a)(this,r),t.apply(this,arguments)}return Object(s.a)(r,null,[{key:"parse",value:function(e,t){return le.parse(e,t,(function(e,t){return e===t}))}}]),r}(le),ce=function(e){Object(n.a)(r,e);var t=re(r);function r(){return Object(o.a)(this,r),t.apply(this,arguments)}return Object(s.a)(r,null,[{key:"parse",value:function(e,t){return le.parse(e,t,(function(e,t){return e!==t}))}}]),r}(le),he=function(e){Object(n.a)(r,e);var t=re(r);function r(){return Object(o.a)(this,r),t.apply(this,arguments)}return Object(s.a)(r,null,[{key:"parse",value:function(e,t){return le.parse(e,t,(function(e,t){return e<t}))}}]),r}(le),fe=function(e){Object(n.a)(r,e);var t=re(r);function r(){return Object(o.a)(this,r),t.apply(this,arguments)}return Object(s.a)(r,null,[{key:"parse",value:function(e,t){return le.parse(e,t,(function(e,t){return e<=t}))}}]),r}(le),ye=function(e){Object(n.a)(r,e);var t=re(r);function r(){return Object(o.a)(this,r),t.apply(this,arguments)}return Object(s.a)(r,null,[{key:"parse",value:function(e,t){return le.parse(e,t,(function(e,t){return e>t}))}}]),r}(le),pe=function(e){Object(n.a)(r,e);var t=re(r);function r(){return Object(o.a)(this,r),t.apply(this,arguments)}return Object(s.a)(r,null,[{key:"parse",value:function(e,t){return le.parse(e,t,(function(e,t){return e>=t}))}}]),r}(le),de=function(){function e(t){Object(o.a)(this,e),this.arg=t,this.type=F}return Object(s.a)(e,[{key:"evaluate",value:function(e,t){return!this.arg.evaluate(e,t)}}],[{key:"parse",value:function(t,r){if(2!==t.length)throw new Error('"!" expects 1 argument');return new e(Qe(t[1],r))}}]),e}(),ve=function(){function e(t){Object(o.a)(this,e),this.args=t,this.type=F}return Object(s.a)(e,[{key:"evaluate",value:function(e,t){var r,n=ee(this.args);try{for(n.s();!(r=n.n()).done;){if(!r.value.evaluate(e,t))return!1}}catch(i){n.e(i)}finally{n.f()}return!0}}],[{key:"parse",value:function(t,r){for(var n=[],i=1;i<t.length;i++)n.push(Qe(t[i],r));return new e(n)}}]),e}(),ge=function(){function e(t){Object(o.a)(this,e),this.args=t,this.type=F}return Object(s.a)(e,[{key:"evaluate",value:function(e,t){var r,n=ee(this.args);try{for(n.s();!(r=n.n()).done;){if(r.value.evaluate(e,t))return!0}}catch(i){n.e(i)}finally{n.f()}return!1}}],[{key:"parse",value:function(t,r){for(var n=[],i=1;i<t.length;i++)n.push(Qe(t[i],r));return new e(n)}}]),e}(),me=function(){function e(t){Object(o.a)(this,e),this.args=t,this.type=F}return Object(s.a)(e,[{key:"evaluate",value:function(e,t){var r,n=ee(this.args);try{for(n.s();!(r=n.n()).done;){if(r.value.evaluate(e,t))return!1}}catch(i){n.e(i)}finally{n.f()}return!0}}],[{key:"parse",value:function(t,r){for(var n=[],i=1;i<t.length;i++)n.push(Qe(t[i],r));return new e(n)}}]),e}(),_e=function(){function e(t,r,n){Object(o.a)(this,e),this.type=t,this.args=r,this.fallback=n}return Object(s.a)(e,[{key:"evaluate",value:function(e,t){var r,n=ee(this.args);try{for(n.s();!(r=n.n()).done;){var i=r.value;if(i.condition.evaluate(e,t))return i.output.evaluate(e,t)}}catch(a){n.e(a)}finally{n.f()}return this.fallback.evaluate(e,t)}}],[{key:"parse",value:function(t,r,n){if(t.length<4)throw new Error('"case" expects at least 3 arguments');if(t.length%2==1)throw new Error('"case" expects an odd number of arguments');for(var i,a=[],o=1;o<t.length-1;o+=2){var s=Qe(t[o],r),l=Qe(t[o+1],r,n);i||(i=l.type),a.push({condition:s,output:l})}var u=Qe(t[t.length-1],r,n);return i||(i=u.type),new e(i,a,u)}}]),e}(),xe=function(){function e(t,r){Object(o.a)(this,e),this.type=t,this.args=r}return Object(s.a)(e,[{key:"evaluate",value:function(e,t){var r,n=ee(this.args);try{for(n.s();!(r=n.n()).done;){var i=r.value.evaluate(e,t);if(null!==i)return i}}catch(a){n.e(a)}finally{n.f()}return null}}],[{key:"parse",value:function(t,r){if(t.length<2)throw new Error('"coalesce" expects at least 1 argument');for(var n,i=[],a=1;a<t.length;a++){var o=Qe(t[a],r);n||(n=o.type),i.push(o)}return new e(n,i)}}]),e}(),be=function(){function e(t,r,n,i,a){Object(o.a)(this,e),this.type=t,this.input=r,this.labels=n,this.outputs=i,this.fallback=a}return Object(s.a)(e,[{key:"evaluate",value:function(e,t){var r=this.input.evaluate(e,t);return(this.outputs[this.labels[r]]||this.fallback).evaluate(e,t)}}],[{key:"parse",value:function(t,r){if(t.length<3)throw new Error('"match" expects at least 3 arguments');if(t.length%2==0)throw new Error('"case" expects an even number of arguments');for(var n,i,a=Qe(t[1],r),o=[],s={},l=2;l<t.length-1;l+=2){var u=t[l];Array.isArray(u)||(u=[u]);var c,h=ee(u);try{for(h.s();!(c=h.n()).done;){var f=c.value,y=typeof f;if("string"!==y&&"number"!==y)throw new Error('"match" requires string or number literal as labels');if(i){if(y!==i)throw new Error('"match" requires labels to have the same type')}else i=y;s[f]=o.length}}catch(d){h.e(d)}finally{h.f()}var p=Qe(t[l+1],r);n||(n=p.type),o.push(p)}return new e(n,a,s,o,Qe(t[t.length-1],r))}}]),e}(),we=function(){function e(t,r,n,i,a){Object(o.a)(this,e),this.operator=t,this.type=r,this.interpolation=n,this.input=i,this.stops=a}return Object(s.a)(e,[{key:"evaluate",value:function(t,r){var n=this.stops;if(1===n.length)return n[0][1].evaluate(t,r);var i=this.input.evaluate(t,r);if(i<=n[0][0])return n[0][1].evaluate(t,r);if(i>=n[n.length-1][0])return n[n.length-1][1].evaluate(t,r);for(var a=0;++a<n.length&&!(i<n[a][0]););var o=n[a-1][0],s=n[a][0],l=e.interpolationRatio(this.interpolation,i,o,s),u=n[a-1][1].evaluate(t,r),c=n[a][1].evaluate(t,r);if("interpolate"===this.operator){if("array"===this.type.kind&&Array.isArray(u)&&Array.isArray(c))return u.map((function(e,t){return Object(U.e)(e,c[t],l)}));if("color"===this.type.kind&&u instanceof A.a&&c instanceof A.a){var h=new A.a(u),f=new A.a(c);return new A.a([Object(U.e)(h.r,f.r,l),Object(U.e)(h.g,f.g,l),Object(U.e)(h.b,f.b,l),Object(U.e)(h.a,f.a,l)])}if("number"===this.type.kind&&"number"==typeof u&&"number"==typeof c)return Object(U.e)(u,c,l);throw new Error('"'.concat(this.operator,'" cannot interpolate type ').concat(K(this.type)))}if("interpolate-hcl"===this.operator){var y=Object(j.c)(u),p=Object(j.c)(c),d=p.h-y.h,v=Object(j.d)({h:y.h+l*(d>180||d<-180?d-360*Math.round(d/360):d),c:Object(U.e)(y.c,p.c,l),l:Object(U.e)(y.l,p.l,l)});return new A.a(J({a:Object(U.e)(u.a,c.a,l)},v))}if("interpolate-lab"===this.operator){var g=Object(j.b)(u),m=Object(j.b)(c),_=Object(j.d)({l:Object(U.e)(g.l,m.l,l),a:Object(U.e)(g.a,m.a,l),b:Object(U.e)(g.b,m.b,l)});return new A.a(J({a:Object(U.e)(u.a,c.a,l)},_))}throw new Error('Unexpected operator "'.concat(this.operator,'"'))}},{key:"interpolationUniformValue",value:function(t,r){var n=this.stops;if(1===n.length)return 0;if(t>=n[n.length-1][0])return 0;for(var i=0;++i<n.length&&!(t<n[i][0]););var a=n[i-1][0],o=n[i][0];return e.interpolationRatio(this.interpolation,r,a,o)}},{key:"getInterpolationRange",value:function(e){var t=this.stops;if(1===t.length){var r=t[0][0];return[r,r]}var n=t[t.length-1][0];if(e>=n)return[n,n];for(var i=0;++i<t.length&&!(e<t[i][0]););return[t[i-1][0],t[i][0]]}}],[{key:"parse",value:function(t,r,n){var i=t[0];if(t.length<5)throw new Error('"'.concat(i,'" expects at least 4 arguments'));var a=t[1];if(!Array.isArray(a)||0===a.length)throw new Error('"'.concat(a,'" is not a valid interpolation'));switch(a[0]){case"linear":if(1!==a.length)throw new Error("Linear interpolation cannot have parameters");break;case"exponential":if(2!==a.length||"number"!=typeof a[1])throw new Error("Exponential interpolation requires one numeric argument");break;case"cubic-bezier":if(5!==a.length)throw new Error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1");for(var o=1;o<5;o++){var s=a[o];if("number"!=typeof s||s<0||s>1)throw new Error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1")}break;default:throw new Error('"'.concat(t[0],'" unknown interpolation type "').concat(a[0],'"'))}if(t.length%2!=1)throw new Error('"'.concat(i,'" expects an even number of arguments'));var l,u=Qe(t[2],r,G);"interpolate-hcl"===i||"interpolate-lab"===i?l=z:n&&"value"!==n.kind&&(l=n);for(var c=[],h=3;h<t.length;h+=2){var f=t[h];if("number"!=typeof f)throw new Error('"'.concat(i,'" requires stop inputs as literal numbers'));if(c.length&&c[c.length-1][0]>=f)throw new Error('"'.concat(i,'" requires strictly ascending stop inputs'));var y=Qe(t[h+1],r,l);l||(l=y.type),c.push([f,y])}if(l&&l!==z&&l!==G&&("array"!==l.kind||l.itemType!==G))throw new Error('"'.concat(i,'" cannot interpolate type ').concat(K(l)));return new e(i,l,a,u,c)}},{key:"interpolationRatio",value:function(t,r,n,i){var a=0;return"linear"===t[0]?a=e.exponentialInterpolationRatio(r,1,n,i):"exponential"===t[0]?a=e.exponentialInterpolationRatio(r,t[1],n,i):"cubic-bezier"===t[0]&&(a=Object(R.c)(t[1],t[2],t[3],t[4])(e.exponentialInterpolationRatio(r,1,n,i),1e-5)),a<0?a=0:a>1&&(a=1),a}},{key:"exponentialInterpolationRatio",value:function(e,t,r,n){var i=n-r;if(0===i)return 0;var a=e-r;return 1===t?a/i:(Math.pow(t,a)-1)/(Math.pow(t,i)-1)}}]),e}(),ke=function(){function e(t,r,n){Object(o.a)(this,e),this.type=t,this.input=r,this.stops=n}return Object(s.a)(e,[{key:"evaluate",value:function(e,t){var r=this.stops;if(1===r.length)return r[0][1].evaluate(e,t);for(var n=this.input.evaluate(e,t),i=0;++i<r.length&&!(n<r[i][0]););return this.stops[i-1][1].evaluate(e,t)}}],[{key:"parse",value:function(t,r){if(t.length<5)throw new Error('"step" expects at least 4 arguments');if(t.length%2!=1)throw new Error('"step" expects an even number of arguments');var n,i=Qe(t[1],r,G),a=[];a.push([-1/0,Qe(t[2],r)]);for(var o=3;o<t.length;o+=2){var s=t[o];if("number"!=typeof s)throw new Error('"step" requires stop inputs as literal numbers');if(a.length&&a[a.length-1][0]>=s)throw new Error('"step" requires strictly ascending stop inputs');var l=Qe(t[o+1],r);n||(n=l.type),a.push([s,l])}return new e(n,i,a)}}]),e}(),Ee=function(){function e(t,r){Object(o.a)(this,e),this.type=t,this.output=r}return Object(s.a)(e,[{key:"evaluate",value:function(e,t){return this.output.evaluate(e,t)}}],[{key:"parse",value:function(t,r,n){if(t.length<4)throw new Error('"let" expects at least 3 arguments');if(t.length%2==1)throw new Error('"let" expects an odd number of arguments');for(var i=new ne(r),a=1;a<t.length-1;a+=2){var o=t[a];if("string"!=typeof o)throw new Error('"let" requires a string to define variable names - found '.concat(o));i.add(o,Qe(t[a+1],r))}var s=Qe(t[t.length-1],i,n);return new e(s.type,s)}}]),e}(),Ie=function(){function e(t,r){Object(o.a)(this,e),this.type=t,this.output=r}return Object(s.a)(e,[{key:"evaluate",value:function(e,t){return this.output.evaluate(e,t)}}],[{key:"parse",value:function(t,r,n){if(2!==t.length||"string"!=typeof t[1])throw new Error('"var" requires just one literal string argument');var i=r.get(t[1]);if(!i)throw new Error("".concat(t[1],' must be defined before being used in a "var" expression'));return new e(n||H,i)}}]),e}(),Oe=function(){function e(t,r,n){Object(o.a)(this,e),this.type=t,this.index=r,this.array=n}return Object(s.a)(e,[{key:"evaluate",value:function(e,t){var r=this.index.evaluate(e,t),n=this.array.evaluate(e,t);if(r<0||r>=n.length)throw new Error('"at" index out of bounds');if(r!==Math.floor(r))throw new Error('"at" index must be an integer');return n[r]}}],[{key:"parse",value:function(t,r){if(3!==t.length)throw new Error('"at" expects 2 arguments');var n=Qe(t[1],r,G),i=Qe(t[2],r);return new e(i.type.itemType,n,i)}}]),e}(),Te=function(){function e(t,r){Object(o.a)(this,e),this.key=t,this.obj=r,this.type=H}return Object(s.a)(e,[{key:"evaluate",value:function(e,t){var r=this.key.evaluate(e,t);return this.obj?this.obj.evaluate(e,t)[r]:null==e?void 0:e.values[r]}}],[{key:"parse",value:function(t,r){switch(t.length){case 2:return new e(Qe(t[1],r));case 3:return new e(Qe(t[1],r),Qe(t[2],r));default:throw new Error('"get" expects 1 or 2 arguments')}}}]),e}(),Se=function(){function e(t,r){Object(o.a)(this,e),this.key=t,this.obj=r,this.type=F}return Object(s.a)(e,[{key:"evaluate",value:function(e,t){var r=this.key.evaluate(e,t);return this.obj?r in this.obj.evaluate(e,t):!(null==e||!e.values[r])}}],[{key:"parse",value:function(t,r){switch(t.length){case 2:return new e(Qe(t[1],r));case 3:return new e(Qe(t[1],r),Qe(t[2],r));default:throw new Error('"has" expects 1 or 2 arguments')}}}]),e}(),Le=function(){function e(t,r){Object(o.a)(this,e),this.key=t,this.vals=r,this.type=F}return Object(s.a)(e,[{key:"evaluate",value:function(e,t){var r=this.key.evaluate(e,t);return-1!==this.vals.evaluate(e,t).indexOf(r)}}],[{key:"parse",value:function(t,r){if(3!==t.length)throw new Error('"in" expects 2 arguments');return new e(Qe(t[1],r),Qe(t[2],r))}}]),e}(),Pe=function(){function e(t,r,n){Object(o.a)(this,e),this.item=t,this.array=r,this.from=n,this.type=G}return Object(s.a)(e,[{key:"evaluate",value:function(e,t){var r=this.item.evaluate(e,t),n=this.array.evaluate(e,t);if(this.from){var i=this.from.evaluate(e,t);if(i!==Math.floor(i))throw new Error('"index-of" index must be an integer');return n.indexOf(r,i)}return n.indexOf(r)}}],[{key:"parse",value:function(t,r){if(t.length<3||t.length>4)throw new Error('"index-of" expects 3 or 4 arguments');var n=Qe(t[1],r),i=Qe(t[2],r);return 4===t.length?new e(n,i,Qe(t[3],r,G)):new e(n,i)}}]),e}(),De=function(){function e(t){Object(o.a)(this,e),this.arg=t,this.type=G}return Object(s.a)(e,[{key:"evaluate",value:function(e,t){var r=this.arg.evaluate(e,t);if("string"==typeof r)return r.length;if(Array.isArray(r))return r.length;throw new Error('"length" expects string or array')}}],[{key:"parse",value:function(t,r){if(2!==t.length)throw new Error('"length" expects 2 arguments');return new e(Qe(t[1],r))}}]),e}(),Ne=function(){function e(t,r,n,i){Object(o.a)(this,e),this.type=t,this.array=r,this.from=n,this.to=i}return Object(s.a)(e,[{key:"evaluate",value:function(e,t){var r=this.array.evaluate(e,t);if(!Array.isArray(r)&&"string"!=typeof r)throw new Error('"slice" input must be an array or a string');var n=this.from.evaluate(e,t);if(n<0||n>=r.length)throw new Error('"slice" index out of bounds');if(n!==Math.floor(n))throw new Error('"slice" index must be an integer');if(this.to){var i=this.to.evaluate(e,t);if(i<0||i>=r.length)throw new Error('"slice" index out of bounds');if(i!==Math.floor(i))throw new Error('"slice" index must be an integer');return r.slice(n,i)}return r.slice(n)}}],[{key:"parse",value:function(t,r){if(t.length<3||t.length>4)throw new Error('"slice" expects 2 or 3 arguments');var n=Qe(t[1],r),i=Qe(t[2],r,G);if(i.type!==G)throw new Error('"slice" index must return a number');if(4===t.length){var a=Qe(t[3],r,G);if(a.type!==G)throw new Error('"slice" index must return a number');return new e(n.type,n,i,a)}return new e(n.type,n,i)}}]),e}(),Ae=function(){function e(){Object(o.a)(this,e),this.type=F}return Object(s.a)(e,[{key:"evaluate",value:function(e,t){return e&&void 0!==e.id}}],[{key:"parse",value:function(t){if(1!==t.length)throw new Error('"has-id" expects no arguments');return new e}}]),e}(),je=function(){function e(t,r){Object(o.a)(this,e),this.args=t,this.calculate=r,this.type=G}return Object(s.a)(e,[{key:"evaluate",value:function(e,t){var r;return this.args&&(r=this.args.map((function(r){return r.evaluate(e,t)}))),this.calculate(r)}}],[{key:"parse",value:function(t,r,n){return new e(t.slice(1).map((function(e){return Qe(e,r)})),n)}}]),e}(),Re=function(e){Object(n.a)(r,e);var t=re(r);function r(){return Object(o.a)(this,r),t.apply(this,arguments)}return Object(s.a)(r,null,[{key:"parse",value:function(e,t){switch(e.length){case 2:return je.parse(e,t,(function(e){return-e[0]}));case 3:return je.parse(e,t,(function(e){return e[0]-e[1]}));default:throw new Error('"-" expects 1 or 2 arguments')}}}]),r}(je),Ue=function(e){Object(n.a)(r,e);var t=re(r);function r(){return Object(o.a)(this,r),t.apply(this,arguments)}return Object(s.a)(r,null,[{key:"parse",value:function(e,t){return je.parse(e,t,(function(e){var t,r=1,n=ee(e);try{for(n.s();!(t=n.n()).done;){r*=t.value}}catch(i){n.e(i)}finally{n.f()}return r}))}}]),r}(je),Me=function(e){Object(n.a)(r,e);var t=re(r);function r(){return Object(o.a)(this,r),t.apply(this,arguments)}return Object(s.a)(r,null,[{key:"parse",value:function(e,t){if(3===e.length)return je.parse(e,t,(function(e){return e[0]/e[1]}));throw new Error('"/" expects 2 arguments')}}]),r}(je),Be=function(e){Object(n.a)(r,e);var t=re(r);function r(){return Object(o.a)(this,r),t.apply(this,arguments)}return Object(s.a)(r,null,[{key:"parse",value:function(e,t){if(3===e.length)return je.parse(e,t,(function(e){return e[0]%e[1]}));throw new Error('"%" expects 2 arguments')}}]),r}(je),Ce=function(e){Object(n.a)(r,e);var t=re(r);function r(){return Object(o.a)(this,r),t.apply(this,arguments)}return Object(s.a)(r,null,[{key:"parse",value:function(e,t){if(3===e.length)return je.parse(e,t,(function(e){return Math.pow(e[0],e[1])}));throw new Error('"^" expects 1 or 2 arguments')}}]),r}(je),Ge=function(e){Object(n.a)(r,e);var t=re(r);function r(){return Object(o.a)(this,r),t.apply(this,arguments)}return Object(s.a)(r,null,[{key:"parse",value:function(e,t){return je.parse(e,t,(function(e){var t,r=0,n=ee(e);try{for(n.s();!(t=n.n()).done;){r+=t.value}}catch(i){n.e(i)}finally{n.f()}return r}))}}]),r}(je),Ve=function(){function e(t,r){Object(o.a)(this,e),this.args=t,this.calculate=r,this.type=G}return Object(s.a)(e,[{key:"evaluate",value:function(e,t){var r;return this.args&&(r=this.args.map((function(r){return r.evaluate(e,t)}))),this.calculate(r)}}],[{key:"parse",value:function(t,r){return new e(t.slice(1).map((function(e){return Qe(e,r)})),e.ops[t[0]])}}]),e}();Ve.ops={abs:function(e){return Math.abs(e[0])},acos:function(e){return Math.acos(e[0])},asin:function(e){return Math.asin(e[0])},atan:function(e){return Math.atan(e[0])},ceil:function(e){return Math.ceil(e[0])},cos:function(e){return Math.cos(e[0])},e:function(){return Math.E},floor:function(e){return Math.floor(e[0])},ln:function(e){return Math.log(e[0])},ln2:function(){return Math.LN2},log10:function(e){return Math.log(e[0])/Math.LN10},log2:function(e){return Math.log(e[0])/Math.LN2},max:function(e){return Math.max.apply(Math,Object(N.a)(e))},min:function(e){return Math.min.apply(Math,Object(N.a)(e))},pi:function(){return Math.PI},round:function(e){return Math.round(e[0])},sin:function(e){return Math.sin(e[0])},sqrt:function(e){return Math.sqrt(e[0])},tan:function(e){return Math.tan(e[0])}};var Fe=function(){function e(t){Object(o.a)(this,e),this.args=t,this.type=V}return Object(s.a)(e,[{key:"evaluate",value:function(e,t){return this.args.map((function(r){return r.evaluate(e,t)})).join("")}}],[{key:"parse",value:function(t,r){return new e(t.slice(1).map((function(e){return Qe(e,r)})))}}]),e}(),ze=function(){function e(t,r){Object(o.a)(this,e),this.arg=t,this.calculate=r,this.type=V}return Object(s.a)(e,[{key:"evaluate",value:function(e,t){return this.calculate(this.arg.evaluate(e,t))}}],[{key:"parse",value:function(t,r){if(2!==t.length)throw new Error("".concat(t[0]," expects 1 argument"));return new e(Qe(t[1],r),e.ops[t[0]])}}]),e}();ze.ops={downcase:function(e){return e.toLowerCase()},upcase:function(e){return e.toUpperCase()}};var qe=function(){function e(t){Object(o.a)(this,e),this.args=t,this.type=z}return Object(s.a)(e,[{key:"evaluate",value:function(e,t){var r=this._validate(this.args[0].evaluate(e,t)),n=this._validate(this.args[1].evaluate(e,t)),i=this._validate(this.args[2].evaluate(e,t));return new A.a({r:r,g:n,b:i})}},{key:"_validate",value:function(e){if("number"!=typeof e||e<0||e>255)throw new Error("".concat(e,": invalid color component"));return Math.round(e)}}],[{key:"parse",value:function(t,r){if(4!==t.length)throw new Error('"rgb" expects 3 arguments');return new e(t.slice(1).map((function(e){return Qe(e,r)})))}}]),e}(),He=function(){function e(t){Object(o.a)(this,e),this.args=t,this.type=z}return Object(s.a)(e,[{key:"evaluate",value:function(e,t){var r=this._validate(this.args[0].evaluate(e,t)),n=this._validate(this.args[1].evaluate(e,t)),i=this._validate(this.args[2].evaluate(e,t)),a=this._validateAlpha(this.args[3].evaluate(e,t));return new A.a({r:r,g:n,b:i,a:a})}},{key:"_validate",value:function(e){if("number"!=typeof e||e<0||e>255)throw new Error("".concat(e,": invalid color component"));return Math.round(e)}},{key:"_validateAlpha",value:function(e){if("number"!=typeof e||e<0||e>1)throw new Error("".concat(e,": invalid alpha color component"));return e}}],[{key:"parse",value:function(t,r){if(5!==t.length)throw new Error('"rgba" expects 4 arguments');return new e(t.slice(1).map((function(e){return Qe(e,r)})))}}]),e}(),We=function(){function e(t){Object(o.a)(this,e),this.color=t,this.type=W(G,4)}return Object(s.a)(e,[{key:"evaluate",value:function(e,t){return new A.a(this.color.evaluate(e,t)).toRgba()}}],[{key:"parse",value:function(t,r){if(2!==t.length)throw new Error('"to-rgba" expects 1 argument');return new e(Qe(t[1],r))}}]),e}(),Ye=function(){function e(t,r){Object(o.a)(this,e),this.type=t,this.args=r}return Object(s.a)(e,[{key:"evaluate",value:function(e,t){var r,n,i=ee(this.args);try{for(i.s();!(n=i.n()).done;){var a=n.value.evaluate(e,t);if(Z(r=Q(a),this.type))return a}}catch(o){i.e(o)}finally{i.f()}throw new Error("Expected ".concat(K(this.type)," but got ").concat(K(r)))}}],[{key:"parse",value:function(t,r){var n=t[0];if(t.length<2)throw new Error("".concat(n," expects at least one argument"));var i,a=1;if("array"===n){if(t.length>2){switch(t[1]){case"string":i=V;break;case"number":i=G;break;case"boolean":i=F;break;default:throw new Error('"array" type argument must be string, number or boolean')}a++}else i=H;var o;if(t.length>3){if(null!==(o=t[2])&&("number"!=typeof o||o<0||o!==Math.floor(o)))throw new Error('"array" length argument must be a positive integer literal');a++}i=W(i,o)}else switch(n){case"string":i=V;break;case"number":i=G;break;case"boolean":i=F;break;case"object":i=q}for(var s=[];a<t.length;a++){var l=Qe(t[a],r);s.push(l)}return new e(i,s)}}]),e}(),Ke=function(){function e(t,r){Object(o.a)(this,e),this.type=t,this.args=r}return Object(s.a)(e,[{key:"evaluate",value:function(t,r){if(this.type===F)return Boolean(this.args[0].evaluate(t,r));if(this.type===V)return $(this.args[0].evaluate(t,r));if(this.type===G){var n,i=ee(this.args);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=Number(a.evaluate(t,r));if(!isNaN(o))return o}}catch(h){i.e(h)}finally{i.f()}return null}if(this.type===z){var s,l=ee(this.args);try{for(l.s();!(s=l.n()).done;){var u=s.value;try{var c=e.toColor(u.evaluate(t,r));if(c instanceof A.a)return c}catch(f){}}}catch(h){l.e(h)}finally{l.f()}return null}}}],[{key:"parse",value:function(t,r){var n=t[0],i=e.types[n];if(i===F||i===V){if(2!==t.length)throw new Error("".concat(n," expects one argument"))}else if(t.length<2)throw new Error("".concat(n," expects at least one argument"));for(var a=[],o=1;o<t.length;o++){var s=Qe(t[o],r);a.push(s)}return new e(i,a)}},{key:"toBoolean",value:function(e){return Boolean(e)}},{key:"toString",value:function(e){return $(e)}},{key:"toNumber",value:function(e){var t=Number(e);if(isNaN(t))throw new Error('"'.concat(e,'" is not a number'));return t}},{key:"toColor",value:function(e){if(e instanceof A.a)return e;if("string"==typeof e){var t=A.a.fromString(e);if(t)return t;throw new Error('"'.concat(e,'" is not a color'))}if(Array.isArray(e))return A.a.fromArray(e);throw new Error('"'.concat(e,'" is not a color'))}}]),e}();function Qe(e,t,r){var n=typeof e;if("string"===n||"boolean"===n||"number"===n||null===e){if(r)switch(r.kind){case"string":"string"!==n&&(e=Ke.toString(e));break;case"number":"number"!==n&&(e=Ke.toNumber(e));break;case"color":e=Ke.toColor(e)}e=["literal",e]}if(!Array.isArray(e)||0===e.length)throw new Error("Expression must be a non empty array");var i=e[0];if("string"!=typeof i)throw new Error("First element of expression must be a string");var a=Ze[i];if(void 0===a)throw new Error('Invalid expression operator "'.concat(i,'"'));if(!a)throw new Error('Unimplemented expression operator "'.concat(i,'"'));return a.parse(e,t,r)}Ke.types={"to-boolean":F,"to-color":z,"to-number":G,"to-string":V};var Ze={array:Ye,boolean:Ye,collator:null,format:null,image:null,literal:function(){function e(t){Object(o.a)(this,e),this.val=t,this.type=Q(t)}return Object(s.a)(e,[{key:"evaluate",value:function(e,t){return this.val}}],[{key:"parse",value:function(t){if(2!==t.length)throw new Error('"literal" expects 1 argument');return new e(t[1])}}]),e}(),number:Ye,"number-format":null,object:Ye,string:Ye,"to-boolean":Ke,"to-color":Ke,"to-number":Ke,"to-string":Ke,typeof:function(){function e(t){Object(o.a)(this,e),this.arg=t,this.type=V}return Object(s.a)(e,[{key:"evaluate",value:function(e,t){return K(Q(this.arg.evaluate(e,t)))}}],[{key:"parse",value:function(t,r){if(2!==t.length)throw new Error('"typeof" expects 1 argument');return new e(Qe(t[1],r))}}]),e}(),accumulated:null,"feature-state":null,"geometry-type":ae,id:ie,"line-progress":null,properties:oe,at:Oe,get:Te,has:Se,in:Le,"index-of":Pe,length:De,slice:Ne,"!":de,"!=":ce,"<":he,"<=":fe,"==":ue,">":ye,">=":pe,all:ve,any:ge,case:_e,coalesce:xe,match:be,within:null,interpolate:we,"interpolate-hcl":we,"interpolate-lab":we,step:ke,let:Ee,var:Ie,concat:Fe,downcase:ze,"is-supported-script":null,"resolved-locale":null,upcase:ze,rgb:qe,rgba:He,"to-rgba":We,"-":Re,"*":Ue,"/":Me,"%":Be,"^":Ce,"+":Ge,abs:Ve,acos:Ve,asin:Ve,atan:Ve,ceil:Ve,cos:Ve,e:Ve,floor:Ve,ln:Ve,ln2:Ve,log10:Ve,log2:Ve,max:Ve,min:Ve,pi:Ve,round:Ve,sin:Ve,sqrt:Ve,tan:Ve,zoom:se,"heatmap-density":null,"has-id":Ae,none:me},$e=function(){function e(t){Object(o.a)(this,e),this._expression=t}return Object(s.a)(e,[{key:"filter",value:function(e,t){if(!this._expression)return!0;try{return this._expression.evaluate(e,t)}catch(r){return console.log(r.message),!0}}}],[{key:"createFilter",value:function(t){if(!t)return null;this.isLegacyFilter(t)&&(t=this.convertLegacyFilter(t));try{var r;return new e(Qe(t,null,F))}catch(r){return console.log(r.message),null}}},{key:"isLegacyFilter",value:function(e){if(!Array.isArray(e))return!0;if(0===e.length)return!0;switch(e[0]){case"==":case"!=":case">":case"<":case">=":case"<=":return 3===e.length&&"string"==typeof e[1]&&!Array.isArray(e[2]);case"in":return e.length>=3&&"string"==typeof e[1]&&!Array.isArray(e[2]);case"!in":return!0;case"any":case"all":for(var t=1;t<e.length;t++)if(!this.isLegacyFilter(e[1]))return!1;return!0;case"none":return!0;case"has":return 2===e.length&&("$id"===e[1]||"$type"===e[1]);case"!has":return!0;default:return!1}}},{key:"convertLegacyFilter",value:function(t){if(!Array.isArray(t)||0===t.length)return!0;var r=t[0];if(1===t.length)return"any"!==r;switch(r){case"==":return e.convertComparison("==",t[1],t[2]);case"!=":return e.negate(e.convertComparison("==",t[1],t[2]));case">":case"<":case">=":case"<=":return e.convertComparison(r,t[1],t[2]);case"in":return e.convertIn(t[1],t.slice(2));case"!in":return e.negate(e.convertIn(t[1],t.slice(2)));case"any":case"all":case"none":return e.convertCombining(r,t.slice(1));case"has":return e.convertHas(t[1]);case"!has":return e.negate(e.convertHas(t[1]));default:throw new Error("Unexpected legacy filter.")}}},{key:"convertComparison",value:function(e,t,r){switch(t){case"$type":return[e,["geometry-type"],r];case"$id":return[e,["id"],r];default:return[e,["get",t],r]}}},{key:"convertIn",value:function(e,t){switch(e){case"$type":return["in",["geometry-type"],["literal",t]];case"$id":return["in",["id"],["literal",t]];default:return["in",["get",e],["literal",t]]}}},{key:"convertHas",value:function(e){switch(e){case"$type":return!0;case"$id":return["has-id"];default:return["has",e]}}},{key:"convertCombining",value:function(e,t){return[e].concat(t.map(this.convertLegacyFilter))}},{key:"negate",value:function(e){return["!",e]}}]),e}(),Xe=function e(){Object(o.a)(this,e)};function Je(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return et(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return et(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function et(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}Xe.backgroundLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:0}},Xe.fillLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:0}},Xe.lineLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:0},"line-cap":{type:"enum",values:["butt","round","square"],default:0},"line-join":{type:"enum",values:["bevel","round","miter"],default:2},"line-miter-limit":{type:"number",default:2},"line-round-limit":{type:"number",default:1.05}},Xe.symbolLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:0},"symbol-avoid-edges":{type:"boolean",default:!1},"symbol-placement":{type:"enum",values:["point","line","line-center"],default:0},"symbol-sort-key":{type:"number",default:-1},"symbol-spacing":{type:"number",minimum:1,default:250},"icon-allow-overlap":{type:"boolean",default:!1},"icon-anchor":{type:"enum",values:["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"],default:0},"icon-ignore-placement":{type:"boolean",default:!1},"icon-image":{type:"string"},"icon-keep-upright":{type:"boolean",default:!1},"icon-offset":{type:"array",value:"number",length:2,default:[0,0]},"icon-optional":{type:"boolean",default:!1},"icon-padding":{type:"number",minimum:0,default:2},"icon-rotate":{type:"number",default:0},"icon-rotation-alignment":{type:"enum",values:["map","viewport","auto"],default:2},"icon-size":{type:"number",minimum:0,default:1},"text-allow-overlap":{type:"boolean",default:!1},"text-anchor":{type:"enum",values:["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"],default:0},"text-field":{type:"string"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"]},"text-ignore-placement":{type:"boolean",default:!1},"text-justify":{type:"enum",values:["auto","left","center","right"],default:2},"text-keep-upright":{type:"boolean",default:!0},"text-letter-spacing":{type:"number",default:0},"text-line-height":{type:"number",default:1.2},"text-max-angle":{type:"number",minimum:0,default:45},"text-max-width":{type:"number",minimum:0,default:10},"text-offset":{type:"array",value:"number",length:2,default:[0,0]},"text-optional":{type:"boolean",default:!1},"text-padding":{type:"number",minimum:0,default:2},"text-rotate":{type:"number",default:0},"text-rotation-alignment":{type:"enum",values:["map","viewport","auto"],default:2},"text-size":{type:"number",minimum:0,default:16},"text-transform":{type:"enum",values:["none","uppercase","lowercase"],default:0},"text-writing-mode":{type:"array",value:"enum",values:["horizontal","vertical"],default:[0]}},Xe.circleLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:0}},Xe.backgroundPaintDefinition={"background-color":{type:"color",default:[0,0,0,1]},"background-opacity":{type:"number",minimum:0,maximum:1,default:1},"background-pattern":{type:"string"}},Xe.fillPaintDefinition={"fill-antialias":{type:"boolean",default:!0},"fill-color":{type:"color",default:[0,0,0,1]},"fill-opacity":{type:"number",minimum:0,maximum:1,default:1},"fill-outline-color":{type:"color",default:[0,0,0,0]},"fill-pattern":{type:"string"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0]},"fill-translate-anchor":{type:"enum",values:["map","viewport"],default:0}},Xe.linePaintDefinition={"line-blur":{type:"number",minimum:0,default:0},"line-color":{type:"color",default:[0,0,0,1]},"line-dasharray":{type:"array",value:"number",default:[]},"line-gap-width":{type:"number",minimum:0,default:0},"line-offset":{type:"number",default:0},"line-opacity":{type:"number",minimum:0,maximum:1,default:1},"line-pattern":{type:"string"},"line-translate":{type:"array",value:"number",length:2,default:[0,0]},"line-translate-anchor":{type:"enum",values:["map","viewport"],default:0},"line-width":{type:"number",minimum:0,default:1}},Xe.symbolPaintDefinition={"icon-color":{type:"color",default:[0,0,0,1]},"icon-halo-blur":{type:"number",minimum:0,default:0},"icon-halo-color":{type:"color",default:[0,0,0,0]},"icon-halo-width":{type:"number",minimum:0,default:0},"icon-opacity":{type:"number",minimum:0,maximum:1,default:1},"icon-translate":{type:"array",value:"number",length:2,default:[0,0]},"icon-translate-anchor":{type:"enum",values:["map","viewport"],default:0},"text-color":{type:"color",default:[0,0,0,1]},"text-halo-blur":{type:"number",minimum:0,default:0},"text-halo-color":{type:"color",default:[0,0,0,0]},"text-halo-width":{type:"number",minimum:0,default:0},"text-opacity":{type:"number",minimum:0,maximum:1,default:1},"text-translate":{type:"array",value:"number",length:2,default:[0,0]},"text-translate-anchor":{type:"enum",values:["map","viewport"],default:0}},Xe.rasterPaintDefinition={"raster-opacity":{type:"number",minimum:0,maximum:1,default:1},"raster-hue-rotate":{type:"number",default:0},"raster-brightness-min":{type:"number",minimum:0,maximum:1,default:0},"raster-brightness-max":{type:"number",minimum:0,maximum:1,default:1},"raster-saturation":{type:"number",minimum:-1,maximum:1,default:0},"raster-contrast":{type:"number",minimum:-1,maximum:1,default:0},"raster-fade-duration":{type:"number",minimum:0,default:300}},Xe.circlePaintDefinition={"circle-blur":{type:"number",minimum:0,default:0},"circle-color":{type:"color",default:[0,0,0,1]},"circle-opacity":{type:"number",minimum:0,maximum:1,default:1},"circle-radius":{type:"number",minimum:0,default:5},"circle-stroke-color":{type:"color",default:[0,0,0,1]},"circle-stroke-opacity":{type:"number",minimum:0,maximum:1,default:1},"circle-stroke-width":{type:"number",minimum:0,default:0},"circle-translate":{type:"array",value:"number",length:2,default:[0,0]},"circle-translate-anchor":{type:"enum",values:["map","viewport"],default:0}};var tt=function(){function e(t,r){var n;switch(Object(o.a)(this,e),this.isDataDriven=!1,this.interpolator=null,t.type){case"number":case"color":n=!0;break;case"array":n="number"===t.value;break;default:n=!1}if(null==r&&(r=t.default),Array.isArray(r)&&r.length>0&&Ze[r[0]]){var i={number:G,color:z,string:V,boolean:F,enum:V};try{var a=Qe(r,null,"array"===t.type?W(i[t.value]||H,t.length):i[t.type]);this.getValue=this._buildExpression(a,t),this.isDataDriven=!0,a instanceof we&&a.input instanceof se&&(this.interpolator=a)}catch(h){console.log(h.message),this.getValue=this._buildSimple(t.default)}}else{n&&"interval"===r.type&&(n=!1);var s=r&&r.stops&&r.stops.length>0;if(s){var l,u=Je(r.stops);try{for(u.s();!(l=u.n()).done;){var c=l.value;c[1]=this._validate(c[1],t)}}catch(f){u.e(f)}finally{u.f()}}if(this.isDataDriven=!!r&&!!r.property,this.isDataDriven)if(void 0!==r.default&&(r.default=this._validate(r.default,t)),s)switch(r.type){case"identity":this.getValue=this._buildIdentity(r,t);break;case"categorical":this.getValue=this._buildCategorical(r,t);break;default:this.getValue=n?this._buildInterpolate(r,t):this._buildInterval(r,t)}else this.getValue=this._buildIdentity(r,t);else s?this.getValue=n?this._buildZoomInterpolate(r):this._buildZoomInterval(r):(r=this._validate(r,t),this.getValue=this._buildSimple(r))}}return Object(s.a)(e,[{key:"_validate",value:function(t,r){if("number"===r.type){if(t<r.minimum)return r.minimum;if(t>r.maximum)return r.maximum}else"color"===r.type?t=e._parseColor(t):"enum"===r.type?"string"==typeof t&&(t=r.values.indexOf(t)):"array"===r.type&&"enum"===r.value?t=t.map((function(e){return"string"==typeof t?r.values.indexOf(e):e})):"string"===r.type&&(t=$(t));return t}},{key:"_buildSimple",value:function(e){return function(){return e}}},{key:"_buildExpression",value:function(e,t){var r=this;return function(n,i){try{var a=e.evaluate(i,n);return void 0===a?t.default:r._validate(a,t)}catch(o){return console.log(o.message),t.default}}}},{key:"_buildIdentity",value:function(e,t){var r=this;return function(n,i){var a;return i&&(a=i.values[e.property]),void 0!==a?r._validate(a,t):void 0!==e.default?e.default:t.default}}},{key:"_buildCategorical",value:function(e,t){var r=this;return function(n,i){var a;return i&&(a=i.values[e.property]),void 0!==(a=r._categorical(a,e.stops))?a:void 0!==e.default?e.default:t.default}}},{key:"_buildInterval",value:function(e,t){var r=this;return function(n,i){var a;return i&&(a=i.values[e.property]),"number"==typeof a?r._interval(a,e.stops):void 0!==e.default?e.default:t.default}}},{key:"_buildInterpolate",value:function(e,t){var r=this;return function(n,i){var a;return i&&(a=i.values[e.property]),"number"==typeof a?r._interpolate(a,e.stops,e.base||1):void 0!==e.default?e.default:t.default}}},{key:"_buildZoomInterpolate",value:function(e){var t=this;return function(r){return t._interpolate(r,e.stops,e.base||1)}}},{key:"_buildZoomInterval",value:function(e){var t=this;return function(r){return t._interval(r,e.stops)}}},{key:"_categorical",value:function(e,t){for(var r=t.length,n=0;n<r;n++)if(t[n][0]===e)return t[n][1]}},{key:"_interval",value:function(e,t){for(var r=t.length,n=0,i=0;i<r&&t[i][0]<=e;i++)n=i;return t[n][1]}},{key:"_interpolate",value:function(e,t,r){for(var n,i,a=t.length,o=0;o<a;o++){var s=t[o];if(!(s[0]<=e)){i=s;break}n=s}if(n&&i){var l=i[0]-n[0],u=e-n[0],c=1===r?u/l:(Math.pow(r,u)-1)/(Math.pow(r,l)-1);if(Array.isArray(n[1])){for(var h=n[1],f=i[1],y=[],p=0;p<h.length;p++)y.push(Object(U.e)(h[p],f[p],c));return y}return Object(U.e)(n[1],i[1],c)}return n?n[1]:i?i[1]:void 0}}],[{key:"_isEmpty",value:function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}},{key:"_parseColor",value:function(e){return Array.isArray(e)?e:("string"==typeof e&&(e=new A.a(e)),e instanceof A.a?this._isEmpty(e)?void 0:A.a.toUnitRGBA(e):e)}}]),e}(),rt=r("PmOk");function nt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Object(a.a)(e);if(t){var o=Object(a.a)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Object(i.a)(this,r)}}function it(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return at(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return at(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function at(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var ot=function(){function e(t,r,n,i){switch(Object(o.a)(this,e),this.type=t,this.typeName=r.type,this.id=r.id,this.source=r.source,this.sourceLayer=r["source-layer"],this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,this.filter=r.filter,this.layout=r.layout,this.paint=r.paint,this.z=n,this.uid=i,t){case 0:this._layoutDefinition=Xe.backgroundLayoutDefinition,this._paintDefinition=Xe.backgroundPaintDefinition;break;case 1:this._layoutDefinition=Xe.fillLayoutDefinition,this._paintDefinition=Xe.fillPaintDefinition;break;case 2:this._layoutDefinition=Xe.lineLayoutDefinition,this._paintDefinition=Xe.linePaintDefinition;break;case 3:this._layoutDefinition=Xe.symbolLayoutDefinition,this._paintDefinition=Xe.symbolPaintDefinition;break;case 4:this._layoutDefinition=Xe.circleLayoutDefinition,this._paintDefinition=Xe.circlePaintDefinition}this._layoutProperties=this._parseLayout(this.layout),this._paintProperties=this._parsePaint(this.paint)}return Object(s.a)(e,[{key:"getFeatureFilter",value:function(){return void 0!==this._featureFilter?this._featureFilter:this._featureFilter=$e.createFilter(this.filter)}},{key:"getLayoutProperty",value:function(e){return this._layoutProperties[e]}},{key:"getPaintProperty",value:function(e){return this._paintProperties[e]}},{key:"getLayoutValue",value:function(e,t,r){var n,i=this._layoutProperties[e];return i&&(n=i.getValue(t,r)),void 0===n&&(n=this._layoutDefinition[e].default),n}},{key:"getPaintValue",value:function(e,t,r){var n,i=this._paintProperties[e];return i&&(n=i.getValue(t,r)),void 0===n&&(n=this._paintDefinition[e].default),n}},{key:"isPainterDataDriven",value:function(){var e=this._paintProperties;if(e)for(var t in e)if(e[t].isDataDriven)return!0;return!1}},{key:"_parseLayout",value:function(e){var t={};for(var r in e){var n=this._layoutDefinition[r];n&&(t[r]=new tt(n,e[r]))}return t}},{key:"_parsePaint",value:function(e){var t={};for(var r in e){var n=this._paintDefinition[r];n&&(t[r]=new tt(n,e[r]))}return t}},{key:"computeAttributesKey",value:function(e,t,r,n){var i,a=0,o=0,s=it(t);try{for(s.s();!(i=s.n()).done;){var l=i.value,u=3;if(!l||l!==n){var c=r[l],h=c.isLayout,f=c.isOptional,y=h?this.getLayoutProperty(l):this.getPaintProperty(l);u=null!=y&&y.interpolator?2:null!=y&&y.isDataDriven?1:f&&!y?3:0}o|=u<<a,a+=2}}catch(p){s.e(p)}finally{s.f()}return o<<3|e}}]),e}(),st=function(e){Object(n.a)(r,e);var t=nt(r);function r(e,n,i,a){var s;return Object(o.a)(this,r),(s=t.call(this,e,n,i,a)).backgroundMaterial=new _(s.computeAttributesKey(0,_.ATTRIBUTES,_.ATTRIBUTES_INFO)),s}return r}(ot),lt=function(e){Object(n.a)(r,e);var t=nt(r);function r(e,n,i,a){var s;Object(o.a)(this,r);var l=(s=t.call(this,e,n,i,a)).getPaintProperty("fill-color"),u=s.getPaintProperty("fill-opacity"),c=s.getPaintProperty("fill-pattern");s.hasDataDrivenColor=null==l?void 0:l.isDataDriven,s.hasDataDrivenOpacity=null==u?void 0:u.isDataDriven,s.hasDataDrivenFill=s.hasDataDrivenColor||s.hasDataDrivenOpacity||(null==c?void 0:c.isDataDriven);var h=s.getPaintProperty("fill-outline-color");return s.outlineUsesFillColor=!h,s.hasDataDrivenOutlineColor=null==h?void 0:h.isDataDriven,s.hasDataDrivenOutline=h?h.isDataDriven:!!l&&l.isDataDriven,s.hasDataDrivenOutline=(h?s.hasDataDrivenOutlineColor:s.hasDataDrivenColor)||s.hasDataDrivenOpacity,s.fillMaterial=new k(s.computeAttributesKey(1,k.ATTRIBUTES,k.ATTRIBUTES_INFO)),s.outlineMaterial=new E(s.computeAttributesKey(2,s.outlineUsesFillColor?E.ATTRIBUTES_FILL:E.ATTRIBUTES_OUTLINE,s.outlineUsesFillColor?E.ATTRIBUTES_INFO_FILL:E.ATTRIBUTES_INFO_OUTLINE),s.outlineUsesFillColor),s}return r}(ot),ut=function(e){Object(n.a)(r,e);var t=nt(r);function r(e,n,i,a){var s,l,u,c,h,f,y,p,d,v;Object(o.a)(this,r);var g=(s=t.call(this,e,n,i,a)).getPaintProperty("line-pattern");if(s.lineMaterial=new O(s.computeAttributesKey(3,O.ATTRIBUTES,O.ATTRIBUTES_INFO,g?"line-dasharray":"")),s.hasDataDrivenLine=(null==(l=s.getPaintProperty("line-blur"))?void 0:l.isDataDriven)||(null==(u=s.getPaintProperty("line-color"))?void 0:u.isDataDriven)||(null==(c=s.getPaintProperty("line-gap-width"))?void 0:c.isDataDriven)||(null==(h=s.getPaintProperty("line-offset"))?void 0:h.isDataDriven)||(null==(f=s.getPaintProperty("line-opacity"))?void 0:f.isDataDriven)||(null==(y=s.getPaintProperty("line-pattern"))?void 0:y.isDataDriven)||(null==(p=s.getPaintProperty("line-dasharray"))?void 0:p.isDataDriven)||(null==(d=s.getLayoutProperty("line-cap"))?void 0:d.isDataDriven)||(null==(v=s.getPaintProperty("line-width"))?void 0:v.isDataDriven),s.canUseThinTessellation=!1,!s.hasDataDrivenLine){var m=s.getPaintProperty("line-width");if(!m||"number"==typeof m&&.5*m<rt.D){var _=s.getPaintProperty("line-offset");(!_||"number"==typeof _&&0===_)&&(s.canUseThinTessellation=!0)}}return s}return Object(s.a)(r,[{key:"getDashKey",value:function(e,t){var r;switch(t){case 0:r="Butt";break;case 1:r="Round";break;case 2:r="Square";break;default:r="Butt"}return"dasharray-[".concat(e.toString(),"]-").concat(r)}}]),r}(ot),ct=function(e){Object(n.a)(r,e);var t=nt(r);function r(e,n,i,a){var s,l,u,c,h,f,y,p,d,v,g,m,_;return Object(o.a)(this,r),(s=t.call(this,e,n,i,a)).iconMaterial=new P(s.computeAttributesKey(4,P.ATTRIBUTES,P.ATTRIBUTES_INFO)),s.textMaterial=new D(s.computeAttributesKey(6,D.ATTRIBUTES,D.ATTRIBUTES_INFO)),s.hasDataDrivenIcon=(null==(l=s.getPaintProperty("icon-color"))?void 0:l.isDataDriven)||(null==(u=s.getPaintProperty("icon-halo-blur"))?void 0:u.isDataDriven)||(null==(c=s.getPaintProperty("icon-halo-color"))?void 0:c.isDataDriven)||(null==(h=s.getPaintProperty("icon-halo-width"))?void 0:h.isDataDriven)||(null==(f=s.getPaintProperty("icon-opacity"))?void 0:f.isDataDriven)||(null==(y=s.getLayoutProperty("icon-size"))?void 0:y.isDataDriven),s.hasDataDrivenText=(null==(p=s.getPaintProperty("text-color"))?void 0:p.isDataDriven)||(null==(d=s.getPaintProperty("text-halo-blur"))?void 0:d.isDataDriven)||(null==(v=s.getPaintProperty("text-halo-color"))?void 0:v.isDataDriven)||(null==(g=s.getPaintProperty("text-halo-width"))?void 0:g.isDataDriven)||(null==(m=s.getPaintProperty("text-opacity"))?void 0:m.isDataDriven)||(null==(_=s.getLayoutProperty("text-size"))?void 0:_.isDataDriven),s}return r}(ot),ht=function(e){Object(n.a)(r,e);var t=nt(r);function r(e,n,i,a){var s;return Object(o.a)(this,r),(s=t.call(this,e,n,i,a)).circleMaterial=new b(s.computeAttributesKey(5,b.ATTRIBUTES,b.ATTRIBUTES_INFO)),s}return r}(ot),ft=function(){function e(t,r,n){var i,a,s,l,u,c;Object(o.a)(this,e),this.allowOverlap=t.getLayoutValue("icon-allow-overlap",r),this.ignorePlacement=t.getLayoutValue("icon-ignore-placement",r),this.keepUpright=t.getLayoutValue("icon-keep-upright",r),this.optional=t.getLayoutValue("icon-optional",r),this.rotationAlignment=t.getLayoutValue("icon-rotation-alignment",r),2===this.rotationAlignment&&(this.rotationAlignment=n?0:1),null!=(i=c=t.getLayoutProperty("icon-anchor"))&&i.isDataDriven?this._anchorProp=c:this.anchor=t.getLayoutValue("icon-anchor",r),null!=(a=c=t.getLayoutProperty("icon-offset"))&&a.isDataDriven?this._offsetProp=c:this.offset=t.getLayoutValue("icon-offset",r),null!=(s=c=t.getLayoutProperty("icon-padding"))&&s.isDataDriven?this._paddingProp=c:this.padding=t.getLayoutValue("icon-padding",r),null!=(l=c=t.getLayoutProperty("icon-rotate"))&&l.isDataDriven?this._rotateProp=c:this.rotate=t.getLayoutValue("icon-rotate",r),null!=(u=c=t.getLayoutProperty("icon-size"))&&u.isDataDriven?this._sizeProp=c:this.size=t.getLayoutValue("icon-size",r)}return Object(s.a)(e,[{key:"update",value:function(e,t){this._anchorProp&&(this.anchor=this._anchorProp.getValue(e,t)),this._offsetProp&&(this.offset=this._offsetProp.getValue(e,t)),this._paddingProp&&(this.padding=this._paddingProp.getValue(e,t)),this._rotateProp&&(this.rotate=this._rotateProp.getValue(e,t)),this._sizeProp&&(this.size=this._sizeProp.getValue(e,t))}}]),e}(),yt=function(){function e(t,r,n){var i,a,s,l,u,c,h,f,y,p,d,v;Object(o.a)(this,e),this.allowOverlap=t.getLayoutValue("text-allow-overlap",r),this.ignorePlacement=t.getLayoutValue("text-ignore-placement",r),this.keepUpright=t.getLayoutValue("text-keep-upright",r),this.optional=t.getLayoutValue("text-optional",r),this.rotationAlignment=t.getLayoutValue("text-rotation-alignment",r),2===this.rotationAlignment&&(this.rotationAlignment=n?0:1),null!=(i=v=t.getLayoutProperty("text-anchor"))&&i.isDataDriven?this._anchorProp=v:this.anchor=t.getLayoutValue("text-anchor",r),null!=(a=v=t.getLayoutProperty("text-justify"))&&a.isDataDriven?this._justifyProp=v:this.justify=t.getLayoutValue("text-justify",r),null!=(s=v=t.getLayoutProperty("text-letter-spacing"))&&s.isDataDriven?this._letterSpacingProp=v:this.letterSpacing=t.getLayoutValue("text-letter-spacing",r),null!=(l=v=t.getLayoutProperty("text-line-height"))&&l.isDataDriven?this._lineHeightProp=v:this.lineHeight=t.getLayoutValue("text-line-height",r),null!=(u=v=t.getLayoutProperty("text-max-angle"))&&u.isDataDriven?this._maxAngleProp=v:this.maxAngle=t.getLayoutValue("text-max-angle",r),null!=(c=v=t.getLayoutProperty("text-max-width"))&&c.isDataDriven?this._maxWidthProp=v:this.maxWidth=t.getLayoutValue("text-max-width",r),null!=(h=v=t.getLayoutProperty("text-offset"))&&h.isDataDriven?this._offsetProp=v:this.offset=t.getLayoutValue("text-offset",r),null!=(f=v=t.getLayoutProperty("text-padding"))&&f.isDataDriven?this._paddingProp=v:this.padding=t.getLayoutValue("text-padding",r),null!=(y=v=t.getLayoutProperty("text-rotate"))&&y.isDataDriven?this._rotateProp=v:this.rotate=t.getLayoutValue("text-rotate",r),null!=(p=v=t.getLayoutProperty("text-size"))&&p.isDataDriven?this._sizeProp=v:this.size=t.getLayoutValue("text-size",r),null!=(d=v=t.getLayoutProperty("text-writing-mode"))&&d.isDataDriven?this._writingModeProp=v:this.writingMode=t.getLayoutValue("text-writing-mode",r)}return Object(s.a)(e,[{key:"update",value:function(e,t){this._anchorProp&&(this.anchor=this._anchorProp.getValue(e,t)),this._justifyProp&&(this.justify=this._justifyProp.getValue(e,t)),this._letterSpacingProp&&(this.letterSpacing=this._letterSpacingProp.getValue(e,t)),this._lineHeightProp&&(this.lineHeight=this._lineHeightProp.getValue(e,t)),this._maxAngleProp&&(this.maxAngle=this._maxAngleProp.getValue(e,t)),this._maxWidthProp&&(this.maxWidth=this._maxWidthProp.getValue(e,t)),this._offsetProp&&(this.offset=this._offsetProp.getValue(e,t)),this._paddingProp&&(this.padding=this._paddingProp.getValue(e,t)),this._rotateProp&&(this.rotate=this._rotateProp.getValue(e,t)),this._sizeProp&&(this.size=this._sizeProp.getValue(e,t)),this._writingModeProp&&(this.writingMode=this._writingModeProp.getValue(e,t))}}]),e}()},"lb/t":function(e,t,r){"use strict";r.r(t);var n=r("eijD"),i=r("hisu"),a=r("yBJb"),o=r("NthX"),s=r.n(o),l=r("IH5m"),u=r("7im+"),c=r("9wAn");function h(e){return!(e<11904)&&(e>=12704&&e<=12735||e>=12544&&e<=12591||e>=65072&&e<=65103||e>=63744&&e<=64255||e>=13056&&e<=13311||e>=11904&&e<=12031||e>=12736&&e<=12783||e>=12288&&e<=12351||e>=13312&&e<=19903||e>=19968&&e<=40959||e>=12800&&e<=13055||e>=65280&&e<=65519||e>=12352&&e<=12447||e>=12272&&e<=12287||e>=12032&&e<=12255||e>=12784&&e<=12799||e>=12448&&e<=12543||e>=65040&&e<=65055||e>=42128&&e<=42191||e>=40960&&e<=42127)}function f(e){switch(e){case 10:case 32:case 38:case 40:case 41:case 43:case 45:case 47:case 173:case 183:case 8203:case 8208:case 8211:case 8231:return!0}return!1}function y(e){switch(e){case 9:case 10:case 11:case 12:case 13:case 32:return!0}return!1}var p=r("hLiK");function d(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return v(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return v(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var g=function(){function e(t,r,n,a,o,s,l){Object(i.a)(this,e),this._glyphItems=t,this._maxWidth=r,this._lineHeight=n,this._letterSpacing=a,this._hAnchor=o,this._vAnchor=s,this._justify=l}return Object(a.a)(e,[{key:"getShaping",value:function(e,t,r){for(var n,i=this._letterSpacing,a=this._lineHeight,o=this._justify,s=this._maxWidth,l=[],u=0,c=0,p=e.length,v=0;v<p;v++){var g,m=e.charCodeAt(v),_=r&&(746===(n=m)||747===n||!(n<4352)&&(n>=12704&&n<=12735||n>=12544&&n<=12591||n>=65072&&n<=65103&&!(n>=65097&&n<=65103)||n>=63744&&n<=64255||n>=13056&&n<=13311||n>=11904&&n<=12031||n>=12736&&n<=12783||n>=12288&&n<=12351&&!(n>=12296&&n<=12305||n>=12308&&n<=12319||12336===n)||n>=13312&&n<=19903||n>=19968&&n<=40959||n>=12800&&n<=13055||n>=12592&&n<=12687||n>=43360&&n<=43391||n>=55216&&n<=55295||n>=4352&&n<=4607||n>=44032&&n<=55215||n>=12352&&n<=12447||n>=12272&&n<=12287||n>=12688&&n<=12703||n>=12032&&n<=12255||n>=12784&&n<=12799||n>=12448&&n<=12543&&12540!==n||n>=65280&&n<=65519&&!(65288===n||65289===n||65293===n||n>=65306&&n<=65310||65339===n||65341===n||65343===n||n>=65371&&n<=65503||65507===n||n>=65512&&n<=65519)||n>=65104&&n<=65135&&!(n>=65112&&n<=65118||n>=65123&&n<=65126)||n>=5120&&n<=5759||n>=6320&&n<=6399||n>=65040&&n<=65055||n>=19904&&n<=19967||n>=40960&&n<=42127||n>=42128&&n<=42191)),x=void 0,b=d(this._glyphItems);try{for(b.s();!(g=b.n()).done;){if(x=g.value[m])break}}catch(Y){b.e(Y)}finally{b.f()}l.push({codePoint:m,x:u,y:c,vertical:_,glyphMosaicItem:x}),x&&(u+=x.metrics.advance+i)}var w=u;s>0&&(w=u/Math.max(1,Math.ceil(u/s)));for(var k=e.indexOf("​")>=0,E=[],I=0;I<p-1;I++){var O=l[I].codePoint,T=h(O);if(f(O)||T){var S=0;if(10===O)S-=1e4;else if(T&&k)S+=150;else{40!==O&&65288!==O||(S+=50);var L=l[I+1].codePoint;41!==L&&65289!==L||(S+=50)}E.push(this._buildBreak(I+1,l[I].x,w,E,S,!1))}}for(var P=this._optimalBreaks(this._buildBreak(p,u,w,E,0,!0)),D=0,N=t?-a:a,A=0,j=0;j<P.length;j++){for(var R=P[j],U=A;U<R&&y(l[U].codePoint);)l[U].glyphMosaicItem=null,++U;for(var M=R-1;M>U&&y(l[M].codePoint);)l[M].glyphMosaicItem=null,--M;if(U<=M){for(var B=l[U].x,C=U;C<=M;C++)l[C].x-=B,l[C].y=c;var G=l[M].x;l[M].glyphMosaicItem&&(G+=l[M].glyphMosaicItem.metrics.advance),D=Math.max(G,D),o&&this._applyJustification(l,U,M)}A=R,c+=N}if(l.length>0){var V=P.length-1,F=(o-this._hAnchor)*D,z=(-this._vAnchor*(V+1)+.5)*a;t&&V&&(z+=V*a);var q,H=d(l);try{for(H.s();!(q=H.n()).done;){var W=q.value;W.x+=F,W.y+=z}}catch(Y){H.e(Y)}finally{H.f()}}return l.filter((function(e){return e.glyphMosaicItem}))}},{key:"_breakScore",value:function(e,t,r,n){var i=(e-t)*(e-t);return n?e<t?i/2:2*i:i+Math.abs(r)*r}},{key:"_buildBreak",value:function(e,t,r,n,i,a){var o,s=null,l=this._breakScore(t,r,i,a),u=d(n);try{for(u.s();!(o=u.n()).done;){var c=o.value,h=t-c.x,f=this._breakScore(h,r,i,a)+c.score;f<=l&&(s=c,l=f)}}catch(y){u.e(y)}finally{u.f()}return{index:e,x:t,score:l,previousBreak:s}}},{key:"_optimalBreaks",value:function(e){return e?this._optimalBreaks(e.previousBreak).concat(e.index):[]}},{key:"_applyJustification",value:function(e,t,r){for(var n=e[r],i=n.vertical?24:n.glyphMosaicItem?n.glyphMosaicItem.metrics.advance:0,a=(n.x+i)*this._justify,o=t;o<=r;o++)e[o].x-=a}}],[{key:"getTextBox",value:function(e,t){if(!e.length)return null;var r,n=1/0,i=1/0,a=0,o=0,s=d(e);try{for(s.s();!(r=s.n()).done;){var l=r.value,u=l.glyphMosaicItem.metrics.advance,c=l.x,h=l.y-17,f=c+u,y=h+t;n=Math.min(n,c),a=Math.max(a,f),i=Math.min(i,h),o=Math.max(o,y)}}catch(p){s.e(p)}finally{s.f()}return{x:n,y:i,width:a-n,height:o-i}}},{key:"getBox",value:function(e){if(!e.length)return null;var t,r=1/0,n=1/0,i=0,a=0,o=d(e);try{for(o.s();!(t=o.n()).done;){var s=t.value,l=s.glyphMosaicItem.metrics,u=l.height,c=l.left,h=l.top,f=l.width,y=s.x,p=s.y-(u-Math.abs(h)),v=y+f+c,g=p+u;r=Math.min(r,y),i=Math.max(i,v),n=Math.min(n,p),a=Math.max(a,g)}}catch(m){o.e(m)}finally{o.f()}return{x:r,y:n,width:i-r,height:a-n}}},{key:"addDecoration",value:function(e,t){var r=e.length;if(0!==r){for(var n=e[0].x+e[0].glyphMosaicItem.metrics.left,i=e[0].y,a=1;a<r;a++){var o=e[a];if(o.y!==i){var s=e[a-1].x+e[a-1].glyphMosaicItem.metrics.left+e[a-1].glyphMosaicItem.metrics.width;e.push({codePoint:0,x:n,y:i+t-3,vertical:!1,glyphMosaicItem:{sdf:!0,rect:new p.a(4,0,4,8),metrics:{width:s-n,height:8,left:0,top:0,advance:0},page:0,code:0}}),i=o.y,n=o.x+o.glyphMosaicItem.metrics.left}}var l=e[r-1].x+e[r-1].glyphMosaicItem.metrics.left+e[r-1].glyphMosaicItem.metrics.width;e.push({codePoint:0,x:n,y:i+t-3,vertical:!1,glyphMosaicItem:{sdf:!0,rect:new p.a(4,0,4,8),metrics:{width:l-n,height:8,left:0,top:0,advance:0},page:0,code:0}})}}}]),e}(),m=r("bQwG"),_=r("FA+R");function x(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return b(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return b(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var w=function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5;Object(i.a)(this,e),this.x=t,this.y=r,this.angle=n,this.segment=a,this.minzoom=o},k=function e(t,r,n,a,o){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.5,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:c.c;Object(i.a)(this,e),this.anchor=t,this.labelAngle=r,this.glyphAngle=n,this.page=a,this.alternateVerticalGlyph=o,this.minzoom=s,this.maxzoom=l},E=function e(t,r,n,a,o,s,l,u,c,h,f,y){Object(i.a)(this,e),this.tl=t,this.tr=r,this.bl=n,this.br=a,this.mosaicRect=o,this.labelAngle=s,this.minAngle=l,this.maxAngle=u,this.anchor=c,this.minzoom=h,this.maxzoom=f,this.page=y},I=function e(t){Object(i.a)(this,e),this.shapes=t},O=function(){function e(){Object(i.a)(this,e)}return Object(a.a)(e,[{key:"getIconPlacement",value:function(e,t,r){var n=new _.a(e.x,e.y),i=0===r.rotationAlignment,a=r.keepUpright,o=r.rotate*c.b;i&&(o+=e.angle);var s=new I([]);return r.allowOverlap&&r.ignorePlacement||!m.c||(s.iconColliders=[]),this._addIconPlacement(s,n,t,r,o),i&&a&&this._addIconPlacement(s,n,t,r,o+c.d),s}},{key:"_addIconPlacement",value:function(e,t,r,n,i){var a=r.pixelRatio,o=r.width/a,s=r.height/a,l=n.offset,u=l[0],h=l[1];switch(n.anchor){case 0:u-=o/2,h-=s/2;break;case 1:h-=s/2;break;case 2:u-=o,h-=s/2;break;case 3:u-=o/2;break;case 4:u-=o/2,h-=s;break;case 5:break;case 7:h-=s;break;case 6:u-=o;break;case 8:u-=o,h-=s}var f=r.rect,y=2/a,p=u-y,d=h-y,v=p+f.width/a,g=d+f.height/a,x=new _.a(p,d),b=new _.a(v,g),w=new _.a(p,g),k=new _.a(v,d);if(0!==i){var I=Math.cos(i),O=Math.sin(i);x.rotate(I,O),b.rotate(I,O),w.rotate(I,O),k.rotate(I,O)}var T=new E(x,k,w,b,f,i,0,256,t,.5,c.c,0);if(e.shapes.push(T),(!n.allowOverlap||!n.ignorePlacement)&&m.c){var S=n.size,L=n.padding,P={xTile:t.x,yTile:t.y,dxPixels:u*S-L,dyPixels:h*S-L,hard:!n.optional,partIndex:0,width:o*S+2*L,height:s*S+2*L,angle:i,minLod:.5,maxLod:c.c};e.iconColliders.push(P)}}},{key:"getTextPlacement",value:function(e,t,r,n){var i,a=new _.a(e.x,e.y),o=n.rotate*c.b,s=0===n.rotationAlignment,l=n.keepUpright,u=n.padding,h=.5,f=s?e.angle:0,y=e.segment>=0&&s,p=n.allowOverlap&&n.ignorePlacement?null:[],d=[],v=!y,m=Number.POSITIVE_INFINITY,b=Number.NEGATIVE_INFINITY,w=m,O=b,T=(y||s)&&l,S=n.size/24,L=!1,P=x(t);try{for(P.s();!(i=P.n()).done;){if(i.value.vertical){L=!0;break}}}catch(Ne){P.e(Ne)}finally{P.f()}var D,N=0,A=0;if(!y&&L){var j=g.getTextBox(t,24*n.lineHeight);switch(n.anchor){case 1:N=j.height/2,A=-j.width/2;break;case 2:N=-j.height/2,A=j.width/2;break;case 3:N=j.height/2,A=j.width/2;break;case 4:N=-j.height/2,A=-j.width/2;break;case 5:N=j.height;break;case 7:A=-j.width;break;case 6:A=j.width;break;case 8:N=-j.height}}N+=24*n.offset[0],A+=24*n.offset[1];var R,U=x(t);try{for(U.s();!(R=U.n()).done;){var M=R.value,B=M.glyphMosaicItem;if(B&&!B.rect.isEmpty){var C=B.rect,G=B.metrics,V=B.page;if(p&&v){if(void 0!==D&&D!==M.y){var F=void 0,z=void 0,q=void 0,H=void 0;L?(F=-O+N,z=m+A,q=O-w,H=b-m):(F=m+N,z=w+A,q=b-m,H=O-w);var W={xTile:e.x,yTile:e.y,dxPixels:F*S-u,dyPixels:z*S-u,hard:!n.optional,partIndex:1,width:q*S+2*u,height:H*S+2*u,angle:o,minLod:.5,maxLod:c.c};p.push(W),m=Number.POSITIVE_INFINITY,b=Number.NEGATIVE_INFINITY,w=m,O=b}D=M.y}var Y=[];if(y){var K=.5*B.metrics.width,Q=(M.x+G.left-4+K)*S*8;if(h=this._placeGlyph(e,h,Q,r,e.segment,1,M.vertical,V,Y),l&&(h=this._placeGlyph(e,h,Q,r,e.segment,-1,M.vertical,V,Y)),h>=2)break}else Y.push(new k(a,f,f,V,!1)),s&&l&&Y.push(new k(a,f+c.d,f+c.d,V,!1));var Z=M.x+G.left,$=M.y-17-G.top,X=Z+G.width,J=$+G.height,ee=void 0,te=void 0,re=void 0,ne=void 0,ie=void 0,ae=void 0,oe=void 0,se=void 0;if(!y&&L)if(M.vertical){var le=(Z+X)/2-G.height/2,ue=($+J)/2+G.width/2;ee=new _.a(-ue-4+N,le-4+A),te=new _.a(ee.x+C.width,ee.y+C.height),re=new _.a(ee.x,te.y),ne=new _.a(te.x,ee.y)}else ee=new _.a(4-$+N,Z-4+A),te=new _.a(ee.x-C.height,ee.y+C.width),re=new _.a(te.x,ee.y),ne=new _.a(ee.x,te.y);else ee=new _.a(Z-4+N,$-4+A),te=new _.a(ee.x+C.width,ee.y+C.height),re=new _.a(ee.x,te.y),ne=new _.a(te.x,ee.y);for(var ce=0,he=Y;ce<he.length;ce++){var fe=he[ce],ye=void 0,pe=void 0,de=void 0,ve=void 0;if(fe.alternateVerticalGlyph){if(!ie){var ge=($+J)/2+A;ie=new _.a((Z+X)/2+N-G.height/2-4,ge+G.width/2+4),ae=new _.a(ie.x+C.height,ie.y-C.width),oe=new _.a(ae.x,ie.y),se=new _.a(ie.x,ae.y)}ye=ie,pe=oe,de=se,ve=ae}else ye=ee,pe=re,de=ne,ve=te;var me=$,_e=J,xe=fe.glyphAngle+o;if(0!==xe){var be=Math.cos(xe),we=Math.sin(xe);ye=ye.clone(),pe=pe.clone(),de=de.clone(),ve=ve.clone(),ye.rotate(be,we),ve.rotate(be,we),pe.rotate(be,we),de.rotate(be,we)}var ke=0,Ee=256;if(y&&L?M.vertical?fe.alternateVerticalGlyph?(ke=32,Ee=96):(ke=224,Ee=32):(ke=224,Ee=96):(ke=192,Ee=64),d.push(new E(ye,de,pe,ve,C,fe.labelAngle,ke,Ee,fe.anchor,fe.minzoom,fe.maxzoom,fe.page)),p&&(!T||this._legible(fe.labelAngle)))if(v)Z<m&&(m=Z),me<w&&(w=me),X>b&&(b=X),_e>O&&(O=_e);else if(fe.minzoom<2){var Ie={xTile:e.x,yTile:e.y,dxPixels:(Z+N)*S-u,dyPixels:(me+N)*S-u,hard:!n.optional,partIndex:1,width:(X-Z)*S+2*u,height:(_e-me)*S+2*u,angle:xe,minLod:fe.minzoom,maxLod:fe.maxzoom};p.push(Ie)}}}}}catch(Ne){U.e(Ne)}finally{U.f()}if(h>=2)return null;if(p&&v){var Oe,Te,Se,Le;L?(Oe=-O+N,Te=m+A,Se=O-w,Le=b-m):(Oe=m+N,Te=w+A,Se=b-m,Le=O-w);var Pe={xTile:e.x,yTile:e.y,dxPixels:Oe*S-u,dyPixels:Te*S-u,hard:!n.optional,partIndex:1,width:Se*S+2*u,height:Le*S+2*u,angle:o,minLod:.5,maxLod:c.c};p.push(Pe)}var De=new I(d);return p&&p.length>0&&(De.textColliders=p),De}},{key:"_legible",value:function(e){var t=Object(c.h)(e);return t<65||t>=193}},{key:"_placeGlyph",value:function(e,t,r,n,i,a,o,s,l){var u=a,h=u<0?Object(c.g)(e.angle+c.d,c.a):e.angle,f=0;r<0&&(u*=-1,r*=-1,f=c.d),u>0&&++i;var y=new _.a(e.x,e.y),p=n[i],d=c.c;if(n.length<=i)return d;for(;;){var v=p.x-y.x,g=p.y-y.y,m=Math.sqrt(v*v+g*g),x=Math.max(r/m,t),b=v/m,w=g/m,E=Object(c.g)(Math.atan2(w,b)+f,c.a);if(l.push(new k(y,h,E,s,!1,x,d)),o&&l.push(new k(y,h,E,s,!0,x,d)),x<=t)return x;y=p.clone();do{if(i+=u,n.length<=i||i<0)return x;p=n[i]}while(y.isEqual(p));var I=p.x-y.x,O=p.y-y.y,T=Math.sqrt(I*I+O*O);I*=m/T,O*=m/T,y.x-=I,y.y-=O,d=x}}}]),e}(),T=r("aNYv"),S=r("4i+k"),L=function(){function e(t,r){Object(i.a)(this,e),this.values={};for(var n=r.keys,a=r.values;t.next();)switch(t.tag()){case 1:this.id=t.getUInt64();break;case 2:for(var o=t.getMessage(),s=this.values;!o.empty();){var l=o.getUInt32(),u=o.getUInt32();s[n[l]]=a[u]}o.release();break;case 3:this.type=t.getUInt32();break;case 4:this._pbfGeometry=t.getMessage();break;default:t.skip()}}return Object(a.a)(e,[{key:"getGeometry",value:function(e){if(void 0!==this._geometry)return this._geometry;if(!this._pbfGeometry)return null;var t,r,n=this._pbfGeometry;this._pbfGeometry=null,e?e.reset(this.type):t=[];for(var i,a=1,o=0,s=0,l=0;!n.empty();){if(0===o){var u=n.getUInt32();a=7&u,o=u>>3}switch(o--,a){case 1:s+=n.getSInt32(),l+=n.getSInt32(),e?e.moveTo(s,l):(r&&t.push(r),(r=[]).push(new _.a(s,l)));break;case 2:s+=n.getSInt32(),l+=n.getSInt32(),e?e.lineTo(s,l):r.push(new _.a(s,l));break;case 7:e?e.close():r&&!r[0].equals(s,l)&&r.push(r[0].clone());break;default:throw n.release(),new Error("Invalid path operation")}}return e?i=e.result():(r&&t.push(r),i=t),n.release(),this._geometry=i,i}}]),e}(),P=r("CHlC"),D=r("kMo5"),N=r("P+uj"),A=r("r9FC");function j(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Object(N.a)(e);if(t){var i=Object(N.a)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Object(D.a)(this,r)}}var R=function(e){Object(P.a)(r,e);var t=j(r);function r(){return Object(i.a)(this,r),t.call(this,12)}return Object(a.a)(r,[{key:"add",value:function(e,t,r){var n=this.array;n.push(e),n.push(t),n.push(r)}}]),r}(A.a),U=(A.a,function(){function e(t){for(Object(i.a)(this,e),this.extent=4096,this.keys=[],this.values=[],this._pbfLayer=t.clone();t.next();)switch(t.tag()){case 1:this.name=t.getString();break;case 3:this.keys.push(t.getString());break;case 4:this.values.push(t.processMessage(e._parseValue));break;case 5:this.extent=t.getUInt32();break;default:t.skip()}}return Object(a.a)(e,[{key:"getData",value:function(){return this._pbfLayer}}],[{key:"_parseValue",value:function(e){for(;e.next();)switch(e.tag()){case 1:return e.getString();case 2:return e.getFloat();case 3:return e.getDouble();case 4:return e.getInt64();case 5:return e.getUInt64();case 6:return e.getSInt64();case 7:return e.getBool();default:e.skip()}return null}}]),e}()),M=r("6CzD");function B(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Object(N.a)(e);if(t){var i=Object(N.a)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Object(D.a)(this,r)}}var C=function(e){Object(P.a)(r,e);var t=B(r);function r(e){return Object(i.a)(this,r),t.call(this,e)}return Object(a.a)(r,[{key:"add",value:function(e,t,r,n,i,a,o,s,l,u,c,h){var f=this.array,y=A.a.i1616to32(e,t);f.push(y);var p=31;y=A.a.i8888to32(Math.round(p*r),Math.round(p*n),Math.round(p*i),Math.round(p*a)),f.push(y),y=A.a.i8888to32(Math.round(p*o),Math.round(p*s),Math.round(p*l),Math.round(p*u)),f.push(y),y=A.a.i1616to32(c,0),f.push(y),h&&f.push.apply(f,Object(M.a)(h))}}]),r}(A.a),G=function(e){Object(P.a)(r,e);var t=B(r);function r(e){return Object(i.a)(this,r),t.call(this,e)}return Object(a.a)(r,[{key:"add",value:function(e,t,r){var n=this.array;n.push(A.a.i1616to32(e,t)),r&&n.push.apply(n,Object(M.a)(r))}}]),r}(A.a),V=function(e){Object(P.a)(r,e);var t=B(r);function r(e){return Object(i.a)(this,r),t.call(this,e)}return Object(a.a)(r,[{key:"add",value:function(e,t,r,n,i,a,o){var s=this.array,l=this.index,u=A.a.i1616to32(e,t);s.push(u);return u=A.a.i8888to32(Math.round(15*r),Math.round(15*n),i,a),s.push(u),o&&s.push.apply(s,Object(M.a)(o)),l}}]),r}(A.a),F=function(e){Object(P.a)(r,e);var t=B(r);function r(e){return Object(i.a)(this,r),t.call(this,e)}return Object(a.a)(r,[{key:"add",value:function(e,t,r,n,i,a,o,s,l,u,h,f){var y=this.array,p=A.a.i1616to32(e,t);y.push(p),p=A.a.i1616to32(Math.round(8*r),Math.round(8*n)),y.push(p),p=A.a.i8888to32(i/4,a/4,s,l),y.push(p),p=A.a.i8888to32(0,Object(c.h)(o),10*u,Math.min(10*h,255)),y.push(p),f&&y.push.apply(y,Object(M.a)(f))}}]),r}(A.a),z=function(e){Object(P.a)(r,e);var t=B(r);function r(e){return Object(i.a)(this,r),t.call(this,e)}return Object(a.a)(r,[{key:"add",value:function(e,t,r,n,i){var a=this.array,o=A.a.i1616to32(2*e+r,2*t+n);a.push(o),i&&a.push.apply(a,Object(M.a)(i))}}]),r}(A.a),q=function(){function e(t,r,n){Object(i.a)(this,e),this.layerExtent=4096,this._features=[],this.layer=t,this.zoom=r,this._spriteInfo=n,this._filter=t.getFeatureFilter()}return Object(a.a)(e,[{key:"pushFeature",value:function(e){this._filter&&!this._filter.filter(e,this.zoom)||this._features.push(e)}},{key:"hasFeatures",value:function(){return this._features.length>0}},{key:"getResources",value:function(e,t,r){}}]),e}();function H(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return W(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return W(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function W(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Object(N.a)(e);if(t){var i=Object(N.a)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Object(D.a)(this,r)}}var K=function(e){Object(P.a)(r,e);var t=Y(r);function r(e,n,a,o,s){var l;return Object(i.a)(this,r),(l=t.call(this,e,n,a)).type=4,l._circleVertexBuffer=o,l._circleIndexBuffer=s,l}return Object(a.a)(r,[{key:"circleIndexStart",get:function(){return this._circleIndexStart}},{key:"circleIndexCount",get:function(){return this._circleIndexCount}},{key:"processFeatures",value:function(e){var t=this._circleVertexBuffer,r=this._circleIndexBuffer;this._circleIndexStart=3*r.index,this._circleIndexCount=0;var n=this.layer,i=this.zoom;e&&e.setExtent(this.layerExtent);var a,o=H(this._features);try{for(o.s();!(a=o.n()).done;){var s=a.value,l=s.getGeometry(e);if(l){var u,c=n.circleMaterial.encodeAttributes(s,i,n),h=H(l);try{for(h.s();!(u=h.n()).done;){var f=u.value;if(f){var y,p=H(f);try{for(p.s();!(y=p.n()).done;){var d=y.value,v=t.index;t.add(d.x,d.y,0,0,c),t.add(d.x,d.y,0,1,c),t.add(d.x,d.y,1,0,c),t.add(d.x,d.y,1,1,c),r.add(v+0,v+1,v+2),r.add(v+1,v+2,v+3),this._circleIndexCount+=6}}catch(g){p.e(g)}finally{p.f()}}}}catch(g){h.e(g)}finally{h.f()}}}}catch(g){o.e(g)}finally{o.f()}}},{key:"serialize",value:function(){var e=6;e+=this.layerUIDs.length,e+=this._circleVertexBuffer.array.length,e+=this._circleIndexBuffer.array.length;var t=new Uint32Array(e),r=new Int32Array(t.buffer),n=0;t[n++]=this.type,t[n++]=this.layerUIDs.length;for(var i=0;i<this.layerUIDs.length;i++)t[n++]=this.layerUIDs[i];t[n++]=this._circleIndexStart,t[n++]=this._circleIndexCount,t[n++]=this._circleVertexBuffer.array.length;for(var a=0;a<this._circleVertexBuffer.array.length;a++)r[n++]=this._circleVertexBuffer.array[a];t[n++]=this._circleIndexBuffer.array.length;for(var o=0;o<this._circleIndexBuffer.array.length;o++)t[n++]=this._circleIndexBuffer.array[o];return t.buffer}}]),r}(q),Q=r("p/dP"),Z=r("F6Re");function $(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return X(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return X(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function X(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function J(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Object(N.a)(e);if(t){var i=Object(N.a)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Object(D.a)(this,r)}}var ee=new(r("5ZAw").a);var te=function(e){Object(P.a)(r,e);var t=J(r);function r(e,n,a,o,s,l,u){var c;return Object(i.a)(this,r),(c=t.call(this,e,n,a)).type=1,c._patternMap=new Map,c._fillVertexBuffer=o,c._fillIndexBuffer=s,c._outlineVertexBuffer=l,c._outlineIndexBuffer=u,c}return Object(a.a)(r,[{key:"fillIndexStart",get:function(){return this._fillIndexStart}},{key:"fillIndexCount",get:function(){return this._fillIndexCount}},{key:"outlineIndexStart",get:function(){return this._outlineIndexStart}},{key:"outlineIndexCount",get:function(){return this._outlineIndexCount}},{key:"getResources",value:function(e,t,r){var n=this.layer,i=this.zoom,a=n.getPaintProperty("fill-pattern");if(a)if(a.isDataDriven){var o,s=$(this._features);try{for(s.s();!(o=s.n()).done;){var l=o.value;t.add({name:a.getValue(i,l),repeat:!0})}}catch(u){s.e(u)}finally{s.f()}}else t.add({name:a.getValue(i),repeat:!0})}},{key:"processFeatures",value:function(e){this._fillIndexStart=3*this._fillIndexBuffer.index,this._fillIndexCount=0,this._outlineIndexStart=3*this._outlineIndexBuffer.index,this._outlineIndexCount=0;var t=this.layer,r=this.zoom,n=t.fillMaterial,i=t.outlineMaterial,a=t.hasDataDrivenFill,o=t.hasDataDrivenOutline;e&&e.setExtent(this.layerExtent);var s=t.getPaintProperty("fill-pattern"),l=null==s?void 0:s.isDataDriven,u=!s&&t.getPaintValue("fill-antialias",r);if(t.outlineUsesFillColor){if(u&&!t.hasDataDrivenOpacity){var c=t.getPaintValue("fill-opacity",r),h=t.getPaintValue("fill-opacity",r+1);c<1&&h<1&&(u=!1)}if(u&&!t.hasDataDrivenColor){var f=t.getPaintValue("fill-color",r),y=t.getPaintValue("fill-color",r+1);f[3]<1&&y[3]<1&&(u=!1)}}var p=this._features,d=null==e?void 0:e.validateTessellation;if(l){var v,g=[],m=$(p);try{for(m.s();!(v=m.n()).done;){var _=v.value,x=s.getValue(r,_),b=this._spriteInfo[x];if(b&&b.rect){var w=n.encodeAttributes(_,r,t,b),k=u&&o?i.encodeAttributes(_,r,t):[],E=_.getGeometry(e);g.push({ddFillAttributes:w,ddOutlineAttributes:k,page:b.page,geometry:E}),g.sort((function(e,t){return e.page-t.page}));var I,O=$(g);try{for(O.s();!(I=O.n()).done;){var T=I.value,S=T.ddFillAttributes,L=T.ddOutlineAttributes,P=T.page,D=T.geometry;this._processFeature(D,u,t.outlineUsesFillColor,S,L,d,P)}}catch(B){O.e(B)}finally{O.f()}}}}catch(B){m.e(B)}finally{m.f()}}else{var N,A=$(p);try{for(A.s();!(N=A.n()).done;){var j=N.value,R=a?n.encodeAttributes(j,r,t):null,U=u&&o?i.encodeAttributes(j,r,t):null,M=j.getGeometry(e);this._processFeature(M,u,t.outlineUsesFillColor,R,U,d)}}catch(B){A.e(B)}finally{A.f()}}}},{key:"serialize",value:function(){var e=10;e+=this.layerUIDs.length,e+=this._fillVertexBuffer.array.length,e+=this._fillIndexBuffer.array.length,e+=this._outlineVertexBuffer.array.length,e+=this._outlineIndexBuffer.array.length,e+=3*this._patternMap.size+1;var t=new Uint32Array(e),r=new Int32Array(t.buffer),n=0;t[n++]=this.type,t[n++]=this.layerUIDs.length;for(var i=0;i<this.layerUIDs.length;i++)t[n++]=this.layerUIDs[i];t[n++]=this._fillIndexStart,t[n++]=this._fillIndexCount,t[n++]=this._outlineIndexStart,t[n++]=this._outlineIndexCount;var a=this._patternMap,o=a.size;if(t[n++]=o,o>0){var s,l=$(a);try{for(l.s();!(s=l.n()).done;){var u=Object(T.a)(s.value,2),c=u[0],h=Object(T.a)(u[1],2),f=h[0],y=h[1];t[n++]=c,t[n++]=f,t[n++]=y}}catch(m){l.e(m)}finally{l.f()}}t[n++]=this._fillVertexBuffer.array.length;for(var p=0;p<this._fillVertexBuffer.array.length;p++)r[n++]=this._fillVertexBuffer.array[p];t[n++]=this._fillIndexBuffer.array.length;for(var d=0;d<this._fillIndexBuffer.array.length;d++)t[n++]=this._fillIndexBuffer.array[d];t[n++]=this._outlineVertexBuffer.array.length;for(var v=0;v<this._outlineVertexBuffer.array.length;v++)r[n++]=this._outlineVertexBuffer.array[v];t[n++]=this._outlineIndexBuffer.array.length;for(var g=0;g<this._outlineIndexBuffer.array.length;g++)t[n++]=this._outlineIndexBuffer.array[g];return t.buffer}},{key:"_processFeature",value:function(e,t,n,i,a,o,s){if(e){var l=e.length,u=!a||0===a.length;if(t&&(!n||u))for(var c=0;c<l;c++)this._processOutline(e[c],a);for(var h,f=0;f<l;f++){var y=r._area(e[f]);y>32?(void 0!==h&&this._processFill(e,h,i,o,s),h=[f]):y<-32&&void 0!==h&&h.push(f)}void 0!==h&&this._processFill(e,h,i,o,s)}}},{key:"_processOutline",value:function(e,t){var r,n,i,a=this._outlineVertexBuffer,o=this._outlineIndexBuffer,s=o.index,l=new _.a(0,0),u=new _.a(0,0),c=new _.a(0,0),h=-1,f=-1,y=-1,p=-1,d=-1,v=!1,g=e.length;if(!(g<2)){for(var m=e[0],x=e[g-1];g&&x.isEqual(m);)x=e[--g-1];if(!(g-0<2)){for(var b=0;b<g;++b){0===b?(r=e[g-1],n=e[0],i=e[1],l.assignSub(n,r),l.normalize(),l.rightPerpendicular()):(r=n,n=i,i=b!==g-1?e[b+1]:e[0],l.assign(u));var w=this._isClipEdge(r,n);-1===p&&(v=w),u.assignSub(i,n),u.normalize(),u.rightPerpendicular();var k=l.x*u.y-l.y*u.x;c.assignAdd(l,u),c.normalize();var E=-c.x*-l.x+-c.y*-l.y,I=Math.abs(0!==E?1/E:1);I>8&&(I=8),k>=0?(y=a.add(n.x,n.y,l.x,l.y,0,1,t),-1===p&&(p=y),h>=0&&f>=0&&y>=0&&!w&&o.add(h,f,y),f=a.add(n.x,n.y,I*-c.x,I*-c.y,0,-1,t),-1===d&&(d=f),h>=0&&f>=0&&y>=0&&!w&&o.add(h,f,y),h=f,f=y,y=a.add(n.x,n.y,c.x,c.y,0,1,t),h>=0&&f>=0&&y>=0&&!w&&o.add(h,f,y),f=a.add(n.x,n.y,u.x,u.y,0,1,t),h>=0&&f>=0&&y>=0&&!w&&o.add(h,f,y)):(y=a.add(n.x,n.y,I*c.x,I*c.y,0,1,t),-1===p&&(p=y),h>=0&&f>=0&&y>=0&&!w&&o.add(h,f,y),f=a.add(n.x,n.y,-l.x,-l.y,0,-1,t),-1===d&&(d=f),h>=0&&f>=0&&y>=0&&!w&&o.add(h,f,y),h=f,f=y,y=a.add(n.x,n.y,-c.x,-c.y,0,-1,t),h>=0&&f>=0&&y>=0&&!w&&o.add(h,f,y),(h=a.add(n.x,n.y,-u.x,-u.y,0,-1,t))>=0&&f>=0&&y>=0&&!w&&o.add(h,f,y))}h>=0&&f>=0&&p>=0&&!v&&o.add(h,f,p),h>=0&&p>=0&&d>=0&&!v&&o.add(h,d,p),this._outlineIndexCount+=3*(o.index-s)}}}},{key:"_processFill",value:function(e,t,r,n,i){var a;t.length>1&&(a=[]);var o,s=0,l=$(t);try{for(l.s();!(o=l.n()).done;){var u=o.value;0!==s&&a.push(s),s+=e[u].length}}catch(D){l.e(D)}finally{l.f()}var c,h=2*s,f=Q.a.acquire(),y=$(t);try{for(y.s();!(c=y.n()).done;)for(var p=e[c.value],d=p.length,v=0;v<d;++v)f.push(p[v].x,p[v].y)}catch(D){y.e(D)}finally{y.f()}var g=Object(Z.a)(f,a,2);if(Z.a.deviation(f,a,2,g)>0){var m=[],_=[];if(function(e,t,r,n){var i,a;ee.beginPolygon(e,t);var o,s=$(n);try{for(s.s();!(o=s.n()).done;){var l=o.value,u=r[l];if(!(u.length<3)){ee.beginContour();for(var c=0;c<u.length;++c){i=u[c].x,a=u[c].y;var h=[i,a,0];ee.addVertex(h,h)}ee.endContour()}}}catch(D){s.e(D)}finally{s.f()}ee.endPolygon()}(m,_,e,t),_.length>0){for(var x=this._fillVertexBuffer.index,b=0;b<m.length;)this._fillVertexBuffer.add(m[b++],m[b++],r);for(var w=0;w<_.length;)this._fillIndexBuffer.add(x+_[w+0],x+_[w+1],x+_[w+2]),w+=3;if(void 0!==i){var k=this._patternMap,E=k.get(i);E?E[1]+=_.length:k.set(i,[this._fillIndexStart+this._fillIndexCount,_.length])}this._fillIndexCount+=_.length}}else{var I=g.length;if(I>0){for(var O=this._fillVertexBuffer.index,T=0;T<h;)this._fillVertexBuffer.add(f[T++],f[T++],r);for(var S=0;S<I;)this._fillIndexBuffer.add(O+g[S++],O+g[S++],O+g[S++]);if(void 0!==i){var L=this._patternMap,P=L.get(i);P?P[1]+=I:L.set(i,[this._fillIndexStart+this._fillIndexCount,I])}this._fillIndexCount+=I}}Q.a.release(f)}},{key:"_isClipEdge",value:function(e,t){return e.x===t.x?e.x<=-64||e.x>=4160:e.y===t.y&&(e.y<=-64||e.y>=4160)}}],[{key:"_area",value:function(e){for(var t=0,r=e.length-1,n=0;n<r;n++)t+=(e[n].x-e[n+1].x)*(e[n].y+e[n+1].y);return.5*(t+=(e[r].x-e[0].x)*(e[r].y+e[0].y))}}]),r}(q),re=r("msFv");function ne(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return ie(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ie(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function ie(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ae(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Object(N.a)(e);if(t){var i=Object(N.a)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Object(D.a)(this,r)}}var oe=function(e){Object(P.a)(r,e);var t=ae(r);function r(e,n,a,o,s){var l;return Object(i.a)(this,r),(l=t.call(this,e,n,a)).type=2,l._tessellationOptions={pixelCoordRatio:8,halfWidth:0,offset:0},l._patternMap=new Map,l.tessellationProperties={_lineVertexBuffer:null,_lineIndexBuffer:null,_ddValues:null},l.tessellationProperties._lineVertexBuffer=o,l.tessellationProperties._lineIndexBuffer=s,l._lineTessellator=new re.a(se(l.tessellationProperties),le(l.tessellationProperties),e.canUseThinTessellation),l}return Object(a.a)(r,[{key:"lineIndexStart",get:function(){return this._lineIndexStart}},{key:"lineIndexCount",get:function(){return this._lineIndexCount}},{key:"getResources",value:function(e,t,r){var n=this.layer,i=this.zoom,a=n.hasDataDrivenLine,o=n.getPaintProperty("line-pattern"),s=n.getPaintProperty("line-dasharray"),l=n.getLayoutProperty("line-cap");if(o||s){var u=(null==l?void 0:l.getValue(i))||0,c=null==l?void 0:l.isDataDriven;if(a){var h=null==o?void 0:o.isDataDriven,f=null==s?void 0:s.isDataDriven;if(!h&&!f)return;var y,p=ne(this._features);try{for(p.s();!(y=p.n()).done;){var d=y.value;h?t.add(o.getValue(i,d)):t.add({name:this._getDashArrayKey(d,i,n,s,c,l,u)})}}catch(g){p.e(g)}finally{p.f()}}else if(o)t.add(o.getValue(i));else if(s){var v=s.getValue(i);t.add({name:n.getDashKey(v,u)})}}}},{key:"processFeatures",value:function(e){var t,r,n,i,a,o;this._lineIndexStart=3*this.tessellationProperties._lineIndexBuffer.index,this._lineIndexCount=0;var s=this.layer,l=this.zoom,u=this._features,c=this._tessellationOptions,h=s.hasDataDrivenLine,f=s.lineMaterial;e&&e.setExtent(this.layerExtent);var y,p=s.getPaintProperty("line-pattern"),d=s.getPaintProperty("line-dasharray"),v=null==p?void 0:p.isDataDriven,g=null==d?void 0:d.isDataDriven,m=null!=(t=y=s.getLayoutProperty("line-cap"))&&t.isDataDriven?y:null,_=m?null:s.getLayoutValue("line-cap",l),x=_||0,b=!!m,w=null!=(r=y=s.getLayoutProperty("line-join"))&&r.isDataDriven?y:null,k=w?null:s.getLayoutValue("line-join",l),E=null!=(n=y=s.getLayoutProperty("line-miter-limit"))&&n.isDataDriven?y:null,I=E?null:s.getLayoutValue("line-miter-limit",l),O=null!=(i=y=s.getLayoutProperty("line-round-limit"))&&i.isDataDriven?y:null,T=O?null:s.getLayoutValue("line-round-limit",l),S=null!=(a=y=s.getPaintProperty("line-width"))&&a.isDataDriven?y:null,L=S?null:s.getPaintValue("line-width",l),P=null!=(o=y=s.getPaintProperty("line-offset"))&&o.isDataDriven?y:null,D=P?null:s.getPaintValue("line-offset",l);if(v||g){var N,A=[],j=ne(u);try{for(j.s();!(N=j.n()).done;){var R=N.value,U=v?p.getValue(l,R):this._getDashArrayKey(R,l,s,d,b,m,x),M=this._spriteInfo[U];if(M&&M.rect){var B=f.encodeAttributes(R,l,s,M),C=R.getGeometry(e);A.push({ddAttributes:B,page:M.page,cap:m?m.getValue(l,R):_,join:w?w.getValue(l,R):k,miterLimit:E?E.getValue(l,R):I,roundLimit:O?O.getValue(l,R):T,halfWidth:.5*(S?S.getValue(l,R):L),offset:P?P.getValue(l,R):D,geometry:C})}}}catch(ie){j.e(ie)}finally{j.f()}A.sort((function(e,t){return e.page-t.page})),c.textured=!0;for(var G=0,V=A;G<V.length;G++){var F=V[G],z=F.ddAttributes,q=F.page,H=F.cap,W=F.join,Y=F.miterLimit,K=F.roundLimit,Q=F.halfWidth,Z=F.offset,$=F.geometry;c.capType=H,c.joinType=W,c.miterLimit=Y,c.roundLimit=K,c.halfWidth=Q,c.offset=Z,this._processFeature($,z,q)}}else{c.textured=!(!p&&!d),c.capType=_,c.joinType=k,c.miterLimit=I,c.roundLimit=T,c.halfWidth=.5*L,c.offset=D;var X,J=ne(u);try{for(J.s();!(X=J.n()).done;){var ee=X.value,te=h?f.encodeAttributes(ee,l,s):null;m&&(c.capType=m.getValue(l,ee)),w&&(c.joinType=w.getValue(l,ee)),E&&(c.miterLimit=E.getValue(l,ee)),O&&(c.roundLimit=O.getValue(l,ee)),S&&(c.halfWidth=.5*S.getValue(l,ee)),P&&(c.offset=P.getValue(l,ee));var re=ee.getGeometry(e);this._processFeature(re,te)}}catch(ie){J.e(ie)}finally{J.f()}}}},{key:"serialize",value:function(){var e=6;e+=this.layerUIDs.length,e+=this.tessellationProperties._lineVertexBuffer.array.length,e+=this.tessellationProperties._lineIndexBuffer.array.length,e+=3*this._patternMap.size+1;var t=new Uint32Array(e),r=new Int32Array(t.buffer),n=0;t[n++]=this.type,t[n++]=this.layerUIDs.length;for(var i=0;i<this.layerUIDs.length;i++)t[n++]=this.layerUIDs[i];t[n++]=this._lineIndexStart,t[n++]=this._lineIndexCount;var a=this._patternMap,o=a.size;if(t[n++]=o,o>0){var s,l=ne(a);try{for(l.s();!(s=l.n()).done;){var u=Object(T.a)(s.value,2),c=u[0],h=Object(T.a)(u[1],2),f=h[0],y=h[1];t[n++]=c,t[n++]=f,t[n++]=y}}catch(v){l.e(v)}finally{l.f()}}t[n++]=this.tessellationProperties._lineVertexBuffer.array.length;for(var p=0;p<this.tessellationProperties._lineVertexBuffer.array.length;p++)r[n++]=this.tessellationProperties._lineVertexBuffer.array[p];t[n++]=this.tessellationProperties._lineIndexBuffer.array.length;for(var d=0;d<this.tessellationProperties._lineIndexBuffer.array.length;d++)t[n++]=this.tessellationProperties._lineIndexBuffer.array[d];return t.buffer}},{key:"_processFeature",value:function(e,t,r){if(e)for(var n=e.length,i=0;i<n;i++)this._processGeometry(e[i],t,r)}},{key:"_processGeometry",value:function(e,t,r){if(!(e.length<2)){for(var n,i,a=e[0],o=1;o<e.length;)(n=e[o].x-a.x)*n+(i=e[o].y-a.y)*i<1e-6?e.splice(o,1):(a=e[o],++o);if(!(e.length<2)){var s=this.tessellationProperties._lineIndexBuffer,l=3*s.index;this._tessellationOptions.initialDistance=0,this._tessellationOptions.wrapDistance=65535,this.tessellationProperties._ddValues=t,this._lineTessellator.tessellate(e,this._tessellationOptions);var u=3*s.index-l;if(void 0!==r){var c=this._patternMap,h=c.get(r);h?h[1]+=u:c.set(r,[l+this._lineIndexCount,u])}this._lineIndexCount+=u}}}},{key:"_getDashArrayKey",value:function(e,t,r,n,i,a,o){var s=i?a.getValue(t,e):o,l=n.getValue(t,e);return r.getDashKey(l,s)}}]),r}(q),se=function(e){return function(t,r,n,i,a,o,s,l,u,c,h){return e._lineVertexBuffer.add(t,r,s,l,n,i,a,o,u,c,h,e._ddValues),e._lineVertexBuffer.index-1}},le=function(e){return function(t,r,n){e._lineIndexBuffer.add(t,r,n)}},ue=oe,ce=r("+cn+"),he=r("lZmO"),fe=r("W32V");function ye(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return pe(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pe(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function pe(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function de(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Object(N.a)(e);if(t){var i=Object(N.a)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Object(D.a)(this,r)}}function ve(e,t){return e.iconMosaicItem&&t.iconMosaicItem?e.iconMosaicItem.page===t.iconMosaicItem.page?0:e.iconMosaicItem.page-t.iconMosaicItem.page:e.iconMosaicItem&&!t.iconMosaicItem?1:!e.iconMosaicItem&&t.iconMosaicItem?-1:0}var ge=function(e){Object(P.a)(r,e);var t=de(r);function r(e,n,a,o,s,l,u,c){var h;return Object(i.a)(this,r),(h=t.call(this,e,n,c.getSpriteItems())).type=3,h._markerMap=new Map,h._glyphMap=new Map,h._glyphBufferDataStorage=new Map,h._isIconSDF=!1,h._iconVertexBuffer=a,h._iconIndexBuffer=o,h._textVertexBuffer=s,h._textIndexBuffer=l,h._placementEngine=u,h._workerTileHandler=c,h}return Object(a.a)(r,[{key:"markerPageMap",get:function(){return this._markerMap}},{key:"glyphsPageMap",get:function(){return this._glyphMap}},{key:"symbolInstances",get:function(){return this._symbolInstances}},{key:"getResources",value:function(e,t,n){var i=this.layer,a=this.zoom;e&&e.setExtent(this.layerExtent);var o,s,l,u,c=i.getLayoutProperty("icon-image"),h=i.getLayoutProperty("text-field"),f=i.getLayoutProperty("text-transform"),y=i.getLayoutProperty("text-font"),p=[];c&&!c.isDataDriven&&(o=c.getValue(a)),h&&!h.isDataDriven&&(s=h.getValue(a)),f&&f.isDataDriven||(l=i.getLayoutValue("text-transform",a),f=null),y&&y.isDataDriven||(u=i.getLayoutValue("text-font",a),y=null);var d,v=ye(this._features);try{for(v.s();!(d=v.n()).done;){var g=d.value,m=g.getGeometry(e);if(m&&0!==m.length){var _=void 0,x=void 0;c&&((_=c.isDataDriven?c.getValue(a,g):this._replaceKeys(o,g.values))&&t.add({name:_}));var b=!1;if(h&&(x=h.isDataDriven?h.getValue(a,g):this._replaceKeys(s,g.values))){switch(x=x.replace(/\\n/g,"\n"),f&&(l=f.getValue(a,g)),l){case 2:x=x.toLowerCase();break;case 1:x=x.toUpperCase()}if(r._bidiEngine.hasBidiChar(x)){var w;w="rtl"===r._bidiEngine.checkContextual(x)?"IDNNN":"ICNNN",x=r._bidiEngine.bidiTransform(x,w,"VLYSN"),b=!0}var k=x.length;if(k>0){y&&(u=y.getValue(a,g));var E,I=ye(u);try{for(I.s();!(E=I.n()).done;){var O=E.value,T=n[O];T||(T=n[O]=new Set);for(var S=0;S<k;S++){var L=x.charCodeAt(S);T.add(L)}}}catch(N){I.e(N)}finally{I.f()}}}if(_||x){var P=i.getLayoutValue("symbol-sort-key",a,g),D={feature:g,sprite:_,label:x,rtl:b,geometry:m,hash:(x?Object(he.b)(x):0)^(_?Object(he.b)(_):0),priority:P,textFont:u};p.push(D)}}}}catch(N){v.e(N)}finally{v.f()}this._symbolFeatures=p}},{key:"processFeatures",value:function(e){e&&e.setExtent(this.layerExtent);var t,n=this.layer,i=this.zoom,a=n.getLayoutValue("symbol-placement",i),o=0!==a,s=8*n.getLayoutValue("symbol-spacing",i),l=n.getLayoutProperty("icon-image"),u=n.getLayoutProperty("text-field"),h=l?new fe.d(n,i,o):null,f=u?new fe.g(n,i,o):null,y=this._workerTileHandler;l&&(t=y.getSpriteItems()),this._iconIndexStart=3*this._iconIndexBuffer.index,this._textIndexStart=3*this._textIndexBuffer.index,this._iconIndexCount=0,this._textIndexCount=0,this._markerMap.clear(),this._glyphMap.clear();var p=[],d=1;f&&f.size&&(d=f.size/24);var v,m=f?f.maxAngle*c.b:0,_=f?8*f.size:0,x=ye(this._symbolFeatures);try{for(x.s();!(v=x.n()).done;){var b=v.value,k=void 0;h&&t&&b.sprite&&((k=t[b.sprite])&&k.sdf&&(this._isIconSDF=!0));var E=void 0;k&&h.update(i,b.feature);var I=0,O=b.label;if(O){f.update(i,b.feature);var T=o?f.keepUpright:f.writingMode&&f.writingMode.indexOf(1)>=0,S=.5;switch(f.anchor){case 5:case 1:case 7:S=0;break;case 6:case 2:case 8:S=1}var L=.5;switch(f.anchor){case 5:case 3:case 6:L=0;break;case 7:case 4:case 8:L=1}var P=.5;switch(f.justify){case 0:P=S;break;case 1:P=0;break;case 3:P=1}var D=24*f.letterSpacing,N=o?0:24*f.maxWidth,A=24*f.lineHeight,j=b.textFont.map((function(e){return y.getGlyphItems(e)}));if((E=new g(j,N,A,D,S,L,P).getShaping(O,b.rtl,T))&&E.length>0){var R,U=1e30,M=-1e30,B=ye(E);try{for(B.s();!(R=B.n()).done;){var C=R.value;U=Math.min(U,C.x),M=Math.max(M,C.x)}}catch(Q){B.e(Q)}finally{B.f()}I=(M-U+48)*d*8}}var G,V=ye(b.geometry);try{for(V.s();!(G=V.n()).done;){var F=G.value,z=[];if(1===a){if(E&&E.length>0&&f&&f.size){var q=8*f.size*(2+Math.min(2,4*Math.abs(f.offset[1])));F=r._smoothVertices(F,q)}r._pushAnchors(z,F,s,I)}else 2===a?r._pushCenterAnchor(z,F):3===b.feature.type?r._pushCentroid(z,F):z.push(new w(F[0].x,F[0].y));for(var H=0,W=z;H<W.length;H++){var Y=W[H];if(!(Y.x<0||Y.x>4096||Y.y<0||Y.y>4096)&&(!(o&&I>0&&0===f.rotationAlignment)||r._honorsTextMaxAngle(F,Y,I,m,_))){var K={shaping:E,line:F,iconMosaicItem:k,anchor:Y,symbolFeature:b,textColliders:[],iconColliders:[],textVertexRanges:[],iconVertexRanges:[]};p.push(K),this._processFeature(K,h,f)}}}}catch(Q){V.e(Q)}finally{V.f()}}}catch(Q){x.e(Q)}finally{x.f()}p.sort(ve),this._addPlacedGlyphs(),this._symbolInstances=p}},{key:"serialize",value:function(){var e=11;e+=this.layerUIDs.length,e+=3*this.markerPageMap.size,e+=3*this.glyphsPageMap.size,e+=r.symbolsSerializationLength(this._symbolInstances),e+=this._iconVertexBuffer.array.length,e+=this._iconIndexBuffer.array.length,e+=this._textVertexBuffer.array.length,e+=this._textIndexBuffer.array.length;var t=new Uint32Array(e),n=new Int32Array(t.buffer),i=new Float32Array(t.buffer),a=0;t[a++]=this.type,t[a++]=this.layerUIDs.length;for(var o=0;o<this.layerUIDs.length;o++)t[a++]=this.layerUIDs[o];t[a++]=this._isIconSDF?1:0,t[a++]=this.markerPageMap.size;var s,l=ye(this.markerPageMap);try{for(l.s();!(s=l.n()).done;){var u=Object(T.a)(s.value,2),c=u[0],h=Object(T.a)(u[1],2),f=h[0],y=h[1];t[a++]=c,t[a++]=f,t[a++]=y}}catch(I){l.e(I)}finally{l.f()}t[a++]=this.glyphsPageMap.size;var p,d=ye(this.glyphsPageMap);try{for(d.s();!(p=d.n()).done;){var v=Object(T.a)(p.value,2),g=v[0],m=Object(T.a)(v[1],2),_=m[0],x=m[1];t[a++]=g,t[a++]=_,t[a++]=x}}catch(I){d.e(I)}finally{d.f()}t[a++]=this._iconVertexBuffer.index/4,t[a++]=this._textVertexBuffer.index/4,a=r.serializeSymbols(t,n,i,a,this._symbolInstances),t[a++]=this._iconVertexBuffer.array.length;for(var b=0;b<this._iconVertexBuffer.array.length;b++)n[a++]=this._iconVertexBuffer.array[b];t[a++]=this._iconIndexBuffer.array.length;for(var w=0;w<this._iconIndexBuffer.array.length;w++)t[a++]=this._iconIndexBuffer.array[w];t[a++]=this._textVertexBuffer.array.length;for(var k=0;k<this._textVertexBuffer.array.length;k++)n[a++]=this._textVertexBuffer.array[k];t[a++]=this._textIndexBuffer.array.length;for(var E=0;E<this._textIndexBuffer.array.length;E++)t[a++]=this._textIndexBuffer.array[E];return t.buffer}},{key:"_replaceKeys",value:function(e,t){return e.replace(/{([^{}]+)}/g,(function(e,r){return r in t?t[r]:""}))}},{key:"_processFeature",value:function(e,t,r){var n=e.line,i=e.iconMosaicItem,a=e.shaping,o=e.anchor,s=this.zoom,l=this.layer,u=!!i,h=!0;u&&(h=t.optional||!i);var f,y,p=a&&a.length>0,d=!0;if(p&&(d=r.optional),u&&(f=this._placementEngine.getIconPlacement(o,i,t)),(f||h)&&(p&&(y=this._placementEngine.getTextPlacement(o,a,n,r)),y||d)){if(f&&y||(d||h?d||y?h||f||(y=null):f=null:(f=null,y=null)),y){var v=l.hasDataDrivenText?l.textMaterial.encodeAttributes(e.symbolFeature.feature,s,l):null;if(this._storePlacedGlyphs(e,y.shapes,s,r.rotationAlignment,v),y.textColliders){e.textColliders=y.textColliders;var g,m=ye(y.textColliders);try{for(m.s();!(g=m.n()).done;){var _=g.value;_.minLod=Math.max(s+Object(c.f)(_.minLod),0),_.maxLod=Math.min(s+Object(c.f)(_.maxLod),25);var x=_.angle;if(x){var b=Math.cos(x),w=Math.sin(x),k=_.dxPixels*b-_.dyPixels*w,E=_.dxPixels*w+_.dyPixels*b,I=(_.dxPixels+_.width)*b-_.dyPixels*w,O=(_.dxPixels+_.width)*w+_.dyPixels*b,T=_.dxPixels*b-(_.dyPixels+_.height)*w,S=_.dxPixels*w+(_.dyPixels+_.height)*b,L=(_.dxPixels+_.width)*b-(_.dyPixels+_.height)*w,P=(_.dxPixels+_.width)*w+(_.dyPixels+_.height)*b,D=Math.min(k,I,T,L),N=Math.max(k,I,T,L),A=Math.min(E,O,S,P),j=Math.max(E,O,S,P);_.dxPixels=D,_.dyPixels=A,_.width=N-D,_.height=j-A}}}catch(ee){m.e(ee)}finally{m.f()}}}if(f){var R=l.hasDataDrivenIcon?l.iconMaterial.encodeAttributes(e.symbolFeature.feature,s,l):null;if(this._addPlacedIcons(e,f.shapes,s,i.page,1===t.rotationAlignment,R),f.iconColliders){e.iconColliders=f.iconColliders;var U,M=ye(f.iconColliders);try{for(M.s();!(U=M.n()).done;){var B=U.value;B.minLod=Math.max(s+Object(c.f)(B.minLod),0),B.maxLod=Math.min(s+Object(c.f)(B.maxLod),25);var C=B.angle;if(C){var G=Math.cos(C),V=Math.sin(C),F=B.dxPixels*G-B.dyPixels*V,z=B.dxPixels*V+B.dyPixels*G,q=(B.dxPixels+B.width)*G-B.dyPixels*V,H=(B.dxPixels+B.width)*V+B.dyPixels*G,W=B.dxPixels*G-(B.dyPixels+B.height)*V,Y=B.dxPixels*V+(B.dyPixels+B.height)*G,K=(B.dxPixels+B.width)*G-(B.dyPixels+B.height)*V,Q=(B.dxPixels+B.width)*V+(B.dyPixels+B.height)*G,Z=Math.min(F,q,W,K),$=Math.max(F,q,W,K),X=Math.min(z,H,Y,Q),J=Math.max(z,H,Y,Q);B.dxPixels=Z,B.dyPixels=X,B.width=$-Z,B.height=J-X}}}catch(ee){M.e(ee)}finally{M.f()}}}}}},{key:"_addPlacedIcons",value:function(e,t,r,n,i,a){var o,s=Math.max(r-1,0),l=this._iconVertexBuffer,u=this._iconIndexBuffer,h=this._markerMap,f=ye(t);try{for(f.s();!(o=f.n()).done;){var y=o.value,p=i?0:Math.max(r+Object(c.f)(y.minzoom),s),d=i?25:Math.min(r+Object(c.f)(y.maxzoom),25);if(!(d<=p)){var v=y.tl,g=y.tr,m=y.bl,_=y.br,x=y.mosaicRect,b=y.labelAngle,w=y.minAngle,k=y.maxAngle,E=y.anchor,I=l.index,O=x.x,T=x.y,S=O+x.width,L=T+x.height,P=l.index;l.add(E.x,E.y,v.x,v.y,O,T,b,w,k,p,d,a),l.add(E.x,E.y,g.x,g.y,S,T,b,w,k,p,d,a),l.add(E.x,E.y,m.x,m.y,O,L,b,w,k,p,d,a),l.add(E.x,E.y,_.x,_.y,S,L,b,w,k,p,d,a),e.iconVertexRanges.length>0&&e.iconVertexRanges[0][0]+e.iconVertexRanges[0][1]===P?e.iconVertexRanges[0][1]+=4:e.iconVertexRanges.push([P,4]),u.add(I+0,I+1,I+2),u.add(I+1,I+2,I+3),h.has(n)?h.get(n)[1]+=6:h.set(n,[this._iconIndexStart+this._iconIndexCount,6]),this._iconIndexCount+=6}}}catch(D){f.e(D)}finally{f.f()}}},{key:"_addPlacedGlyphs",value:function(){var e,t=this._textVertexBuffer,r=this._textIndexBuffer,n=this._glyphMap,i=ye(this._glyphBufferDataStorage);try{for(i.s();!(e=i.n()).done;){var a,o=Object(T.a)(e.value,2),s=o[0],l=ye(o[1]);try{for(l.s();!(a=l.n()).done;){var u=a.value,c=t.index,h=u.symbolInstance,f=u.ddAttributes,y=t.index;t.add(u.glyphAnchor[0],u.glyphAnchor[1],u.tl[0],u.tl[1],u.xmin,u.ymin,u.labelAngle,u.minAngle,u.maxAngle,u.minLod,u.maxLod,f),t.add(u.glyphAnchor[0],u.glyphAnchor[1],u.tr[0],u.tr[1],u.xmax,u.ymin,u.labelAngle,u.minAngle,u.maxAngle,u.minLod,u.maxLod,f),t.add(u.glyphAnchor[0],u.glyphAnchor[1],u.bl[0],u.bl[1],u.xmin,u.ymax,u.labelAngle,u.minAngle,u.maxAngle,u.minLod,u.maxLod,f),t.add(u.glyphAnchor[0],u.glyphAnchor[1],u.br[0],u.br[1],u.xmax,u.ymax,u.labelAngle,u.minAngle,u.maxAngle,u.minLod,u.maxLod,f),h.textVertexRanges.length>0&&h.textVertexRanges[0][0]+h.textVertexRanges[0][1]===y?h.textVertexRanges[0][1]+=4:h.textVertexRanges.push([y,4]),r.add(c+0,c+1,c+2),r.add(c+1,c+2,c+3),n.has(s)?n.get(s)[1]+=6:n.set(s,[this._textIndexStart+this._textIndexCount,6]),this._textIndexCount+=6}}catch(p){l.e(p)}finally{l.f()}}}catch(p){i.e(p)}finally{i.f()}this._glyphBufferDataStorage.clear()}},{key:"_storePlacedGlyphs",value:function(e,t,r,n,i){var a,o,s,l,u,h,f,y,p,d,v,g,m=Math.max(r-1,0),_=1===n,x=ye(t);try{for(x.s();!(g=x.n()).done;){var b=g.value;(a=_?0:Math.max(r+Object(c.f)(b.minzoom),m),(o=_?25:Math.min(r+Object(c.f)(b.maxzoom),25))<=a)||(s=b.tl,l=b.tr,u=b.bl,h=b.br,f=b.labelAngle,y=b.minAngle,p=b.maxAngle,d=b.anchor,v=b.mosaicRect,this._glyphBufferDataStorage.has(b.page)||this._glyphBufferDataStorage.set(b.page,[]),this._glyphBufferDataStorage.get(b.page).push({glyphAnchor:[d.x,d.y],tl:[s.x,s.y],tr:[l.x,l.y],bl:[u.x,u.y],br:[h.x,h.y],xmin:v.x,ymin:v.y,xmax:v.x+v.width,ymax:v.y+v.height,labelAngle:f,minAngle:y,maxAngle:p,minLod:a,maxLod:o,placementLod:m,symbolInstance:e,ddAttributes:i}))}}catch(w){x.e(w)}finally{x.f()}}}],[{key:"symbolsSerializationLength",value:function(e){var t=0;t+=1;var r,n=ye(e||[]);try{for(n.s();!(r=n.n()).done;){var i=r.value;t+=4,t+=1;var a,o=ye(i.textColliders);try{for(o.s();!(a=o.n()).done;){a.value;t+=10}}catch(u){o.e(u)}finally{o.f()}var s,l=ye(i.iconColliders);try{for(l.s();!(s=l.n()).done;){s.value;t+=10}}catch(u){l.e(u)}finally{l.f()}t+=1,t+=2*i.textVertexRanges.length,t+=1,t+=2*i.iconVertexRanges.length}}catch(u){n.e(u)}finally{n.f()}return t}},{key:"serializeSymbols",value:function(e,t,r,n,i){i=i||[],t[n++]=i.length;var a,o=ye(i);try{for(o.s();!(a=o.n()).done;){var s=a.value;t[n++]=s.anchor.x,t[n++]=s.anchor.y,t[n++]=s.symbolFeature.hash,t[n++]=s.symbolFeature.priority,t[n++]=s.textColliders.length+s.iconColliders.length;var l,u=ye(s.textColliders);try{for(u.s();!(l=u.n()).done;){var c=l.value;t[n++]=c.xTile,t[n++]=c.yTile,t[n++]=c.dxPixels,t[n++]=c.dyPixels,t[n++]=c.hard?1:0,t[n++]=c.partIndex,r[n++]=c.minLod,r[n++]=c.maxLod,t[n++]=c.width,t[n++]=c.height}}catch(E){u.e(E)}finally{u.f()}var h,f=ye(s.iconColliders);try{for(f.s();!(h=f.n()).done;){var y=h.value;t[n++]=y.xTile,t[n++]=y.yTile,t[n++]=y.dxPixels,t[n++]=y.dyPixels,t[n++]=y.hard?1:0,t[n++]=y.partIndex,r[n++]=y.minLod,r[n++]=y.maxLod,t[n++]=y.width,t[n++]=y.height}}catch(E){f.e(E)}finally{f.f()}t[n++]=s.textVertexRanges.length;var p,d=ye(s.textVertexRanges);try{for(d.s();!(p=d.n()).done;){var v=Object(T.a)(p.value,2),g=v[0],m=v[1];t[n++]=g,t[n++]=m}}catch(E){d.e(E)}finally{d.f()}t[n++]=s.iconVertexRanges.length;var _,x=ye(s.iconVertexRanges);try{for(x.s();!(_=x.n()).done;){var b=Object(T.a)(_.value,2),w=b[0],k=b[1];t[n++]=w,t[n++]=k}}catch(E){x.e(E)}finally{x.f()}}}catch(E){o.e(E)}finally{o.f()}return n}},{key:"_pushAnchors",value:function(e,t,r,n){r+=n;for(var i=0,a=t.length-1,o=0;o<a;o++)i+=_.a.distance(t[o],t[o+1]);var s=n||r;if(!(i<=(s*=.5)))for(var l=s/i,u=0,h=-(r=i/Math.max(Math.round(i/r),1))/2,f=t.length-1,y=0;y<f;y++){for(var p=t[y],d=t[y+1],v=d.x-p.x,g=d.y-p.y,m=Math.sqrt(v*v+g*g),x=void 0;h+r<u+m;){var b=((h+=r)-u)/m,k=Object(c.e)(p.x,d.x,b),E=Object(c.e)(p.y,d.y,b);void 0===x&&(x=Math.atan2(g,v)),e.push(new w(k,E,x,y,l))}u+=m}}},{key:"_pushCenterAnchor",value:function(e,t){for(var r=0,n=t.length-1,i=0;i<n;i++)r+=_.a.distance(t[i],t[i+1]);for(var a=r/2,o=0,s=t.length-1,l=0;l<s;l++){var u=t[l],h=t[l+1],f=h.x-u.x,y=h.y-u.y,p=Math.sqrt(f*f+y*y);if(a<o+p){var d=(a-o)/p,v=Object(c.e)(u.x,h.x,d),g=Object(c.e)(u.y,h.y,d),m=Math.atan2(y,f);return void e.push(new w(v,g,m,l,0))}o+=p}}},{key:"_deviation",value:function(e,t,r){var n=(t.x-e.x)*(r.x-t.x)+(t.y-e.y)*(r.y-t.y),i=(t.x-e.x)*(r.y-t.y)-(t.y-e.y)*(r.x-t.x);return Math.atan2(i,n)}},{key:"_honorsTextMaxAngle",value:function(e,t,r,n,i){for(var a=0,o=r/2,s=new _.a(t.x,t.y),l=t.segment+1;a>-o;){if(--l<0)return!1;a-=_.a.distance(e[l],s),s=e[l]}a+=_.a.distance(e[l],e[l+1]);for(var u=[],c=0,h=e.length;a<o;){var f=e[l],y=void 0,p=l;do{if(++p===h)return!1;y=e[p]}while(y.isEqual(f));var d=void 0,v=p;do{if(++v===h)return!1;d=e[v]}while(d.isEqual(y));var g=this._deviation(f,y,d);for(u.push({deviation:g,distToAnchor:a}),c+=g;a-u[0].distToAnchor>i;)c-=u.shift().deviation;if(Math.abs(c)>n)return!1;a+=_.a.distance(y,d),l=p}return!0}},{key:"_smoothVertices",value:function(e,t){if(t<=0)return e;var r=e.length;if(r<3)return e;var n=[],i=0,a=0;n.push(0);for(var o=1;o<r;o++){var s=_.a.distance(e[o],e[o-1]);s>0&&(i+=s,n.push(i),++a!==o&&(e[a]=e[o]))}if((r=a+1)<3)return e;t=Math.min(t,.2*i);var l=e[0].x,u=e[0].y,c=e[r-1].x,h=e[r-1].y,f=_.a.sub(e[0],e[1]);f.normalize(),e[0].x+=t*f.x,e[0].y+=t*f.y,f.assignSub(e[r-1],e[r-2]),f.normalize(),e[r-1].x+=t*f.x,e[r-1].y+=t*f.y,n[0]-=t,n[r-1]+=t;var y=[];y.push(new _.a(l,u));for(var p=1e-6,d=.5*t,v=1;v<r-1;v++){for(var g=0,m=0,x=0,b=v-1;b>=0;b--){var w=d+n[b+1]-n[v];if(w<0)break;var k=n[b+1]-n[b],E=n[v]-n[b]<d?1:w/k;if(E<p)break;var I=E*E,O=E*w-.5*I*k,T=E*k/t,S=e[b+1],L=e[b].x-S.x,P=e[b].y-S.y;g+=T/O*(S.x*E*w+.5*I*(w*L-k*S.x)-I*E*k*L/3),m+=T/O*(S.y*E*w+.5*I*(w*P-k*S.y)-I*E*k*P/3),x+=T}for(var D=v+1;D<r;D++){var N=d-n[D-1]+n[v];if(N<0)break;var A=n[D]-n[D-1],j=n[D]-n[v]<d?1:N/A;if(j<p)break;var R=j*j,U=j*N-.5*R*A,M=j*A/t,B=e[D-1],C=e[D].x-B.x,G=e[D].y-B.y;g+=M/U*(B.x*j*N+.5*R*(N*C-A*B.x)-R*j*A*C/3),m+=M/U*(B.y*j*N+.5*R*(N*G-A*B.y)-R*j*A*G/3),x+=M}y.push(new _.a(g/x,m/x))}return y.push(new _.a(c,h)),e[0].x=l,e[0].y=u,e[r-1].x=c,e[r-1].y=h,y}},{key:"_pushCentroid",value:function(e,t){var r=4096,n=4096,i=t.length-1,a=0,o=0,s=0,l=t[0].x,u=t[0].y;l>r&&(l=r),l<0&&(l=0),u>n&&(u=n),u<0&&(u=0);for(var c=1;c<i;c++){var h=t[c].x,f=t[c].y,y=t[c+1].x,p=t[c+1].y;h>r&&(h=r),h<0&&(h=0),f>n&&(f=n),f<0&&(f=0),y>r&&(y=r),y<0&&(y=0),p>n&&(p=n),p<0&&(p=0);var d=(h-l)*(p-u)-(y-l)*(f-u);a+=d*(l+h+y),o+=d*(u+f+p),s+=d}a/=3*s,o/=3*s,isNaN(a)||isNaN(o)||e.push(new w(a,o))}}]),r}(q);ge._bidiEngine=new ce.a;var me,_e,xe=ge,be=r("KMaQ");function we(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return ke(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ke(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function ke(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}(_e=me||(me={}))[_e.INITIALIZED=0]="INITIALIZED",_e[_e.NO_DATA=1]="NO_DATA",_e[_e.READY=2]="READY",_e[_e.MODIFIED=3]="MODIFIED",_e[_e.INVALID=4]="INVALID";var Ee=function(){function e(t,r,n,a,o){if(Object(i.a)(this,e),this._pbfTiles={},this._tileClippers={},this._client=n,this._tile=r,o){this._styleLayerUIDs=new Set;var s,l=we(o);try{for(l.s();!(s=l.n()).done;){var u=s.value;this._styleLayerUIDs.add(u)}}catch(I){l.e(I)}finally{l.f()}}this._styleRepository=a,this._layers=this._styleRepository.layers;var c=r.tileKey.split("/").map(parseFloat),h=Object(T.a)(c,3),f=h[0],y=h[1],p=h[2];this._level=f;for(var d=8+Math.max(5*(this._level-14),0),v=0,g=Object.keys(t);v<g.length;v++){var m=g[v],_=t[m];if(this._pbfTiles[m]=new S.a(new Uint8Array(_.protobuff),new DataView(_.protobuff)),_.refKey){var x=_.refKey.split("/").map(parseFloat),b=f-Object(T.a)(x,1)[0];if(b>0){var w=(1<<b)-1,k=y&w,E=p&w;this._tileClippers[m]=new be.b(b,k,E,8,d)}}this._tileClippers[m]||(this._tileClippers[m]=new be.a)}}var t;return Object(a.a)(e,[{key:"_canParseStyleLayer",value:function(e){return!this._styleLayerUIDs||this._styleLayerUIDs.has(e)}},{key:"parse",value:(t=Object(n.a)(s.a.mark((function e(t){var r,n,i,a,o,l,u,c,h=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=this._initialize(t),n=r.returnedBuckets,this._processLayers(r),this._linkReferences(r),this._filterFeatures(r),i=new Set,a={},o=we(n);try{for(o.s();!(l=o.n()).done;)(u=l.value).getResources(u.tileClipper,i,a)}catch(s){o.e(s)}finally{o.f()}if(this._tile.status!==me.INVALID){e.next=7;break}return e.abrupt("return",Promise.resolve([]));case 7:return c=this._fetchResources(i,a,t),e.abrupt("return",Promise.all(c).then((function(){return h._processFeatures(r.returnedBuckets)})));case 9:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"_initialize",value:function(e){return{signal:e&&e.signal,sourceNameToTileData:this._parseTileData(this._pbfTiles),layers:this._layers,zoom:this._level,sourceNameToTileClipper:this._tileClippers,sourceNameToUniqueSourceLayerBuckets:{},sourceNameToUniqueSourceLayers:{},returnedBuckets:[],layerIdToBucket:{},referencerUIDToReferencedId:new Map}}},{key:"_processLayers",value:function(e){for(var t=e.sourceNameToTileData,r=e.layers,n=e.zoom,i=e.sourceNameToTileClipper,a=e.sourceNameToUniqueSourceLayerBuckets,o=e.sourceNameToUniqueSourceLayers,s=e.returnedBuckets,l=e.layerIdToBucket,u=e.referencerUIDToReferencedId,c=r.length-1;c>=0;c--){var h=r[c];if(!(!this._canParseStyleLayer(h.uid)||h.minzoom&&n<Math.floor(h.minzoom)||h.maxzoom&&n>=h.maxzoom||0===h.type)&&(t[h.source]&&i[h.source])){var f=t[h.source],y=i[h.source],p=h.sourceLayer,d=f[p];if(d){var v=o[h.source];if(v||(v=o[h.source]=new Set),v.add(h.sourceLayer),h.refLayerId)u.set(h.uid,h.refLayerId);else{var g=this._createBucket(h);if(g){g.layerUIDs=[h.uid],g.layerExtent=d.extent,g.tileClipper=y;var m=a[h.source];m||(m=a[h.source]={});var _=m[p];_||(_=m[p]=[]),_.push(g),s.push(g),l[h.id.toLowerCase()]=g}}}}}}},{key:"_linkReferences",value:function(e){var t=e.layerIdToBucket;e.referencerUIDToReferencedId.forEach((function(e,r){e=e.toLowerCase(),t[e]&&t[e].layerUIDs.push(r)}))}},{key:"_filterFeatures",value:function(e){for(var t=e.signal,r=e.sourceNameToTileData,n=e.sourceNameToUniqueSourceLayerBuckets,i=e.sourceNameToUniqueSourceLayers,a=10*this._level,o=10*(this._level+1),s=[],u=[],c=function(){var e=f[h];i[e].forEach((function(t){s.push(t),u.push(e)}))},h=0,f=Object.keys(i);h<f.length;h++)c();for(var y=0;y<s.length;y++){var p=u[y],d=s[y];if(r[p]&&n[p]){var v=r[p][d],g=n[p][d];if(g&&0!==g.length){if(Object(l.n)(t))return;for(var m=v.getData();m.nextTag(2);){var _=m.getMessage(),x=new L(_,v);_.release();var b=x.values;if(b){var w=b._minzoom;if(w&&w>=o)continue;var k=b._maxzoom;if(k&&k<=a)continue}var E,I=we(g);try{for(I.s();!(E=I.n()).done;){E.value.pushFeature(x)}}catch(O){I.e(O)}finally{I.f()}}}}}}},{key:"_fetchResources",value:function(e,t,r){var n,i,a=[],o=this._tile.getWorkerTileHandler();for(var s in e.size>0&&(n=o.fetchSprites(e,this._client,r),a.push(n)),t){var l=t[s];l.size>0&&(i=o.fetchGlyphs(this._tile.tileKey,s,l,this._client,r),a.push(i))}return a}},{key:"_processFeatures",value:function(e){var t,r=this,n=e.filter((function(e){return e.hasFeatures()||r._canParseStyleLayer(e.layer.uid)})),i=we(n);try{for(i.s();!(t=i.n()).done;){var a=t.value;a.processFeatures(a.tileClipper)}}catch(o){i.e(o)}finally{i.f()}return n}},{key:"_parseTileData",value:function(e){for(var t={},r=0,n=Object.keys(e);r<n.length;r++){for(var i=n[r],a=e[i],o={};a.next();)switch(a.tag()){case 3:var s=a.getMessage(),l=new U(s);s.release(),o[l.name]=l;break;default:a.skip()}t[i]=o}return t}},{key:"_createBucket",value:function(e){switch(e.type){case 0:return null;case 1:return this._createFillBucket(e);case 2:return this._createLineBucket(e);case 4:return this._createCircleBucket(e);case 3:return this._createSymbolBucket(e)}}},{key:"_createFillBucket",value:function(e){return new te(e,this._level,this._tile.getWorkerTileHandler().getSpriteItems(),new G(e.fillMaterial.getStride()),new R,new V(e.outlineMaterial.getStride()),new R)}},{key:"_createLineBucket",value:function(e){return new ue(e,this._level,this._tile.getWorkerTileHandler().getSpriteItems(),new C(e.lineMaterial.getStride()),new R)}},{key:"_createCircleBucket",value:function(e){return new K(e,this._level,this._tile.getWorkerTileHandler().getSpriteItems(),new z(e.circleMaterial.getStride()),new R)}},{key:"_createSymbolBucket",value:function(e){var t=this._tile;return new xe(e,this._level,new F(e.iconMaterial.getStride()),new R,new F(e.textMaterial.getStride()),new R,t.placementEngine,t.getWorkerTileHandler())}}]),e}();function Ie(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return Oe(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Oe(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function Oe(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Te=function(){function e(t,r,n,a){Object(i.a)(this,e),this.status=me.INITIALIZED,this.placementEngine=new O,this.tileKey=t,this.refKeys=r,this._workerTileHandler=n,this._styleRepository=a}var t,r;return Object(a.a)(e,[{key:"release",value:function(){this.tileKey="",this.refKeys=null,this.status=me.INITIALIZED,this._workerTileHandler=null}},{key:"parse",value:(r=Object(n.a)(s.a.mark((function e(t,r,n){var i,a,o,c,h,f,y,p,d=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n&&n.signal,Object(u.i)(i)&&(a=function e(){i.removeEventListener("abort",e),d.status=me.INVALID},i.addEventListener("abort",a)),e.prev=2,e.next=5,this._parse(t,n);case 5:o=e.sent,e.next=13;break;case 8:if(e.prev=8,e.t0=e.catch(2),!Object(l.m)(e.t0)){e.next=12;break}throw e.t0;case 12:return e.abrupt("return",{result:[],transferList:[]});case 13:this.status=me.READY,c=[],h=Ie(o);try{for(h.s();!(f=h.n()).done;)y=f.value,p=y.serialize(),c.push(p)}catch(s){h.e(s)}finally{h.f()}return e.abrupt("return",{result:c,transferList:c.length<=r&&c});case 18:case"end":return e.stop()}}),e,this,[[2,8]])}))),function(e,t,n){return r.apply(this,arguments)})},{key:"setObsolete",value:function(){this.status=me.INVALID}},{key:"getLayers",value:function(){return this._workerTileHandler.getLayers()}},{key:"getWorkerTileHandler",value:function(){return this._workerTileHandler}},{key:"_parse",value:(t=Object(n.a)(s.a.mark((function e(t,r){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.sourceName2DataAndRefKey,0!==Object.keys(n).length){e.next=3;break}return e.abrupt("return",[]);case 3:return this.status=me.MODIFIED,e.abrupt("return",new Ee(n,this,r.client,this._styleRepository,t.styleLayerUIDs).parse(r));case 5:case"end":return e.stop()}}),e,this)}))),function(e,r){return t.apply(this,arguments)})}]),e}(),Se=r("IjGd");function Le(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return Pe(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Pe(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function Pe(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var De=function(){function e(){Object(i.a)(this,e),this._spriteInfo={},this._glyphInfo={}}var t;return Object(a.a)(e,[{key:"reset",value:function(){return this._spriteInfo={},this._glyphInfo={},Promise.resolve()}},{key:"getLayers",value:function(){var e;return null==(e=this._styleRepository)?void 0:e.layers}},{key:"createTileAndParse",value:(t=Object(n.a)(s.a.mark((function e(t,r){var n,i,a,o,u,c,h;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=t.key,i={},a=0,o=Object.keys(t.sourceName2DataAndRefKey);a<o.length;a++)u=o[a],c=t.sourceName2DataAndRefKey[u],i[u]=c.refKey;return h=new Te(n,i,this,this._styleRepository),e.prev=3,e.next=6,h.parse(t,this._vectorTileLayerMaxBuffers,r);case 6:return e.abrupt("return",e.sent);case 9:if(e.prev=9,e.t0=e.catch(3),h.setObsolete(),h.release(),Object(l.m)(e.t0)){e.next=13;break}throw e.t0;case 13:return e.abrupt("return",null);case 14:case"end":return e.stop()}}),e,this,[[3,9]])}))),function(e,r){return t.apply(this,arguments)})},{key:"updateStyle",value:function(e){if(e&&0!==e.length&&this._styleRepository){var t,r=this._styleRepository,n=Le(e);try{for(n.s();!(t=n.n()).done;){var i=t.value,a=i.type,o=i.data;switch(a){case 0:r.setPaintProperties(o.layer,o.paint);break;case 1:r.setLayoutProperties(o.layer,o.layout);break;case 3:r.deleteStyleLayer(o.layer);break;case 2:r.setStyleLayer(o.layer,o.index)}}}catch(s){n.e(s)}finally{n.f()}}}},{key:"setStyle",value:function(e){this._styleRepository=new Se.a(e.style),this._spriteInfo={},this._glyphInfo={},this._vectorTileLayerMaxBuffers=e.vectorTileLayerMaxBuffers}},{key:"fetchSprites",value:function(e,t,r){var n=[],i=this._spriteInfo;return e.forEach((function(e){void 0===i[e.name]&&n.push(e)})),0===n.length?Promise.resolve():t.invoke("getSprites",n,{signal:r&&r.signal}).then((function(e){for(var t in e){var r=e[t];i[t]=r}}))}},{key:"getSpriteItems",value:function(){return this._spriteInfo}},{key:"fetchGlyphs",value:function(e,t,r,n,i){var a=[],o=this._glyphInfo[t];return o?r.forEach((function(e){o[e]||a.push(e)})):(o=this._glyphInfo[t]=[],r.forEach((function(e){return a.push(e)}))),0===a.length?Promise.resolve():n.invoke("getGlyphs",{tileID:e,font:t,codePoints:a},i).then((function(e){for(var t=0;t<e.length;t++)e[t]&&(o[t]=e[t])}))}},{key:"getGlyphItems",value:function(e){return this._glyphInfo[e]}}]),e}();t.default=De},msFv:function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n=r("hisu"),i=r("yBJb"),a=r("PmOk");function o(e,t){return e.x===t.x&&e.y===t.y}function s(e){if(e){var t=e.length;if(!(t<=1)){for(var r=0,n=1;n<t;n++)o(e[n],e[r])||++r===n||(e[r]=e[n]);e.length=r+1}}}function l(e,t){return e.x=t.y,e.y=-t.x,e}function u(e,t){return e.x=-t.y,e.y=t.x,e}function c(e,t){return e.x=t.x,e.y=t.y,e}function h(e,t){return e.x=-t.x,e.y=-t.y,e}function f(e){return Math.sqrt(e.x*e.x+e.y*e.y)}function y(e,t){return e.x*t.y-e.y*t.x}function p(e,t){return e.x*t.x+e.y*t.y}function d(e,t,r,n){return e.x=t.x*r+t.y*n,e.y=t.x*n-t.y*r,e}var v=function(){function e(t,r,i){Object(n.a)(this,e),this.writeVertex=t,this.writeTriangle=r,this.canUseThinTessellation=i,this.prevNormal={x:void 0,y:void 0},this.nextNormal={x:void 0,y:void 0},this.textureNormalLeft={x:0,y:1},this.textureNormalRight={x:0,y:-1},this.textureNormal={x:void 0,y:void 0},this.joinNormal={x:void 0,y:void 0},this.inner={x:void 0,y:void 0},this.outer={x:void 0,y:void 0},this.roundStart={x:void 0,y:void 0},this.roundEnd={x:void 0,y:void 0},this.startBreak={x:void 0,y:void 0},this.endBreak={x:void 0,y:void 0},this.innerPrev={x:void 0,y:void 0},this.innerNext={x:void 0,y:void 0},this.bevelStart={x:void 0,y:void 0},this.bevelEnd={x:void 0,y:void 0},this.bevelMiddle={x:void 0,y:void 0}}return Object(i.a)(e,[{key:"tessellate",value:function(e,t){s(e),this.canUseThinTessellation&&t.halfWidth<a.D&&!t.offset?this.tessellateThin_(e,t):this.tessellate_(e,t)}},{key:"tessellateThin_",value:function(e,t){if(!(e.length<2))for(var r=t.wrapDistance||65535,n=t.initialDistance||0,i=!1,a=e[0].x,o=e[0].y,s=e.length,l=1;l<s;++l){i&&(i=!1,n=0);var u=e[l].x,c=e[l].y,h=u-a,f=c-o,y=Math.sqrt(h*h+f*f);if(h/=y,f/=y,n+y>r){i=!0;var p=(r-n)/y;y=r-n,u=(1-p)*a+p*u,c=(1-p)*o+p*c,--l}var d=this.writeVertex(a,o,0,0,h,f,f,-h,0,-1,n),v=this.writeVertex(a,o,0,0,h,f,-f,h,0,1,n);n+=y;var g=this.writeVertex(u,c,0,0,h,f,f,-h,0,-1,n),m=this.writeVertex(u,c,0,0,h,f,-f,h,0,1,n);this.writeTriangle(d,v,g),this.writeTriangle(v,g,m),a=u,o=c}}},{key:"tessellate_",value:function(e,t){var r=e[0],n=e[e.length-1],i=o(r,n),a=i?3:2;if(!(e.length<a)){var s,v,g,m,_=t.pixelCoordRatio,x=null!=t.capType?t.capType:0,b=null!=t.joinType?t.joinType:2,w=null!=t.miterLimit?Math.min(t.miterLimit,4):2,k=null!=t.roundLimit?Math.min(t.roundLimit,1.05):1.05,E=null!=t.halfWidth?t.halfWidth:2,I=!!t.textured,O=null,T=null,S=this.prevNormal,L=this.nextNormal,P=-1,D=-1,N=this.joinNormal,A=this.textureNormalLeft,j=this.textureNormalRight,R=this.textureNormal,U=-1,M=-1,B=t.wrapDistance||65535,C=t.initialDistance||0,G=this.writeVertex,V=this.writeTriangle,F=function(e,t,r,n,i,a){var o=G(s,v,g,m,r,n,e,t,i,a,C);return U>=0&&M>=0&&o>=0&&V(U,M,o),U=M,M=o,o};i&&(O=e[e.length-2],L.x=n.x-O.x,L.y=n.y-O.y,D=f(L),L.x/=D,L.y/=D);for(var z=!1,q=0;q<e.length;++q){if(z&&(z=!1,C=0),O&&(S.x=-L.x,S.y=-L.y,C+(P=D)>B&&(z=!0)),z){var H=(B-C)/P;P=B-C,O={x:(1-H)*O.x+H*e[q].x,y:(1-H)*O.y+H*e[q].y},--q}else O=e[q];s=O.x,v=O.y;var W=q<=0&&!z,Y=q===e.length-1;if(W||(C+=P),(T=Y?i?e[1]:null:e[q+1])?(L.x=T.x-s,L.y=T.y-v,D=f(L),L.x/=D,L.y/=D):(L.x=void 0,L.y=void 0),!i){if(W){u(N,L),g=N.x,m=N.y,2===x&&(F(-L.y-L.x,L.x-L.y,L.x,L.y,0,-1),F(L.y-L.x,-L.x-L.y,L.x,L.y,0,1)),1===x&&(F(-L.y-L.x,L.x-L.y,L.x,L.y,-1,-1),F(L.y-L.x,-L.x-L.y,L.x,L.y,-1,1)),1!==x&&0!==x||(F(-L.y,L.x,L.x,L.y,0,-1),F(L.y,-L.x,L.x,L.y,0,1));continue}if(Y){l(N,S),g=N.x,m=N.y,1!==x&&0!==x||(F(S.y,-S.x,-S.x,-S.y,0,-1),F(-S.y,S.x,-S.x,-S.y,0,1)),2===x&&(F(S.y-S.x,-S.x-S.y,-S.x,-S.y,0,-1),F(-S.y-S.x,S.x-S.y,-S.x,-S.y,0,1)),1===x&&(F(S.y-S.x,-S.x-S.y,-S.x,-S.y,1,-1),F(-S.y-S.x,S.x-S.y,-S.x,-S.y,1,1));continue}}var K=void 0,Q=void 0,Z=-y(S,L);if(Math.abs(Z)<.01)p(S,L)>0?(N.x=S.x,N.y=S.y,Z=1,K=Number.MAX_VALUE,Q=!0):(u(N,L),Z=1,K=1,Q=!1);else{N.x=(S.x+L.x)/Z,N.y=(S.y+L.y)/Z;var $=((K=f(N))-1)*E*_;Q=K>4||$>P&&$>D}g=N.x,m=N.y;var X=b;switch(b){case 0:K<1.05&&(X=2);break;case 1:K<k&&(X=2);break;case 2:K>w&&(X=0)}switch(X){case 2:if(F(N.x,N.y,-S.x,-S.y,0,-1),F(-N.x,-N.y,-S.x,-S.y,0,1),Y)break;if(I){var J=z?0:C;U=this.writeVertex(s,v,g,m,L.x,L.y,N.x,N.y,0,-1,J),M=this.writeVertex(s,v,g,m,L.x,L.y,-N.x,-N.y,0,1,J)}break;case 0:var ee=Z<0,te=void 0,re=void 0,ne=void 0,ie=void 0;if(ee){var ae=U;U=M,M=ae,te=A,re=j}else te=j,re=A;if(Q)ne=ee?u(this.innerPrev,S):l(this.innerPrev,S),ie=ee?l(this.innerNext,L):u(this.innerNext,L);else{var oe=ee?h(this.inner,N):c(this.inner,N);ne=oe,ie=oe}var se=ee?l(this.bevelStart,S):u(this.bevelStart,S);F(ne.x,ne.y,-S.x,-S.y,te.x,te.y);var le=F(se.x,se.y,-S.x,-S.y,re.x,re.y);if(Y)break;var ue=ee?u(this.bevelEnd,L):l(this.bevelEnd,L);if(Q){var ce=this.writeVertex(s,v,g,m,-S.x,-S.y,0,0,0,0,C);U=this.writeVertex(s,v,g,m,L.x,L.y,ie.x,ie.y,te.x,te.y,C),M=this.writeVertex(s,v,g,m,L.x,L.y,ue.x,ue.y,re.x,re.y,C),this.writeTriangle(le,ce,M)}else{if(I){var he=this.bevelMiddle;he.x=(se.x+ue.x)/2,he.y=(se.y+ue.y)/2,d(R,he,-S.x,-S.y),F(he.x,he.y,-S.x,-S.y,R.x,R.y),d(R,he,L.x,L.y),U=this.writeVertex(s,v,g,m,L.x,L.y,he.x,he.y,R.x,R.y,C),M=this.writeVertex(s,v,g,m,L.x,L.y,ie.x,ie.y,te.x,te.y,C)}else{var fe=U;U=M,M=fe}F(ue.x,ue.y,L.x,L.y,re.x,re.y)}if(ee){var ye=U;U=M,M=ye}break;case 1:var pe=Z<0,de=void 0,ve=void 0;if(pe){var ge=U;U=M,M=ge,de=A,ve=j}else de=j,ve=A;var me=pe?h(this.inner,N):c(this.inner,N),_e=void 0,xe=void 0;Q?(_e=pe?u(this.innerPrev,S):l(this.innerPrev,S),xe=pe?l(this.innerNext,L):u(this.innerNext,L)):(_e=me,xe=me);var be=pe?l(this.roundStart,S):u(this.roundStart,S),we=pe?u(this.roundEnd,L):l(this.roundEnd,L),ke=F(_e.x,_e.y,-S.x,-S.y,de.x,de.y),Ee=F(be.x,be.y,-S.x,-S.y,ve.x,ve.y);if(Y)break;var Ie=this.writeVertex(s,v,g,m,-S.x,-S.y,0,0,0,0,C);Q||this.writeTriangle(U,M,Ie);var Oe=h(this.outer,me),Te=this.writeVertex(s,v,g,m,L.x,L.y,we.x,we.y,ve.x,ve.y,C),Se=void 0,Le=void 0,Pe=K>2;if(Pe){var De=void 0;K!==Number.MAX_VALUE?(Oe.x/=K,Oe.y/=K,De=(K*((De=p(S,Oe))*De-1)+1)/De):De=-1,(Se=pe?l(this.startBreak,S):u(this.startBreak,S)).x+=S.x*De,Se.y+=S.y*De,(Le=pe?u(this.endBreak,L):l(this.endBreak,L)).x+=L.x*De,Le.y+=L.y*De}d(R,Oe,-S.x,-S.y);var Ne=this.writeVertex(s,v,g,m,-S.x,-S.y,Oe.x,Oe.y,R.x,R.y,C);d(R,Oe,L.x,L.y);var Ae=I?this.writeVertex(s,v,g,m,L.x,L.y,Oe.x,Oe.y,R.x,R.y,C):Ne,je=Ie,Re=I?this.writeVertex(s,v,g,m,L.x,L.y,0,0,0,0,C):Ie,Ue=-1,Me=-1;if(Pe&&(d(R,Se,-S.x,-S.y),Ue=this.writeVertex(s,v,g,m,-S.x,-S.y,Se.x,Se.y,R.x,R.y,C),d(R,Le,L.x,L.y),Me=this.writeVertex(s,v,g,m,L.x,L.y,Le.x,Le.y,R.x,R.y,C)),I?Pe?(this.writeTriangle(je,Ee,Ue),this.writeTriangle(je,Ue,Ne),this.writeTriangle(Re,Ae,Me),this.writeTriangle(Re,Me,Te)):(this.writeTriangle(je,Ee,Ne),this.writeTriangle(Re,Ae,Te)):Pe?(this.writeTriangle(Ie,Ee,Ue),this.writeTriangle(Ie,Ue,Me),this.writeTriangle(Ie,Me,Te)):(this.writeTriangle(Ie,Ee,Ne),this.writeTriangle(Ie,Ae,Te)),Q?(U=this.writeVertex(s,v,g,m,L.x,L.y,xe.x,xe.y,de.x,de.y,C),M=Te):(U=I?this.writeVertex(s,v,g,m,L.x,L.y,xe.x,xe.y,de.x,de.y,C):ke,this.writeTriangle(U,Re,Te),M=Te),pe){var Be=U;U=M,M=Be}}}}}}]),e}()},r9FC:function(e,t,r){"use strict";var n=r("hisu"),i=r("yBJb"),a=function(){function e(t){Object(n.a)(this,e),this._array=[],t<=0&&console.error("strideInBytes must be positive!"),this._stride=t}return Object(i.a)(e,[{key:"array",get:function(){return this._array}},{key:"index",get:function(){return 4*this._array.length/this._stride}},{key:"itemSize",get:function(){return this._stride}},{key:"sizeInBytes",get:function(){return 4*this._array.length}},{key:"reset",value:function(){this.array.length=0}},{key:"toBuffer",value:function(){return new Uint32Array(this._array).buffer}}],[{key:"i1616to32",value:function(e,t){return 65535&e|t<<16}},{key:"i8888to32",value:function(e,t,r,n){return 255&e|(255&t)<<8|(255&r)<<16|n<<24}},{key:"i8816to32",value:function(e,t,r){return 255&e|(255&t)<<8|r<<16}}]),e}();t.a=a}}]);
//# sourceMappingURL=52-048cf126374d3131932d.js.map