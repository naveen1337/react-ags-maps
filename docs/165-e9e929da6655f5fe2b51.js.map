{"version":3,"sources":["webpack:///C:/Users/chubs/development/react-ags-maps/node_modules/@arcgis/core/views/layers/TileLayerView.js","webpack:///C:/Users/chubs/development/react-ags-maps/node_modules/@arcgis/core/views/2d/layers/TileLayerView2D.js"],"names":["_createSuper","Derived","hasNativeReflectConstruct","Reflect","construct","sham","Proxy","Boolean","prototype","valueOf","call","e","_isNativeReflectConstruct","result","Super","NewTarget","this","constructor","arguments","apply","_i2","c","_i","_fetchPopupFeatures","_super","key","value","mark","_callee2","s","a","i","_c","_this","wrap","_context2","prev","next","layer","abrupt","Promise","reject","type","get","allSublayers","toArray","filter","r","minScale","t","maxScale","popupTemplate","popupEnabled","visible","map","_ref","_callee","o","_context","createQuery","event","renderer","geometry","createFetchPopupFeaturesQueryGeometry","getRequiredFields","outFields","sent","queryFeatures","features","stop","_x3","then","_ref2","concat","_x","_x2","w","getLogger","d","_g","_","_fetchImage2","_enqueueTileFetch2","_fetchTile","_doRefresh","_tileStrategy","_fetchQueue","_this2","tileInfo","spatialReference","equals","view","watch","refresh","addResolvingPromise","resampling","pause","state","update","resume","notifyChange","_this3","tileServers","_tileInfoView","fullExtent","tileInfoView","concurrency","length","process","fetchTile","cachePolicy","acquireTile","releaseTile","requestUpdate","container","requestRender","destroy","clear","removeAllChildren","_this4","updateRequested","suspended","reset","tiles","forEach","_enqueueTileFetch","_this$_tileInfoView$g","_this$_tileInfoView$g2","_this$_tileInfoView$t","_this$_tileInfoView$t2","_bitmapView","createTile","bitmap","getTileCoords","x","y","resolution","getTileResolution","size","width","height","addChild","abort","id","removeChild","once","l","h","n","u","tilemapCache","signal","_fetchImage","t0","_createBlankImage","fetchAvailabilityUpsample","level","row","col","t1","_resampleImage","_callee3","_t","_this5","_context3","has","push","source","error","_callee4","_context4","timestamp","refreshTimestamp","_x4","_x5","getLODInfoAt","getXForColumn","m","getYForRow","p","f","g","Math","round","_2","getContext","drawImage","_e","_e2","document","createElement","I"],"mappings":"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","file":"165-e9e929da6655f5fe2b51.js","sourcesContent":["import _toConsumableArray from \"C:/Users/chubs/development/react-ags-maps/docz/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _asyncToGenerator from \"C:/Users/chubs/development/react-ags-maps/docz/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"C:/Users/chubs/development/react-ags-maps/docz/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:/Users/chubs/development/react-ags-maps/docz/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"C:/Users/chubs/development/react-ags-maps/docz/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"C:/Users/chubs/development/react-ags-maps/docz/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:/Users/chubs/development/react-ags-maps/docz/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _regeneratorRuntime from \"C:/Users/chubs/development/react-ags-maps/docz/node_modules/@babel/runtime/regenerator\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../chunks/tslib.es6.js\";\nimport r from \"../../core/Error.js\";\nimport { isSome as t } from \"../../core/maybe.js\";\nimport { eachAlways as o } from \"../../core/promiseUtils.js\";\nimport { property as s } from \"../../core/accessorSupport/decorators/property.js\";\nimport \"../../core/has.js\";\nimport \"../../core/accessorSupport/ensureType.js\";\nimport \"../../core/Logger.js\";\nimport { subclass as a } from \"../../core/accessorSupport/decorators/subclass.js\";\nimport { calculateTolerance as p } from \"../../renderers/support/clickToleranceUtils.js\";\n\nvar i = function i(_i2) {\n  var c = /*#__PURE__*/function (_i) {\n    _inherits(c, _i);\n\n    var _super = _createSuper(c);\n\n    function c() {\n      _classCallCheck(this, c);\n\n      return _super.apply(this, arguments);\n    }\n\n    _createClass(c, [{\n      key: \"fetchPopupFeatures\",\n      value: function () {\n        var _fetchPopupFeatures = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e, s) {\n          var _this = this;\n\n          var a, i, _c;\n\n          return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n            while (1) {\n              switch (_context2.prev = _context2.next) {\n                case 0:\n                  a = this.layer;\n\n                  if (e) {\n                    _context2.next = 3;\n                    break;\n                  }\n\n                  return _context2.abrupt(\"return\", Promise.reject(new r(\"tilelayerview:fetchPopupFeatures\", \"Nothing to fetch without area\", {\n                    layer: a\n                  })));\n\n                case 3:\n                  if (!(\"tile\" !== a.type)) {\n                    _context2.next = 5;\n                    break;\n                  }\n\n                  return _context2.abrupt(\"return\", Promise.reject(new r(\"tilelayerview:fetchPopupFeatures\", \"Layer type should be 'tile'\", {\n                    type: a.type\n                  })));\n\n                case 5:\n                  i = this.get(\"view.scale\"), _c = a.allSublayers.toArray().filter(function (e) {\n                    var r = 0 === e.minScale || i <= e.minScale,\n                        t = 0 === e.maxScale || i >= e.maxScale;\n                    return e.popupTemplate && e.popupEnabled && e.visible && r && t;\n                  });\n                  return _context2.abrupt(\"return\", o(_c.map( /*#__PURE__*/function () {\n                    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(r) {\n                      var o, a, i;\n                      return _regeneratorRuntime.wrap(function _callee$(_context) {\n                        while (1) {\n                          switch (_context.prev = _context.next) {\n                            case 0:\n                              o = r.createQuery(), a = t(s) ? s.event : null, i = p({\n                                renderer: r.renderer,\n                                event: a\n                              });\n                              o.geometry = _this.createFetchPopupFeaturesQueryGeometry(e, i);\n                              _context.next = 4;\n                              return r.popupTemplate.getRequiredFields();\n\n                            case 4:\n                              o.outFields = _context.sent;\n                              _context.next = 7;\n                              return r.queryFeatures(o);\n\n                            case 7:\n                              return _context.abrupt(\"return\", _context.sent.features);\n\n                            case 8:\n                            case \"end\":\n                              return _context.stop();\n                          }\n                        }\n                      }, _callee);\n                    }));\n\n                    return function (_x3) {\n                      return _ref.apply(this, arguments);\n                    };\n                  }())).then(function (e) {\n                    var _ref2;\n\n                    return (_ref2 = []).concat.apply(_ref2, _toConsumableArray(e.map(function (e) {\n                      return e.value;\n                    }).filter(Boolean)));\n                  }));\n\n                case 7:\n                case \"end\":\n                  return _context2.stop();\n              }\n            }\n          }, _callee2, this);\n        }));\n\n        function fetchPopupFeatures(_x, _x2) {\n          return _fetchPopupFeatures.apply(this, arguments);\n        }\n\n        return fetchPopupFeatures;\n      }()\n    }]);\n\n    return c;\n  }(_i2);\n\n  return e([s()], c.prototype, \"layer\", void 0), c = e([a(\"esri.layers.mixins.TileLayerView\")], c), c;\n};\n\nexport default i;\nexport { i as TileLayerView };","import _slicedToArray from \"C:/Users/chubs/development/react-ags-maps/docz/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _asyncToGenerator from \"C:/Users/chubs/development/react-ags-maps/docz/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"C:/Users/chubs/development/react-ags-maps/docz/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:/Users/chubs/development/react-ags-maps/docz/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _get from \"C:/Users/chubs/development/react-ags-maps/docz/node_modules/@babel/runtime/helpers/esm/get\";\nimport _inherits from \"C:/Users/chubs/development/react-ags-maps/docz/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"C:/Users/chubs/development/react-ags-maps/docz/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:/Users/chubs/development/react-ags-maps/docz/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _regeneratorRuntime from \"C:/Users/chubs/development/react-ags-maps/docz/node_modules/@babel/runtime/regenerator\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../chunks/tslib.es6.js\";\nimport t from \"../../../core/Error.js\";\nimport i from \"../../../core/Logger.js\";\nimport { isNone as r } from \"../../../core/maybe.js\";\nimport { isAbortError as s } from \"../../../core/promiseUtils.js\";\nimport { property as a } from \"../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../core/has.js\";\nimport \"../../../core/accessorSupport/ensureType.js\";\nimport { subclass as l } from \"../../../core/accessorSupport/decorators/subclass.js\";\nimport { BitmapTileLayerView2D as o } from \"./BitmapTileLayerView2D.js\";\nimport { LayerView2DMixin as h } from \"./LayerView2D.js\";\nimport n from \"../tiling/TileInfoView.js\";\nimport c from \"../tiling/TileKey.js\";\nimport u from \"../tiling/TileQueue.js\";\nimport m from \"../tiling/TileStrategy.js\";\nimport p from \"../../layers/LayerView.js\";\nimport { RefreshableLayerView as f } from \"../../layers/RefreshableLayerView.js\";\nimport { TileLayerView as g } from \"../../layers/TileLayerView.js\";\nimport { createQueryGeometry as y } from \"../../support/drapedUtils.js\";\nvar w = i.getLogger(\"esri.views.2d.layers.TileLayerView2D\"),\n    d = [0, 0];\n\nvar _ = /*#__PURE__*/function (_g) {\n  _inherits(_, _g);\n\n  var _super = _createSuper(_);\n\n  function _() {\n    var _this;\n\n    _classCallCheck(this, _);\n\n    _this = _super.apply(this, arguments), _this._tileStrategy = null, _this._fetchQueue = null, _this.layer = null;\n    return _this;\n  }\n\n  _createClass(_, [{\n    key: \"initialize\",\n    value: function initialize() {\n      var _this2 = this;\n\n      var e = this.layer.tileInfo,\n          i = e && e.spatialReference;\n      var r;\n      i || (r = new t(\"layerview:tiling-information-missing\", \"The layer doesn't provide tiling information\", {\n        layer: this.layer\n      })), i.equals(this.view.spatialReference) || (r = new t(\"layerview:spatial-reference-incompatible\", \"The spatial reference of this layer does not meet the requirements of the view\", {\n        layer: this.layer\n      })), this.watch(\"resampling\", function () {\n        _this2.refresh();\n      }), r && this.addResolvingPromise(Promise.reject(r));\n    }\n  }, {\n    key: \"resampling\",\n    get: function get() {\n      return !(\"resampling\" in this.layer) || !1 !== this.layer.resampling;\n    }\n  }, {\n    key: \"hitTest\",\n    value: function hitTest() {\n      return null;\n    }\n  }, {\n    key: \"update\",\n    value: function update(e) {\n      this._fetchQueue.pause(), this._fetchQueue.state = e.state, this._tileStrategy.update(e), this._fetchQueue.resume(), this.notifyChange(\"updating\");\n    }\n  }, {\n    key: \"attach\",\n    value: function attach() {\n      var _this3 = this;\n\n      var e = \"tileServers\" in this.layer ? this.layer.tileServers : null;\n      this._tileInfoView = new n(this.layer.tileInfo, this.layer.fullExtent), this._fetchQueue = new u({\n        tileInfoView: this._tileInfoView,\n        concurrency: e && 10 * e.length || 10,\n        process: function process(e, t) {\n          return _this3.fetchTile(e, t);\n        }\n      }), this._tileStrategy = new m({\n        cachePolicy: \"keep\",\n        resampling: this.resampling,\n        acquireTile: function acquireTile(e) {\n          return _this3.acquireTile(e);\n        },\n        releaseTile: function releaseTile(e) {\n          return _this3.releaseTile(e);\n        },\n        tileInfoView: this._tileInfoView\n      }), this.requestUpdate(), this.container.requestRender(), _get(_getPrototypeOf(_.prototype), \"attach\", this).call(this);\n    }\n  }, {\n    key: \"detach\",\n    value: function detach() {\n      _get(_getPrototypeOf(_.prototype), \"detach\", this).call(this), this._tileStrategy.destroy(), this._fetchQueue.clear(), this.container.removeAllChildren(), this._fetchQueue = this._tileStrategy = this._tileInfoView = null;\n    }\n  }, {\n    key: \"moveStart\",\n    value: function moveStart() {\n      this.requestUpdate();\n    }\n  }, {\n    key: \"viewChange\",\n    value: function viewChange() {\n      this.requestUpdate();\n    }\n  }, {\n    key: \"moveEnd\",\n    value: function moveEnd() {\n      this.requestUpdate();\n    }\n  }, {\n    key: \"createFetchPopupFeaturesQueryGeometry\",\n    value: function createFetchPopupFeaturesQueryGeometry(e, t) {\n      return y(e, t, this.view);\n    }\n  }, {\n    key: \"doRefresh\",\n    value: function () {\n      var _doRefresh = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var _this4 = this;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                this.updateRequested || this.suspended || (this._fetchQueue.reset(), this._tileStrategy.tiles.forEach(function (e) {\n                  return _this4._enqueueTileFetch(e);\n                }), this.notifyChange(\"updating\"));\n\n              case 1:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function doRefresh() {\n        return _doRefresh.apply(this, arguments);\n      }\n\n      return doRefresh;\n    }()\n  }, {\n    key: \"isUpdating\",\n    value: function isUpdating() {\n      var e;\n      return (null == (e = this._fetchQueue) ? void 0 : e.length) > 0;\n    }\n  }, {\n    key: \"acquireTile\",\n    value: function acquireTile(e) {\n      var _this$_tileInfoView$g, _this$_tileInfoView$g2, _this$_tileInfoView$t, _this$_tileInfoView$t2;\n\n      var t = this._bitmapView.createTile(e),\n          i = t.bitmap;\n\n      return (_this$_tileInfoView$g = this._tileInfoView.getTileCoords(d, t.key), _this$_tileInfoView$g2 = _slicedToArray(_this$_tileInfoView$g, 2), i.x = _this$_tileInfoView$g2[0], i.y = _this$_tileInfoView$g2[1], _this$_tileInfoView$g), i.resolution = this._tileInfoView.getTileResolution(t.key), (_this$_tileInfoView$t = this._tileInfoView.tileInfo.size, _this$_tileInfoView$t2 = _slicedToArray(_this$_tileInfoView$t, 2), i.width = _this$_tileInfoView$t2[0], i.height = _this$_tileInfoView$t2[1], _this$_tileInfoView$t), this._enqueueTileFetch(t), this._bitmapView.addChild(t), this.requestUpdate(), t;\n    }\n  }, {\n    key: \"releaseTile\",\n    value: function releaseTile(e) {\n      this._fetchQueue.abort(e.key.id), this._bitmapView.removeChild(e), e.once(\"detach\", function () {\n        return e.destroy();\n      }), this.requestUpdate();\n    }\n  }, {\n    key: \"fetchTile\",\n    value: function () {\n      var _fetchTile = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e, t) {\n        var i, a, l, o, h, n, u;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                i = \"tilemapCache\" in this.layer ? this.layer.tilemapCache : null, a = !r(t) && t.signal;\n\n                if (i) {\n                  _context2.next = 13;\n                  break;\n                }\n\n                _context2.prev = 2;\n                _context2.next = 5;\n                return this._fetchImage(e, a);\n\n              case 5:\n                return _context2.abrupt(\"return\", _context2.sent);\n\n              case 8:\n                _context2.prev = 8;\n                _context2.t0 = _context2[\"catch\"](2);\n\n                if (!(!s(_context2.t0) && !this.resampling)) {\n                  _context2.next = 12;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\", this._createBlankImage());\n\n              case 12:\n                throw _context2.t0;\n\n              case 13:\n                l = new c(0, 0, 0, 0);\n                _context2.prev = 14;\n                _context2.next = 17;\n                return i.fetchAvailabilityUpsample(e.level, e.row, e.col, l, {\n                  signal: a\n                });\n\n              case 17:\n                if (!(l.level !== e.level && !this.resampling)) {\n                  _context2.next = 19;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\", this._createBlankImage());\n\n              case 19:\n                _context2.next = 21;\n                return this._fetchImage(l, a);\n\n              case 21:\n                o = _context2.sent;\n                _context2.next = 31;\n                break;\n\n              case 24:\n                _context2.prev = 24;\n                _context2.t1 = _context2[\"catch\"](14);\n\n                if (!s(_context2.t1)) {\n                  _context2.next = 28;\n                  break;\n                }\n\n                throw _context2.t1;\n\n              case 28:\n                _context2.next = 30;\n                return this._fetchImage(e, a);\n\n              case 30:\n                o = _context2.sent;\n\n              case 31:\n                h = l.level, n = l.row, u = l.col;\n                return _context2.abrupt(\"return\", this.resampling && h !== e.level ? this._resampleImage(o, h, n, u, e.level, e.row, e.col) : o);\n\n              case 33:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this, [[2, 8], [14, 24]]);\n      }));\n\n      function fetchTile(_x, _x2) {\n        return _fetchTile.apply(this, arguments);\n      }\n\n      return fetchTile;\n    }()\n  }, {\n    key: \"_enqueueTileFetch\",\n    value: function () {\n      var _enqueueTileFetch2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(e) {\n        var _this5 = this;\n\n        var _t;\n\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                if (this._fetchQueue.has(e.key.id)) {\n                  _context3.next = 12;\n                  break;\n                }\n\n                _context3.prev = 1;\n                _context3.next = 4;\n                return this._fetchQueue.push(e.key);\n\n              case 4:\n                _t = _context3.sent;\n                e.bitmap.source = _t, e.bitmap.width = this._tileInfoView.tileInfo.size[0], e.bitmap.height = this._tileInfoView.tileInfo.size[1], e.once(\"attach\", function () {\n                  return _this5.requestUpdate();\n                });\n                _context3.next = 11;\n                break;\n\n              case 8:\n                _context3.prev = 8;\n                _context3.t0 = _context3[\"catch\"](1);\n                s(_context3.t0) || w.error(_context3.t0);\n\n              case 11:\n                this.requestUpdate();\n\n              case 12:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this, [[1, 8]]);\n      }));\n\n      function _enqueueTileFetch(_x3) {\n        return _enqueueTileFetch2.apply(this, arguments);\n      }\n\n      return _enqueueTileFetch;\n    }()\n  }, {\n    key: \"_fetchImage\",\n    value: function () {\n      var _fetchImage2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(e, t) {\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                return _context4.abrupt(\"return\", this.layer.fetchTile(e.level, e.row, e.col, {\n                  timestamp: this.refreshTimestamp,\n                  signal: t\n                }));\n\n              case 1:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function _fetchImage(_x4, _x5) {\n        return _fetchImage2.apply(this, arguments);\n      }\n\n      return _fetchImage;\n    }()\n  }, {\n    key: \"_resampleImage\",\n    value: function _resampleImage(e, t, i, r, s, a, l) {\n      var o = this._tileInfoView.tileInfo.size,\n          h = this._tileInfoView.getTileResolution(t),\n          n = this._tileInfoView.getTileResolution(s);\n\n      var c = this._tileInfoView.getLODInfoAt(s);\n\n      var u = c.getXForColumn(l),\n          m = c.getYForRow(a);\n      c = this._tileInfoView.getLODInfoAt(t);\n\n      var p = c.getXForColumn(r),\n          f = c.getYForRow(i),\n          g = Math.round((u - p) / h),\n          y = Math.round(-(m - f) / h),\n          w = Math.round(o[0] * (n / h)),\n          d = Math.round(o[1] * (n / h)),\n          _2 = this._createBlankImage();\n\n      return _2.getContext(\"2d\").drawImage(e, g, y, w, d, 0, 0, o[0], o[1]), _2;\n    }\n  }, {\n    key: \"_createBlankImage\",\n    value: function _createBlankImage() {\n      var _e, _e2;\n\n      var e = this._tileInfoView.tileInfo.size,\n          t = document.createElement(\"canvas\");\n      return (_e = e, _e2 = _slicedToArray(_e, 2), t.width = _e2[0], t.height = _e2[1], _e), t;\n    }\n  }]);\n\n  return _;\n}(g(f(o(h(p)))));\n\ne([a()], _.prototype, \"resampling\", null), _ = e([l(\"esri.views.2d.layers.TileLayerView2D\")], _);\nvar I = _;\nexport default I;"],"sourceRoot":""}