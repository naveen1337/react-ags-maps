(window.webpackJsonp=window.webpackJsonp||[]).push([[149],{ag3Y:function(e,t,a){"use strict";a.r(t),a.d(t,"previewSymbol2D",(function(){return b}));var n=a("mK0O"),l=a("WYis"),r=a("Mp7X"),i=a("frPA"),c=a("fVET"),o=a("j5Xy"),s=a("D/n4");function u(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function m(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?u(Object(a),!0).forEach((function(t){Object(n.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):u(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var p="picture-fill",h=120,d=document.createElement("canvas");function f(e,t){var a=d.getContext("2d"),n=[];return t&&(t.weight&&n.push(t.weight),t.size&&n.push(t.size+"px"),t.family&&n.push(t.family)),a.font=n.join(" "),a.measureText(e).width}function v(e){if(0===e.length)return 0;if(e.length>2){var t=Object(i.d)(1),a=parseFloat(e);switch(e.slice(-2)){case"px":return a;case"pt":return a*t;case"in":return 72*a*t;case"pc":return 12*a*t;case"mm":return a*(7.2/2.54)*t;case"cm":return a*(72/2.54)*t}}return parseFloat(e)}function b(e,t){var a,n,u=null!=(null==t?void 0:t.size)?Object(i.c)(t.size):null,d=null!=(null==t?void 0:t.maxSize)?Object(i.c)(t.maxSize):null,b=null!=(null==t?void 0:t.opacity)?t.opacity:null,y=null!=(null==t?void 0:t.rotation)?t.rotation:"angle"in e?e.angle:null,w=Object(c.b)(e),O=Object(c.d)(e);if(w&&!O){var g="type"in w?null:new l.a(w);"#ffffff"===(g?g.toHex():null)&&(O={color:"#bdc3c7",width:.75})}var j={shape:null,fill:null,stroke:O,offset:[0,0]};null!=(a=O)&&a.width&&(O.width=Math.min(O.width,80));var M=(null==(n=O)?void 0:n.width)||0,k=null!=u&&(null==(null==t?void 0:t.scale)||(null==t?void 0:t.scale)),x=0,L=0,P=!1;switch(e.type){case"simple-marker":var z=e.style,S=Math.min(null!=u?u:Object(i.c)(e.size),d||h);switch(x=S,L=S,z){case"circle":j.shape={type:"circle",cx:0,cy:0,r:.5*S},k||(x+=M,L+=M);break;case"cross":j.shape={type:"path",path:[{command:"M",values:[0,.5*L]},{command:"L",values:[x,.5*L]},{command:"M",values:[.5*x,0]},{command:"L",values:[.5*x,L]}]};break;case"diamond":j.shape={type:"path",path:[{command:"M",values:[0,.5*L]},{command:"L",values:[.5*x,0]},{command:"L",values:[x,.5*L]},{command:"L",values:[.5*x,L]},{command:"Z",values:[]}]},k||(x+=M,L+=M);break;case"square":j.shape={type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[x,0]},{command:"L",values:[x,L]},{command:"L",values:[0,L]},{command:"Z",values:[]}]},k||(x+=M,L+=M),y&&(P=!0);break;case"triangle":j.shape={type:"path",path:[{command:"M",values:[.5*x,0]},{command:"L",values:[x,L]},{command:"L",values:[0,L]},{command:"Z",values:[]}]},k||(x+=M,L+=M),y&&(P=!0);break;case"x":j.shape={type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[x,L]},{command:"M",values:[x,0]},{command:"L",values:[0,L]}]},y&&(P=!0);break;case"path":j.shape={type:"path",path:e.path||""},k||(x+=M,L+=M),y&&(P=!0),k=!0}break;case"simple-line":var C=Math.min(null!=u?u:M,d||80),D=C>22?2*C:40;O.width=C,x=D,L=C,j.shape={type:"path",path:[{command:"M",values:[0,L]},{command:"L",values:[x,L]}]};break;case p:case"simple-fill":x=Math.min(null!=u?u:22,d||h)+M,L=x,k=!0,j.shape="object"==typeof(null==t?void 0:t.symbolConfig)&&null!=t&&t.symbolConfig.isSquareFill?o.l.squareFill[0]:o.l.fill[0];break;case"picture-marker":var E=Object(i.c)(e.width),F=Object(i.c)(e.height),q=Math.max(E,F),T=E/F;E=T<=1?Math.ceil(q*T):q,F=T<=1?q:Math.ceil(q/T),x=Math.min(null!=u?u:E,d||h),L=Math.min(null!=u?u:F,d||h),j.shape={type:"image",x:-Math.round(x/2),y:-Math.round(L/2),width:x,height:L,src:e.url||""},y&&(P=!0);break;case"text":var Z=e,A=Z.text||"Aa",H=Z.font,J=Math.min(null!=u?u:Object(i.c)(H.size),d||h),X=f(A,{weight:H.weight,size:J,family:H.family}),Y=/[\uE600-\uE6FF]/.test(A);x=Y?J:X,L=J;var K=.25*v((H?J:0).toString());Y&&(K+=5),j.shape={type:"text",text:A,x:0,y:K,align:"middle",decoration:H&&H.decoration,rotated:Z.rotated,kerning:Z.kerning},j.font=H&&{size:J,style:H.style,decoration:H.decoration,weight:H.weight,family:H.family}}if(!j.shape)return Promise.reject(new r.a("symbolPreview: renderPreviewHTML2D","symbol not supported."));var R=w,V=e.color,W=null;return R&&"pattern"===R.type&&V&&e.type!==p?W=Object(c.c)(R.src,V.toCss(!0)).then((function(e){return R.src=e,j.fill=R,j})):(j.fill=w,W=Promise.resolve(j)),W.then((function(e){var a=[[e]];if("object"==typeof(null==t?void 0:t.symbolConfig)&&null!=t&&t.symbolConfig.applyColorModulation){var n=.6*x;a.unshift([m(m({},e),{},{offset:[-n,0],fill:Object(o.a)(w,-.3)})]),a.push([m(m({},e),{},{offset:[n,0],fill:Object(o.a)(w,.3)})]),x+=2*n}return Object(s.a)(a,[x,L],{node:t&&t.node,scale:k,opacity:b,rotation:y,useRotationSize:P})}))}}}]);
//# sourceMappingURL=149-83ef6f3bf1b53d88fb21.js.map